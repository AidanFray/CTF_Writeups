
GHIDRA Training 0[plage IVa TT [3]ALLL IR ERE LS AR A EE SA
application for performing sof
tware reverse engineering. Ghi
dra is

built upon a completely generi
c application framework. Appli
cation-specific capabilities a

re

provided by small software bur
dles called plugins, each provuser's guide provides detailed

information on how to use bot
h Ghidra's generic and reverse
engineering-specific capabilit

ies.

Intended Audience
This guide is intended for any
one interested in learning howDocument Scope

The purpose of this document |
s to describe how to use Ghidr
a. It does NOT provide
information on the software ar
chitecture or the programming
[ARgiven time, Ghidra capabiliti
es can be added, removed, or
even replaced by changing the
current set of plugins. Conseq
uently, a feature might not be
available as described and the
images shown in this documer
may not exactly match your
display.Fille System Layout

In the directory you choose, a
ghidra installation directory
named

ghidra_<version> is created. T
he following directory structu
[CAVITE

created under the Ghidra insta
llation directory.

Foleo)Wibtal anid on=tine nip

docs
tutorial and on-line help
Extensions

installable extensions for GhiGhidra

essential files for running Gh
idra

GPL

GPL utility and support progralicenses

licenses for non-GPL portions
of Ghidra

server

files required to launch and csupport

files useful for debugging and
configuring

Ghidra

Introduction 2/6

[Ilugins that are not part of th

e base

distribution. They are either
experimental, still under deve
lopment, or

contributed by others. These p
lugins may not have been teste
d, and therefore

may be unstable and are not ir
cluded in anv of the default these plugins OTLEr COTLalrt Lr
e more cutting edge features a
nd may be worth

considering. They are easily a
ccessible and can be added by
configuring a tool.

Io): W {N= Tele

LEY eLIICReIR lI L RTE]
es a plugin for use with IDA P
[XE]hdl i

with IDA Pro

to export IDA Pro databases as
XML files so that they can be

Talelela =e MTp ee)

Ghidra. This allows IDA Pro us
ers to migrate their data to G

LICICN

hla til adie ieee

 

To add the XML exporter plugirr version of IDA from the vers
ion
folders in the <ghidra install
ation directory>/Extensions/ID
Lv )
folder. The plugin is availabl
e for IDA Pro versions 6 and 7

. If you are
unsure of your IDA version, stprogram ... from IDA's main me
nu to display the version.

To export data to Ghidra using
the XML plugin, select File -

> Plugins ->

Dump database as XML file... f
rom IDA's main menu.

Crartimm ~hidraIntroduction 3/6

Launching Ghidra varies deper
ing on the operating system.
Ghidra on Windows:

Run the ghidraRun.batfile loca
ted in the Ghidra installation
directory.

One wav to run this file is toA LA)

ghidra.bat file and then simpl
y double click on the file.
Ghidra on Linux and macOS:
Run the ghidraRunshell script
file located in the Ghidra ins
tallation

directory.

Advanced Startup

Ghidra provides some Java starhaa aid ood
advanced features. To use a st
artup parameter you must opel
support/launch.propertiesand ¢
dd the parameter to that file.
For example,
VMARGS=-Dfont.size.override=

Ghidra Overview
When Ghidra first starts, theIntroduction 4/6

Ghidra Front-End with no open
project

Ghidra is a project-oriented a
pplication and, consequently,efore, the first thing to do i

s to create a project or open
an

existing project. Once a proje
ct is open, Ghidra will displa
y the folders and data that ma
&

up the project along with the
user's current set of tools. O

RR Sa UY a —would not contain any data. Da
ta must be imported into a Ghi
dra project before any work
can be performed. Importing di
ta into a Ghidra project creat
es programs that Ghidra tools
can manipulate.

Introduction 5/6AealLASLC RIA RL SLA LL RR San
project

A Ghidra tool is a configurati
on of plugins that can be used
to manipulate programs.
When Ghidra is first installed
, a default tool - the code br
owser tool - is created for th

IGhidra Project Window.

To run a tool, click on its ic

on in the Tool Chest. When a t
ool is running, a new window
will appear for that tool and
the tool's icon will be displa
yed in the Running Tools area
of

the Ghidra Project Window.is simply a collection of
running tools that are visible
on the desktop. Users can hav
e multiple workspaces, each
with its own set of running to
ols. Running tools that are no
t in the current workspace are
still running and consuming sy
Bul ICEL] though thError Dialogs
Introduction 6/6

Errors may occur in Ghidra. An
error may be anticipated, or

it may be unexpected in

which case it is a programming

aman Ye eer Sinan,General Errors

Whenever an action or operatic
n does not complete as desirec
, butis an

anticipated error such as a us
er entering a file path that d
[IE RE Ele]

will display an Error dialog e
xplaining the cause of the pro
blem as shownUnexpected Programming Erro
Whenever an action or operatic
n fails in a totally unexpecte

d way, i.e., a programming
error, a dialog is displayed a

s shown below:

The Details >>> button expanfal ohio if ori
stack trace. (The stack trace
is also output to the console.

)

Introduction 1/6

Introduction
Ghidra is a highly extensibleIch

built upon a completely generi
c application framework. Appli
cation-specific capabilities a

re

provided by small software bur
dles called plugins, each prov

iding one or more features. Thh Ghidra's generic and reverse
engineering-specific capabilit
ies.

Intended Audience

This guide is intended for any
one interested in learning how
to use Ghidra to reverse
engineer a software system.‘I'he purpose of this document |
s to describe how to use Ghidr
a. It does NOT provide
information on the software ar
chitecture or the programming
[48

Disclaimer
Ghidra is configurable. At any
aiven time Ghidra capabilitiSVEN Teplalel Ly Lhallygling Lic
current set of plugins. Conseq
uently, a feature might not be
available as described and the
images shown in this documer
may not exactly match your
display.

Getting Started
REESE CEE 1dEb atl dati bet aba
named

ghidra_<version> is created. T
he following directory structu
[CAVITE

created under the Ghidra insta
llation directory.

docs

tutorial and on-line helpdocs

tutorial and on-line help
Extensions

installable extensions for Ghi

dra, Eclipse and
IDA Proessential files for running Gh
idra

GPL
GPL utility and support progra

ms used by
Ghidralicenses for non-GPL portions
of Ghidra

server
files required to launch and c

onfigure the
Ghidra serverfiles useful for debugging and
configuring
Ghidra

Introduction 2/6
Extensions

There are a number of Ghidra
lugins that are not part of thfad Mat bal
experimental, still under deve
lopment, or

contributed by others. These p
lugins may not have been teste
d, and therefore

may be unstable and are not ir
cluded in any of the default t
ools. However,

these plugins often contain thconsidering. They are easily a
ccessible and can be added by
configuring a tool.

Io): W {N= Tel ed

LEY eLIICReIR Glo L RT ET]
es a plugin for use with IDA P
ro (a

commercially available disasse
uh The XML plugin is usedXML files so that they can be
imported into

Ghidra. This allows IDA Pro us
ers to migrate their data to G
LICICN

To add the XML exporter plugir
to your IDA installation:
Locate the README file for you

» sresrei rare SE VFSA | Zrrervd Flos vies pesfolders In the <ghidra Install
ation directory>/Extensions/ID
Le)

folder. The plugin is availabl

e for IDA Pro versions 6 and 7
RISCIVETC

unsure of your IDA version, st
art IDA and select Help -> Abo
[f1

prodaram from IDA's main me10 EAPOIL Udla LO Lillia Usitty
the XML plugin, select File -
> Plugins ->

Dump database as XML file... f
rom IDA's main menu.

Starting Ghidra

[Riegel [VT a le Ta RET (5)ing on the operating system.
Ghidra on Windows:

Run the ghidraRun.batfile loca
ted in the Ghidra installation
directory.

 

at lor tai Baath wf a

One way to run this file is to
use the Windows file explorer
JRE ERTGhidra on Linux and macOS:
Run the ghidraRunshell script
file located in the Ghidra ins
tallation

directory.

Advanced Startup

Ghidra provides some Java star
tup parameters which allow for
the usage ofsupport/launch.propertiesand ¢
dd the parameter to that file.
For example,
VMARGS=-Dfont.size.override=

Ghidra Overview

When Ghidra first starts, the
Ghidra Project Window will apy
CETIntroduction 4/6

Ghidra Front-End with no open
project

Ghidra is a project-oriented a

pplication and, consequently,

all work must be performed in
the context of a project. Ther

efore the first thina todo iLL

existing project. Once a proje
ct is open, Ghidra will displa

y the folders and data that ma
&

up the project along with the
user's current set of tools. O

f course, newly created projec
1S

would not contain any data. Daatanal doh losbatemaurstaiud isola’ tdi
can be performed. Importing di
ta into a Ghidra project creat
es programs that Ghidra tools
can manipulate.

Introduction 5/6

Ghidra Front-End with an openA Ghidra tool is a configurati
on of plugins that can be used
to manipulate programs.
When Ghidra is first installed

, a default tool - the code br
owser tool - is created for th

e

user and its icon is displayed
in lu Tool [SL area of lu)on in the Tool Chest. When a t
ool is running, a new window
will appear for that tool and
the tool's icon will be displa
yed in the Running Tools area
of

the Ghidra Project Window.
Ghidra also supports the conce
pt of workspaces. A workspace

ern, (AL |on the desktop. Users can hav
e multiple workspaces, each
with its own set of running to
ols. Running tools that are no
t in the current workspace are
still running and consuming sy
stem resources even though th
NEIGH AENIntroduction 6/6

Errors may occur in Ghidra. An
error may be anticipated, or

it may be unexpected in

which case it is a programming
error. Each type of error is
described below.

General Errors, butis an

anticipated error such as a us
er entering a file path that d
[IE RE Mele]

will display an Error dialog e
xplaining the cause of the pro
blem as shown

below in the sample error dial
og:Whenever an action or operatic
n fails in a totally unexpecte

d way, i.e., a programming
error, a dialog is displayed a

s shown below:

The Details >>> button expan
the dialog to show the detail
H s of the javaIntroduction 1/6

Introduction

Ghidra is a highly extensible
application for performing sof
tware reverse engineering. Ghi

paneCc application framework. Appli
cation-specific capabilities a

re

provided by small software bur
dles called plugins, each prov
iding one or more features. Th
[5]

user's guide provides detailed
information on how to use bot
h Ghidra's aeneric and reverseLh

Intended Audience

This guide is intended for any
one interested in learning how
to use Ghidra to reverse
engineer a software system.

Document Scope
The purpose of this document iA me A
information on the software ar
chitecture or the programming
[48

Disclaimer

Ghidra is configurable. At any
given time, Ghidra capabiliti
es can be added, removed, or
even replaced by changing theavailable as described and the
images shown in this documer
may not exactly match your
display.

Getting Started

File System Layout

In the directory you choose, a
ghidra installation directoryhe following directory structu
[CAVITE

created under the Ghidra insta
llation directory.

docs

tutorial and on-line help

prtutorial and on-line help
Extensions

installable extensions for Ghi
dra, Eclipse and

IDA Pro

GhidraLLl-)

GPL

GPL utility and support progra
ms used by

Ghidra

licensesserver
files required to launch and c
onfigure the

Ghidra server

supportGhidra
Introduction 2/6

Extensions

There are a number of Ghidra
lugins that are not part of th

e base

CIE EI ED] They are eithercontributed by others. These p
lugins may not have been teste
d, and therefore

may be unstable and are not ir
cluded in any of the default t
ools. However,

these plugins often contain th
e more cutting edge features a
nd may be worth

rari rd evi mre “Tinea swat a meting mwconfiguring a tool.

Io): W {N= Te] ed

LEY eh ICReIR lI L RTE]
es a plugin for use with IDA P
ro (a

commercially available disasse
mbler). The XML plugin is used
with IDA Pro

to export IDA Pro databases as
XML files so that thev can beAelia BL A
ers to migrate their data to G
LICICN

To add the XML exporter plugir
to your IDA installation:
Locate the README file for you
r version of IDA from the vers
ion

folders in the <ghidra installfolder. The plugin is availabl

e for IDA Pro versions 6 and 7

. If you are

unsure of your IDA version, st
art IDA and select Help -> Abo
ut

program ... from IDA's main me
nu to display the version.

To export data to Ghidra usingIT Re CI as XML file... f
rom IDA's main menu.
Starting Ghidra

Introduction 3/6

Launching Ghidra varies deperRun the ghidraRun.batfile loca
ted in the Ghidra installation
directory.

One way to run this file is to
use the Windows file explorer
JRE ERT

ghidra.bat file and then simpl
y double click on the file.

Fhidra mm limiiv ame meas.Tile located In the Ghidra ins
tallation

directory.

Advanced Startup

Ghidra provides some Java star
tup parameters which allow for
the usage of

advanced features. To use a st
artup parameter you must opel
supbort/launch propertiesand :LRA CER) SLA
VMARGS=-Dfont.size.override=

Ghidra Overview

When Ghidra first starts, the
Ghidra Project Window will apy
CET

Introduction 4/6Eitc e d fa aalel

project

Ghidra is a project-oriented a
pplication and, consequently,
all work must be performed in
the context of a project. Ther
efore, the first thing to do i

s to create a project or open
any the folders and data that ma
&

up the project along with the
user's current set of tools. O

f course, newly created projec
1S

would not contain any data. Da
ta must be imported into a Ghi
dra project before any workes programs that Ghidra tools
can manipulate.
Introduction 5/6

Ghidra Front-End with an open
project

AChidra Frnl ie a ~reanfirt rabto manipulate programs.
When Ghidra is first installed
, a default tool - the code br
owser tool - is created for th

e

user and its icon is displayed
in the Tool Chest area of the
Ghidra Project Window.

To run a tool, click on its ic

on in the Tool Chest When a tWilh appedl TOF Liat LOOT alld
the tool's icon will be displa
yed in the Running Tools area
of

the Ghidra Project Window.
Ghidra also supports the conce
pt of workspaces. A workspace
is simply a collection of
running tools that are visible
on the desktop. Users can havols. Running tools that are no
tin the current workspace are
still running and consuming sy
stem resources even though th
NEICI AY EIN

Error DialogsErrors may occur in Ghidra. An
error may be anticipated, or

it may be unexpected in

which case it is a programming
error. Each type of error is
described below.

General Errors

Whenever an action or operatic
n does not complete as desirecer entering a file path that d
[IE REG ME Te]

will display an Error dialog e
xplaining the cause of the pro
blem as shown

below in the sample error dial
[IH

Unexpected Programming Erro

TR Lrd way, I.e., a programming
error, a dialog is displayed a
s shown below:

The Details >>> button expan
the dialog to show the detail
s of the java

stack trace. (The stack trace

is also output to the console.

)Introduction 1/6

Introduction

Ghidra is a highly extensible
application for performing sof
tware reverse engineering. Ghi
Ich

built upon a completely generi
[Tel IE Ri CI Ee Lo Yel sli]provided by small software bur
dles called plugins, each prov

iding one or more features. Th

5

user's guide provides detailed

information on how to use bot
h Ghidra's generic and reverse
engineering-specific capabilit

ies.This guide is intended for any
one interested in learning how
to use Ghidra to reverse
engineer a software system.

Document Scope
The purpose of this document |
s to describe how to use Ghidr
a. It does NOT provideLR

Disclaimer

Ghidra is configurable. At any
given time, Ghidra capabiliti
es can be added, removed, or
even replaced by changing the
current set of plugins. Conseq
uently, a feature might not be

PN RY A rl amay not exactly match your
display.

Getting Started

File System Layout

In the directory you choose, a
ghidra installation directory
named

ghidra_<version> is created. T
he followina directorv structuhe A A AS BLA LAE LE LL EL)
llation directory.
docs

tutorial and on-line help

docs

tutorial and on-line helpinstallable extensions for Ghi
dra, Eclipse and

IDA Pro

Ghidra

essential files for running Gh
idraGPL utility and support progra
ms used by
Ghidra

[ICH

licenses for non-GPL portions
of Ghidrafiles required to launch and c
onfigure the
[LICE EY

support

files useful for debugging and

configuring
y od TEEIntroduction 2/6

Extensions

There are a number of Ghidra
lugins that are not part of th

e base

distribution. They are either
experimental, still under deve
lopment, or

contributed bv others These pbTEC RR AS A

may be unstable and are not ir
cluded in any of the default t
ools. However,

these plugins often contain th
e more cutting edge features a
nd may be worth

considering. They are easily a
ccessible and can be added by
configuring a tool.es a plugin for use with IDA P

ro (a

commercially available disasse
mbler). The XML plugin is used
with IDA Pro

to export IDA Pro databases as
XML files so that they can be
imported into

Ghidra. This allows IDA Pro usTo add the XML exporter plugir
to your IDA installation:
Locate the README file for you
r version of IDA from the vers
ion

folders in the <ghidra install
ation directory>/Extensions/ID. If you are

unsure of your IDA version, st
art IDA and select Help -> Abo
ut

program ... from IDA's main me
nu to display the version.

To export data to Ghidra using
the XML plugin, select File -

> Plugins ->

ur TM Toe. TIN IMStarting Ghidra
Introduction 3/6

Launching Ghidra varies deper
ing on the operating system.
Ghidra on Windows:

Run the ahidraRun batfile locaunecory.

One way to run this file is to
use the Windows file explorer
JRE ERT
ghidra.bat file and then simpl
y double click on the file.
Ghidra on Linux and macOS:
Run the ghidraRunshell script
file located in the Ghidra inshiatus’ Jd
Advanced Startup

Ghidra provides some Java star
tup parameters which allow for
the usage of

advanced features. To use a st
artup parameter you must opel
support/launch.propertiesand ¢
dd the parameter to that file.
For example,Ghidra Overview

When Ghidra first starts, the
Ghidra Project Window will apy
CET

Introduction 4/6

Ghidra Front-End with no openGhidra is a project-oriented a
pplication and, consequently,
all work must be performed in
the context of a project. Ther
efore, the first thing to do i

s to create a project or open
an

existing project. Once a proje

ct is open, Ghidra will displa
rT IT ey a peup the project along with the
user's current set of tools. O

f course, newly created projec
1S

would not contain any data. Da
ta must be imported into a Ghi
dra project before any work
can be performed. Importing di
ta into a Ghidra project creat
es nroarams that Ghidra toolsIntroduction 5/6

Ghidra Front-End with an open
project

A Ghidra tool is a configurati
on of plugins that can be used
to manipulate programs.owser tool - is created for th

e

user and its icon is displayed
in the Tool Chest area of the
Ghidra Project Window.

To run a tool, click on its ic

on in the Tool Chest. When a t
ool is running, a new window
will appear for that tool andof

the Ghidra Project Window.
Ghidra also supports the conce
pt of workspaces. A workspace
is simply a collection of
running tools that are visible
on the desktop. Users can hav
e multiple workspaces, each
with its own set of running tostill running and consuming sy
stem resources even though th
NEIGH IN

Error Dialogs

Introduction 6/6

oT, TRY | WW WT TeeIt may be unexpected In

which case it is a programming
error. Each type of error is
described below.

General Errors

Whenever an action or operatic
n does not complete as desirec
, butis an

anticipated error such as a us
er enterina a file path that dWilh display afl ETO Uigaloy ©
xplaining the cause of the pro
blem as shown

below in the sample error dial
og:

Unexpected Programming Erro
Whenever an action or operatic
n fails in a totally unexpecte

d way, i.e., a programmingThe Details >>> button expan
the dialog to show the detail
s of the java

stack trace. (The stack trace

is also output to the console.

)GHIDRA Training 1
TOP SECRET//CYBER//NOFORN[plage IVa TT [3]

Introduction

Ghidra is a highly extensible
application for performing sof
tware reverse engineering. Ghi

BRE.Cc application framework. Appli
cation-specific capabilities a

re

provided by small software bur
dles called plugins, each prov
iding one or more features. Th
is

user's guide provides detailed
information on how to use bot
h Ghidra's aeneric and reverseLh

Intended Audience

This guide is intended for any
one interested in learning how
to use Ghidra to reverse
engineer a software system.

Document Scope
The purpose of this document iA me A
information on the software ar
chitecture or the programming
[48

Disclaimer

Ghidra is configurable. At any
given time, Ghidra capabiliti
es can be added, removed, or
even replaced by changing theavailable as described and the
images shown in this documer
may not exactly match your
display.

Getting Started

File System Layout

In the directory you choose, a
ghidra installation directoryhe following directory structu
[CAVITE

created under the Ghidra insta
llation directory.

docs

tutorial and on-line help

prtutorial and on-line help
Extensions

installable extensions for Ghi
dra, Eclipse and

IDA Pro

GhidraLLl-)

GPL

GPL utility and support progra
ms used by

Ghidra

licensesserver
files required to launch and c
onfigure the

Ghidra server

supportGhidra
Introduction 2/6

Extensions

There are a number of Ghidra
lugins that are not part of th

e base

CIE EI ED] They are eithercontributed by others. These p
lugins may not have been teste
d, and therefore

may be unstable and are not ir
cluded in any of the default t
ools. However,

these plugins often contain th
e more cutting edge features a
nd may be worth

rari rd evi mre “Tinea swat a meting mwconfiguring a tool.

Io): W {N= Te] ed

LEY eh ICReIR lI L RTE]
es a plugin for use with IDA P
ro (a

commercially available disasse
mbler). The XML plugin is used
with IDA Pro

to export IDA Pro databases as
XML files so that thev can beAelia BL A
ers to migrate their data to G
LICICN

To add the XML exporter plugir
to your IDA installation:
Locate the README file for you
r version of IDA from the vers
ion

folders in the <ghidra installfolder. The plugin is availabl

e for IDA Pro versions 6 and 7

. If you are

unsure of your IDA version, st
art IDA and select Help -> Abo
ut

program ... from IDA's main me
nu to display the version.

To export data to Ghidra usingIT Re CI as XML file... f
rom IDA's main menu.
Starting Ghidra

Introduction 3/6

Launching Ghidra varies deperRun the ghidraRun.batfile loca
ted in the Ghidra installation
directory.

One way to run this file is to
use the Windows file explorer
JRE ERT

ghidra.bat file and then simpl
y double click on the file.

Fhidra mm limiiv ame meas.Tile located In the Ghidra ins
tallation

directory.

Advanced Startup

Ghidra provides some Java star
tup parameters which allow for
the usage of

advanced features. To use a st
artup parameter you must opel
supbort/launch propertiesand :LRA CER) SLA
VMARGS=-Dfont.size.override=

Ghidra Overview

When Ghidra first starts, the
Ghidra Project Window will apy
CET

Introduction 4/6Eitc e d fa aalel

project

Ghidra is a project-oriented a
pplication and, consequently,
all work must be performed in
the context of a project. Ther
efore, the first thing to do i

s to create a project or open
any the folders and data that ma
&

up the project along with the
user's current set of tools. O

f course, newly created projec
1S

would not contain any data. Da
ta must be imported into a Ghi
dra project before any workes programs that Ghidra tools
can manipulate.
Introduction 5/6

Ghidra Front-End with an open
project

AChidra Frnl ie a ~reanfirt rabto manipulate programs.
When Ghidra is first installed
, a default tool - the code br
owser tool - is created for th

e

user and its icon is displayed
in the Tool Chest area of the
Ghidra Project Window.

To run a tool, click on its ic

on in the Tool Chest When a tWilh appedl TOF Liat LOOT alld
the tool's icon will be displa
yed in the Running Tools area
of

the Ghidra Project Window.
Ghidra also supports the conce
pt of workspaces. A workspace
is simply a collection of
running tools that are visible
on the desktop. Users can havols. Running tools that are no
tin the current workspace are
still running and consuming sy
stem resources even though th
NEICI AY EIN

Error DialogsErrors may occur in Ghidra. An
error may be anticipated, or

it may be unexpected in

which case it is a programming
error. Each type of error is
described below.

General Errors

Whenever an action or operatic
n does not complete as desirecer entering a file path that d
[IE REG ME Te]

will display an Error dialog e
xplaining the cause of the pro
blem as shown

below in the sample error dial
[IH

Unexpected Programming Erro

TR Lrd way, I.e., a programming
error, a dialog is displayed a
s shown below:

The Details >>> button expan
the dialog to show the detail
s of the java

stack trace. (The stack trace

is also output to the console.

)Docking Windows
Docking Windows 1/3

Ghidra tools provide various G
Ul components that allow user:
to view and manage programs
The Docking Windows feature :
lows users to customize theLd

 

The Basic Dockable Componen
The image below shows a tool
ith three Dockable Component
Program Trees, Listing, and D
ata Type Manager.

Each component consist of sev
ral common parts:the component and displays tt
e title of the window. It also
serves as a handle for draggi
ng the component to other
positions within the tool. The
el ISN CE Rl [TA Te eE TEER)
hether the component has key
ard focus. When the componen
has focus, the titleve focus at a time.

Local Toolbar

The title bar also serves as a
local toolbar. It contains ic
ons for actions that apply onl
y to this component. Hovering
the mouse over an icon

causes a tool tip to be displa

yed. The tool tip give a hint

PE VE LS Fat[UE TTRTS)
Docking Windows 2/3

The menu icon will appear if t
he dockable component has a
cal menu. As with the local to
olbar the local menu item appLOMPLNENL. MOuUsc CHLK OI LHC
icon to show the menu.

Close Icon

ELIE

to hide the dockable componer
. The component will be remov
d until you select the compone
nt's name from the tool's Wind
ow

menu. Some components, suckSEA Che el

hen you close these componen

hi it

Work Area

The work area contains the spe
cific GUI component that is be
ing managed.

Arranging Components
Docking Windows allows usersneeds. There are three ways c
omponents can be arranged in
jell
1. Docked with other compone
s: components are side-by-side
(or top to bottom) with anoth
er component.

2. Stacked with other compone
ts: components share the same3. In their own window: a comy
onent can be placed in its own
LULA

Moving Components
Components can be rearrange
y dragging them in various way
s. To drag a component, press

and hold the left mouse button
rv Fleas 535 la bomna begin moving the mouse. [|
mouse cursor will change to i
ndicate what will happen if th
e mouse button is

released at that location.
Invalid Location - releasing h
ere will cancel the drag opera
<1,

Will move the component to th
left of the component that thWi move Lhe Lomponent Lo Ll
right of the component that t
he mouse cursor is over.

Will move the component abov
the component that the mouse
ursor is over.

Will move the component belo!
the component that the mouse
ursor is over.

Will stack the component withhai tink ul Shaclbandaabint elitist aha
effect.

Will place the component in a
new window.

To get the arrow cursors to ap
pear, move the mouse near the
inside edge of another compon
nt. To get the stack cursor, m
ove the mouse

over the middle area of anotheer the desktop. The Invalid lo
cation cursor

will appear when the mouse is
over the component being mow

Resizing components

Docked components are separ:
d by thin borders. When the me
use is moved over a border whicursor will change to a resize
icon. To change the relative s
ize of the components, press t
he left mouse button while ove
r a border and drag

the border in the appropriate
HELA

Renaming Components

Trmmeiant rarainAlnante (a Nn caRight-click on either the titi

e bar or tab of a transient wi
ndow and a popup menu item
|

appear that allows you to chan
ge the title of that component
. This can be useful when you
wish to better identify search
results when you have perforr
edWindows Menu

Windows Menu
Docking Windows 3/3

Each component currently loac
d in the tool has a correspondponent can be used to show a
component that is currently no
t visible. If the component is
already showing, it will be b
rought to the front (if it is
behind some other component
windows) and the component \
| be made active (have keyboal
d focus). Temporary windows sbelow the separator bar. Multi
ple windows of the same type :
re grouped into sub-menus. Fo
example the following snapshe
t of a window menu

indicates there are several se
arch results windows open.Tool Options

Ghidra Tool

Ghidra Project Window
Ghidra Front End 1/12

The Project Window is displaye

IEA NL I EE AEjects, workspaces, Programs, a
nd tools. If

you are running Ghidra for the
first time, you will need to
create a new project to get st
arted.

The Project Window is a tool a
nd may be configured with "sp
cial" plugins that provide gen
eral capabilities that mav beEVEL. Dy Ucialult, thc rifoject
Window contains plugins for i
mporting and exporting Progra
s, archiving a project, and re
storing an archived

project. These plugins may be
added to other tools.

The options for archiving and
restoring a project will show
up only in the Ghidra ProjectAEE
these options can be added to
other tools.

The following sections describ
e the Project Window:
LINES

Active Project Panel
Read-Only Project Data Panel
WorkspacesGhidra Server Connection Stat
B

Data Tree

Data Table

File Icons

Console

Configure Project Window

Edit Menu OptionsEdit Menu Options
Manage Tools
Getting Help

Exit Ghidra

Ghidra Front End 2/12

LINES
The Tool Chest shows the tools

PUTO Ca A TRAE TN FeyIdra-<version>/tools folder. I
he tools are

placed there when you initiall
y install Ghidra. These tools
are always available to your c
urrently open project. See Ghi
dra Tool

Administration for information
on managing tools. The Tool C
hest panel is a tool bar withLOH your 1001

Chest.

You can launch a tool by click
ing on the icon. You can launc
h a tool with a Program by dra
gging a Program file from the
Project data

tree and dropping it on the to
ol icon in the Tool Chest.ali rill alto a’ acest bos alllc dad de
your programs and datatype ar
hives in a tree view or a tabl

e view. The tree view is usefu

| for organizing

your files into folders and su
b-folders. The table view is u
seful for sorting all your fil

es on some particular attribut
e such as size,d perform various actions on p
rogram files or datatype archi
ves.

Project Data Tree

The data tree shows all files
in the project orgnanized into
folders and sub-folders. Icon
s for files indicate whether ther you have the file checked
out. Open this view by activat
ing the "Tree View" tab.

Tree Only Actions

The data tree supports the fol
lowing operations:

Create New Folder

To create a new folder,
Li IE FO T T2. Right mouse click and choos
e the New Folder option.

3. A new node is created in th
e tree; a cell editor is displ
ayed, containing the default n
ame, New Folder; enter a new
name, or the <Escape> key to
ancel the editing.Lil LUE RHI CL eet ht ll
ancel the editing.

Ghidra Front End 3/12

You cannot create a sub-folder
of a folder that you do not o
LGR

Copy Folders and Files

To copy folders and files to a
nother folder that you own,hula Bde ato oi uchintntadibiainnil aia)
ders and files.

If you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Copy option.

3. Select a destination folderarge files, an "in progress" d
ialog is displayed. You may
cancel the paste operation at
any time.

Move Folders and Files

To move folders and files to a
nother folder that you own,
1. Select a file or folder; yoIf you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Cut option; the icon wil

| change to a dithered image t
o indicate the cut operation.

3. Select a destination foldere the Paste option.

You cannot move a file that is
in use.

Drag/Drop for Copy

You can get the same effect of
Copy/Paste using Drag and Dr

1. Select a folder or file (or
multiple folders and files)Ulay Lhe URJELL LO another 101
[E18
3. Drop the object on a folder

You will not get a valid drop
target for folders that you do
lel R

If you release the Ctrl key du
ring the drag, the operation cha ahi Sallie Lill Sob ol
own. Dragging files from anoth
er user always results in a co
py, regardless of whether you
hold down the Ctrl key.
Drag/Drop for Move

You can get the same effect of
Cut/Paste using Drag and Droy

1. Select a folder or file and2. Release the mouse button w
en you get a valid drop target

If a folder or file already ex

ists in the destination folder

, Ghidra will append a ".copy"
to the name to make it uniqueits descendant folders,

To expand a folder and all of
its descendant folders,

1. Select a folder.

2. Right mouse click and choos
e the Expand All option.

Flhidra Frank End A719lo collapse a folder and all o

f its descendant folders,

1. Select a folder.

2. Right mouse click and choos
e the Collapse All option.

Project Data Table

The data table shows all files
in the proiect in a table sorARR LLCS EE] Sl SA AP
files are

sorted on file type. Icons for
files indicate whether they a
re under version control and w
hether you have the file check
ed out.
To open this view, active the
"Table View" tab.PEELE

Deleting folders is a recursiv
e operation, so all descendant
folders and files are also de
leted. This is a permanent ope
ration.

To delete a folder or file,

1. Select the folder or file oIf you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Delete option.

The Delete option is disabled
fora Ls that is in use.1. Select the folder or file.

2. Right mouse click and choos
e the Rename option.

3. A cell editor is displayed;
enter the new name.

3. A cell editor is displayed
; enter the new name.

TS 4 ra) ies Han ems pon ms ce i bas Pupate 3 MlovanpsGhidra Front End 5/12

You cannot rename a file that
isin use.

You cannot rename your projec
LelCIS

Select All

To select a folder and all of

its descendants<. RHUL MOUSE CHLK alll CLHULS
e the Select All option.

Read-Only

To mark a file as read only,

1. Select a file.

2. Right mouse click and choos
e the Read-Only option.

The icon for the file is updat
ed to indicate the read only shadi Nalanda anthii filoiastotin tent bitudiatadiniet | ital lia

LC)

Read-Only option.

A read-only Program must be s
ved to a new name if you make
changes to it.

You cannot change the read-or
y state of a file while it is

in use.

Drag File to a Toolol icon in the Tool Chest.

To open a file in a running to
ol, drag a file to the tool ic

on in the Running Tools tool b
ar, OR drag the file to the to
[RLS

Open a File in the Default Toot," double click on the Progra
m that you want to open, OR ri
ght mouse

click on the file and choose O
pen in Default Tool.

Open a File With a Specific To
ol
To launch a tool with a specif

Ea2. Right mouse click and choos
CXel-EhR i]

<tool name>.

Refresh

The

button on the tool bar refresh
es the list of files in the se
lected folders This is a wavad

structure with the project rep
ository. The list of files and
folders in the Project Data T
ree is updated. This button is
enabled

only for selected folders. You
can also refresh folders from
a viewed project or viewed re
pository.LID
Ghidra Front End 6/12

To view information about a fi
le, right mouse click on the f
ile in the data tree and choos
e the About... option.There are numerous actions rel
ated to version control. See P
roject Repository for details.

File Icons
The Project Data Tree shows ic
ons for the following types of
files:

REY Ice project)

The Project Data Tree shows m
difications to these icons for
files in the following states

File Status

Sample Icon in Project Data

Ea.Description

Versioned File not checked
out.

The program named "Example
versioned as

indicated by the light purple
background. It is

not checked out since thereLhELK ITalk. VEIsIon Lis thei
atest version, as

indicated by "(1)"; the versio
LRUIIR-ER

latest version when the file i
s not checked out.

Versioned File is Checked out
exclusively by you.i igiekad én
checked out, as indicated by "
(1of 1)";

Version 1 is the latest versio
n. The blue check

mark icon indicates that the f
ile is checked out

with an exclusive lock.

If your project is not associa
ted with a Ghidrachecked out and the check out
will always be

exclusive, since the project i

s not shared.

Versioned File is Checked
Out; the project is associated
with a Ghidra Serverchecked out; Version 3 is the
latest version on

the server, as indicated by "(

3 of 3)" and the

green circle with a check mark
. The asterisk

indicates you have changes to
the file which

have not been checked in yet.Out; the project Is associated
with a Ghidra Server. A
newer version exists on the
server.

Version 2 of the program name
SETI

checked out; a Version 3 has b
een created since

Version 2 was checked out asARCS ECLA EAR A A LC SL A
with a check

mark. The asterisk indicates y
ou have changes

to the file which have not bee
n checked in yet.

Private File

A program named "ExamplRacha f Shh anal etait al
n your local
machine, and is not visible to
other users.

Hijacked File
The private file "Example" exi

HER Ig
computer, but another user adithe private file to

appear as hijacked, (i.e., the
file can be saved

BEER ERE Te RSE TT Ie)
you do not have

the the file checked out that
is on the Ghidra

Server.) Hijacked files may al
so result from aversion of "Example" will not
be visible in

Hijacked File
checkout that was terminated.

The shared
version of "Example" will notyour project until you undo th
e hijack.

You Front End 7/12

can also either rename the hij
acked "Example",

move it to another folder, del
ete it, or use the

Undo Hijack action. Then the s
hared

"Examble" will appear in vourversioned rie.

Read-Only Project Data

You can view data from other P
rojects or remote Repositories

and copy data into your curre

nt Project's data folders.

View Other Projects

To view the data from another

[IEEEN

ES

Select Project

View Project...

A file chooser is displayed; t
he default location is the pro

jects folder in the installati
on folder.A new tab for the data tree is
created in the "READ-ONLY Pre
ject Data" panel in the Projec

t Window, next to the

Active Project panel; the tab
shows the name of the project.
5. The list of recent projects
menu is updated to include th
is project.You can copy and paste folder
s (via menus or drag and drop)
and files from the other view
to your folders.

Ghidra Front End 8/12
You do not have to hold the Ct

rl key down when you drag frot

PR A SEA Tr SL TEas this view Is always read-on
ly.

View a Shared Project

You view a shared project the
same way you would a non-sha
d project; the difference is t
hat when you view the shared
project, an attempt is made to
connect to the Ghidra Server
associated with that proiectA ALA AR LE AAS A I
dra Server for the other share
d project, you may have to ent
er a password. If the connecti
on

to the Ghidra Server is unsucc
essful, then the only files av
ailable to you are your privat

e files.

View a Repositorytacit lu wi ttatd ood A
1. Select Project

View Repository...

2. A repository chooser is dis
played; allowing you to specif
y a Ghidra Server network add]
ess and select one of its
repositories...

3. Enter the Ghidra Server add
ress and port. The default porthe right of the host name an
d port fields. This will conne

ct to the specified Ghidra Ser
Cl

and list available repositorie

s for which you have been gran
ted access. You may be prompt
d for a password should

user authentication be neededlable.

6. Click the Select Repository
button. A new tab for the dat
a tree is created in the "READ
-ONLY Project Data" panel

in the Project Window, next to
the Active Project panel; the
tab shows the URL of the remc
te repository.

= The liek Af rarant mrniarteto include this repository.

View Recent

Ghidra maintains a list of Pro
jects and remote Repositories
that were recently viewed.

To view a recently opened proj
[Ele eT =To Te E]1 els"

1. Select Project

View RecentLola
2. Select a project or reposit
ory from the menu.

If the project/repository is n

ot in the view, a new tab is c
reated in the "READ-ONLY Proj
ct Data" panel in

the Project Window; the tab sh
ows the name of the project or
repository URL.hiicalinh ibd Tel lg Laatalata

ository is selected.

Close View

To close a view, select Projec

t Close View

<project path/repository URL>
OR click on the small 'X* on
the specific

view tab, OR right mouse clickThe tab is removed from the "R
EAD-ONLY Project Data" panel
n the Project Window.

Close All Read-Only Views

To close all read-only views a

t once, select Project

Close ViewThe tabbed pane for read-only
Project data is removed from t
he Project Window.

Workspaces

A workspace contains a set of
running tools, and the tools’

IR ET 1 EVRWhen you switch

Ghidra

to another workspace, you swit
ch to a different set of runni

ng tools. The tools from the o
ther workspace remain running
butFront

are notEnd 9/12

visible until you switch back

to that workspaceRL LE a LLL A ALR LR RL} ®
Tools panel. Switch to anothe
r workspace by choosing a nan
LHCInRGE
list. The default workspace, n
amed "Workspace," is created
n the project.

The workspace state, i.e., run
ning tools, tool connections,
tool configuration, etc., is mProject.

To create a new workspace,

1. Select Project

Workspace Add...

2. A dialog is displayed; ente

r a new workspace name. Dupl
ate workspace names are not a
[VER

3. Click on the OK button; thename is added to the list of w
orkspaces

in the combo box.

If you leave "Workspace" as th
e new workspace name in the ¢
alog and click on OK, a one-up
number is appended to the
name to make it unique.

To rename the current workspzname...
2. A dialog is displayed.

3. Enter the new name for the
current workspace. Duplicate v
orkspace names are not allowe
. The list of workspace names
5

updated to reflect the new nan
e.

Tr Aalata Fhe rirrant wwarbemns1. Select Project Workspace De
lete...

2. A dialog is displayed to co
nfirm your delete request.

3. Choose the Delete button to
delete the workspace.

Tools in the workspace are clo
sed.

If you made changes to a file
that is not open in anv otherSU LO prompt you Lo save youl
changes.

The oldest workspace becomes
he current workspace. If the d
eleted workspace was the last
one, then the default
workspace ("Workspace") becc
s the current workspace.

To switch workspaces,2. Switches sequentially throu
gh the list of workspaces (in
creation order), wrapping back
to the first after the last h

as been reached.

For example: WS1, WS2, WS3,
en WS1.

3. If only 1 workspace exists,
this action will do nothing.The Running Tools panel show:
an icon for each tool that is
running in the current workspa
ce. Click on the icon to bring
that tool

forward on your console. To cl
ose the tool from the Running
Tools panel, right mouse click
on the icon for the tool andTo connect running tools, drag
one icon onto another icon. T
hose tools are connected for a
Il tool events.

Tools running in different wor
kspaces may be connected.

Ghidra Server Connection Stat
BIf your project Is associated
with a Ghidra Server, then be
low the Running Tools panel yc
u will see a connection status
panel that shows

Ghidra

the name of the Project Reposi
tory, your access privileges,
and an indication of whether y
ou are currently connectedAealLiLC A E T

Server. The status button,
indicates that your project re
pository is connected to the G
hidra Server; the status butto
n,

indicates that your project re
pository is associated with a
Ghidra Server but it is not co
nnected to it.this status panel is empty.

Edit Project Access List

If your project is shared, the
Project menu has an option to
edit the project access list.
This list controls what users
have access to the

project and what privileges thoject, the option for Project
[SCI TI[Te

Access List will be enabled. T
he dialog displayed when you ¢
elect this option shows a pane
I that is the same as the one
you see in the

New Project Wizard when you ¢
3 up MCR user list IS new proo add and
remove users, and change user
* privileges in the project.

In order for a user to show up
in the Known Users list, the
server administrator must add
a new user to the Ghidra Serve
r. This is

Tr wren T° TPTthe svrAdmin command. Refer
o the server/svrREADME.htmifil
e

in the installation directory

for use of this administration
command.

If the user does not have admi
nistrative privilege in the pr
oject, the user will not be ab

le to view this full dialoa anstead, he OpLion 10 Frojec
t View Project Access List wil
| be enabled, which will displ
ay the following dialog and al
low the user

to view the project users and
their current access privilege
sonly.

Change PasswordChange Password
Ghidra Front End 11/12

If your project is associated
with a Ghidra Server that is u
sing Ghidra password authenti
ation, then the menu item, Pro
ject Changeo change your password. A dial
og is displayed to confirm you
r request, as

shown below.

If you select Continue, a dial
og is displayed for you to ent
er your new password, and to r
e-enter your password.the Ghidra Server using passwit
rd authentication, your defaul
t password is "changeme". The
[SEIN EET fe ENGI ERE ST
24 hours so you must change
our password as soon as possik
le. If your password expires o
rif a user

forgets their password, the Gh

FE I eTaccomplished from a commanc
CULE GE

server system using the svrAdn
in command. Refer to the serve
r/sviREADME.htmlfile in the in
stallation directory for use o
jal

administration command.

Consoleto display the system console.

Log messages, including the st
andard output and error strean
s, are redirected to the conso
le. If you are running Ghidra

in development

mode (i.e., through Eclipse or
nC Ed PIR CRIESI dicta i data tnt
the Ghidra
console.
Errors and other informational
messages are logged to a file
in <user home>/.ghidra/ghidr
User.log. Messages are append
d to the file
every time you launch Ghidra.
Once the log file has reachedamed
ghidraUser.log.0. Older backug
files are similarly rolled to
another file with a one-up di
git suffix as well. Ghidra sto
res a maximum of

three backup files (ghidraUser
.log.0, ghidraUser.log.1, ghid
raUser.log.2) at a time. The |troubleshooting.

The field next to the icon in
the Ghidra Project Window sho
s the last message sent to the
console (error messages are i
RCN

Getting Help

FrantavE Cancitivia almContext Sensitive Help

Ghidra provides context sensit
ive help that pops up when yot
hit the <F1> or <Help> key.

Ghidra Front End 12/12

To get help on a menu option,
1.Ea

ES

Display the menu (either from
the tool menu or the popup) th
at has the option you want hel
pon.

Position the mouse pointer ove
r the option.

Press the <F1> or <Help> key.haut aide dadiiaaantiias 1 of Rad bites od

contents.

To get help on a dialog or too

| window, click somewhere in t
hat window and press the <F1
or <Help> key.

If no specific help exists, th

en a default page for Ghidra h
elp is displayed.build information about the Gh
idra application.

Related Topics:

Tool Administration

Projects

Program

Import Program

Export Program

CEL to Ghidra HelpProject Info dialog

Ghidra Server 1/1
GhidraServer

Ghidra Server
The Ghidra Server provides fil

ERR AREY NIETO AE A S eon a single effort. It provide

s network storage for shared p
roject repositories while
controlling user access.

Running the Server

The Ghidra Server capability i
s incorporated into the standa
rd distribution of Ghidra.
Please refer to the svi READMEALLL ELL A

directory (<your installation
directory>/server/svrREADME.t
ml). This file will

provide information regarding
the installation, configuratio

n and administration of the
Ghidra Server.

Related Topics:

[HEC ole El 17132RE he/ /NOFORNAbout Ghidra 1/2

About Ghidra

The About Ghidra dialog displa
ys general application informa
tion regarding Ghidra.

To view information about Ghic
Ic]LLLgchIk]c]

This option is also available
from the Ghidra Project Windo
Information displayed in the d
ialog

Version

For example, "8.1"

If "Dev" is included in versioJava Version

For example, "11.0.1"
Version of Java being used to
run Ghidra.

Build date

For example, "2019-Jan-18"

Installed Processors
The Installed Processors dialo
I IAL) SPA EElahduage moduies currently fn.
talled. This list is quite bri

ef and does not convey the
assorted variants which may be
implemented for each process
| 4

This option is also available
from the Ghidra Project Windo:[LSE

From the menu-bar in tool, cli
ck Help

LLLChit cir)

Installed Processors...

User Agreement
The User Agreement dialog disuse the Ghidra tool. You agree
d to these terms when you firs
tran Ghidra.

Related Topics
About Program File

Ghidra Projects 1/1A Ghidra project maintains inf
ormation for a particular reve
rse engineering (RE)

effort. The RE effort involves
using tools built with plugin
s to analyze target software.
Tools are accessible across pr
ojects and not associated with
any one project inGhidra project as

programs. The Ghidra project c
rganizes and maintains these
rograms for multiple

users.

The latest release of Ghidra i
ntroduces the concept of a pro
ject repository that contains
files that are versioned, shar
ed, or private. A shared proje. nt’
files in the repository. Mult
iple users in the project can
add files, access files on the
server and create new version
s of the files. Private files

are local your project and hav
e not been added to a project
repository. You can still

take advantage of the project
J AL Rt A Rm TaLESAN ES RULER LL LC IAA As
8

You can create subfolders and
import programs into your proj
ect. You can also view

other data from other projects
, or drag the other project da
ta into your current project.
The Ghidra Project Window shc
s the active project. The Ghidllowing project operations:
Create a project

Open an existing project
Close the project

Re-open a project

View a recent project

Save the project

Archive the project

Restore an archived project
Related Topics:Import Programs
Project Repository

Creating a Project
Creating a Project 1/6

The New Project option creates
Lamm105€ your current project,
create the new project, and up
date the Ghidra Project Windoy
with the newly created projec
t. The New Project wizard
takes you through the steps to
create either a non-shared pr
oject or a shared project. The
shared project can be shared
Wii]epository on a server that oth
er users can access.

To create a new non-shared pre
JE

1. Select the File New Project
... menu option from the Ghidr
a Project Window.

2. The first panel of the New
Project wizard is displayed, wLI

3. Leave the Non-Shared Projec
t radio button selected to cre
ate a project that will not be
shared with others.

4. Activate the Next>> button.

Creating a Project 2/6ARIE ALAS RS LD SU AUREL SLC
er; select the directory of wh
ere you want your new project
lo

reside. The Project Directory
field defaults to the last dir
ectory that you specified to ¢
reate a new project.

4. Enter the name of your new
project; the Finish button isIf you have a project opened,
Ghidra closes the project and
opens the new project.

6. If there is an active proje

ct and it has been modified, G
hidra will prompt to save the
active project before closing
[1am eTy]

the Save Modified Files dialog
, click the OK button to saveopened.
Creating a Shared Project

The discussion for this sectio
n assumes the following:
You have a Ghidra Server that

is set up to manage the projec
ET TI I ennTOU have beech added Lo the sc
ver's list of known users.

If you are associating your pr
oject with an existing project
repository, the Administrator
of the project has added you
asa

user to the project repository

You know the name and port nPKI Authentication, you have a
PKI Certificate.

To create a shared project,

1. Select the File New Project
... menu option from the Ghidr
a Project Window; the first pa
nel of the New Project wizard
is displayed.

2. Select the Shared Project r
adio button on the Select ProjCreating a Project 3/6

3. Activate the Next >> button

4. Enter the name of the serve
ror the IP address of the ser

ver of where the repository re
RI PR IR Te Sr antofmation 1or accessing anot
her shared project, then the s
erver and port number from th;
t project are used as default
values.)

5. Enter the port number. The
default port number is 13100.
6. Activate the Next >> buttonthe Ghidra Server.

Creating a Project 4/6

7. In this example, three repo
sitories are listed in the Rep
ository Names list which refle
ct all the repositories the us
[Sa EHLA
i [SEE] ry your login cr
edentials. By default, the Exi
sting

Repository radio button is sel
ected because of the existing
repositories found on the serv
er. Only those repositories yo

u

have been granted access to w
PT pI aleave Lhe Fadlio bution select
ed, and select a repository na
me from the list of

Repository Names.

To create a new repository, se
lect the Create Repository rad
io button; the Repository Name
field becomes enabled.

Enter the name of the new rep
sitory. This option will be dianonymous mode.

8. Activate the Next>> button.
If you selected the Create Re
pository radio button, then th
e following sample Project Acc
[CE

panel to specify user access i

s displayed. If you are creati

ng a new shared repository, yo
u are by default the Administrlowed to change your own acce

s. If the server has been conf
igured with anonymous mode
enabled, an additional checkbc
x control will appear allowing
you to grant anonymous acces
LR IER EN ToT EN elo"

lar TER aT<Z. Users thal ale known Lo the
server are listed in the Know
n Users area. Users that are p
art of the project are marked
Ni]

lu)

icon. To add users, select use
rs from Known Users, select th
e Add>> button. Add all users
by selecting the Add Alllect the <<Remove button. To
emove all users (except
yourself), select the Remove A
LITT

The Project Users table on the
right side of the dialog indi
cates user privileges:

Read Only - the user can open
programs in read only mode, c:
nnot check out files from thenot add files to the repositor
y. The read only user may crea
te a local copy of the

program; the project repositor
y is not affected.

Read/Write - the user can chec
k out files from the repositor

y and check in files into the
repository, and add new

filae FA Fhe renncitargAdi ALS Aon CLS UEC SL
ility to add users to and remo
ve users from the project;

the Admin can assign administ
ative privileges to other user

s. The project must have at le
ast one administrative

user. The administrator also c
an terminate a check out.

If you are creating a projectoject Access panel as

part of the New Project wizard
. After you have opened the sh
ared project, and if you are a

n administrator in the

existing repository, then you
can display and modify user pr
ivileges by choosing the Proje
ct Edit Project

Access List... option.Lita

create your eg that will
be associated with the projec
Id

repository. Typically, you wou
Id specify a directory on your
local file system.

Creating a Project 6/6ry. Ihe rFroject virectory fiel
d defaults to the directory th
at you last specified for a ne
w project.

Click on the browse (... ) but
ton to bring up a file chooser

12. The Project Name field def
aults to the name of the repos
itory that you selected in Stewhen the Project Directory and
Project Name fields have vali
d entries.

13. Select the Finish button t
o complete the New Project prc
cess.

Before the new project is open
ed, if you made changes, you a
re asked whether to save the o
Id project. If you choose toe Tool Chest and no files are
associated with the project th

at

you have just created. Your cu
rrent workspace is named "Wo
EEL

 

Related Topics:
Ghidra Projects

Cloce Proiactpen Froject

Archive Current Project
Project Repository

Edit Project Access List

Open Project

[el LILI IEREL [ICN (I To uPproject identified in the Open
a Ghidra Project dialog will
be opened. If the

active project has been modifi
ed since it was last saved, Gh
idra will prompt you to save t
he active project before closi
ng it. The project

window is restored with any pl
ugins it had when you last savthe project are
launched; programs that the tc
ols had open are opened. The |
ast active workspace from this
project now shows up as the a
ctive workspace.

Other viewed projects are rest
ored.

Projects that were created usi
J LI A ryCah drag the dala fom the old
project to

your current project.

To open a project, choose it f
rom a list of projects in the
default project directory. If

the project has been opened be
fore, then the project

will appear in the Reopen list

. If the project is being shartory. Use the browse

button, on the Open a Ghidra F
roject dialog, to locate the t
arget project.

To open a project:

1. From the Ghidra Project Win
dow, select File

Open Project.... The Open a Gh
idra Project dialog appears.3 to *.gpr Tr FIERO
ension). Select the project fr
om the Open a Ghidra Project «
ialog.

The project name can be of an
length. The name of the proje
ct has the same restrictions t
hat the operating system impo
BR Aane must have Lhe .Jgbr extens
[LN

3. Click the Open Project butt
on. The selected project appea
rs in the Ghidra Project Windo
w. If you are opening a shared
project, Ghidra

attempts to connect to the Ghi
dra Server. You may have to en
ter a password, depending on tis using.

Opening a Ghidra Project 2/2
If this were a shared project,
the connection status button

(

) would be displayed, indicatibal

connected to the server. If th

e project failed to connect to
the server, the status button
would appear as

. If the server comes up

after you have opened the shar
ed project, you can click on s
tatus button to attempt to con
nert Fa Fhe carvar Yall can ofna shafed project, however,
you will not be able to do any
check outs or check ins.

Related Topics:

Ghidra Projects

Close Project

Save Project

Reopen Project
Archive Current ProjectVion: Va =Close Project 1/2

Close Project

Closing a project will return
Ghidra to the NO ACTIVE PROJE
T state. If you have

changed the state of your proj
ect (e.g., launched another toto save your project and any c
hanges you have made to
your program.

To close a project:

1. Select File Close Project f
rom the menu.

2. If there are unsaved change
s, Ghidra will display the Sav
e Modified Files dialog todefault. Deselect items

that you do not want saved. Se
lect the OK button close the p
roject.

The Deselect All button desele
cts all changed items in your
project. If you choose

OK, your current project state

PO DOV NR | WE St LL ry[=

When the project is closed, th
e Ghidra Project Window indice
tes NO ACTIVE

dela

dela
Related Topics:
[el R le =e a)NEW rFroject

Open Project

Reopen Project
Archive Current Project

Close Project 2/2

Re-opening a Project 1/2projects that you recently op
ened. These are available in
the Ghidra Project Window's m
nu. Reopening a project will ¢
lose any active project

and open the project selected
from the Reopen menu. The pr
ect that was most

recently opened is placed firsRe-opening a Project 2/2

To reopen a project:

Select File

Reopen directory path/project_
name where
directory_path/project_name ir
dicates the project from the |[JE MIG FTL ERI J Tel
name and restores all of the
project's configurations.

If the project that you are re
-opening is shared, then an at
tempt is made to

connect to the Ghidra Server.
If the connection was not succ
essful, you can still access

PE Al EW A TEserver will be unavailable.
Related Topics:

Ghidra Projects

Close Project

Save Project

Open Project

Archive Current Project
Project RepositorySave Project

Saving a Ghidra Project will ¢
ommit all of the project-relat
ed changes that were made
since the project was opened o
r since the project was last s
aved. Saving a project

retains information about:

The plugins that are being useihbiaal abbot A alee tha
d by each of the running tools
Options associated with the pl
ugins and/or the tool

The running tools’ sizes and p
ositions on the screen

Viewed projects

List of recently opened projec

1S

The active workspaceClas
From the Ghidra Project Windo
menu, select File

Save Project.

You can also save your project
as you exit Ghidra.Ghidra Project Window
Code Browser Options
Tool Options

Exit Ghidra

Archive Current Project

Archive Project 1/2ave the entire contents of the
currently open project to a f
ile name that you specify.

The archive is a snapshot of t
he project data at the time of
the archival. You must close
all running tools before you
can begin the archive process.
After the archive is complete,
the Ghidra Proiect Window's nrRL

or failed. The archive can be
restored by using the Restore
Project operation.

Why Archive a Project?
Archiving a project saves it t

o a file in a format that is c
ompatible between different G
idra release versions. It also
saves off the project data inArchiving the project does not
remove the project from the G
hidra projects directory. So a
rchiving the project has no
impact on further use of the p
roject.

Archiving periodically to a un
iquely named file can simply b
e used as a way to backup thethen be copied to another disk
drive or computer system for
redundancy.

To archive the current project

1. Close any tools that are ru
nning. (You cannot archive a p
roject that has running tools.

)nt Project...

3. From the Archive Current Pr
oject dialog, specify the Arch
ive File where the project is

to be saved. The default
location of the archive file i

s your projects directory.

The file name must end with a

PP RU San archiving.

5. If the specified archive al
ready exists the Archive File
Exists dialog is displayed.

Decide whether you want to ov
rwrite the existing archive fi

le. Select Yes if you want to
overwrite the file.

Otherwise select No and enterve Ludrrent Flfoject dialOy.

Decide whether you want to ov
CICERO ROE IIE TIER
ile. Select Yes if you want to
overwrite the file.

Otherwise, select No and enter
another filename in the Archi
ve Current Project dialog.fuente an ett ed

6. Your project is saved autom
atically before the archive pr
ocess begins.

7. The 'In Progress’ dialog is
displayed indicating the proj
ect is being archived. You can
cancel the archive process at
any time by clicking on the CaWhen Archiving Errors Occur
If the archive process encount
ers an error, archiving will t
erminate and a message will a
pear. Also, the failure

is indicated in the Ghidra Pro
ject Window's message area.Related Topics:
Restore Project
Ghidra Projects/ /NOFORNRestore Project
Restore Project 1/2

The Restore Project operation
will create a new project from
an Archived project file. Res
toring a project makes it the
active project.Ibid’ ded illo
CLR
To restore an archived project

1. If a project is open, close

it by selecting File
2. Select File Restore Project

Close Project from the Ghidra3. The Restore Project Archive
dialog is displayed. Fill in

the fields to indicate the pro
ject to restore and where to r
estore it.

ES

Archive File: Specify the full
path for the archive file to

be restored. Use the browse buThe Restore Directory and Proj
ect Name fields are automatice
lly filled in when you use the
browse button (".

..") to the right of the Arch

ive File field to select the a
rchive file.

Restore Directory: The project
directory where the new proje

RTI rmHERI [Cla

4. Press the OK button.

5. If the project is being res
tored to the same name and lo
ation as an existing project,
the Project Exists dialog is d
isplayed,

as shown below.

Specify a different Restore DiWOES LEXIS alll Ly ayalll.

6. The 'In Progress’ dialog is
displayed indicating the arch
ive is restoring. When the res
tore is complete, this dialog
A

disappear and the newly restor
ed project appears in the Ghid
ra Project Window.

To cancel the restore operatiofoi {Biv ata cinch Sakai attend
ring the restore are

removed as a result of the can
cellation.

Restore Project 2/2

Restoring a Version 2.x Projec
IdXx or before, and the project
contained multiple users, the
project is restored with you a
s the owner of all the files.
You will see the folders and d
ata files for the other users
that

were in the project, but you a
re the owner.Related Topics:
Archive Project
Ghidra Projects
Project Repository
Project Repository 1/9

Br TE rau SOE at tiles in the repository can

be versioned. Versioning allow
B

you to track file changes over
the life of the project. The
repository supports check out,
check in, version history, an

d

viewing what is checked out. V
hen vou check in vour file aA AL A SAE AD A LL A
WAG RIAWIG TN aN el Tle LC RTE]
r. If the project is associate

d with a Ghidra Server, the pr
oject is shared, meaning that
lu)

files in the project are acces
sible by multiple users concur
rently. The Project Access Lis
SEER EE EE LCE Le)hia aca athe tala dialog dick ad
y. When you create a new proje
ct, you can specify whether it
should be associated with a
Ghidra Server.
For projects that are not shar
ed, all files and versions are
managed locally in your proje
ct directory. For the shared
project repository, files area file is created locally in y
our

project directory. When you ch
eck in a file, it is merged (i

f necessary) with the latest v
ersion to create a new version

Merging is necessary only for
shared project repositories, aalways the latest version.

Connect to the Server

When you open a shared projec
, Ghidra attempts to connect t
o the server that is associate

d with the shared project.
Depending on what user authe
ication mode the server is usi

ree | xrmis renEser nasser Bio & rEnot running, you are still abl

e to work with your checked ot
t files while you are offline.
Other versioned files not
checked out are not accessible
. When the server comes up, G
idra will reconnect as necessa
ry. You can also

attempt to connect "manually"
bv selectina the connection ston the Ghidra Project Window ¢
ron

the Project Info dialog. When
the connection is successful,
the connection status button c
hanges toLl Sc iin cali oh tt bt uid
the server after having starte

d Ghidra, shared files not che
cked out "disappear" from

the Ghidra Project Window, as
they are unavailable. Private
files remain intact and are no

t affected by the server
connection.

You are authenticated only oncies managed by the

same Ghidra Server, you will b
e prompted only once for a pas
sword, as required.
Troubleshooting a Failed Conn
ction

If you fail to connect to the
Ghidra Server, check the folloVerify that you are attempting
to login using the correct au
thentication mode.

Verify that the Ghidra Server
administrator has added you a:
a user on the server.

If the server is using Ghidra
Password authentication, you r

J rel cn I ESL en nt IC Dtdra Server administrator.
Verify the host name and port
of the Ghidra Server.

Verify that the Ghidra Server
is running: from a command w
dow, type

telnet [host] [port]
If the server is not listening
on that port vou will get aAL SL

telnet.
Project Repository 2/9

NES Chel afl]

Except for merging, accessing
version control features is th

e same regardless of whether yAdd to Version Control

Add a file (or multiple files

at once) to version control by
selecting the file in the Ghi
ICRY Id

Window. You can either click o
n the tool bar icon, , or righ

t mouse click and choose the A
dd toENTE
NETS eel lage]

Leave the checkbox selected fc
r Keep File Checked Out so tha
t you do not have check out th
efile

after you have added it to ver
sion control. This checkbox wiyou have the file open. The Ap
ply to All button allows you t

o associate the same comment
or

multiple files that you are ad
ding to version control. After
you add the file, the Ghidra
Project

Window indicates the file's ch

[PR IRE ACL al TYRProject Repository 3/9

This image shows that the file
"Program_A" is associated wit
h a shared project (note the b
[TEN TIT

on the file icon), and you are
now working with version 1 of
1 The file "Proaram B" has nauucu LO velsion CONLrol note
the plain icon and no version
information). It is considere
dtobea

"private" file. Private files

are never visible to other use
rs.

A normal checkout is indicated
by a checkmark with a green t
ackground , while an exclusivehati ba bh hc an alii bad
. A checkmark with a red
background indicates that a ne
wer version has been checked-
n by another user.

A tool tip on the file (let th

e mouse pointer hover over it)
shows the date the file was c
hecked out, and

the date that is was last modihat changes have

been made but not checked in
Check Out

To check out a file, select th

e file in the Ghidra Project W
indow. You can either either c
[IL QT RT]

check out icon

on the tool bar, or right mousoption.

Project Repository 4/9

If your project repository is
shared, a dialog is displayed
to allow you to request an exc
lusive lock on

Les GATE | RL: meri vasiires boapls Vet:pulate the memory map In any
ay, ed.

move or delete memory blocks
change the program's languag
etc. An exclusive lock can be
[CTI e=t]

if no other user has the file
checked out. While the exclusi
ve lock exists, no other user
can check outTHE SACIUSIVE TOLK Is HTiphed
for a non-shared project repos
itory.

Check In

After you have made your char
es and saved them, you are rea
dy to check in your file. (You
cannot

check in a file that was not c
hanged.) The check in createsfile, select the file in the G
hidra Project Window. You can
either click on the check in i
[<)

on the

tool bar, or right mouse click
and select the Check In... op
<1,

Thee tool where you have the file
opened.

A dialog is displayed so that
you can enter comments that c
scribe your changes.

The checkbox for Keep File Che
cked Out is selected and disabfile open. If the file is clos

ed and you plan to create more
versions, leave the checkbox
ECT CR fe]

Keep File Checked Out. The ch
ckbox for Create ".keep" file

is selected by default; this o
ption causes

a copy of the file that you ar

23’ wel zn bri reat [Ere Fon Ins sme asst 7% poIn a shared project repository
, when you check in your file,
the changes in your file may
have to be

merged into the latest version
on the server. This will be t
he case if another user checks
in a file sinceYY, WHEN you LHELK 1 your The
, the changes in your file may
have to be

merged into the latest version
on the server. This will be t
he case if another user checks
in a file since

Project Repository 5/9

you did a checkout on the file
. Under most conditions, the mbiol
intervention required on your
part. However, if you made cha
nges such that a conflict aris
CERRY

have to resolve the conflict a

t the time of check in. When a
nother user checks in his file

, you will see

navigation markers for change:re indicated

in red. Refer to the Merge pag
e for more information about n
EIN IeN

Undo Checkout

You may want to undo your ch
kout such that you lose all yo
ur changes, and your file reve
[SRR]1. Close the checked out file.
2. Select the checked out file
in the Ghidra Project Window.
3. You can either click on the
undo checkout icon

in the tool bar, or right mous
e click on the

selected file and choose the U
ndo Checkout option. If you ha

WW reas rd Es. pelo pera sies foe Frves File | =€ undo check out.

If the checkbox on the dialog
is selected, then a private fi

le is created with a ".keep" e
xtension on the

filename. The checkbox is sele
cted by default.

If you have the file open in t
he Code Browser when vou attewil

get an error dialog indicating
that the file is in use. You
must close the file first, the

n undo check out.

Update

While you are working on a pro
gram in a shared project repos
itory, you may want to periodi
callybik indian Swnlls iapvrialon Akan wii
o are working in the same shar
Cl

project repository. Use the Up
date... option to bring your c
opy into sync with the latest
CISL

the program in the repository.
If your changes conflict with
those made in the latest versrom the latest version into yo
[ISIC

the program in the repository

. If your changes conflict wit

h those made in the latest ver
sion, you will

be prompted to merge change:Project Repository 6/9

Consider this scenario: RRL
e you are working on version 4
of 5 of a program. The "5" in
dicates

that there are 5 versions of t
he program in the repository.

The "A" indircatae Fat trent ir Rimor the program Is based on the
version "4" version that you
checked out from the repositor
y. (To see

the version numbers for your p
rograms, check the file's stat
us in the Ghidra Project Windo
w data

tree). When you update, you w
1l update to the latest versioie update

is complete, your file status
will show "Version 5 of 5" jus

t as though you had checked o
[ACIS LIER

The Update... option allows yo
u to have the latest changes a
pplied to your program withou
bel

having to check in your file.bout iat lil dnt edo alah al ull had
the Ghidra Project Window Je.
click on

J RTT Ie ETN Tele))]

in the tool bar, or right mous

e click and choose the Update.
.. option. The Update

option is only enabled when th
e latest version number on the
server is greater than the veThe
icon is also available from th

e tool where you have the file
opened.

The update action is not appli
cable in a non-shared project
[CIeLHICIAA file becomes "hijacked" whe
it exists locally as a privat

e file in your project and a f
[LEN GEERT)

name exists in the repository.
This will happen when user an
other adds a file to version c
ontrol while

you have a private file of the

[TTR] | Tres WAT SIr checkout of

the file is terminated. The fi

le icon in the Ghidra Project
Window changes to indicate th
titis

hijacked. To undo the hijack:
1. Close the file if you have
[II-III

2. Right mouse click on the hi
iacked file(s) in the Ghidra P=. €ICLL UTNIUL Hljatk.... THE
following dialog is displayed
to confirm the undo hijack.

Project Repository 7/9
Deselect the checkbox next to

the name if you do not want to
undo the hijack for that fileit blithe Shean | ftciiiachaly of Rt | ae A
e with a .keep extension, is s
elected by default; if the che
ckbox is

selected, a .keep file will be
created. In this example, you
would see SharedProgram.exe
EN]

your project data tree after y
ou select the OK button. The cthat you have selected for the
undo hijack.

Show Version History
To show the history on any ver
sioned file, right mouse click
on the file in the Ghidra Pro

ject Window, and select

the Show Histol option. Thuser that created it,
and the comments describing f
CAGE

View Version

To view any version in the his
tory, select the version, righ

t mouse click and choose the C

pen
LTH a LE I nLn your tool chest. I'he version
is read

only and is opened in the sele
cted tool. The filename shown
in the title of the tool indic
ates the version

With <tool> where <tool> der
tes a menu item for each toolnis fead

only and is opened in the sele
cted tool. The filename shown
in the title of the tool indic
ates the version

Project Repository 8/9

number, e.g., "SharedProgram.
xe@10 [Read Only]" indicates:
ou are viewing version 10 of
SharedProgram.exe. You can rrOther ways to open a specific
version in a tool are:

Drag a version from the Versio
n History dialog to a running
tool, the running tool's icon,
ortoa

tool icon in the tool chest.

If you have a default tool spe
cified, double click on the veHR CRel EN IIe dialog isd
isplayed; from this dialog you
can select a version to open.

PEELE

You can delete the first and |
ast version if you are the own
er, or if you are an administr
Ll in thehas the file checked out is n
ot available to

either undo his checkout or ch
eck in his file, the administr
ator may terminate the checko
tin order to

delete the version.

VALE EE GIT

AR nA TTick on the file In the Ghidra
Project Window, and

select the View Checkouts... 0
ption.

The Checkout Date is when yol
checked out the file; the Vers
ion is the version number of t
he file that you have

checked outVIEYES IT Lhe Project Ieposit
ory, you can terminate the che
ckout. Right mouse click

on the version and choose the
Terminate Checkout option. A
ialog is displayed to confirm
the terminate

checkout action. The administr
ator may need to do this if us
ers who have files checked outBahiaecd ll Loins en ali B Jhcait ccihs dd
ut is terminated, the file bec
omes hijacked.

Find Checkouts
To view a list of all the fil

es that you have checked out i
n a folder and all of its subfmouse click and choose Find C
eckouts.... In the sample imag
e below, all checkouts from th
CRIA [le

directory (pathname of "/") ar
e displayed; one file from the
"TestFiles" folder is checked
out.to the file. Checkout Date is
when you checked out

the file. Version is the versi

on number of the file that you
have checked out.

From this dialog, you can chec
[SOB EER TRV Te RY IT
heckout. Make a selection in t
he table, right mouse

Plier md hermes PZ hamlr bm Feclick on the toolbar icon
to check in, or click

on the icon

to undo the check out.

Related Topics:

Ghidra Server

Creating a Shared Project
Merging Program Files
Open a VersionLAY AUR LA RE LL)

Ghidra Project Window
Ghidra Front End 1/12
The Project Window is displaye

d when you run Ghidra. From t
is window, you manage your ptyou are running Ghidra for the
first time, you will need to
create a new project to get st
arted.

The Project Window is a tool a
nd may be configured with "sp
cial" plugins that provide gen
eral capabilities that may be
required at a highmporting and exporting Progra
s, archiving a project, and re
storing an archived

project. These plugins may be
added to other tools.

The options for archiving and
restoring a project will show
up only in the Ghidra Project
window, even though the plugiother tools.

The following sections describ
e the Project Window:
LINES

Active Project Panel
Read-Only Project Data Panel
Workspaces

AUTLGIG IRE

Drmicrt RemmeibmmySs
Data Tree

Data Table

File Icons

Console

Configure Project Window
Edit Menu Options

Confiaure Proiect WindowMdallaye 1001s
Getting Help
Exit Ghidra

Ghidra Front End 2/12

LINES

The Tool Chest shows the tools
that you currently have in yo
ur <user home dir>/.ghidra/.gtplaced there when you initiall
y install Ghidra. These tools
are always available to your c
urrently open project. See Ghi
dra Tool

Administration for information
on managing tools. The Tool C
hest panel is a tool bar with

an icon that represents each tYou can launch a tool by click
ing on the icon. You can launc
h a tool with a Program by dra
gging a Program file from the
Project data

tree and dropping it on the to
ol icon in the Tool Chest.

JX ASCEhives in a tree view or a tabl
e view. The tree view is usefu
| for organizing

your files into folders and su
b-folders. The table view is u
seful for sorting all your fil

es on some particular attribut
e such as size,

processor, or modification dat

rR a IL TR)rogram files or datatype archi
ves.
Project Data Tree

The data tree shows all files

in the project orgnanized into
folders and sub-folders. Icon
EACIRICER CHEER EG ad
hey are

under version control and whetLULL UPC this View Dy atlivalt
ing the "Tree View" tab.

Tree Only Actions

The data tree supports the fol
lowing operations:

Create New Folder

To create a new folder,

1. Select a folder that you ow
n.Bgl alia ll dh i al alii
3. A new node is created in th
e tree; a cell editor is displ
ayed, containing the default n
ame, New Folder; enter a new
name, or the <Escape> key to
ancel the editing.Ghidra Front End 3/12
You cannot create a sub-folder
of a folder that you do not o
LGR

Copy Folders and Files

To copy folders and files to a
nother folder that you own,

1. Select a file or folder;If you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Copy option.

3. Select a destination folder

4. Right mouse click and choos

WE i LS RT an | Alalog Is displayed. You may
cancel the paste operation at
any time.

Move Folders and Files

To move folders and files to a
nother folder that you own,
1. Select a file or folder; yo

u may also select multiple fol
ders and filesRL A A A ER RL aL
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Cut option; the icon wil

| change to a dithered image t
o indicate the cut operation.

3. Select a destination folder

4. Right mouse click and choosYou cannot move a file that is
in use.

Drag/Drop for Copy

You can get the same effect of
Copy/Paste using Drag and Dr
p.

1. Select a folder or file (or
multiple folders and files).

2. Hold the Ctrl key down and3. Drop the object on a folder

You will not get a valid drop
target for folders that you do
ell N

If you release the Ctrl key du
ring the drag, the operation c
hanges to a move if you are drer user always results in a co
py, regardless of whether you
hold down the Ctrl key.
Drag/Drop for Move

You can get the same effect of
Cut/Paste using Drag and Droy

1. Select a folder or file and
drag it to a folder that youen you get a valia drop target

If a folder or file already ex

ists in the destination folder

, Ghidra will append a ".copy"
to the name to make it unique

Expand/Collapse
To expand a folder and all ofTo expand a folder and all of
its descendant folders,

1. Select a folder.

2. Right mouse click and choos
e the Expand All option.

Ghidra Front End 4/121. Select a folder.
2. Right mouse click and choos
e the Collapse All option.

Project Data Table
The data table shows all files

in the project in a table sor
ted by some attribute of the fsorted on file type. Icons for
files indicate whether they a
re under version control and w
hether you have the file check
ed out.

To open this view, active the
"Table View" tab.

Actions for Both the Data TreePEELE

Deleting folders is a recursiv
e operation, so all descendant
folders and files are also de
leted. This is a permanent ope
ration.

To delete a folder or file,

1. Select the folder or file o

r select multiple folders and

pony selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Delete option.

The Delete option is disabled
for a file that is in use.
Rename

To rename a folder or file<. RHUL MOUSE CHLK alll CLHULS
e the Rename option.

3. A cell editor is displayed;
enter the new name.

3. A cell editor is displayed

; enter the new name.
Duplicate names are not allow:
CR GIR GEREN ER CICYou cannot rename a file that
isin use.

You cannot rename your projec
LCelCIS

Select All

To select a folder and all of

its descendants,

1. Select a folder.Read-Only

To mark a file as read only,

1. Select a file.

2. Right mouse click and choos
e the Read-Only option.

The icon for the file is updat
ed to indicate the read only s
tate. When you right mouse cliRead-Only option.

A read-only Program must be s
ved to a new name if you make
changes to it.

You cannot change the read-or
y state of a file while it is

in use.

Drag File to a Tool

To launch a tool with a specif
Pl RE TE TE WE allo open a file In a running to
ol, drag a file to the tool ic

on in the Running Tools tool b
ar, OR drag the file to the to
[SRLS

Open a File in the Default Too
|

To open a file in the tool tha

t was specified as the "defaulITE LUal you Wwalit LO Open, Un Ti
ght mouse

click on the file and choose O
pen in Default Tool.

Open a File With a Specific To
ol

To launch a tool with a specif
ic file,

1. Select the file.EE ul

 

<tool name>.

Refresh

The

button on the tool bar refresh
es the list of files in the se
lected folders. This is a way
to sync the project folder/filository. The list of files and
folders in the Project Data T
ree is updated. This button is
enabled

only for selected folders. You
can also refresh folders from
a viewed project or viewed re
[SLEIICIsA

LILI

Ghidra Front End 6/12

To view information about a fi
le, right mouse click on the f

ile in the data tree and choos

e the About... option.

Ey TT IR A TL TT PAated to version control. See P
roject Repository for details.

File Icons

The Project Data Tree shows ic
ons for the following types of
files:

- A program

- A project data type archive
(a data tvpe file stored in th© FIUJELL Vala TEC SHOWS Th
difications to these icons for
files in the following states

File Status

Sample Icon in Project Data
LICEVersioned File not checked
out.

The program named "Example
versioned as

indicated by the light purple
background. It is

not checked out, since there
is no circle with aindicated by "(1)"; the versio
LRUIIR-ER

latest version when the file i
s not checked out.

Versioned File is Checked out
exclusively by you.

A CITT Lu Rs program name(lof 1)";

Version 1 is the latest versio
n. The blue check

mark icon indicates that the f
ile is checked out

with an exclusive lock.

If your project is not associa
ted with a Ghidra

Server, you will always have t

[De awill always be
exclusive, since the project i
s not shared.

Versioned File is Checked
Out; the project is associated
with a Ghidra Server

Version 3 of the program name
"Examble" isA EL

the server, as indicated by "(

3 of 3)" and the

green circle with a check mark
. The asterisk

indicates you have changes to
the file which

have not been checked in yet.

Versioned File is Checkednewer version exists on the
server.

Version 2 of the program name
SCTE

checked out; a Version 3 has b
een created since

Version 2 was checked out, as
indicated by "(2mark. The asterisk indicates y
ou have changes
to the file which have not bee
n checked in yet.

Private File

 

A program named "Example" i
ot undermachine, and is not visible to
other users.

Hijacked File

The private file "Example" exi
HER Ig

computer, but another user ad;
ed "Example" to

Aris maskmns siameituadl wnbbi ete wish veilappear as hijacked, (l.e., the
file can be saved

BEER ERE Te RSE TT Ie)
you do not have

the the file checked out that
is on the Ghidra

Server.) Hijacked files may al
so result from a

checkout that was terminated.
The sharedLAC ALL CE

Hijacked File

checkout that was terminated.
The shared

version of "Example" will not
be visible in

GhidrahulTals com tt-al
You Front End 7/12

can also either rename the hij
acked "Example",

move it to another folder, del
ete it, or use the

Undo Hijack action. Then the s
hared

"Example" will appear in your
data tree as aRead-Only Project Data

You can view data from other P
rojects or remote Repositories
and copy data into your curre
nt Project's data folders.

View Other Projects

To view the data from another
project:

13

Select Project

View Project...

A file chooser is displayed; t
he default location is the pro
jects folder in the installati
on folder.

Choose a project; the file extcreated In the "READ-ONLY Pre
ject Data" panel in the Projec

t Window, next to the

Active Project panel; the tab
shows the name of the project.
5. The list of recent projects
menu is updated to include th
is project.= (Via [Telus OF Ufay alld Urfop)
and files from the other view
to your folders.

Ghidra Front End 8/12

You do not have to hold the Ct
rl key down when you drag frot
the other view since this can
not be a move operation,he
View a Shared Project

You view a shared project the
same way you would a non-sha
d project; the difference is t
hat when you view the shared
project, an attempt is made to
connect to the Ghidra Server
associated with that project.
Depending on the userd project, you may have to ent
er a password. If the connecti
on

to the Ghidra Server is unsucc
essful, then the only files av
ailable to you are your privat
e files.

View a Repository

To view the data from a serverView Repository...

2. A repository chooser is dis
played; allowing you to specif
y a Ghidra Server network add]
ess and select one of its
repositories...

3. Enter the Ghidra Server add
ress and port. The default por
[ECHR

A CUrlr Fives TY zafrae ls FFtmm Frad port fields. This will conne

ct to the specified Ghidra Ser
Cl

and list available repositorie

s for which you have been gran
ted access. You may be prompt
d for a password should

user authentication be needed
5. Select the desired reposito
rv from the list of those avai0. LHCK LINE o=IElLL REPLUSILOUTY
button. A new tab for the dat
a tree is created in the "READ
-ONLY Project Data" panel

in the Project Window, next to
the Active Project panel; the
tab shows the URL of the remc
te repository.

7. The list of recent projects
/repositories menu is updatedView Recent

Ghidra maintains a list of Pro
jects and remote Repositories
that were recently viewed.

To view a recently opened proj
[Clee T ll =ToTeE]1 Ve] 3A

1. Select Project

View Recent

<project path or repository URory from the menu.
If the project/repository is n

ot in the view, a new tab is c
reated in the "READ-ONLY Proj
ct Data" panel in

the Project Window; the tab sh
ows the name of the project or
repository URL.

If the tab is in the view, theClose View

To close a view, select Projec

t Close View

<project path/repository URL>
OR click on the small 'X' on
the specific

view tab, OR right mouse click
on the corresponding view tab

J Reel LIEAD-ONLY Project Data” panel
n the Project Window.

Close All Read-Only Views

To close all read-only views a
t once, select Project

Close View

Close All Read-Only Views.Frojett Uatla Is Temoved ofn t
he Project Window.

Workspaces

A workspace contains a set of
running tools, and the tools’
opened data. A workspace is a
nalogous to a virtual desktop.to another workspace, you swit
ch to a different set of runni

ng tools. The tools from the o
ther workspace remain running
butFront

are notEnd 9/12

visible until you switch back
to that workspace.

The workspace names are lister workspace by choosing a nan
LHCInRGE)

list. The default workspace, n
amed "Workspace," is created
n the project.

The workspace state, i.e., run
ning tools, tool connections,
tool configuration, etc., is m
aintained when you exit GhidreTo create a new workspace,

1. Select Project

Workspace Add...

2. A dialog is displayed; ente

r a new workspace name. Dupl
ate workspace names are not a
[VER

3. Click on the OK button; the
newly created workspace becc

PR AAorkspaces

in the combo box.

If you leave "Workspace" as th
e new workspace name in the ¢
alog and click on OK, a one-up
number is appended to the
name to make it unique.

To rename the current workspz
e,

1 Select Proiect Workspace Re<. A UldlIUy 1s Ulsplayced.

3. Enter the new name for the
current workspace. Duplicate v
orkspace names are not allowe
. The list of workspace names
is

updated to reflect the new nan
e.

To delete the current workspac
:2. A dialog is displayed to co
nfirm your delete request.

3. Choose the Delete button to
delete the workspace.

Tools in the workspace are clo
sed.

If you made changes to a file
that is not open in any other
tool, a dialog will be displayThe oldest workspace becomes
he current workspace. If the d
eleted workspace was the last
one, then the default
workspace ("Workspace") becc
s the current workspace.

To switch workspaces,
1. Select Project Workspace Swgh the list of workspaces (in
creation order), wrapping back
to the first after the last h

as been reached.

For example: WS1, WS2, WS3,
en WS1.

3. If only 1 workspace exists,
this action will do nothing.

Biimmime Tramlean icon for each tool that is
running in the current workspa
ce. Click on the icon to bring
that tool

forward on your console. To cl
ose the tool from the Running
Tools panel, right mouse click
on the icon for the tool and
choose the

Close optionrie Lon onto another Cor. 1
hose tools are connected for a
Il tool events.

Tools running in different wor
kspaces may be connected.

Ghidra Server Connection Stat
5low the Running Tools panel yc
u will see a connection status
panel that shows

Ghidra

the name of the Project Reposi
tory, your access privileges,
and an indication of whether y
ou are currently connected

to the Frontindicates that your project re
pository is connected to the G
hidra Server; the status butto
n,

indicates that your project re
pository is associated with a
Ghidra Server but it is not co
nnected to it.

If CIs CIE is not associaEdit Project Access List

If your project is shared, the
Project menu has an option to
edit the project access list.
This list controls what users
have access to the

project and what privileges th
e users have. If you have admi

EN NET EYEE Y SaEdit Project

Access List will be enabled. T
he dialog displayed when you ¢
elect this option shows a pane
I that is the same as the one
you see in the

NEAT AUF ET RUT TT BYTE:
t up the user list for new pro
ject. As in the New Project Wi
zard this dialoda allows vou tAACA A ERA LE ® A Ee]
* privileges in the project.

In order for a user to show up
in the Known Users list, the
server administrator must add
a new user to the Ghidra Serve
r. This is

accomplished from a commanc
ell on the server system usinge

in the installation directory
for use of this administration
command.

If the user does not have admi
nistrative privilege in the pr
oject, the user will not be ab
le to view this full dialog an

d make edits.| be enabled, which will displ
ay the following dialog and al
[VAG ERIEETg

to view the project users and
their current access privilege
sonly.

Change PasswordGhidra Front End 11/12

If your project is associated
with a Ghidra Server that is u
sing Ghidra password authenti
ation, then the menu item, Pro
ject Change

Password... will be present. U

I A LR i, AL0g Is displayed to confirm you
r request, as
ECL E-EOUA

If you select Continue, a dial
og is displayed for you to ent
er your new password, and to r
e-enter your password.

When vou initiallv connect tora authentication, your uciaul
t password is "changeme". The
[SEI EET fe ENGI CRE ST
24 hours so you must change
our password as soon as possik
le. If your password expires o
rif a user

forgets their password, the Gh
idra Server administrator must
reset your password. This isserver system using the svrAdn
in command. Refer to the serve
r/sviREADME.htmlfile in the in
stallation directory for use o
jal

administration command.

Console
Click on the console iconLog messages, including the st
andard output and error strean
s, are redirected to the conso
le. If you are running Ghidra

in development

mode (i.e., through Eclipse or
some other IDE), you will see
standard output and errors inconsole.

Errors and other informational
messages are logged to a file
in <user home>/.ghidra/ghidr
User.log. Messages are append
d to the file

every time you launch Ghidra.
Once the log file has reached
500KB in size, however, it wil

[EF LR EE | a_i.ghidraUser.log.0. Older backup
files are similarly rolled to
another file with a one-up di
git suffix as well. Ghidra sto
res a maximum of

three backup files (ghidraUser
.log.0, ghidraUser.log.1, ghid
raUser.log.2) at a time. The |
og files can be used by Ghidra
developers forARLE AA A A LA A LL
the Ghidra Project Window sho
s the last message sent to the
console (error messages are i
LRCIN

Getting Help

Context Sensitive Helpinc Ubiniuiatiodbiil tute ollie 1
Ghidra provides context sensit
ive help that pops up when yot
hit the <F1> or <Help> key.

Ghidra Front End 12/12
To get help on a menu option,

iS
2.Display the menu (either from
the tool menu or the popup) th
at has the option you want hel
pon.

Position the mouse pointer ove
r the option.

Press the <F1> or <Help> key
The Help Viewer is displayed aTo get help on a dialog or too

| window, click somewhere in t
hat window and press the <F1
or <Help> key.

If no specific help exists, th

en a default page for Ghidra h

elp is displayed.

LLLIgehIk]c]

TE I Ed rT LT amIdra application.
Related Topics:

Tool Administration
Projects

Program

Import Program

Export Program
Welcome to Ghidra Help
Create a Shared Project
Proiect RepositorvGhidra Programs 1/1

Ghidra Programs

A Ghidra program is an execut:
ble unit of software or some g
roup of data. It can be

viewed and analyzed within a (
hidra tool. A Ghidra program ihata ctl Bh ural aie’ ian aaabedd Lil
s associated with a program at
the time it is created.

The language is used for disas
sembling bytes into instructio

ns. Each program defines

its own address spaces and me
ory. Various program elements
can be added to the

program to further define it aelements that can be defined i
n the program are labels, refe
rences, comments,

functions, and data.

A Ghidra program is created by
importing a file into a Ghidr

a project. This can be
accomplished from either the Coject, the following actions c
an be performed:

Open

Close

Rename

Save

PLES

[SCT]ed

LI

Ralatad Tamme.fh Rel)Importerbil ciel fein

Introduction

Ghidra can import a variety of
different types of files into

a Ghidra project as Ghidra "p
rograms." There are separate a
ctions for

importing single files, import
ing multiple files, and importCEILI] CXeTS
multiple files into a new prog
ram are available in both the
front-end project window or th
e CodeBrowser tool. The action
for adding to

an existing program is only av
ailable from the Code Browser
tool and only if there is a cuSupported Formats

Common Object File Format (C
i

Debug Symbols (DBG)
Executable and Linking Format
(ELF)

Ghidra Data Type Archive Forrr

Id
CTE Immiik Emre abMac O5 X Mach-O

Module Definition (DEF)

[III IER Te

New Executable (NE)

Old-style DOS Executable (MZ)
Portable Executable (PE)
Preferred Executable Format (F
EF)

Program Mapfile (MAP)

Raw BinarvFile Import Actions

These actions can be used to i
mport one or more files into a
Ghidra project. They can be a
ccessed via the File menu in e
ither the Front-end Project
Window or the CodeBrowser Tc
unless otherwise specified.1 incisal cial Salt la
a single file into Ghidra. If

the file is an archive consist
ing of multiple programs, then
this action will bring

up the Batch Importer Dialog,
otherwise it will use the stan
dard single file Importer Dial
og to complete the import.
BICToEHar: the file to import usin
g the filechooser that appears

Use the Importer Dialog (or th
e Batch Importer Dialog if it
is an archive) that pops up to
configure the import.

Press OK to initiate the impor
4new program will appear in th
e project window and if initia
ted from

a CodeBrowser tool, it will be
opened in the tool.

Batch Import
This action is used to import
multiple files by selecting a

rmbt Airartnrms and labtime i+mport.

BICToEH

Invoke the action from the Fil
e Batch Import... menu item.
Use the filechooser dialog tha
t appears to select a root dir
ectory for searching for files
[RT Tel Te

Use the Batch Importer Dialog
that appears to select and conMIRAE Ed LAS A ® BLA LL
iate importing the selected fi
les.

Use the Batch Importer Dialog
that appears to select and co
nfigure files for importing.
Press OK on the dialog to init
iate importing the selected filak mid
Plugin 2/11

A results summary dialog will
appear and, if successful, the
new program(s) will appear in
the project window. If the
action was

initiated from the CodeBrowsei
tool and only a few files wer

e imported, they will be openeOpen File System

This action is used to open th
e File System Browser which cz
n be used to view the contents
of container files (tar, zip,
etc.) and import

files from within those contai
ATES
BIToEHm.
Use the dialog that appears to
browse the contents of the co
ntainer file and import files

as desired.

Add to Program
This action is used to import
data from a file into an exist

FA LE I iLEC ad el h

BICToEH

Invoke the action from the Fil
e Add to Program... menu item
Use the filechooser dialog tha
t appears to select a root dir
ectory for searching for files

to import.

Use the Importer Dialog to con
fiaure the importale Mporting te scicecied i
les.

When the import is complete, t
he currently open program sho
Id have additional data in it.

Other Import Actions

Import Selection
This action is used to importBICToEH

Make a selection in the Listin

g window in the CodeBrowser t
ol.

Invoke the action by right-cli
cking and from the popup men
select the Extract and Import
... menu item.

Use the Importer Dialog to coniate importing the selected fi
les.

When the import is complete,
new program will appear in th
e project window and also be o
pened in a new tab in the List
le]

Window.le file import, the Importer D
ialog is used to configure the
import for that file.

Importer Plugin 3/11

Dialog Fields
Format - This field is a drop-

I WT Yr LN REET€ used to to Import the tile.
Typically,

there are two options availabl
e. One for the actual format o
f the file (if Ghidra could de
tect it) and other is the Raw
Binary

format, which is always an opt
ion regardless of the actual f
ile format and it will simplvhnout any

interpretation.

Language - This field specifie

s the language/compiler specif
ication that will be used in t
he resulting program. Often, t
IERIE

automatically detected from th
e file format. The Language/Co
mpiler Spec Chooser Dialog callanguage/compiler spec that w
Il be used.

Destination Folder - This fiel

d is used to specify the desti
nation folder within the curre
nt project for where the newly
imported

program will be saved. If a fo
Ider is selected in the front-der, otherwise

the root folder will be the de
fault. The ... will bring up a
dialog for changing the desti
nation folder.

Program Name - This field spec
ifies the name for the newly i
mported program. By default, i
t will be the name of the impoextenstion removed (e.g., .xml
, .gzf). Path information at t
he beginning of the this field
will be used

to create a destination folder
in the current project under
the root folder specified by t
he Destination Folder field.
Options... - This button will

[I | ST Aime oes 1 FEEL SYIf this dialog appears as a re
sult of the Add To Program act
ion, then the Language, Destin
ation Folder, and Filename fie
Ids will

be disabled since these values
are already determined by the
existing program.THE Import OpLIOfs differ uspc
nding on the selected format.
Common Options

These options appear many of
he standard executable progra
formats such as ELF, PE, etc.
Apply Processor Defined Labels
If this option is on, the impo
rter will create processor lab
els at specific addresses as dThis is usually used to label
things like the reset vector o

r interrupt vector.

Anchor Processor Defined Labe
B

If this option is on, labels c¢
reated from the processor spec
ification are anchored. This m
eans that if the image base isnat [5 address LEVANT NT]
ginally placed. If the option

is

off, the symbols will move wit
h the image base or the memo
Jl

Create Export Symbol FilesCreates symbol files for each
library used by an executable.
The symbol file will contain
stack purge information for ea
[<a

exported symbol in the library
. The symbol files will be sto
red in
<GHIDRA_INSTALL_DIR>/Ghid

FR mA a LeWhen running Ghidra with .syn
ols files created from an olde

r operating system, you may re
ceive the following

NETO N EEE To

Unable to locate [symbol_name
in [<filepath>.exports]. Plea
se verify the version is corre

ct.

This warnina messade indicatehe COrresponding exports 1
le. The only information lost
by

not including these symbols is
function purge and comments
If you require this informatio
n, manually delete the .export
B

file and Ghidra will regenerat
eit.hii ciuiaaba abo. Sasi daa al
nal libraries used by the exec
utable. The entire library dep
endency tree will be traversed
ina

depth-first manner and a progr
am will be created for each li
brary. The external references
in these program will be reso
Ived.COFF Options

COFF format has all the Comm
Options, plus:

Attempt to link sections locat

ed at 0x0

If selected, sections located

at 0x0 will be relocated seque
ntially in memory. This will afrom being ignored.

[SNe] uT 1]

ELF format has all the Commor
Options, plus:

Perform Symbol Relocations

If selected, Ghidra will attem
pt to apply the relocations sp
ecified in the ELF header.

[TTe for importing the memory se
tions.

Import Non-loaded Data

If selected, Ghidra will impor

t ELF sections that don't get
loaded into memory when the
ogram is run. These sections w
1)

not be stored in a special add
ress space called "other"Aad

If selected, Ghidra will attem
p to resolve external referenc
es against other programs alre
ady imported into Ghidra that
EICH]

the destination folder for thi

s import.

[IER EelBass Address

Importer Plugin 5/11

This field is used to specify
the start address in memory fo
r where to load the bytes.
Overlayverlay space will be created w

ith the same name as the Bloc}
Name.

Block Name

This field is used to specify

the name of the memory block
hat will contain the newly imp

orted bytes.only the Common Options.
Motorola Hex Options

Bass Address

This field is used to specify
the start address in memory fo
r where to load the bytes.
Overlay

If selected, the bytes will be

Truss rd snp 8] rt: ¥aaree rises LA maeseny imIth the same name as the Bloc
Name.

Block Name

This field is used to specify

the name of the memory block
hat will contain the newly imp
orted bytes.

MZ Options
The MZ format has onlv the CoFE UpLIOhis

The PE format has all the Comr
on Options, plus:

Parse CLI headers (if present)
If selected, any CLI headers p
resent will be processed.

Raw Binary Options

Block Name
The name of the memory blockhidden ad Sb iat Sl caida Sd

will be the name of the defau

id
address space (usually "ram")

Base Address

Base Address

Importer Plugin 6/11e imported. By default, this w
[LNCINN

File Offset

This field is the byte offset
into the imported file from wh
ich to start importing raw byt
es. By default, this will be 0s will be set to the total num
ber of bytes in the imported f
[LER

Apply Processor Defined Labels
If this option is on, the impo
rter will create processor lab
els at specific addresses as d
efined by the processor specif

[(E1LN
hy im

 

tall ead Fn Iakalr interrupt vector.

Anchor Processor Defined Labe
B

If this option is on, labels c¢
reated from the processor spec
ification are anchored. This m
eans that if the image base is
changed or a memory block is
oved, those symbols will remai
n at the address thev were ori1s

off, the symbols will move wit
h the image base or the memo
lle

XML Options

The XML format is used to load
from a Ghidra XML formatted f
ile. The options are simply sw
itches for which types of proghit aot cl aiid
Memory Blocks

Imports memory block definitic
ns (name, start address, lengt
h, etc). See Memory Map
Memory Contents

Imports bytes for the memory |
locks.

Instructions

Imports disassembled instructiImports data types and definec
data. See Data Type Manager :
nd Data.

Symbols

Imports user-defined symbols.
See Symbol Table.

Equates

Import equate definitions and
references. See Equate Table.Comments

Importer Plugin 7/11

Imports comments (pre, post,
ol, plate, repeatable). See Co
mments.

[eT gul

Imports user-defined propertieImports Bookmarks.

ICES

Imports program organizations
(program trees, modules, fragr
ents). See Program Tree.
References

Imports user-defined memory,
tack, and external references.
See References.

Functions= did Variables. oTC FUNLLIOnNS

Registers

Imports program context and r
gisters. See Register Values.
Relocation Table

See Relocation Table.
[SAIN

Imports program entry points.
External LibrariesLibrary Search Path

The Library Search Path dialog
is used to specify the direct
ories that Ghidra should use t
o resolve external libraries (
e.g; *.dll, *.s0) while

Ilella< hI RChange the Library Path Searct
[o){:-1g

To change the search order of
the paths within the list:

1. Select a path from the list
2. Select the

button to move the path up in
the list

3. Select theThe search order is important
when you have different versio
ns of a libraries in different
directories. The first direct
ory

in the search path that contai
ns a required library is the o
ne that Ghidra will use.1. Click the

button

2. Select a directory from the
file chooser

3. Click the "Select Directory
RTC

The newly added path will be
laced at the top of the list.4. 2EIeCL UNE OF NOTE paths Ih
[URGE

2. Click the

button

Reset Library Search Paths
To reset the paths to the defa
FLIES

1. Click the

buttonht

 

| bia ded

This option will remove any pa
ths added manually.

Language and Compiler Specif
cation Dialog

Importer Plugin 9/11the Ghidra language (Processc
r/Compiler Spec) of the progra
m being imported. Certain forn
ats, like "PE", "ELF", or

"XML", will usually choose the
appropriate language/compile
spec. If not, this dialog can

be used to select one or over
ride the default selection.ts a unique processor language
Icompiler spec pair. To select
one, simple click on the row
and press the OK button.
Table Columns

Processor - The processor for
this selection

Variant - Some processors have
different versions of the pro

[POL SE CR. I.ariants should have a
meaningful name

Size - the size in bits of the
processor address space
Endian - the endianess of the
processor

Compile - the compiler specifi
cation used to build the progr
amLR A nL
ce the number of entries in th
e table. Only the entries that
contain the text in this fiel

d will be displayed.

[DIT gTela ToT)

This field shows the currently
selected language/compiler s
C=

Show Only Recommended LanhE a thd Sheil Blabanl ivan hia Jaci
s suggested by the selected im
porter format will be shown. O
therwise, all known languages
will be shown.

Not all importer formats can d
etermine an appropriate langu.
ge, in which case all the lang
uages will be displayed.d to import multiple files at
the same time. The files may b
e individual files in a direct
ory tree, and/or files from an
archive file of some sort such
as a zip or tar file.

Importer Plugin 10/11This section manages a list of
folder trees or container fil

es (e.g., zips) to scan for fi

les to import. Initially, this
contains the folder or

file that was initially select

ed from the file chooser.
Adding an additional import so

urce folder.
[rs TE aE FY ER TES THI RTKing an additional folder ort
ile (import source) to search
for

import files

Removing an import source fol
og

Select a folder in the import
sources window and press the
emove button.

Depth limitA A A LC LL AS
to search for each of the spe
cified import sources. Note th
at this is

not the level of subfolders to
search, but rather the nestin
g levels of archive type files
RRR FAT)

JEST)

This button will rescan the imtidbit didnt

Files to Import

This section displays a table
showing the files that were fo
und. Each row represents a set
of similar files that can be
imported. The table

columns are as follows:
<checkbox> - if checked, thisDAELET)

Loader - displays the format (
Loader) that will be used to i
[nal Lela ISR {IN

Language - displays the langus
ge that will be used (if appli
cable). Clicking on this field
will pop up a list of accepta
ble langua CSLanguage - displays the langu
age that will be used (if appl
icable). Clicking on this fiel

d will pop up a list of accept
able languages

LCRGLEER {IN

Files - displays the number of
files in the group. Clicking

SA I Re | 1]

 

pr alImporter Plugin 11/11
Import Options

Strip leading path

If selected, the newly importe
d files will not use the relat
ive path of the file when stor
ing the result in the project.
Otherwise the file will be inmine project.

Strip container paths

If selected, the newly importe
d files will not use the inter
ior archive path when storing
the result in the project. Oth
erwise,

the file will be in a correspo
nding relative path to the pat
h the file was in its archive.der in the project that will b

e the root folder for storing
the imported files. Each impor
ted file

will be stored in a relative p
ath to that root folder. The r
elative path is usually the re
lative path of the file to its
Inl=llsdions described earlier.

Provided By: Importer Plugin

Exporting Files 1/8

[SCL RAE
Ghidra provides an Exporter thll

various formats.

Some of the formats the Export
er supports are:

ASCII

Binary

C/C++

Ghidra Zip File (.gzf)

HTML

PIE Pa[SIs Yalu Le]

The export action can be invok
ed from the front-end project
window or the CodeBrowser
[elh

To export from the front-end p
roject window:

[Te oHALLL A

From the popup menu that apy
rs, select the Export... menu
item.

Use the Exporter Dialog that a
ppears to configure the export

Press the OK button to perform
[ENOL IeITER

Make sure the program to expc
t is the currently open progra
m in the

CodeBrowser tool.

Invoke the action from the Fil
e Export File... menu item.Invoke the action from the Fil
e Export File... menu item.
Use the Exporter Dialog that a
ppears to configure the export

Press the OK button to perform
[ERO Ie

Export Dialogsen program.

Dialog Fields

Format - This field is a drop-
down list containing all the
valid export file formats that
could be used to to export th
e

program. By default, the last

Jue) Tm STILEOutput File - This field speci
fies the the output file for

the export. By default, the ou
tput file's name will be the
name of the program and the c
tput folder will be the

user's home folder or the last
folder used for an export if

an export has been performed
n the current session UseHe LhoLsEr LO Liallye thie
output file.

Selection Only - If this check
box is selected, then only the
areas of the program that are
in the current selection will

be exported. Obviously, this o
nly applies when exporting
from an open program with a s
lection in the CodeBrowserfae alana. aaaatet ttl a aed
window. Also, not all export f
ormats support partial
exports. The GZF format, for e
xample, always exports the
entire program since it is rea
lly just making an exported
copy of the entire program dat
abase.entire program since it is re
ally just making an exported
copy of the entire program dat
abase.

Options... - This button will
pop up format specific

options for the import.Ascii
Creates a plain text represent
ation of the program's listing

similar to what is displayed i

n the Code Browser Field Form
4

Teel -1a TE)

Eummrbimm Filae 2/QExporting Files 4/8
Advanced

Label
Suffix

the string to
Yolo = ale Mola]La nd

the string to
append on
Comment
lu)

Prefix
begining oflu)
begining of
comments

EL

The check-boxes in this panel
are used to

determine what program elem
s shouldcheck-box denotes that the
corresponding element will be
included

in the file. The checkboxes fo
[CIE ES

that are present in the progra
[EI

selected by default.
Commentsand Plate comments
[ge] gul

Include properties; e.g.,
Bookmarks, Spacers

Include Structures and
Structures Unions defined on c

aLl LER RE Te Ee]
code units (e.g, "??") or
Undefined

replace with "[BYTES
pC]

REMOVED]"
place-holder

Ref
HeadersML A A A AE
reference header
BACK[m,n] or
FWD[m,n]:, where m is
the number of cross
references and n is the
number of offcut cross
reference; select the
Back Refs and/or
Forward Refs for the=REEER EE

Include the list of cross

Back Refs references for each
code

unit

Forward

Include the list of
references to theForward
Refs

Include the list of
references to the
mnemonic for each code
unitInclude signature and
header for each function

ela

The text-fields in this panel
ELIA

width, in number of characters
, to use

TT ET IIIT ST[elV)ue]V lm ICH

Setting a width to zero (0)
SEENON ERIS iT]
he output file.

Binary

Creates a binary file containi
ng only the bytes from each m
mory

block in the proaram |f the pAndie)
the Binary Importer, then this
exporter allows recreation of
lu)

original file.

Only initialized memory blocks
are included in the output
file.

C/C++

Create a C/C++ file containingdata type manager and all of t
he functions in the program.
C/C++ Options

Exporting Files 6/8

Exporting Files 7/8Create C File (.c) - Select to
create a .c file.

Use C++ Style Comments (//) -
Select to use // or /* style
comments.

Ghidra Zip File (.gzf)
Creates a zip file from a prog
ram in your project. You may wou can give it to another user
who can
then import into their project

HTML
Creates a hyper-text represent
ation of the program's listing

similar to what is displayed i

SHE er A TRL I. 2 SA RR.‘I'he RTNML output Is analogous
o the ASCII output, however
HTML allows format and hyper-
ink information to be added to
the file. The formatting allow

s fields to be color-matched t
[}

those in the Code Browser. The
hyper-linking allows navigati
Fela]ML A LE

The HTML Options are identica
LW Nell Nell] IR

[EINE

The Intel Hex format, a printa
ble file representing memory
images, was originally designe
d to program EPROM devices.
The Intel Hex exporter creates
files in this format which caimages, was originally design

ed to program EPROM devices.
The Intel Hex exporter creates
files in this format which ca

n be

used to program these EPROM
vices.

Intel Hex Optionsh address space to export

as Intel Hex format only suppo
rts one address space. This
option will be intialized to t
he "default" address space.

IN
The XML Exporter creates XML
IES RICH conform to SUICICY H)

pS eeT Tels

The XML Options are identical
the XML Importer Options.
Related Topics:

[pal ool gale t- M11

Exporting Files 8/8Opening Program Files 1/5

Ghidra Tools can open an exist
ing Ghidra program file and pr
esent it for review and analys
is. Programs from other viewed
projects or viewed
repositories may also be opene
eRLurrently displayed Loo OF ©
an be displayed in a new insta
nce of a Tool.

Opening a Program File in the
Current Tool

1. To open a program file in t
he currently displayed tool, s
Clea

PAR LEE NRE CECI EC IEICE REOpen... from the Ghidra Tool's
[CLIT

This allows selection of any f
ile that is part of the active
project.

3. Select the program file to
open.

4. Click the OK button OR doutThe selected program is opene
and displayed in the tool. Mo
re than one program can be op
ned at the same time, but only
one of

them can be active at a time.
The Code Browser window shox
a tab for each EeICyl that bethat program the active one, a
s shown in the image below.

In addition to selecting a fi

le, this dialog can be used to
perform some basic directory/
file operations. Right click o

n a program to get the

Areninem Drmmrams Filae 3 JEHistory

The History button on the Oper
Program dialog expands the di
alog to show previous versions
of a program (if the selected
program is

shared), allowing the user to
view a read-only previous vers
ion of the proaramne "story pale! shovws all pr
evious versions for the select
ed program. Each entry shows
hich user created the version,
the date and time the

version was created, the versi
on number, and the comment |
that version. To open a histo
ry file, select it in the Vers

ion History table, andThe History panel shows all p
revious versions for the selec
ted program. Each entry shows
which user created the version
, the date and time the

version was created, the versi
on number, and the comment |
that version. To open a histo
ry file, select it in the VersNe [0 "OK" button. The ver
sion history can be hidden by

pressing the "No History" butt
[LR

Opening a Program in a New Tt
| via Drag and Drop

1. Locate the program to open

in the Ghidra Project Window.gram in the tree, drag itto t
he Tool Chest, and drop it on
the desired tool by releasing
the left mouse button.

The

icon in the Tool Chest indicat
es the CodeBrowser tool.Is launched with the selected
program open. The Running Tc
s area of the Ghidra Project W
indow now shows the newly
launched tool.

Opening Program Files 4/5

Alternativelv prodarams can beLA IRA AS RRL AA ALLL L®
Tools area or onto the tool it
self). In this case, the

program is opened in the exist
ing tool in addition to any pr
ograms that are already open.

Opening a Versioned Program |
C]
If you attempt to open a versiha tha kth Blac bio JL Locldii of a
ayed to warn you of this. You
will not be allowed to

save changes to this file unle
ss you check it out.

If you are working in a shared
project, AND if you plan to m
ake drastic changes to memory
e.g., add or remove memory bin an exclusive lock on the pr
ogram file.

If you choose the "No" option,
the program will be opened re
ad only, thus you will have to
save your changes to another
filename.

Provided by: ProgramManagerfRelated Topics:
Ghidra Programs
Importing Programs
Closing Programs
Shared Project

Opening Program Files 5/5Closing Program Files 1/2

Closing a program will remove
the program from the Tool. The
Tool will remain displayed bu
t will display either another
open program or be empty.

If the program to be closed ha
s chanaes and is open in onlvIMpLeud LO save Le progrdalr. Ac
ever, if the program is open i

il

multiple tools, the user will
not be prompted to save even |
f changes have been made. In
ther words, the only time the
user will be prompted to save
a

program that is being closed ihindi sda iiadiai Jedediah

To Close a Program File

1. From the Tool menu, select

File

Close

2. If changes were made to the
program and they haven't bee
saved yet, the Save Program?

dialog appears.m? dialog perform the followin
g functions.

Save - Saves the program chan
es and close the program in th
e current tool.

Don't Save - Discards any chan
ges that were made to the prog
ram and closes it.

Cancel - Leaves the program ofIf the listing window is open
and multiple programs are ope
, the program names are disple
yed on tabs across the top of
the listing window.

Programs can be closed by sele
cting the appropriate tab and

pressing the corresponding "x'
| Frlo Close All Programs

1. From the Tool menu, select
File

Close All

2. For each program that was ¢
hanged, the Save Program? die
[ET LETEN

To Close All Proarams Other TERA LLL RA LL A
File

Close Others

2. For each of the other progr
ams that was changed, the Say
Program? dialog appears.

Provided by: Program Manager
lugin
Related Topics:hea

 

Closing Program Files 2/2GHIDRA Training 6
TOP SECRET//CYBER//NOFORN[Navigating Programs
Navigating Program Files 1/3

Open programs are represente
in Ghidra bv tabs at the top oNese labs LOU Lhdalye thie atl
ERIC

Also, as described below, ther
e are various actions that all
ow you to change the active pr
ogram.

Program Tabs
When there are more open pro
ams than room to display theirhadi | i” alah ata
[SETTER

This button displays the numb:
r of hidden programs.

Program Tabs ‘More Button’
To access these hidden progral
s, click the button to display
a menu for selecting programsProgram Tabs With Popup Win
Wg

Navigating Program Files 2/3
The popup window displayed a
ows you to select a tab by cli
cking a program name, or by u
ing the up and down arrow key
ldose the selected program. Also
, typing text data will filter

the displayed

program list. You can close th
e popup window without makir
a selection by pressing the Es
cape key or by clicking a comp
onent

outside of the window.

LL Cems to bre peas woes Tietbas id Vi PardadNavigation Actions

Go To Next Program and Go To
revious Program Actions

The next and previous actions
are only available via keybind

[MEERLI NA EET ETN el]
trol-F8 and Control-F9

for previous and next respectALLA ER ARRAS) SEER LEASE
ptions.

The next and previous actions
allow you to move between op:
tabs. For example, when the G
o To Next Program

action is executed, the tab to
the right of the current tab

is highlighted.Lovin diate
ighted tab will become the act
ive program. Quick, repeated e
xecutions of the action

will continue to move the high
lighted tab to the right.

The Go To Previous Program ac
ion works in the same way as t
he Go To Next Program action,
except that itThe operation of tab highlight
ing varies slightly depending
upon the existence of hidden t
abs. Without hidden tabs,

the highlighting, when startin
g from the first or last avail
able tab, will wrap around to
the other side of the tab listprogram being activated until
NLR Ce] oN

Contrastingly, if there are hi
dden tabs, then when the first
or last tab is highlighted, t
hen the next successive
highlight action will trigger
the more tabs button to be exe
cuted.I'he Go To Program... action wi
Il show the program selection

popup window when executed
is menu allows

you to pick a program to go to

Navigating Program Files 3/3ARE LL EAS A A PLE AL
he Tool menu, select Navigatio
il

Go To Program...

Go To Last Active Program Acti
on

The Go To Last Active Program
Action will activate the lastbusaiainilisiuua ibaa’ Matiadtelabod
program. Thus, this action is
disabled when you do not have
a previously active program.
To execute this action, from t
he Tool menu, select Navigatio
il

Provided by: Program Manager
luginClosing Program Files

Go To Last Active Program.

Ghidra Project Window

Ghidra Front End 1/12is window, you manage your pl
jects, workspaces, Programs, a
nd tools. If

you are running Ghidra for the
first time, you will need to
create a new project to get st
arted.

The Project Window is a tool a
nd may be configured with "sp

RCA TV SET 3 RWrequired at a high

level. By default, the Project
Window contains plugins for i
mporting and exporting Progra
s, archiving a project, and re
storing an archived

project. These plugins may be
added to other tools.

The options for archiving and
restorina a proiect will showWITNUOW, SVET LHOUyn the piuyl
s providing
these options can be added to
other tools.

The following sections describ
e the Project Window:
LINES

Active Project Panel
Read-Only Project Data Panelbide
Project Repository

Ghidra Server Connection Stat
B

Data Tree

Data Table

File Icons

Console

Configure Project Window

Edit Menu OptionsConfigure Project Window
Edit Menu Options
Manage Tools

Getting Help

Exit Ghidra

Ghidra Front End 2/12

LINESur <user home dir>/.ghidra/.g|
idra-<version>/tools folder. T
he tools are

placed there when you initiall
y install Ghidra. These tools
are always available to your c
urrently open project. See Ghi
dra Tool

Administration for information

[TIT OVALE tener WUE. LAINEan icon that represents each t
ool in your Tool

Chest.

You can launch a tool by click
ing on the icon. You can launc
h a tool with a Program by dra
gging a Program file from the
Project data

tree and dropping it on the to
Fe BT t RIB RO =IALLIVe Froject

The Active Project view shows
your programs and datatype ar
hives in a tree view or a tabl

e view. The tree view is usefu

| for organizing

your files into folders and su
b-folders. The table view is u
seful for sorting all your fil

es on some particular attributhes abutiidyt Shiai atic i a ut lit
e. In either view, you open an

d perform various actions on p
rogram files or datatype archi

ves.

Project Data Tree

 

The data tree shows all files
in the project orgnanized into
folders and sub-folders. Iconunder version control and whet
her you have the file checked
out. Open this view by activat
ing the "Tree View" tab.

Tree Only Actions
The data tree supports the fol
lowing operations:
Create New FolderLB
2. Right mouse click and choos
e the New Folder option.

3. A new node is created in th
e tree; a cell editor is displ
ayed, containing the default n
ame, New Folder; enter a new
name, or the <Escape> key to
ancel the editing.3.
name, or the <Escape> key to
ancel the editing.

Ghidra Front End 3/12

You cannot create a sub-folder
of a folder that you do not o
LGR

Copy Folders and Files

To cobv folders and files to aERE ALA ELAS SB A AE AL A

u may also select multiple fol
ders and files.

If you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Copy option.

3. Select a destination folderBEd hiatal ut abi
e the Paste option. For very |
arge files, an "in progress" d
ialog is displayed. You may
cancel the paste operation at
any time.

Move Folders and Files
To move folders and files to a
nother folder that you own,ders and files.

If you select a folder, then a
ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Cut option; the icon wil

| change to a dithered image t
o indicate the cut operation.4. Right mouse click and choos
e the Paste option.

You cannot move a file that is
in use.

Drag/Drop for Copy

You can get the same effect of
Copy/Paste using Drag and Dr
p.

1 Calart a faldar ~r fila (Ar2. Rola the Ctrl key down and
drag the object to another fol
[E18

3. Drop the object on a folder

You will not get a valid drop
target for folders that you do
eI R

If vou release the Ctrl kev duHallyges LO a move 11 you afc ul
agging from a folder that you
own. Dragging files from anoth
er user always results in a co
py, regardless of whether you
hold down the Ctrl key.
Drag/Drop for Move

You can get the same effect of
Cut/Paste using Drag and DroyDahat= Eh
IH

2. Release the mouse button w
en you get a valid drop target

If a folder or file already ex

ists in the destination folder

, Ghidra will append a ".copy"
to the name to make it uniqueCEI a [0s and all of
its descendant folders,

To expand a folder and all of
its descendant folders,

1. Select a folder.

2. Right mouse click and choos
e the Expand All option.To collapse a folder and all o

f its descendant folders,

1. Select a folder.

2. Right mouse click and choos
e the Collapse All option.

Project Data Table

EE TE mmted by some attribute of the T
ile. In the example above, the
files are

sorted on file type. Icons for
files indicate whether they a
re under version control and w
hether you have the file check
ed out.

To open this view, active the
"Table View" tabEa A EA SA BL A LR A
and the Data Table

PEELE
Deleting folders is a recursiv

e operation, so all descendant
folders and files are also de
leted. This is a permanent ope
ration.

To delete a folder or file,| Taub ansiniibibdainsanl icici intittainsiakitat
files.

If you select a folder, then a

ny selections that are descend
ants of this folder are ignore

d.

2. Right mouse click and choos
e the Delete option.

The Delete option is disabledTo rename a folder or file,

1. Select the folder or file.

2. Right mouse click and choos
e the Rename option.

3. A cell editor is displayed;
enter the new name.

3. A cell editor is displayedd within the same folder.
Ghidra Front End 5/12

You cannot rename a file that
isin use.

You cannot rename your projec
LClCIS

Select All

Th calart a faldar amd all ~fERE ee R el Lg
2. Right mouse click and choos
e the Select All option.

Read-Only

To mark a file as read only,

1. Select a file.

2. Right mouse click and choos
e the Read-Only option.

The icon for the file is undatalc. vwiich you right mouse cil
ck, a check mark shows up in t
LC)

Read-Only option.

A read-only Program must be s
ved to a new name if you make
changes to it.

You cannot change the read-or
y state of a file while it is

in use.paoaBloabaabiutbiit dina theibl fais ihilaalliag tate
ic file, drag a file to the to

ol icon in the Tool Chest.

To open a file in a running to
ol, drag a file to the tool ic

on in the Running Tools tool b
ar, OR drag the file to the to
ol window.

Open a File in the Default Toot was specified as the "defaul
t," double click on the Progra
m that you want to open, OR ri
ght mouse

click on the file and choose O
pen in Default Tool.

Open a File With a Specific To
ol1. Select the file.
2. Right mouse click and choos
CXel-EhR i]

<tool name>.

Refresh
The
button on the tool bar refresh

BT TY. SEto sync the project folaer/fil

e

structure with the project rep
ository. The list of files and
folders in the Project Data T
ree is updated. This button is
enabled

only for selected folders. You
can also refresh folders from
a viewed proiect or viewed reLLL
Ghidra Front End 6/12
To view information about a fi

le, right mouse click on the f
ile in the data tree and choosVersion Control Actions

There are numerous actions rel
ated to version control. See P
roject Repository for details.

File Icons

The Project Data Tree shows ic
ons for the following types of
files:(a data type file stored in th

e project)

The Project Data Tree shows m
difications to these icons for
files in the following states

File StatusDescription

Versioned File not checked
out.

The program named "Example
versioned as
indicated by the light purple

[A a.Is no circle with a

check mark. Version 1 is the |
atest version, as

indicated by "(1)"; the versio
LRUIIR-ER

latest version when the file i
s not checked out.

Versioned File is Checked out
exclusivelv bv vouVEIN L OF Lhe prograli fidafrie
SCTE

checked out, as indicated by "
(1of 1)";

Version 1 is the latest versio

n. The blue check

mark icon indicates that the f
ile is checked out

with an exclusive lock.

If your project is not associafastisiababatts’ I anal aiobiaoisbtblebtl’ etl iiien
he latest version

checked out and the check out
will always be

exclusive, since the project i

s not shared.

Versioned File is Checked
Out; the project is associated
with a Ghidra ServerSCTE

checked out; Version 3 is the
latest version on

the server, as indicated by "(

3 of 3)" and the

green circle with a check mark
. The asterisk

indicates you have changes to
the file whichVersioned File is Checked
Out; the project is associated
with a Ghidra Server. A
newer version exists on the
server.

Version 2 of the program name
"Example" is
checked out; a Version 3 has b

rr [ —"Indicated by "(2

of 3)" and the magenta circle
with a check

mark. The asterisk indicates y
ou have changes

to the file which have not bee
n checked in yet.

Private FileLAT

version control, exists only o
n your local

machine, and is not visible to
other users.

Hijacked File

The private file "Example" exi
HEB 1'1dfant acim Lia
version control, which caused
the private file to

appear as hijacked, (i.e., the

file can be saved

"as is" using "Save As" since

you do not have

the the file checked out that

is on the Ghidra

Server.) Hijacked files may alThe shared
version of "Example" will not
be visible in

Hijacked File

checkout that was terminated.
The sharedGhidra

your project until you undo th
e hijack.

You Front End 7/12

can also either rename the hij
acked "Example",

move it to another folder, del
ete it, or use the

Undo Hijack action. Then the s
|data tree as a
versioned file.

Read-Only Project Data

You can view data from other P
rojects or remote Repositories

and copy data into your curre

nt Project's data folders.

View Other Projects

To view the data from anotherFala

Select Project

View Project...

A file chooser is displayed; t
he default location is the pro
jects folder in the installatiEatidhiat haan ud a’ anki atest
ension is "gpr."

A new tab for the data tree is
created in the "READ-ONLY Pre
ject Data" panel in the Projec

t Window, next to the

Active Project panel; the tab
shows the name of the project.
5. The list of recent projects
menu is updated to include thYou can copy and paste folder
s (via menus or drag and drop)
and files from the other view
to your folders.

Ghidra Front End 8/12

You do Ci have to hold lu) esnot be a move operation,

as this view is always read-on
ly.

View a Shared Project

You view a shared project the
same way you would a non-sha
d project; the difference is t
hat when you view the shared
project, an attempt is made to

JR PL RLF 1 LNDepending on the user
authentication mode of the Gh
dra Server for the other share
d project, you may have to ent
er a password. If the connecti
on

to the Ghidra Server is unsucc
essful, then the only files av
ailable to you are your privat
RienLR A LL LC A RE A A
-based repository:

1. Select Project

View Repository...

2. A repository chooser is dis
played; allowing you to specif
y a Ghidra Server network add]
ess and select one of its
repositories...

3. Enter the Ghidra Server add4. Click the Refresh button to
the right of the host name an
d port fields. This will conne

ct to the specified Ghidra Ser
Cle

and list available repositorie

s for which you have been gran
ted access. You may be prompt
d for a password shouldry from the list of those avai
lable.

6. Click the Select Repository
button. A new tab for the dat
a tree is created in the "READ
-ONLY Project Data" panel

in the Project Window, next to
the Active Project panel; the
tab shows the URL of the remc[repositories menu is updated
to include this repository.

View Recent

Ghidra maintains a list of Pro
jects and remote Repositories
that were recently viewed.

To view a recently opened proj

[Ele eT =To TE] 1 Ve] 3A
LE FFE ay, moe<project path or repository UR
L>

2. Select a project or reposit
ory from the menu.

If the project/repository is n

ot in the view, a new tab is c
reated in the "READ-ONLY Proj
ct Data" panel in

the Project Window; the tab sh
ows the name of the proiect orne tab 1s 1h Lhe VIEW, Lhe
n the tab for this project/rep
ository is selected.

Close View

To close a view, select Projec

t Close View

<project path/repository URL>
OR click on the small 'X' on
the specificLate J -pai Sl aat ach bl aka Battal cd
and choose the Close option.
The tab is removed from the *
EAD-ONLY Project Data" panel
n the Project Window.

Close All Read-Only Views

To close all read-only views a
t once, select Project

 

Close ViewThe tabbed pane for read-only
Project data is removed from t
he Project Window.

Workspaces

A workspace contains a set ofnalogous to a virtual desktop.
When you switch

Ghidra

to another workspace, you swit
ch to a different set of runni

ng tools. The tools from the o
ther workspace remain running
butFront

are notEnd 9/12

wieilrle ini] vet ewritelh karlI'he workspace names are liste
in a combo box in the Running
Tools panel. Switch to anothe
r workspace by choosing a nan
LHCInRGE

list. The default workspace, n
amed "Workspace," is created
n the project.

The workspace state, i.e., run
nina tools tool connectionsLULA LARS An SL LAS
or close the

Project.

To create a new workspace,

1. Select Project

Workspace Add...

2. A dialog is displayed; ente

r a new workspace name. Dupl
ate workspace names are not a
lowed.hhualit hi adh tabi bath] id iat Sadun
es the current workspace; the
name is added to the list of w
orkspaces

in the combo box.

If you leave "Workspace" as th
e new workspace name in the ¢
alog and click on OK, a one-up
number is appended to the
name to make it unique.1. Select Project Workspace Re
name...

2. A dialog is displayed.

3. Enter the new name for the
current workspace. Duplicate v
orkspace names are not allowe
. The list of workspace names
5

updated to reflect the new nane,

1. Select Project Workspace De
lete...

2. A dialog is displayed to co
nfirm your delete request.

3. Choose the Delete button to
delete the workspace.

Tools in the workspace are clo
sed.

VE vrs renisibas soe sb vi romvnt Treas Hires!tool, a dialog will be display
ed to prompt you to save your
changes.

The oldest workspace becomes
he current workspace. If the d
eleted workspace was the last
one, then the default
workspace ("Workspace") becc
s the current workspace.4. SEIELL FIOUJELL VVUITRSPALE SV
[Le I

2. Switches sequentially throu
gh the list of workspaces (in
creation order), wrapping back
to the first after the last h

as been reached.

For example: WS1, WS2, WS3,
en WS1.

3. If only 1 workspace exists,Running Tools

The Running Tools panel show:
an icon for each tool that is
running in the current workspa
ce. Click on the icon to bring
that tool

forward on your console. To cl
ose the tool from the Running
Tools panel, right mouse clickClose option.

To connect running tools, drag
one icon onto another icon. T
hose tools are connected for a
Il tool events.

Tools running in different wor
kspaces may be connected.

Ghidra Server Connection StatIf your project is associated
with a Ghidra Server, then be
low the Running Tools panel yc
u will see a connection status
panel that shows

Ghidra

the name of the Project Reposi
tory, your access privileges,

PR RE sre OWLRU TRY 1ld

GhidraEnd 10/12

Server. The status button,
indicates that your project re
pository is connected to the G
hidra Server; the status butto
n,

indicates that your project re
pository is associated with a
Ghidra Server but it is not coyoul project is Not d4550C1a
ted with a Ghidra Server, then
this status panel is empty.

Edit Project Access List

If your project is shared, the
Project menu has an option to
edit the project access list.
This list controls what users
have access to thehati ion suliabistl Call tliat
nistrative privilege in the pr
oject, the option for Project
Edit Project

Access List will be enabled. T
he dialog displayed when you ¢
elect this option shows a pane
I that is the same as the one
you see in the

New Project Wizard when you ¢zard, this dialog allows you t

o add and

remove users, and change user
* privileges in the project.

In order for a user to show up
in the Known Users list, the
server administrator must add
a new user to the Ghidra Serveell on the server system using
the svrAdmin command. Refer
o the server/svrREADME.htmifil
e

in the installation directory

for use of this administration
command.

If the user does not have admi
nistrative privilege in the pr

JL LT TL Eed make edits.

Instead, the option for Projec
t View Project Access List wil
| be enabled, which will displ
ay the following dialog and al
low the user

to view the project users and
their current access privilege
sonly.Change Password
Ghidra Front End 11/12

If your project is associated
with a Ghidra Server that is u
sing Ghidra password authenti
ation, then the menu item, Prose this option when you want t
o change your password. A dial
og is displayed to confirm you
r request, as

shown below.

fh Riad | thea ied

 

If you select Continue, a dial
og is displayed for you to ent
er your new password, and to rWhen you initially connect to
the Ghidra Server using passwit
rd authentication, your defaul
t password is "changeme". The
[SEI EET fe ENGI ERE ST
24 hours so you must change
our password as soon as possik
le. If your password expires o
rif a userreset your password. This is
accomplished from a commanc
ell on the

server system using the svrAdn
in command. Refer to the serve
r/sviREADME.htmlfile in the in
stallation directory for use o
jal

administration command.Click on the console icon
to display the system console.

Log messages, including the st
andard output and error strean
s, are redirected to the conso
le. If you are running Ghidra

in development

mode (ie throuah Eclinse orELA A I SL LA ALE
your IDE's console as well as
the Ghidra

console.

Errors and other informational
messages are logged to a file
in <user home>/.ghidra/ghidr
User.log. Messages are append
d to the file

every time you launch Ghidra.| be rolled to a backup file n
amed

ghidraUser.log.0. Older backug
files are similarly rolled to
another file with a one-up di
git suffix as well. Ghidra sto
res a maximum of

three backup files (ghidraUser
.log.0, ghidraUser.log.1, ghiddevelopers for
troubleshooting.

The field next to the icon in
the Ghidra Project Window sho
s the last message sent to the
console (error messages are i
RCN

Getting HelpContext Sensitive Help

Ghidra provides context sensit
ive help that pops up when yot
hit the <F1> or <Help> key.

Ghidra Front End 12/12

re he Luan] bh Habe EY ad a ibera
EN
Fl

Display the menu (either from
the tool menu or the popup) th
at has the option you want hel
pon.

Position the mouse pointer ove
r the option© ACIP VIEWET Is Ulsplaycu a
nd shows the appropriate help
contents.

To get help on a dialog or too

| window, click somewhere in t
hat window and press the <F1
or <Help> key.

If no specific help exists, th

en a default page for Ghidra hThe About Ghidra option show:
build information about the Gh
idra application.

Related Topics:

Tool Administration

Projects

Program

Import Program

Export ProgramProject Repository )
Project Info dialog

Saving Program Files 1/3

Saving Program
When changes are made to a p
FIC] the user Jules save the fe user can either save the cha
nged program back to the
original program file or save
the changed program to a new
ile, leaving the original
program file unchanged.

Save
Saves the changed program ba

PIL a {emg =enabled when changes have be
made. To perform this action:
1. From the Ghidra Tool's ment
, select File

Save.

or
Select the Save iconALA LLL A

Save As

Saves the currently open progr
am to a new program file. This
new program file

becomes the program that is a
tive in the tool. When selecti
ng Save As..., Ghidra will
prompt for a filename. To perf, select File
2. The Save As... dialog appea
rs.

Save As...

Saving Program Files 2/3w Name of the program.

4. Click the Save button.

5. The program is saved to the
new name. This new program
the one now active in the
CIR

If an existing program is sele
cted from the Save As... dialo
g, an overwriteSave All

Saves any currently open progr
ams. If any program has never
been saved before,

Ghidra will prompt for a filen
ame.

1. From the Ghidra Tool's ment
, select FileProvided by: Program Manager
Plugin

Related Topics:

Open Program

Close Program

Saving Program Files 3/3Feryge rrogralhn ries
Merge Program Files 1/30

The Ghidra Server provides fil
e access to multiple users ena
bling a team to collaborate on
a single effort. It provides
network storage for shared pro
ject repositories while controthe shared project repository
allow multiple users to concur
rently:

Check out the same version of
a program file

Make changes to the program 1
C]

Check the changed program fil
back into the shared projectate EET) made 3 a Be v
ersion of a program file by mu
Itiple users. The following st
eps show a typical merge scen;
rio:

Check in / Merge Sequence:

i

Afile is added to version con2.

A user checks out Version 0, m
akes changes, and checks it in
to create Version 1.

cH

User A checks out Version 1.User B checks out Version 1 an
d makes changes.

5.

User B checks in his changed f
ile, creating Version 2 in the
project repository. Because n
Pele al RT Ie eR Nee aleAL LE LAI A A
be created

automatically. This new versio
n will be the changed file cre
ated by User B (Step 4). In th
is case, merging is not involv
ed in the check in process.

6.ES

During the check in process, t
he Ghidra Server determines tt
at a new version of the progra
m file has been added since Us
er A originally checked out th
e file (Step 3). The latest veersion 2, is not the same file
that User A had checked out,
Version 1. A merge is required
since a new version of the fi
le was added to the repository
after User A checked

out the file.

If a new version of a file hasrequired at check in. This is
the only time a merge is requi
red.

The Ghidra Server starts the m
erge process by making a copy
of Version 2. Changes from Use
r A's checked in file are appl
ied to this copy to create the

mins Fila \arcinm 2 Thera armerges - automatic and manus
If changes made by User A anc
User B do not conflict automa
tic merging is done. If change
s made by User A and User B d
conflict, then User A must ma
nually

resolve the conflicts. Note th
at the last user checking in c
hanades must resolve conflictsEa LAI I SR RL LSS AEE LAS
e of changes at a location in
JENIN

The figure below illustrates t
his typical scenario where two
users check out a file, as de
scribed above. The sequence o
events are numbered in paren
heses in the diagram, and corrhii rt hiatal

above:

To begin the merge process, se
lect the Check In option on th
e Ghidra Project Window. A prc
gress bar is displayed while t
he merge is in progress. The m
erge begins with a copy of the
latest version of the file frs copy. At the conclusion of t
he merge, this copy along with
the applied changes will be s
aved in the repository, and wi
Il become the newest version o
ARORIIEN

The merge processes program
ements in the following order:
MemoryProgram Context Registers
Listing

Code Units

Externals

[LleI.I

Symbols

Equates

User Defined Properties
References

Barbi arbeComments
External Program Names
Property Lists

Merge Program Files 2/30

Within each program element
EYP ne sa 1ulolss lle IN -1un-Tsaloluz]eAAS EUR ER ER) Al AS
nflicts before moving on to th
e next program element. For e
ample, the Program Tree merg
performs the

auto merge, and then requests
user input to resolve conflict

s, as required. Once the Progr
am Tree has been merged, wit
all conflicts resolved, the meial id
If you cancel the merge at any
time, you are canceling the e
ntire check in process and you
r file remains checked out. No
ne of the changes that was ma
e as a result of the merge is
applied to the program that yo
u have checked out.

While the auto merge is occurrisplayed in the merge tool. Th
e following image shows an ex:
mple of the merge tool when tl
e merge process is auto mergir
g code units.

At this point the Memory, Prog
ram Trees, Data Types and Pro
ram Context phases have alrea& Code Units sub-phase of the
Listing is currently In Progre
ss,

The Progress In Current Phase
progress bar provides the user
with an idea of how much of t
he phase has completed. The c
her sub-phases of Listing, the
External Programs and Propert

Ar 1 eekee Fomsras bert Femme Poms ree ard 4}Indicated by the Pending icon,
. The message below the curre
nt phase progress bar gives ad
ditional information about wha
t is currently happening in th

e phase.

At the bottom of the merge toc
| is a progress bar and messag
e for an immediate task. When
multiple of these smaller taskISAAC REAR RAE ® Ae I
rrent phase.
The following sections describ
e the auto merge process and ¢
onflict resolution process in
greater detail.

Auto Merge
For each program element, the
Auto Merge is the first of thein davies’ JE vipa dict iat
cribe how Auto Merging applie:
to each program element.
Memory

Program memory is organized
memory blocks. The only chan
es to a memory block that can
be merged are:

Name

Permissionsmory structure (add a block, r
emove a block, etc.) only when
you have checked out the prog
ram with an exclusive lock. Th
is restriction prevents drasti

c changes in memory that
could potentially have a major
impact on other users. Typica
lly, all users working on theen have one user make them. /
exclusive lock prevents
anyone else from checking out
the program while the exclusiv
e lock exists. When you check
in your changes, merging is no
t necessary as no other versio
ns were created while you had
the program checked out.

A I A. WEComments on the memory bloc
re replaced in the results pro
gram during the merge proces:
You must resolve all memory ¢
onflicts before the merge proc
ess can continue with the next
[Sle ICTR Sa El

program trees.

Program Trees

1f vou make anv chanade to a prallgeud alll ITiay be heryced. NO
rther inspection of changes is
done. If the tree was not cha
nged in the latest version, th
en the automatic merge can be
done. If the tree was changed
in the latest version, this is
considered a conflict that yo

u must resolve before the merc
e process can continue with thhe i ot aaa iit ate]
Data Types and Categories
Data types can be created, ren
amed, edited (contents), or de
leted. During merging, newly c
reated data types are added at
tomatically (if a data type wi
th the same name already exis
s in the parent category, then
your new data type is createdto data types are merged.
When merging data types, ther
is only one way that data typ
e conflicts can occur. A confl
ict results only if in both fi

les the same type of change (r
ename, edit contents, delete)
was made to a particular datau changed can be merged autc
tically. For example, if you r
enamed a structure data type ¢
nd in the latest version the c
ontents of that data type were
edited, this will not cause a
conflict and your change can b
e applied automatically during
the merge process.

TIL CC A LE ETadd/remove data types and cat
gories). Note that moving a da
ta type to a different parent
category is considered a categ
ory change, not a data type
change.

As with data types, there is o
nly one way that category conf
licts can occur. A conflict re
sults onlv if in both filesATLA A A A A A AS)
was made to a particular categ
ory.

Other than this, no conflicts
can occur and the category you
changed can be merged autor
ically. For example, if you re
named a category and in the lz
test version the category was
moved to a different parenthail al failed
be applied automatically duri
ng the merge process.

All conflicts must be resolved
before the merge process can
continue with the next progran
element, Program Context Rec
EICIEN

hit watuaatilProgram Context Registers
Merge Program Files 3/30

For any of the registers defin
ed by the program's language
ou can set a register value fo

r an address or range of addre
sses. If you set a register vatically

change the value during the m
rge process if the value wasn’
t changed at that address in t
he latest version. If your ver
sion and the latest version ch
ange the register to the same
value at an address, it will a
Iso get

J RT 7 |egisters will happen before yo
u are prompted to resolve any
conflicting register values.

You must resolve all register
conflicts before the merge pro
cess can continue with the nex
t program element, Listing.
Listing

Various parts of the program a
re meraed in the Listing merae© ufits, TUnCLons, symbols, ©
quates, user defined propertie
s, references, bookmarks, and
comments. For each of these
parts the auto merge will occu
r followed by a manual merge
LEIA DilTeR

Code Units

If you make any change to the
memory bytes or to a code unitke Bail
ta, the code unit gets marked
as changed and may be merge
If you change

the memory bytes and the late
t version doesn't have memory
byte or code unit changes, you
r byte changes will be merged
automatically. If you changed
the code unit and it does notthe change to the code unit wi
Il be merged automatically.

If the latest version had any

of the following changes, the
code unit is in conflict and m
ust be manually merged:

The latest version and your ve
rsion have memory bytes chan
d to different valuese code unit or vice versa

The latest version created or
cleared instructions or data d
ifferently than you did

The latest version created, ch
anged, or removed an equate f
r the code unit you changed or
vice versa

You must resolve all byte and

JE POOL TUM ME Te TRA A Teth the next program element, |
[PLle ITE

External Functions and Labels
If you make any change to the
external locations (external f
unctions or external labels) d
efined within the program, suc
h as creating, updating, or re
moving an external location, t
he external locationLL AR SAS ASE A
The following types of changes
will get merged automatically

Changing the name, external n
mory address, or data type for
an external location as long
as the latest version didn't c
hange the same attribute of th
e external location.ong as the latest version didn
't set the data type for the s
ame external label or remove t
he label.

Changing from an external fun
tion to a label or removing an
external function as long as
the latest version didn't chan
ge the external function.test version didn't also set t

he data type or change the lab
el into an external function.
Changing an external function
as long as the latest version
also didn't make changes to th
e function.

Conflicts could be:

another variable at the s same othe same named register and
irst use address.

You must resolve all external
location conflicts before the
merge process can continue wi
h the next program element, F
nctions.

LleI-I

[FE errr Be WS rerogram, such as creating, upada
ting, or removing a function,
the entry point of the functio

n gets marked as changed and
he function may

be merged.

The following types of changes
will get merged automatically

Addina a function with a bodv10h DOUy In the lalttol version

Removing a function as long as
the latest version did not ch
ange this function or its stac

k frame.

Making changes to the functior
name, return type, parameters
, parameter offset, return typ
e offset, etc. as long as theRE a
ion.

If a variable name conflicts w
ith a variable or symbol of th

e same name in the function's
namespace of the latest versio
n, that variable will automati
cally be renamed to a conflict
name. This

eliminates the name conflict.type, or description if the |
atest version didn't change th
e same part of the parameter.
All local variables will be au
tomatically added if they don’
t conflict with changes to the
latest version.

Conflicts could be:

another variable at the s same othe same named register and
irst use address.

another symbol with the same
ame in the function's namespa
e

the name, datatype, or comme
for a local variable is chang

ed to different values in your
version and the latest versioYou must resolve all function
conflicts before the merge pro
cess can continue with the nex
t program element, Symbols.
Symbols

Whenever you add, remove, or
ename a symbol, the program |
ts marked as changed. It also
gets marked if you change the
primarv svmbol at an address cALLS LIND &

point. The symbol phase of the
Listing merge will merge labe
Is, namespace symbols, class s
ymbols, and external symbols.

Symbols associated with functi
ons, function parameters, and

function local

variables have already been re
solved by the function phase obh asbk chy tabalak bak Sa Ul aa aceill ack ak

will get merged automatically

Any symbol you removed will a
tomatically be removed if the
latest version didn't change t
hat symbol.

Any symbol you added will aut
matically be added if latest v
ersion did not create the sameace.

If each program has a symbol r
amed the same within a name:
ce but at a different address.
These are resolved automatica
lly by merging your symbol usi
ng a .conflict name. In other
words,

CIs Rul] will have a Shi]fied at the end of the symbol
merge phase of any symbols th
t were renamed to avoid a conf
[I=
Any symbol you renamed will
tomatically get renamed if the
latest version didn't rename
that symbol to a different nam
e.

TE vrmit ,rhamea vikimh evra al feIlly set to primary unless the
latest version set a different
symbol to primary.

Entry points that you added or
removed will be added or rem
ved automatically.

You must resolve all symbol co
nflicts before the merge proce
ss can continue with the next
lListind merae phase the AddreAUUTESS DastU Listilly Merye
During this phase of the Listi
ng merge each of the address |
ased listing elements (the equ
ates, user defined properties,
references, bookmarks, and cc
mments) will get merged. First
an auto merge

will occur for each of these e
lements. When all of the autohiatal Abb ccc Rd
ress order for each address th
at has a conflict for any of t
he address based

During this phase of the List

ing merge each of the address
based listing elements (the eq
uates, user defined propertiestan auto merge

will occur for each of these e
lements. When all of the auto
merges are complete, conflict
resolution will proceed in add
ress order for each address th
at has a conflict for any of t
he address based

listing elements. At each addrlicts (equates, user defined p
roperties, references, bookmar
ks, and comments) before proc
eding to the next

address with conflicts. The fo
llowing sub-sections describe
the auto merge for each of the
address based listing element
EXEquates

An equate associates a display
name with a scalar operand or
sub-operand at a particular a
ddress in the program. Whene\
r you create, rename, or remov
e an equate the program gets
marked as changed. An equate
onflict can arise between vourLEER ASR ALAS LARS BS 4 SA I
te changes will get merged aut
omatically:

If an equate was set on a scal
ar and the latest version didn
't set an equate on that scala

r, the equate will be added au
tomatically.

If an equate name's associated
value differs between the twoIved automatically by changing
your version's equate name to
El

conflict name by appending "_
onflict" to your equate name.
If your version's scalar had i

ts associated equate removed,
it will get automatically remo
ved if the latest version didnIf your version's scalar had i
ts associated equate name cha
ged, it will get automatically
renamed if the latest version
didn't remove or rename it di
fferently.

If an equate is changed for a
scalar operand or sub-operand
differently in the latest andThe equate conflicts will need
to be resolved after all of t

he address based auto merges
omplete. After the Equates aut
0 merge completes, an auto m
ge will begin for User Defined
Properties.

User Defined Properties

A user defined property change

PR WL wr TE TUR Ul) | ORadded, removed or changed af
an address. An example proper
y is the Space property
created by the Format plugin.
A user defined property change
will get merged automatically
if the latest version didn't
change the same named prope
at the same address in the pr
odram If the named property vLhallgeud at all aUurcss iil your
version of the program and in
the latest version then a user
defined property conflict exi
EleH

The user defined property conf
licts will need to be resolved
after all of the address base

d auto merges complete. After
the User Defined Properties auha san
will begin for References.
References

References consist of memory
eferences, variable (stack and
register) references, and ext
ernal references. Changes to t
hese include adding reference:
, changing references, and rem
ovinghe latest version are compared
for each of the mnemonic and
operands at an address to dete
rmine whether a conflict exist
sor

the changes can be automatic:
ly merged.

The following types of changes
will get merged automaticallyyou added, changed, or remove
a reference for a mnemonic or
operand at an address and the
latest version didn't change

0 Arsion only have memory reterel
ces for the mnemonic or opera
d.

your reference is a stack vari
able reference and the latest
version has a stack reference
to the same stack frame offset
or no references.

your reference is a register v
ariable reference and the lateMAL A LR A LEA I
no references.

your reference is an external
reference and the latest versi
on has the same external refer
ence or no references.

If your checked out version an
d the latest version both have
changes to the references forver your version and the lates
Id

version have references that a
re different types (for exampl
e, one has memory references.
nd the other has an external r
eference).

The reference conflicts will n
eed to be resolved after all oes auto merge completes, an a
to merge will begin for Bookmz
{EH

Bookmarks

Bookmarks allow you to associ
te a description with an addre

ss in the program. The bookma
k has a type and category asso
ciated with it. Bookmarks thatare Note type bookmarks. Ghid
a plugins can also add bookma
ks of various other types. For
example Auto Analysis adds Al
alysis type bookmarks. Only on
e bookmark of a particular
type and category can exist at
an address. However, only one
Note type of bookmark can exi

SI AL | LE SEL | nny |Changes to bookmarks Include
dding a new bookmark, removi
a bookmark, changing the des
ription for a bookmark, and ch

anging the category for a note
bookmark.

Any changes to the bookmarks
ill get automatically merged a

s long as your changes and the
latest versions chanaes do nony CONTNLL situations.

your version and the latest ve
rsion added or changed a Note
bookmark resulting in a differ
ent category or description fo

r the two versions.

your version and the latest ve
rsion added or changed the sat
e bookmark type and category
esulting in a different descriClee CREEL RE Sg] [el

the address based auto merge
complete. After the Bookmark
auto merge completes, an aut
merge will begin for Comment

 

Comments
If you make a change to a com
ent (Plate, Pre, End-of-line,changes to that type of comm
nt at the same address, the ch
ange

is automatically accepted. Corn
ment changes include adding,
emoving, or updating the comr
nt. If the latest version has

a change to the same commen
hen the conflict will need toThe comment conflicts will nee
d to be resolved after all of

the address based auto merge:
complete. After the Comments
uto merge completes, the conf
ict merge will begin for addre
ss

based listing elements (the eq
uates, user defined properties

IT AN L set 1) 1 LEses with a conflict.

After all address based confli
cts are resolved, the auto mer
ge process continues with the
next program element, Externe
Program Names.

External Program Names
Each external reference has an
associated external proaram nELLE EA LA A
al program. Changing an exter
al program name is marked as
change and may be

merged. Changes include addi
or removing an external progr
am name, and changing the GI
ra program associated with an
external program name. If the
change doesn't conflict with ajusti ital alain laht aie
automatically.

A conflict occurs whenever you
r version removes an external
program name and the latest v
rsion changes the associated G
hidra program or vice versa. A
conflict can also occur if th

e latest version and your
version both change the Ghidr:You must resolve all external
program name conflicts before
the merge process can continu
with the next program elemen
, Property Lists.

Property Lists

Property lists are lists of op
tions that are saved as part o

f the program. You can view aA property will be merged autc
matically if it is a new
property or it was not changed
in the latest version. A conf
lict results when you change a
property that was either remo
ved or changed in the latest v
ersion.

Reacmhiimm (mmf meResolving Conflicts

Merge Program Files 5/30

For each program element, the
Conflict Resolution Merge is t
he second of the two merges w
ich is performed. The first ti
me a conflict is encountered,
the merae process displavs a V=SUIvVe cath

conflict one at a time. To res
olve any conflict, you must ch
oose a radio button or check b
ox depending on the type of co
nflict. Most conflicts require
you to select from the follow
ing:

Latest version (changes from t
he Latest version that is checBabbitt ted Sd
ges)

Original version (values from
the file when you originally ¢
hecked it out)

However, there may be other ci
nflict options that let you ch
oose to add or rename the type
of item that is in conflict i

n addition to keeping the oneme conflicts,

such as comment conflicts, all
ow you to check one or both ch
eck boxes for the comment cor
lict. This allows you to keep
the Latest comment, your com
nt, or a combined copy of both
the Latest and your (Checked
Out)All memory conflicts that rema
in after the auto merge must b
e resolved.

The only conflicts on a memory
block will be changes to the
name, permissions, or commer
. A conflict occurs when you c
hange the name of a memory |

ck and another user has chang
rl TT TT ry dT ayIT you changed the permissions
or comments on a memory blc
, and another user has change
the permissions or comments
n the same memory block you
Il have to select

which changes to keep.

The image below is the panel t
hat is shown when there isa c
onflict on the block name |nai LA A AL A EL LL
ad changed the block name to
LatestText" (radio button for
Latest). You changed the block
name to "MY_Text" (radio butt
on for Checked Out). The block
name in the original program
(the version that you had orig
inally checked out) is shown a
s "text" (radio buttonTo resolve the conflict, you m
ust select a radio button. Aft
er you select a radio button,
the Apply button becomes ena
ed. Click on the Apply button
to continue the merge process.
In this example, there was
only one conflict in the Memor
y merge, as indicated by the Cower right corner of the Merge
Tool indicates progress only
for the Memory Block merge,
not the entire merge process.
The merge process continues v
th Program Trees.

el TET NEE

All program tree conflicts tha

t remain after the auto mergeogram tree, it is marked as ch
anged and may be merged. Th
is no finer granularity than
detecting that the tree change
d, so the merge is going to do
“all or nothing" on the

[Sl ICTR CR ATES Ela IEA
you change the tree (add a fol
der, rename a fragment, etc.)

JOELL ra LTe to keep your changes, keep t
he changes from the latest,
keep the tree from the origina
| program that you checked ou
, Or rename your tree to a new
name. The last option to rena
me your tree allows you to cre
ate your tree in the program t
hat results in the latest
version and not lose anvone eSHOWS LHIS SLEnalio.

Merge Program Files 6/30

The conflict resolution panel
shows what kind of change it i
s, name change versus a struct
ure change; the checkbox indi
ates the changeand Current Checked Out Versi
n. In this example,

another user changed the nam
of a program tree to "Tree3_XX
X" (Latest). You changed the n
ame of the same program tree
0 "MY TREE 3" (Checked Out).
he original name of the tree w
as "Tree Three"shows radio buttons for each
option:

Use name 'Tree3_XXX' (Latest)
- select this option to lose y
our changes and keep what is i
n the latest version

Use name 'MY TREE 3 (Checket
ut) - select this option to re
name the tree in the program tMY TREE 3'

Add new tree named ‘MY TREE
- select this option to creat

e a new tree named 'MY TREE :
in the program that will beco
me the latest version; changes
by other users are retained
Use name ‘Tree Three' (Origins
1) - select this option to los

J A © Ur RVI V TEwhich Is the name from the prc
gram that you had originally c¢
LEE CERT

Select an option to resolve th
e conflict, then click on Appl

y. In this example, the next c
onflict will be displayed that
must be resolved. The progres
s bar on the lower right corne
r of the Merae Tool indicatesrec merge, not ine critre met
ge process.
After all program tree conflic
ts are resolved, the merge pro
cess continues with data types
and categories.
Data Types and Categories
All data type or category conf
licts that remain after the au
to merge must be resolved.atsialafiatiaseissutiaeniagel Shaasadataacad © ool ad
ta type, and the same type of
change was made in the latest
version, then a conflict arise

s that you must resolve. The m
erge process for data types an
[¢]

categories handles these confl
icts one at a time. The Curren
t Conflict area of the panel swhere x is the current conflic

t number, and n is the total n
umber of data type and catego
y conflicts that must be resol
ved. Data type conflicts are r
esolved first.

The image below shows the sc
ario where you:

renamed Foo[Categoryl

changed undefined

char

In the latest version:

moved /MISC
/Categoryl/Category2/Categon
changed undefined

byte

The conflict arises because in

Preble Truce iro Hives $11 shes Fived component was changed to ¢
ifferent data type. The rename
of Foo to My_Foo doesn't caus
e a conflict. If you had

only renamed the data type (w
thout moving it or changing th
e undefined), there would not

have been a conflict.These are the options to resol
VERUEE ile

Latest - select this option to
keep what is in the latest ve
rsion (lose your changes)
Checked Out - select this opti
on to apply your changes; (cha
nges in the latest version are
lost)baie alan (Li hibit Lala ol
am that you had originally che
cked out (your changes and the
se in the latest version are |
ost)

Select a radio button to resol
ve the conflict.

In the Merge Tool window abov
, the title indicates the proj
ect, program and new version Iogram" in the "SampleProject”
will be created by

the merge. The source archive
is indicated for each data tpe
in the conflict window. The "
Foo" data type was added to "
elloProgram" from the "MyTest
rchive" data type archive and
is still associated with it inCategory conflicts are resolve
d after data type conflicts. |

f you make a category change
rename, move, delete, restruct
ure) in your version of the fi

le, and the same type of chang
e was made in the latest versi
on

of the file, then a conflict a

JL YVIATY NEO AE 1) IT NEario where you:
moved /MISC

/Categoryl/MISC

In the latest version:
moved /MISC

/Categoryl/Cateogry2/Categon
IMISCne OpLoris LO TesVIve Lhe Lon
flict are:

Latest - select this option to
keep what is in the latest ve
rsion (lose your changes)
Checked Out - select this opti
on to apply your changes
Original - select this option

to apply what was in the progr
am that you had originally cheost)

Select a radio button to resol
ve the conflict.

After all data type and catego
ry conflicts are resolved, the
merge process continues with
Program Context Registers.
For data types a source archiv
e conflict can occur if the name in each of the two program
being merged. In the followin
g, the "helloProgram" in the
SampleProject” (as indicated
by the Merge Tool title) has a
data type that originated fro
m "MyTestArchive". Before you
checked in your last changes t
o the program, the source datameone checked in the Latest cl
anges the source archive had k
een renamed "TestArchiveOne

to "TestArchiveTwo". Before s

omeone checked in the Latest
hanges the source archive had
been renamed "TestArchiveOn:Name: This is the name of the
source archive in that version
of the program.

Last Sync Time: This is when t
he program was last synchroni:
ed with the source archive.
Changed Since Last Sync? yes,
means that one of the program
s data tvpes associated with tRL A ELL A A CEU LL A LL
ERT [FLT R

To resolve the conflict, selec

t the radio button associated
with the current name of the a
(HIER

Program Context Registers

All register value conflicts t
hat remain after the auto merg
e must be resolved.ge of addresses. When a regist
er's value at an address or ad
dress range is changed in both
the latest version and your c¢
hecked out version and the twc
values are different, this res
ults in a conflict. For each c
onflict, the merge tool will d
isplay the address or addressThe conflict window will prese
nt you with each register that
has value conflicts. For each
of these registers you will h
ave to resolve each of the add
ress ranges that has a conflic
t. The conflict information ar
CEE
the top of the window indicateou are resolving of all the ra
nges in conflict for this regi
ster.

The following image illustrate
s a conflict due to the DIRECT
ION register's value being cha
nged in the latest version and
cleared in your checked out v
ersion of the program. The add

J, Aerdress 01002329 to 0100253b.
is is indicated in the conflic

t resolution area below the pr
ogram listings. The affected a
ddresses are also indicated by
the gray background in the
program listings.

The scrolled listings allow yo
u to see the code units in theALLARD ARR ES AA RE LRA RL
rrect register value to choose

. The layout of the Merge Prog
ram Context window is

very similar to the Merge List
IMRVILIR

The scrolled listings allow y
ou to see the code units in thorrect register value to choos
e. The layout of the Merge Pro
gram Context window is

very similar to the Merge List
ing window.

 

his aia ant Lilacs

Merge Program Files 9/30

The options to resolve the conkeep what is in the latest ve
rsion (lose your changes)
Checked Out - select this opti
on to apply your changes (over
writes change in the latest ve
rsion)

Original - select this option

to restore the original regist
Eg r values [$113 changes LLC] I}Select a radio button to resol
ve the conflict and then press
the Apply button to continue
merging.

After all register conflicts a

re resolved, the merge process
continues with the Listing.
Listing

Ame rire tice nm ttes ref Thom rrr rm inphase. These include the byte
s and code units, functions, s
ymbols, equates, user defined
properties, references, bookma
rks, and comments. Listing
conflicts must be resolved in
the order they are presented b
efore moving to the next confl
ict and eventually completing
ATE eee reeLISLINyY CONTHLLS alc presceliice

d in a Merge Listing Window. T
he Merge Listing Window displ
ys four program listings:
Result

The new program version that
ill result from this merge.

Latestof the program.
Checked Out

Your checked out version of th
e program to be merged.

OriginalThe following shows the Merge
Listing Window and describes |
in red text) some of the featu
res of the conflict window.

The Merge Listing on the top |
eft side of the window indicat
es that you are in the Listing
phase of the merge LL Resolthe Code Unit phase of
Listing Merge. This area provi
des the following information:
the addresses for the conflict
currently being resolved
number of conflicts at the ind
icated address(es)

current conflict

how many sets of conflicts the

ER LE AWE TN.Each of the listings in the ab
ove image displays the associa
ted program (Result, Latest, e
tc). This allows you to look a

t each of the programs involve
d in the merge whenever you a
e trying to resolve a Listing
conflict. You can use the
expand icon in the Result listClils thal afc Ulsplaycu iit all
of the listings like in the C
ode Browser. The GoTo is also
available for navigating withi
n the

listings.

Scroll Locks for the Listings
Initially, the four programs s

croll together. Each listing h

as a lock iconock icon

will also cause all other lock
ed listings to scroll to the s
ame address. When a listing is
displaying the unlocked icon
cause any of the other listing
s to scroll.ting within that listing

, it will not scroll when the
other listings scroll. Likewis
CERT IT [RIA Te]

Code Units

The first type of Listing conf
lict you may encounter is a by
te or SCE [LIS conflict alle must be resolved.

The following types of changes
will result in code unit conf
licts that need resolving.

The following types of change
ERIC STN ERI Tele)
flicts that need resolving.The same bytes had their value
s changed to different values
in the latest version and your
checked out version.

A byte was changed in one ver
ion where a code unit was char
ged in the other version.

The code units were changed i
vour version and the latest vdn AL LLC

For example, latest created an
instruction and your version
created data at an address. An
other example would be that a
different structure was applie
d in your version and the late
st version at

the same address.

An instruction was cleared inAn instruction had a flow over
ride applied in one version an
d a reference was added in the
other version.

If an instruction change confl
icts with a reference change,
the references can be viewed &
y right clicking on an instruct, Original) and

choosing the View Instruction
Details... action. This will p

op up a dialog indicating any
fallthrough override or flow o
verride and the references for
that instruction.

Example : The following image
shows a code unit conflict thaampleStructure from a word to
an array of two characters and
the word

was changed in the latest vers
ion to two separate characters

Notice that the listings allow
you to open and close the str

TEI. 7 J

 

llIcKing on the + In the listing

. The addresses with the gray
background in the

listing indicate the code unit
(s) that you are currently try
ing to resolve.

Note that you will have alread
y resolved all data type confl
icts by this time; this confli
ctis due to different data tvaUurcss. TOU afc TES0IVITYG Witt
ch data type to apply at

the address.

In this case the options to re
solve the conflict are:

‘Latest’ version - select this
option to keep the structure
containing two separate charac
ters as in the latest version
(lose your changes)hailiaed » delatblbocdib Lif ud EF ait iad al
ucture containing the 2 charac
ter array (overwrites change i

n the latest version)

‘Original’ version - select th

is option to restore the origi
nal structure containing the w
ord (your changes and those in
the latest version are lost)
Depending on which option youthe data type name.

Select a radio button to resol
ve the conflict and press the
Apply button to continue with
the merge process.

After all byte and code unit c
onflicts are resolved, the mer
ge process continues with any
Function conflicts in the ListAll external location conflict

s that remain after the auto m
erge must be resolved.

The following types of changes
to external locations will re
sult in conflicts that need re
solving between your checked
ut version and the latest vers
ion in the repository.

YE rots seri sven anvrdzs roe ms | 25 f ropedizee the same external as one tha
t was added in the latest vers
ion. (i.e. It has the same nam
e or is referenced from the sa
me code.)

If an existing external functi
on or label is removed in your
version and changed in the la
test version in any way or vic
PRT ThLLL LR RE EL LA

d the latest sets the data typ

e on the external label or vic
AEN

If you change the number of pe
rameters, the parameter storac
e, or the parameter type (stac
k versus register) and the lat
est also changed parameters ir
any way, then you must selecthata’ Sobol edad ead bet
he latest version's parameters
. The same is true if the late

st version changed the number
or type of parameters and you
changed parameters in any wa
If you change a piece of an ex
ternal functions information a
nd the latest version changes
the same piece of function infe function's name and the othe
r changes the return type, the
n both changes occur without :
conflict. If both change the
name, this is a conflict.

If you change a piece of stack
information and the latest ve
rsion changes the same piece
f stack information to a differeturn address offset
parameter offset

ET GV RPA)

If you change a piece of param
eter information and the lates
t version changes the same pie
ce of parameter information to
a different value.

Parameter information include:Parameter information include
S:

name

data type

comment

offset

register

Merae Proaram Files 11/30ExalTipie Lb. THe TOHOWINY IiTat
e illustrates a possible Add c
onflict. In this case, an exte
rnal label was added to the La
test program and an external f
unction was added to the Chec
ed Out program.

Both external locations refer
to the same external memory &
dress and may be intended asIn this case you must select t
he radio button indicating whi
ch external(s) to keep:

Keep ‘Latest’ will keep the ex
ternal label.

Keep ‘Checked Out’ will keep t
he external function.

Keep Both will keep Both the e
xternal label and the externalfunction would get renamed w
h a new name containing a cor
[I=

DAEHN

Merge Together will merge the
external label and function to
gether. In this case, the resu

It would be an external functi
on, but after pressing the Appan additional name conflict th
at you would need to resolve.
Select a radio button and pres
s the Apply button to continue
UR SN T= (To oT (oTIEEN
Example 2 : The following ima
e illustrates a conflict due t

o an external label having its
data type set in the latest v

reir ry snslri les sri polos perez Si imeMerge Program Files 12/30

In this case you must select t
he radio button indicating whi
ch change to keep:

Keep ‘Latest’ will result in t

he external label with a Float
data tvpbe and the chanae to aAEE LIELREU UUL WIT Recep L
he external as a function and
the data type change will be d
iscarded.

Select a radio button and pres
s the Apply button to continue
LUG RO SN T= (To oT (oTIEEN
Example 3 : The following ima
e illustrates a conflict becau

se you created the same exterr[ilatsinbaalnade °F
arameter storage has been def
ned differently in

each version. You must choose
which parameter signature anc
its associated storage should
be kept.

Merge Program Files 13/30solve the conflict are:

Use Latest version. will use t
he function parameter storage
as itis in the Latest version

Use Checked Out version will u
se the function parameter stor
age as it is in your Checked O

ut versionLUG RO SN T= (TN oT (oTIEEN

After all external label and e
xternal function conflicts are
resolved, the merge process c
ontinues with any regular Func
tion conflicts in the Listing.
[LleI-I

All function conflicts that re
main after the auto merge mu

LTto functions will resultin c
onflicts that need resolving b
etween your checked out versi
n and the latest version in th

e repository.

If you create or change a func
tion causing its body to overl
ap one or more functions that
are defined in the latest vers
ionCE alurcsses IT Lommon arc sal
to overlap if their entry poi

nts and bodies are not exactly
the same.

In this case you must choose w
hich version's function(s) to
[CIN

If an existing function is rem
oved in your version and chang
ed in the latest version in ann with the same entry point, b
ut all parts of the function a

re not the same.

If you change the number of pe
rameters or the parameter type
(stack versus register) and t
he latest also changed parame
ers in any way, then you must
select to keep all of your parrameters. The same is true if
the latest version changed the
number or type of parameters
and you changed parameters ii
any way.

If you change a piece of funct
ion information and the latest
version changes the same piec
e of function information to aname
body

return data type

For example, if one changes th
e function's name and the othe
r changes the return type, the
n both changes occur without :
conflict. If both change the
name, this is a conflict.

VE writ eben mt rors mn whim rems sof wim mlrsion changes the same piece «
f stack information to a diffe
rent value.

Stack information includes:
return address offset
parameter offset

[ETP

ET GV ERA)

If you change a piece of param
eter information and the latesAd EL AA BL ERR AR
a different value.
Parameter information include:

name
data type
comment
offset
registerregister

If you change a piece of local
variable information and the
latest version changes the sam
e piece of local variable info
rmation to a different value.
Local variable information inc
[TCHname
data type
comment
offset
register

Example 1 : The following ima
e illustrates a function param
eter with multiple conflicts.is different than many of the
other listing conflict
resolution areas. Each row of
the table provides you with a
separate conflict and a choice
that must be made.

Notice in the image that the p
arameter name and the param
r type are each in conflict. Y

JL LTR CALERA LR arrou want to keep In the version
that will get
checked in.

The function FUN_01002b44 h
two conflicts for its second p
arameter.

In this case the options to re
solve the conflict are:

Conflict column - indicates whALR RLU LL LAS

Latest column - select the ite
m from this column to keep th
latest version's change (lose
your changes).

Checked Out column - select tt
e item from this column to kee
p your change (overwrites chat
ge in the latest version).
Select a radio button on eachhintaan Maldid of iid Mui ah ae

ontinue with the merge proces

Example 2 : The following ima
e illustrates a conflict due t

o overlapping function bodies.
In this case you created a fu
nction at address 01001984 ar
the latest version created a
function at addressbut their bodies overlap. Sin
ce function bodies can't overl
ap, you must choose which ver
ion's functions should be kept
. The Resolve

Function Overlap Conflict area
indicates the address range(s
) that are in conflict. This i
s also indicated by the gray bMerge Program Files 15/30

In this case you must select t
he radio button indicating whi
ch version's functions to keep

Latest - select the radio butt
on in front of Latest to keep

NE RL LUE RT Le,ges (lose your functions).
Checked Out - select the radio
button in front of Checked Ou
t to keep the your functions f
or the indicated address range
s (overwrites change in the la
LES AVI IN

Select a radio button and pres
s the Apply button to continue
aaa aa lle I= el ge lo HEe ALL SA
se you changed the return type
and the function was deleted
in the latest version. You mus
t choose whether to keep the f
unction or remove

14

Merge Program Files 16/30solve the conflict are:

Delete function as in ‘Latest’
version. - select this option

to remove the function as in
the latest version (lose your
changes)

Keep function 'FUN_010031ee'
s in ‘Checked Out' version - s
elect this option to keep the

 

Saldana dani eedtest version)

Select a radio button and pres
s the Apply button to continue
with the merge process.

After all function conflicts a

re resolved, the merge process
continues with any Symbol col
HIG ALRS EERE ICN

Symbolse resolved.

The symbol phase of the Listin

g merge will merge labels, nan

espace symbols, class symbols,
and external symbols.

The following are the types of
symbol conflicts that require
manual resolution:

Removed symbol in one versior

RT AT TYIn each version.

Same named symbol at the sar
address in each version, but i

n different namespaces (symb«
s with different scope).

Each version set a different s
ymbol to primary at an address

Example 1 : The following ima
e shows a symbol conflict thatILA A aL LAL IR ° LA
ope to function scope (in the
FUN_01004444 function's nam
ace) and

the latest version removed the
symbol.

Merge Program Files 17/30hat a alain dual Lie
n to resolve the conflict. Eac

h row shows the information fo
r a different version of the p
rogram. The Option column all
ws you to

choose a version change or sim
ply indicates which version's
information follows it in the
row. The Symbol column givessymbol.
The address indicates the addr
ess where the symbol is locate
d. The Type indicates whether
the symbol is a label, namespa
ce, class, etc. Primary indica
tes whether the symbol is the
primary symbol at

the address in that versionRemove as in ‘Latest’ version

- select this option to leave

the label DDD removed (lose yc
ur changes)

Change as in ‘Checked Out’ vel
HIT CET 0 [ER Told ol Re Xo}
hange the label DDD to be in t
he function's scope (overwrite
s change in the latest version

\ot selectable, but shows the s
ymbol in the original version
you checked out.

Select a radio button to resol
ve the conflict and press the
Apply button to continue with
the merge process.

Example 2 : The following ima
e shows a symbol conflict thatLE LAS
anged it to global scope, but
the latest version only rename
d the symbol.

Merge Program Files 18/30

In this case the options to re
solve the conflict are:hatha Lia liat Lien ai SL
uld be in the function's scope
(lose your changes)

Rename as in ‘Checked Out’ ve
sion - select this option if M

E should have global scope (ov
erwrites change in the latest
version)

‘Original’ version - this is n

ot selectable, but shows the sSelect a radio button to resol
ve the conflict and press the
Apply button to continue with
the merge process.

Example 3 : The following ima
e shows a symbol conflict that
occurred because you added t
e e label TEN to the JUUCEL]est version

added the same named symbo
the same address, but gave it
global scope.

Merge Program Files 19/30

In the Resolve Symbol Conflict

rrr A ATh of the Tirst two rows shows

the information for a differen
t version of the program. Belo
NAGE GEES)

two radio buttons that let you
choose to either discard your
symbol or rename it so that i
ts name will not conflict with
the one from the latest versi
on.=SUIvVe Lhe Conflict are.

‘Latest’ version - this is not
selectable, but shows the sym
bol in the latest version.
‘Checked Out’ version - this i

s not selectable, but shows yo
[FTE 1IN

Discard ‘Checked Out' symbol -
select this option to not inc
lude your symbol (lose your chnani that aati 1 aa
'‘Bud_conflictl’ - select this
option to rename your symbol
to avoid the conflict.

Select a radio button to resol
ve the conflict and press the
Apply button to continue with
the merge process.

Example 4 : The next image shsymbol at an address. In the f
ollowing scenario, you added t
he label "Bar" and the latest
EIS LE [ EL]

the label "Foo" at the same ad
dress. Both labels can exist a

t the same address since they
have different names, but they
cannot both be the primary syprimary one.

Merge Program Files 20/30

In this case the options to re
solve the conflict are:

Set ‘Latest’ to primary - sele
ct this option if Foo should b

LE RE IRI rar, WEselect this option If Bar sho
uld be the primary symbol.
‘Original’ version - this is n

ot selectable, but shows the s
ymbol in the original version
you checked out. In this case
there was no label originally.
Notice that both symbol are ke
pt as shown in the Result prog
IT chaiseve the Loft anu press Lice
Apply button to continue with
the merge process.

Symbol Merge Information Dial

g

At the end of the Symbol merg
phase, a Symbol Merge Inform
tion dialog will appear if any
namespaces could not be rem
ed as expected. You might indihalter: ia aiadialil usta us li ih
ct with another symbol or it m
ay have been removed by auto
erge. However, if another symk
ol gets placed into that names
pace as a result of

resolving a conflict, the name
space must be retained. The di
alog is simply to inform you t
hat this has occurred. The folSecondNamespace was not rer
d since it contained at least
one other symbol.

Press the OK button on this di
alog to continue with the merg
CY J{ICEES

The Symbol Merge Information
[LLC can also have symbol She merge process, you are notif
ied of the new symbol names a
the end of

the Symbol merge phase.
Conflicting symbols are rename
d by adding a suffix of "_conf
lict" and an incremented numt
r to make the name unique. Th
following image shows two rer

armed cvrale The firek ie Fhesymbol ME which was renamec
ME_conflictl. The second is t
he symbol YOU in the FUN_01C
ae3 namespace which was ren,
d YOU_conflictl.

Press the OK button to continu
e with the merge process.
After all symbol conflicts are
resolved the merae process cListing merde CLONTHeLS.

PNET To Re Tl [To Tg

e resolved, the merge process
continues with any Address Ba:
ed Listing Merge conflicts.

Merge Program Files 21/30
Address Based Listing Mergebin ais.
ined properties, references, b
ookmarks, and comments) has
ready been auto merged befor:
any of their conflicts are pre
sented for conflict

resolution. Conflict resolutio

n will proceed in address orde
r for each address that has a
conflict for any of the addres

hah bai Laban aes’ Shc dacau will have to resolve

all of the conflicts (equates,
user defined properties, refe
rences, bookmarks, and comm:
s) before proceeding to the ne
xt address with conflicts. The
following sub-sections descri
be conflict merging

for each Lu Ri address basedAll equate conflicts that rema
in after the auto merge must b
e resolved.

Equates associate a name with
a scalar. If your version and
the latest version change the
equate for a scalar and they a
re different as a result of th

e change, then the equates are

FleChanges include adding an eq
ate to a scalar, removing an e
quate for a scalar, changing t
he equate name for a scalar.

If an equate is changed differ
ently in the latest and your v
ersions, then you must resolve
the conflict.

Example : The following illust
rates an eauate conflict on thAVUVLUUVD. THE SsCalal Originally
had an equate of 01. Each ver
sion changed the equate on Ox
jek]

new name.

The image below shows the sc
ario where you:

changed 01

14:8changed 01

 

ORANGE

The options to resolve the con
flict are:

Keep ‘Latest’ version - select
this option to keep the equat
e for the latest version (loseelect this option to keep your
equate

‘Original’ version - this row
simply indicates the original
value at the time you checked
out the program

Select the radio button for ei
ther the latest or checked out
version and press the Apply bAfter all equate conflicts are
resolved, the merge process c
ontinues with the User Defined
Properties.

User Defined Properties

All user defined property conf
licts that remain after the au
to merge must be resolved.

User defined properties are in
yy

 

TIL ra Irogram. Individual plugins can
create one or more property.
All of the conflicts for a nam

Cl

property are presented to you
and must be resolved before tt
e next named property with co
flicts is presented.

If the named property was chal
aed at an address in vour versdifferently ih the latest ver
sion then a user defined prope
rty conflict exists.

Example : The image below sh
s the scenario where you:
Added a Space property with a
value of 4.

Added a Space property with aMerge Program Files 22/30

Added a Space property with a
value of 3.

The options to resolve the con
flict are:
Keep ‘Latest’ version - selectr changes)

Keep ‘Checked Out’ version - s
elect this option to apply you

r changes (overwrites change i
n the latest version)

Keep ‘Original’ version - sele
ct this option to restore the
original value of the property
El changes and those in the value of the Space property
you want to have in the checke
din version.

You can resolve the remaining
conflicts for the same named p
roperty by selecting the check
box, Use the selected option f
or resolving all remaining 'Sp
ace' property conflicts. The sed will be applied to the rema
ining conflicts for the same n
amed property. In the example
above, the ‘Check Out’ version
option would be used for the
remaining

conflicts for the Space proper
I
When you Apply after selecting
the radio button and checkboxabuVveE, your Lhallyges (LHe LITE
ked Out version) would be cho
en for the Space property att
ERLE] Ee]

address and for all remaining
addresses that have the Space
property in conflict. Because
you selected the checkbox, you
will no longer be prompted to
resolve conflicts for that prhha atiatbabiil Ss haiti alata al
option for resolving all ...
checkbox for the Space proper
y would not affect the resolvi
ng of conflicts for any other
named property. However, the
ser can select

the checkbox for each differen
t named property with conflict
EXmerge process continues with
LERCIEIELTEER

References

All reference conflicts that r
emain after the auto merge mt
t be resolved.

References consist of memory |
eferences, stack references, r
els [CE EE] and Rl]the latest version are compar
ed for

each mnemonic and operand a
n address to determine if a co
nflict exists.

References conflict if the two
versions of the program (your
version and the latest versio
n) have a reference at the sam

2 srdrd raves isd rrasiis med || Pos iE bomElly)

(memory, stack, register, exte
rnal). References can also con
flict when they are the same t
ype if both versions changed t
he reference and one or more |
arts are now different. The
following indicates the parts
of a reference that can confli
ct with another reference of tMECC BL US RE EUR AS AS A
that may conflict:

external program name
referenced label

referenced address

whether or not it is user defi
LEG]

Parts of a stack reference tha
t may conflict:

stack offsetParts of a register reference
that may conflict:

the register

referenced variable name
first-use address

Parts of a memory reference th
at may conflict:

offsetlabel

reference type (computed call,
computed jump, data, read, w
ite, flow, etc.)

whether or not it is a user re
ference

Merge Program Files 23/30licts:

Your version and the latest ve
rsion each added a different r
eference type (memory, stack,
or external).

If your checked out version an
d the latest version both have
changes to the references for
a mnemonic or operand, the re

Je meray Te CNlatest version have references
that are different types (for
example, one has memory ref
ences and the other has an ext
ernal reference.)

You removed a reference and t
e latest version changed the s
ame reference or vice versa.
Your version and the latest ve
rsion both chanaed a referenceALCL ES EL
indicated above.

Your version and the latest ve
rsion both added the same typ
of reference with the same fr
om and to addresses, but diffe
red such that they conflict.
Your version and the latest ve
rsion both set the primary ref
erence, but not to the same reThe first operand of an instru
ction is numbered as operand (

Example 1 : The following ima
e illustrates an external refe
rence conflict. Your version a
nd the latest version both cha
nged the external reference at
address 01001000 operand 0.come user defined and you che
ged it to refer to the symbol
bud" instead of "IsTextUnicod
e".

The options to resolve the con
flict are:

Change as in ‘Latest’ version
- select this option to keep wse, keep the reference to "IsT
DSLR

Change as in ‘Checked Out’ vel
sion - select this option to a
pply your changes (overwrites
change in the latest version).
In this case keep the referen
ce to "bud."

‘Original’ version - This fiel

EN I eS J TT STe Original version that you ch

ecked out.

Select the radio button for wh
ether to keep the reference to
0x10 or 0x14 and select the A
pply button to continue with t
ERR EITC

Example 2 : The following ima
e illustrates conflictina refeMA ELA Re A EU A EL
on. Possible reference types a
re memory, stack, register or
external.

In this case, you added a stac
k reference and the latest ver
sion has a register reference
added at address 010018cd op
and 0.Ea Aa

Once again, select the radio b

utton for which reference to k

eep and select the Apply butto
n to continue with the merge
[IEE

Example 3 : The next image ill

ustrates a memory reference c
nflict where you changed an eerence and the latest version
changed the memory reference
o a READ_WRITE reference.

Select the radio button for wh
ich reference to keep and sele
ct the Apply button to continu
e with the merge process.

Example ENT) following illuin your version and the latest
version. In this case you add
ed an external reference at ad
dress

01002510 operand 0 and the I;
est version added multiple mer
ory references.

Marne Drmmrar Filae E20‘I'he options to resolve the con
flict are:

Use all in ‘Latest’ version -
select this option to keep wha
tis in the latest version (lo

se your changes). This would k
eep all of the memory referenc
es and lose the external
reference.

Use 'Checked Out' version - seLhallyges |OVETWITILES Chiallye 11
the latest version). This wou
Id keep the external reference
and lose all of the memory
references.

‘Original’ version - This fiel

d is not selectable, but is pr
ovided to show the value in th
e Original version that you ch
ecked out. In this case thereich references to keep and pre

ss the Apply button to continu

e with the merge process.

After all reference conflicts

are resolved, the merge proces
s continues with the Bookmark

Bookmarks
All bookmark conflicts that reNote bookmarks are in conflict
when any of the following occ
Ig

your version and the latest ve
rsion both add a Note bookmar
and the category or descripti
on differ.

your version removes a bookm:
k and the latest version changyour version and the latest ve
rsion change the category and,
or description so that they no
longer match.

All other bookmarks are in con
flict when any of the followin

g occur:

your version and the latest ve
rsion both add a non-Note bool

marl with Fhe cara ~atamars bhyour version removes a non-No
e bookmark of a specific categ
ory and the latest version cha
nges the description for that
bookmark type and category ol
vice versa.

You cannot directly change the
description on a non-Note boo
kmark through regular bookm:
editina in Ghidra but a pluaLb

your version and the latest ve
rsion change the description f
or a bookmark of a particular
type and category so that they
no longer match.

Example 1: The next image ill
ustrates a conflict due to you

r version and the latest versi
on both adding different NoteMerge Program Files 26/30

When bookmarks are in conflic
BL IRChE

Keep ‘Latest’ version - select
this option to keep the bookm
ark change in the latest versi
on (lose your changes)r bookmark changes at the adc
ess (overwrites change in the
latest version)

‘Original’ version - This fiel

d is not selectable, but is pr
ovided to show the value in th
e Original version that you ch
ecked oute not in the same category. Th
is is because only one Note bo
okmark is allowed at an addres
s regardless of its category.
Select either the latest versi

on or your checked out version
and then select Apply to cont
inue with the merge.

Fuammla 3 - Tha mavk imaamea 1where another user changed tr
comment in the latest version
, but you removed the bookma

Merge Program Files 27/30

Select Keep ‘Latest’ version t
o keep the other user's chanaeReEUW JUL version ir you aor L
want the bookmark in the resu
ting program. Then select the
[YJ

button to continue merging.
Comments

All comment conflicts that rem
ain after the auto merge must
be resolved at each conflict a
LIENonflict with each other. The t
ypes of comments are Plate, Pr
e, End-of-Line, Repeatable, an
d Post.

If a comment is removed in one
version and changed in the ot
her version, you must choose w
hether to keep or remove it. T
his scenario is shown in the iMerge Program Files 28/30

If both versions added the sam
e type of comment at an addre
s and the two comments don't
atch, then you must decide to
keep the latest version's comm
ent, your comment, or bothment was changed in both ver:
ons and the two comments no
nger match then you must dec
e to keep the latest version's
comment, your comment, or
both comments. This scenario |
s shown in the image below.

If you choose to keep both com

MIN RR TLL RN URppended to the latest commen
with a new line separating the

[EEL ER RG)

comments is contained within

he other comment, then the lo!
ger comment is kept instead of
combining them with a new lil
e separator.

After all address based listin

a conflicts are resolved theAlciial Frodraltl Nalncs.

After all address based listi

ng conflicts are resolved, the
merge process continues with
External Program Names.

Merge Program Files 29/30
External Program Namesto merge must be resolved.
agelely) [fol qfeTelelT ol) 3

both versions add the same ext
ernal program name with diffe
ent paths

both versions changed the pat
for an existing name

one version removes the exterr
al program name and the otheExample 1 : The following ima
e shows a conflict when the la
test and your versions changed
the path for an external prog
ram name.

Select the version (Latest or
Checked Out) of Ghidra progra
path to associate with the exeed with the merge.

Example 2 : The image below «
ows a conflict due to an exter
nal program name being remo
in one version and changed in
the other.

In the above scenario, the ext
ernal program name "ADVAPI3

[Xe rrr (TT IT Apath indicating which Ghidra p
rogram is associated with the
external program

name, was modified in your ch
cked out version.

The options to resolve the con
flict are:

Remove as in ‘Latest’ version

- select this option to remove
the External Proaram Name deyour Changes)
Keep ‘Checked Out’ version - s
elect this option to apply you

r changes resulting in a new p
rogram path for ADVAPI32.DLL
overwrites change in the lates
t version)

‘Original’ version - This fiel

d is not selectable, but is pr
ovided to show the value in thSelect the radio button for th

e desired result and then sele
ct the Apply button to proceed
with the merge.

When you remove an external |
ogram name that is in conflict
, it will get added back later
as a result of choosing a ref
erence that refers to that extAll property list conflicts th

EI CI EIRIET CTR SET REET
must be resolved.

A property list conflict will
result when you change a prop
rty that was either deleted or
changed in the latest version

. The image below shows this s
cenario:Merge Program Files 30/30

Here, in the Analysis Disassem
bly Property Group, another us
er changed the Mark Bad Disas
embly property. You changed t
e same property. You have foll
owing choices:

Keep the other user's changes

7 a0 a | 0 Lee i i) and lose the change In lates
JACI]

Keep the values from the origi
nal version of the program (Or
iginal), lose your changes and
lose changes made in the late
st version. In this example, i

f you choose this option, the
property will

eRe CeEC PE LA AA LR
ck on the Apply button to go t
o the next property conflict.

In this example, there are thr
ee property list conflicts (no
ted in the Current

Conflict area of this window).
The progress bar on the lower
right corner of the Merge Too
| indicates progress only forhha anlabathinlisl anil sg otha
After you resolve all conflict

s, the check in process is com
plete. The Ghidra Server will
contain a new version of the p
rogram file.

Related Topics:

Shared Project Repository
Check in

Memory BlocksProgram Options
Property lists
Symbols
Property ViewerGHIDRA Training 7
TOP SECRET//CYBER//NOFORNGhidra Tool Administration
Ghidra Tool Administration 1/4

A Ghidra Tool is a collection
of buildina blocks called Plual LLL ISL A ACL a Loe LL
at cooperate with one another
to achieve certain functionali
ty. You can add tools to the T
ool Chest or

configure them to share data a
nd resources with other tools.
Ghidra provides a set of Plug
ins, but you may create your o
wn Plugins to add more functicDefault Tool

Ghidra provides a default tool
, the Code Browser that is in
your Tool Chest. It has all of
the Core plugins already load
ed. This tool may be re-import
ed into your tool chest at any
time. If the tools exist in y

our tool chest, then aYou will see the name in the t
ool tip, and in the Tools

Run menu.) Any tool that you c
reate and add to your Tool Che
st is always available to your
active

Project. However, you should s
ave the tool if you plan to us

e it for other Ghidra projectsTool Management

The following sections describ
e tool management:

Create Tool

Save Tool to Tool Chest
Export Tool

Import Tool into Tool Chest
Configure Tool

Run Tool

rary ive 23 rob Freres[PEI CR fell]

Create Tool

Create Tool creates an empty t
ool (no Plugins). What Plugins
you should add is dictated by
what you want the tool to do.
The following steps can help
you create a useful tool:

1 Define vour reauirements foERRATA LAU A BRL A EL
ing Plugins meet your requiren
ents. If the Plugins do not pr
ovide the functionality, you m
ay need to write your own Plug
in that does meet your require
ments.

3. Add these Plugins to an exi
sting tool or to a new tool.

To create a New Tool,EN

IS

From the Ghidra Project Windo
, select the Tools

Create Tool... option.

A new "empty" tool is displaye
d; the Configure dialog is dis
played.Save Tool to Tool Chest

When you save a tool to your T
ool Chest, you are saving the
tool's configuration such that
it is available to your activ

e project. (When you open any
project, icons for all tools f

rom your Tool Chest will appeaGhidra Project Window). An ic
on for a new tool shows up on
the Tool Chest panel of the Gh
idra Project Window.

To save a tool,
From the tool, select File

Save Toolname, or to change the icon,
1. From the tool, select File
Save Tool As...

2. Enter a new tool name (the
current tool name is shown in
the Tool Name field by default
).
3. Choose an icon from the lis
[LATTE el

Click on the file chooser buttLASALLE) EU

4. Click on the Save button; i

f this is a new tool that you

are adding to your tool chest,
the Tool Chest panel will sho
w the icon for the tool; icon
and name changes (tool tip) ar
d are reflected in the Tool
Chest panel as well.et dwt ollie dnd Fata heat a
XML file in order to share yo
ur tool with other users. You
may have configured your tool
for a particular area of resea
rch or practice; others who ar

e working on a similar

You can export your tool to amay have configured your tool
for a particular area of rese
arch or practice; others who a
re working on a similar
problem may find your tool use
L018

Ghidra Tool Administration 2/41. Select File

Export Tool; a file chooser is
displayed.

2. Select a folder and name fo
r the exported file.

3. Click on the Export button.
To export a tool from the icon

1. In the "Tool Chest", right

TR Tn a is ee2. Select the Export... option

The Status area on the Ghidra
Project Window indicates whet
er the export was successful.

If the tool contains Plugins t
hat are not part of Ghidra (i.
e., you wrote new Plugins), yo
u will have to distribute a ia15 TOF Lhe Fiugins aloiy with
the XML file. The recipient c
an

then just place the jar file i

n one of the locations where G
hidra will search for availabl

e Plugins.

Import Tool

Import Tool to Tool Chesthil A eit cellar dag addi adit

hidra. The imported tool will
appear in your Tool Chest with
the other tools. If the name

of the imported tool already e
Xists, a one-up number is
assigned to the newly importec
tool to make the name unique
BERIT ola dE RT

1. From the Ghidra Project Winor ".obj" extension.
3. Click on the Import button.

Import Tool to Tool Chest...

If the import was successful,
an icon for the tool is added
to the Tool Chest panel. Any e
I] CCLLE] the ‘importa are reIf the tool that you are impor
ting contains Plugins that are
not part of Ghidra, you must
have the jar file containing t
he class files for the Plugins

. Place the jar file in one of
the locations where Ghidra wi
1}

search for available Plugins a
mw reset et 72 ied pramLe

The default tool for the Code
Browser is part of the Ghidra
installation, and can be added
to your Tool Chest at any tim
e. So if you delete the defaul

t tool from your Tool Chest, y
ou can always recover them by
using the Import Default Tools
to Tool Chest optionERAS LL LAL IAS) Al A RL
dow, select Tools

Import Default...

2. A dialog is displayed that
allows you to selectively impo
rt default tools. Select the t
ools you want to import and th
en select OK.

3. The default tools are addedhahaha db Mbit] Thatch Jd ad
n a one-up number is assigned
to them to make the names un
ue, e.g., CodeBrowser_1.

Run Tool

To launch a tool from the Tool
Chest,

Click on the icon for that too

lin the Tool Chest panel on t, select Tools

Run Tool

<tool name>

To launch a tool with a specif

ic Program,

Drag a Program file from the d
ata tree in the Ghidra Project

Window, and drop it onto a to
ol icon in RC CE [SLi SellIf you bring up more than one
instance of the same tool, the
window title shows a one-up n
umber appended to the tool na
e, e.g., CodeBrowser(2).
Rename Tool

To rename a tool from the Tool

[ol 1554
|» SP a HT aT TTY rapeIn the Ghiara Project Window

and select Rename from the pc
[TX CITT

Enter the new tool name in the
dialog that appears and press

the <OK> button.

Set Tool AssociationsARAL SLA A LL AA
that Ghidra uses to open that
file, the associated tool. As

an example, programs in Ghid

a are, by default, associated

with the Code Browser tool. Th
e

associated tool is the tool th
at will be chosen by Ghidra to
open any file that is double-hit catia tbh lc athe A tht ad Jf
at any time, drag a file in t
he Front End onto any tool in
lu)

Tool Chest in order to open th
e file in that tool.

Ghidra Tool Administration 3/4

To change the associated toolSet Tool Associations... menu.
This will open the Set Tool A
ssociations Dialog

This dialog shows a list of kn
own content types and the tool
that is currently used to ope
ll h that [37°13 LL double- SCLCed-out, that means the associa
ted
tool is not in your tool chest

To change a tool association,
select the desired Content Typ
ein the list and then click t
he Edit button. This button wi
Il trigger the Pick Tool dialo‘I'his dialog shows a list of al

| tools that can open the give
n content type. If you choose
a tool from the list that is n

ot in your tool chest, then th
at tool will be added for you
when you close the

dialogs.

The Restore Default button all
ows vou to restore the tool aslh
Ghidra uses tool names to stor
e tool associations. This can
lead to odd behavior if you re
name a custom tool to be the r
ame of a default tool. If your
tools exhibit odd behavior, s
uch as being unable to open

a file that is considered to b

e a default type, then you canSo Co Tm mE mE EEE mag
EIN

Close Tool

To close a tool (not the Ghidr
a Project Window),

1. Select the File

Close Tool option, OR

2. Right mouse click on the ic
on for the running tool and ch
oose the Close option.If you made changes to the Pro
gram and not saved them befo
you closed the tool, then a d
ialog is displayed to ask whet
her you want to save your char
ges.

Choose the Save button to save
hat Program.ve the changes.

Choose the Cancel button if yo
u do not want to close the too
I.

This dialog is displayed when
the last tool is closed that h

as this Program opened. So if
you have two tools running wit

[RL TLE Sn A LL RoLLE-e
be displayed until you close t
he second tool.

You cannot close a tool while
a background process is runni
ng, e.g., Disassembly or Clear
. You must first stop the oper
ation then close the toolbod bl ll El ELLE LL Le Li

Tool Configuration Changes
Changes to tools are automatic
ally saved by default. If you
open multiple instances of the
same tool and make changes
that tool, then Ghidra cannot
automatically save the tool f
IRR R GINg the changes.

You may configure Ghidra to n
t automatically save the tool
via the Front End options (Edi
t->Options->Tool->Automatic:
VEEVCRELIEN

 

Rat hah

 

Delete Tool
To delete a tool from your Too, Select the Tools

Delete Tool

<tool name> OR,

Right mouse click on the icon

in the Tool Chest and select t

he Delete... option.

A dialog to confirm your delet
e request is displayed; choose
the Delete button to remove tt tools back into your Tool Ch
est by selecting the Import De
fault Tools to Tool Chestoptio
n. However, deleting your own
custom tool from your

Tool Chest is a permanent opel
ation.

Tool Status Components

Lee frm) Pesce gu colimtor ret Sram Fork0 show progress for a running
task, e.g., disassembly. On th
e right side of the lower port
ion of the tool, a "write" ico

n indicates that the

program is being modified. The
progress bar shows the progre
ss of the running task. The sp
inning globe indicates that so
methina is happenina in the toA LA

currently running task. You ca
n still interact with the prog
ram while the task is running.

There may be times when a ta:
s "modal" such that no user
interaction with the program i
s allowed until either the tas
k completes or you cancel it.running and to allow you to ca
ncel it. Depending on the task
, the dialog may or may not sh
ow a progress bar.

Related Topics:

Configure Tool

Ghidra Project Window
Configure Ghidra Project WindConfigure Tool
Configure Tool 1/3

The Configure Tool dialog allo
ws you to add/remove plugin p
Bg CERT [LCIEEE] CELEselect File

Configure....This dialog is al

so displayed when you create ¢
new tool.

The Configure Tool dialog show
s a list of plugin packages th
at can be added to the tool. C
licking the checkbox will add

"Vnpackage to the tool. Clicking
on the Configure link will br

ing up a dialog for adding ind
ividual

plugins.

The Ghidra Project Window's C
nfigure display shows its own
list of eligible front-end plu
ains as onlvALLER) AU A RL LE

Saving

Save changes to your tool by c¢
licking on the

clicking on the

icon.

icon in the dialog's toolbar;
save your tool to a different
name byauc Wit oveniaii Sdlibain ui
To Configure all plugins regar
dless of package, select the
dialog will appear with all pl
ugins in its plugin table.

icon in the dialog's toolbar a
nd the Configure PluginsIEhiEll LER be addec
individually.

Configure Tool 2/3

Configure Plugins Dialog

Selecting the Configure link f
or a package will bring up the
the Configure Plugins Dialog.ble at the top of the dialog t
hat shows of all the plugins i

n the package and an informat
on window

at the bottom that shows detai
Is about an individual plugin.

Plugin Table
The plugin table shows the fol

FICTION A. rr ARLeaelCheckbox to Indicate whether |
he plugin is in the tool;

A status icon:

hI

- the plugin is good. It has h
elp and been reasonably testec

- the plugin is useable, but h
as not been fullv tested and/oNE PIUGIT Is Uurnuch ucveiopin
ent and may not be usable at a
11. Not included with producti
on
distribution.

Plugin name: the name is displ
ayed in red when some other p
ugin depends on this plugin;
Short description of the plugi
1Hhunt iti hl il alba Sahl kil Sal
works in the context of a Cod
e Browser or Byte

Viewer, etc.

The Search Filter allows you
to narrow the list of plugins
displayed in the table. Only t
hose plugins whose name orwill be displayed. As you typ
e, the table is updated to Con
LIER CTT RcT

reflect the filter.

Information Window

When you select a row in the t
able, the scrolled window belo
w the table shows more inform
tion about the pluginauthor's name, organization, e
tc. The Dependencies

section lists the class names
of the plugins that depend on
the selected plugin due to som
e service that it provides.

The Class Location indicates f
rom where the java classes are
being loaded.(SCI el]

Configure the Ghidra Project W
indow

Save Tool to Tool Chest

Ghidra Tool Administration

Tool Options Dialog

Tool Options Dialoa 1/4Ealll LOLI Tas afl VpPLIDTS Uial0
g that shows options in a tree
format. When you click on the
node, the associated options
appear in a panel to the right
of the tree. At

a minimum, the tree has a nod
for key bindings and tool opt
ions . Select the node to show
the corresponding options thaMI
their own options, in which ca

se new nodes in the tree or ne

w options for the tool may sho

Ww up. Options provide a flexib

le way for changing plugin beh
avior or

functionality.

The Tool Options dialog has aelating to a keyword. Any opti
ons names or

descriptions that contain the
keyword text will be displayed

To display the Options dialog,
select Edit

Tool Options... from the toolRestoring Default Settings

You can restore any currently
selected options panel to its
default settings by pressing t
he Restore Defaults button at
the bottom of the options pane
I. Use

caution when executing this ac
tion, as it cannot be undone.You can create a new "hot key
for a Plugin's action or modi
fy the default key binding. Th
e hot key (or accelerator) tha

t you add can be used to execu
te the

action with a keystroke combir
ation.

You can also chanae kev bindirLL RE LARA AR AE EA AL
any toolbar icon or menu item
. Click here for

more info.

The Key Bindings panel has a t
able containing the Action Nan
e, Key Binding, and Plugin Narr
e. You can sort the columns in

ascending or descending ordecilia loatic lls kB Si abide’ cil
rder.) The Plugin name is the
name of the plugin supplying t
LEEIe IN

Click on the category header t
o change the sort order.
Change the order of the columi
s by dragging the column head
r to another position in the t
able.ns entered.

If an action has a description
to explain what it does, it w

ill be displayed below the tex
[SiH

The table entries are not edit
able.
LS display LE shows the [Xngs Options panel works the sz
me as for a regular Ghidra Too
I.

Tool Options Dialog 2/4

Change a Key Binding
To change the Key Binding,
pi3.

ES

Select Edit

Tool Options... from the main
[CLIT

Select the Key Bindings node i
n the options tree.

Select an action name to eithe
rset a kev bindina or chanaeAli LR LAA UR LA AS LRA ES

pe the key or keystroke combir
ation (e.g., Ctrl x).

When a key is mapped to multi
le actions, the action name is
listed below the text field.

5. Click on the OK or Apply bu
Jaiof these actions is valid in t

he current context (i.e., the
action is enabled), then a dia
log is

displayed for you to choose wh
at action you want to perform.
To avoid the extra step of cho
osing the action from the dial
og, do not map the same key txRemove a Key Binding
To remove a Key Binding,

iS
va
ER
£3
5.
[2Bmenu.
Select the Key Bindings node i
n the options tree.

Select an action name for the
key binding that you want to r
emove.

Click in the text field for th

e key binding.

Press the <Enter> or <Backsp:

a 0 Fn pb En Ten.

Import Key Bindings
To import a Key Binding,
1. Select Edit

Tool Options... from the main
[CLITih ad of 4

Select Edit

Tool Options... from the main
[CLIT

Select the Key Bindings node ilaser i a wan Behl stat delle)
On the warning dialog, press t
he Yes button to import key bi
ndings or the No button to can
cel the process.

On the file chooser dialog, ch
oose a previously exported fil
e from which to import key bin
dings.

Press OK to import the key binTool Options Dialog 3/4

Importing key bindings will ov
erride your current key bindin
gs settings. It is suggested t
hat you export your key bindin
gs before you import

so that you may revert to your
previous settings if necessarpL @ CTI NII)

Save Tool) if you want you cha
nges to persist between tool i
nvocations.

Key Binding Short-Cut
A key binding can be applied t
0 any menu item or toolbar ico

[SEData

Close
Cycle

Cycle: Float, Double
Apply key bindings to menu ite

ms or icons that are frequent!
v accessed To do this:<. Plate Lhe Cursor on tne men
u item or let the mouse hover
over an icon on the toolbar.

This menu item or icon will be
associated with the Key Bindi
ng. When the Key Binding key
s used, this menu item or acti
on associated

with the icon will be applied.hat Aa a Eh

4. Enter a key combination in
the Set Key Binding dialog, Th
e panel below the text field t
hat accepts the key input show
s the other actions

that are mapped to the key. Th
ese are potential collisions i

f these actions are enabled at5. The key combination that is
entered in this dialog will b

e the key binding for the menu
item.

Export Key Bindings

To export a Key Binding,
i

2.5.
[2B

Select Edit

Options... from the Tool menu.
Select the Key Bindings node i
n the options tree.

Press the Export... button.

If you have made changes, the

PEOL D  rralIB
On the file chooser dialog, ch

oose a file to which to export

key bindings.

Press OK to export the key bin
dings.

esl
Tool is a default node in the
options tree that shows up in£1001 pale! Uctifies the OpLo
ns for the Tool. The table bel
ow lists

the basic options. Plugins may
add their own options to the
Tool options. If a tool does n
ot have a plugin that uses an
option, the option will not sh
ow up on

the Tool panel. For example, tiin ctnialeinlal ll alban Lbs lilt loath alco
Max Go to Entries, Search Limi
t, or Subroutine Model so thes
e

options will not appear on the
Tool panel. If an option has

a description, it will show up

in the description panel belo
w the tree when you pass the r
[IEoptions will not appear on th
e Tool panel. If an option has
a description, it will show u

p in the description panel bel
ow the tree when you pass the
mouse

pointer over the component inTool Options Dialog 4/4
Tool Options

Option

Description

Docking Windows On Top

Selected means to show each

A I A LEA ET eeundocked window will not get
lost" behind its parent window
. Unselected means
that the undocked window ma;
o behind other windows once i
loses focus. Use the
Windows menu to make the ur
ked window visible.

Max Goto EntriesNUTnPeEr UF pdst ChLHES LOU KEEP
in the Go to Address or Label
dialog

Search Limit

Numeric: The maximum numb:
search hits to allow; for exa
mple, when you

search for text in the Programexceeds this limit, or the max
number of addresses displayec
while doing a Go To for

an entry that has multiple mat
ches.

 

Subroutine Model
Use C-like Numeric Formatting
for Addressesdel. This setting is mainly us
ed when creating call

graphs. See Block Models for a
description of the valid Mode
Is.

Selected means to attempt to i
nterpret the value entered in
the Go To dialog as a

number as follows:interpret the value as an octa
I number if it starts with "0"

interpret the value as a binar
y number if it ends with a "b"

To change Tool Options,
i

2.
3.
FlFrom the tool, select Edit

Tool Options...

Select the Tool node in the op
tions tree.

Change the value for the optio
iB

Click on the OK or Apply butto
iB

Bele)EACLE ARAL I AL AS RA LA
f those are described below.

Tool Options
Option

Description

Swing Look and Feelhlhnks aici about ulation le baal
ch as colors and fonts.

Each operating system provide
a different default Look and
Feel. Some of these

work better than others.

Use Inverted Colors

This is a prototype feature thDoing this effectively creates

a Dark Theme, which some us
s find less visually

straining.

As a prototype feature, this f
eature has many known issues
ICEIEILIR

Pre-generated content, such as
images, icons and help filesSome color combinations will k
e difficult to read

Related Topics:

Go to Address or Label
Subroutine Model

Connecting Tools 1/4Ghidra Tools that share data a

nd interact dynamically are sa

id to be connected. Tools

are connected via tool events.

Tools generate events when yc
I'H

open or close a Program

move the cursor to a different

location in the Program

make a selection in the ProaraA main reason to connect tools
is to have one tool track Pro
gram location or selections

in another tool.

A tool may generate events the
t only another tool of this ty

pe can process, e.g., the

Code Browser in one tool prodt
ces and consumes an edit everThus, tools can be connected f
or only those events that

they have in common.

Tool connections are direction
al. You can connect two Tools
A and B in a single

direction such that Tool A gen
erates an event consumed by T
ol B; however, Tool Ao connect Tools A and

B such that the connections ar
e bi-directional, where Tool A
generates an event
consumed by Tool B, and Tool |
generates an event consumed
y Tool A.

The following sections describ
e the ways to connect tools.You automatically connect tool
s when you:

drag the icon for one running
tool onto another running tool
el

drag the icon from the Tool Ch
est onto the icon for the runn
[CR LIN

The tools are connected in bot

Wh Airartinne far all avamnte {abe consumed by lool B, and al
Tool B events will be consume
d by Tool A). For

example, if you move the cursc
rin Tool A, the location chan
ge is reflected in

Tool B. Conversely, if you mov
e the cursor in Tool B, the lo
cation change is

ile Bl cee WDrag and drop tool icons is t
he quickest way to connect tw
JeIEN

Connecting Tools 2/4

Manual Tool Connection

Connecting Toolsfoul tml Bolla cil td
Tools... option from the Ghidr
a Project Window.

Connect

To connect two tools in one di
rection for a specific event,
1. Select a tool in the Event
Producer list (for example TooConsumer list (for example Toc
1B).

3. Select the check box for th

e event of interest in the Eve
la}

Names list.

Only the consumer tool will re
spond to the event

generated by the producer toolirections for a specific event

To connect two tools in both
directions for a specific even
|

Connecting Tools 3/4rection as described above.

2. Select Tool B as the event
producer and and Tool A as the
event consumer.

3. Select the check box for th
e event of interest in the Eve
la}

Names list.

When vou select a check box fcELC SUES ERAS ART) SE RR
K button dismisses the dialog,
as

does selecting the

button. There is no "cancel" a
ssociated with

connecting tools.

The manual connection is usefi
| only if you want to control
specific events between the totla ait)
easiest way to connect all too
Is for all events is to click

on the

Connect All button. This actio
n will connect tools in both
directions, just as though you
had dragged and dropped the
ool icons

to do the automatic connectiorall events by clicking on the
Disconnect All button.

Some Notes on Connecting Toc

1. Because of the basic premis
e of connections, connected To
ols

should have J 15) same programtools each showing a different
program will probably not be v
ery useful.

2. Tools running in different
workspaces may be connected
Even though tools may not be
isible because they are not in
your active workspace, they ca

n still be connected to tools
fasDisconnect Tools
To disconnect tools for a spec
ific event,

To disconnect tools for a spe
cific event,1. Select a tool in the Event
Producer list (for example Too
1A).

2. Select a tool in the Event
Consumer list (for example Toc
1B).

3. Turn off the check box for
the event of interest.

The consumer tool will no longh directions for a specific ev
ent,

1. Disconnect the tools in one
direction as described above.
2. Select Tool B as the event
producer and and Tool A as the
event consumer.

3. Turn off the check box for
the event of interest in the ETo disconnect all tools for al
| events, click on the Disconn
CERIN]

When you deselect a check bo»
for an event, the connection i
B

terminated immediately.GHIDRA Training 8
TOP SECRET//CYBER//NOFOR!dit Plugin Path 1/4

Edit Plugin Path
The Plugin Path is a preferenc
e that indicates where Ghidrad installation locations. User
developed Java classes can
be used to extend Ghidra with
additional plugins and data ty
[JEN

All plugins discovered by Ghid
ra can be displayed in the
Configure dialog for all toolsData Type Manager display.

The User Plugin Paths list sho
ws the paths in the order to b
e searched. Each path is

The User Plugin Paths list sh
ows the paths in the order tois 2/4

Edit Plugin

either a directory path ora j
ar file path. If the path is a
directory, then only class fi
[CS]

in that directory will be used
(not jar files within that di
rectory). If the path is a jar

IRE rr ar a ye.‘I'ne User Plugin Jar Directory
shows the directory that conta
ins jar files to search.

In addition to the above, Ghid
ra also searches in the instal
lation directory, in the
<home>/.ghidra/.ghidra-<vers
n>/plugins directory, if it ex
ists.

The directories noted above aA LLL
classpath. The search order of
these paths is:

1. Jar files in User Plugin Ja

r Directory (Plugin Path prefe
rence)

2. Jar files in the Ghidra plu
gins installation directory

3. User Plugin Paths from the
Plugin Paths preferenceiia SE

After you make a change to the
plugin path, you must restart

Ghidra to see

the effects.

Add a Plugin Path

To add a Plugin Path,

1. From the Ghidra Project Win
dow, select Edit2. The Edit Plugin Path dialog
is displayed; in the Director
ld

Jar File Name field

Select the Add Jar... or Add D
ir... button to choose

either a jar file or directory
from the file system.

Locate Ll] EEIEeY RUS appropriSelect the Add Jar, or Add Dir
button within the

file chooser dialog.

3. Select the Apply or OK butt
on from the Edit Plugin Path

3. Select the Apply or OK but
FTE. TOIT aE a of TT FR ST TYSHALE Re

Apply applies the changes and
leaves the dialog up.

OK applies the changes and dis
misses the dialog.

Change the Search Order
To chanae the search order ofALLEN

154

1. Select a path from the User
Plugin Paths list.

2. Select the

button to move the path up in
the list; select

lu)

to move the path down in the |
ist.i
when you have different versio
Lh

of a plugin in different jar f
iles. The first class that is
loaded is the

one that you will be using whe
n you run Ghidra.

Set the User Plugin Jar Direct
ory1. Enter the absolute director
y path in the User Plugin Jar
Directory field, OR click on t
he ... button to choose a
directory from the file system

2. Select the Apply or OK butt
[LR

lies the changes andmisses the dialog.

Remove Paths

To Remove an existing jar from
the Plugin Path,

1. From the Ghidra Project Win
dow, select Edit

Plugin1. From the Ghidra Project Wi
ndow, select Edit

[14 I

2. Select a User Plugin Path.
3. Click the Remove Button.
4. Click Apply or OK.

Plugin

Edit Pluain Path 4/4TO REMOVE LHC User Fiuyglin jar
Directory from the Plugin Path

1. Clear the User Plugin Jar D
irectory field.

2. Select the Apply or OK butt
[LR

Apply applies the changes and
leaves the dialog up.

OK applies the changes and di:When you click on the Apply or
OK button, your

preferences file in your
<home>/.ghidra/.ghidra-<vers
n> folder is updated
immediately.

If you have a tool that was bu
ilt with Plugins that came fromessage listing each Plugin t
hat could not be found

when you re-open the project c
r when you launch that tool.

Related Topics:
Ghidra Project Window
Configure Ghidra Project WindBuilt in Data Types
Plugins

RESIS
FAECES Ve

The Patch Instruction action w

TT PAT TT LL i ETNe listing. The first time you

use the action, it

may take a moment to prepare
he assembler for your processo
r. You can then edit the text

of the instruction, optionally
replacing it

altogether. As you edit, a con
tent assists will provide comp
letion suaaestions |t will brWier Lie text

comprises a complete instructi
on. Activating a completion su
ggestion will input that text
at your cursor. Activating a b
yte sequence will

complete the action, replacing
the instruction at your curso
r. Pressing ESC or clicking ou
tside of the assembly editor wAssembly Editor

To edit assembly, select Patch
Instruction from the Listing
View context menu or press CT
L-SHIFT-G on the instruction t
[}

modify. Click the plus button
below the content assist to exthe same SLEIGH modeling th:
powers the disassembler. This
offers some nice benefits:
There is no need for an extern
al tool chain.

The assembler and disassembl.
share the same mnemonic syn
pe

Most Ghidra-supported processProcessors added to Ghidra aut
omatically get an assembler.

Most Ghidra-supported process
ors are also supported by the
assembler.

Processors added to Ghidra aut
omatically get an assembler.Keep in mind, the above list i
sin an ideal world. We are in
the process of improving the
assembly engine and processol
[lL [TEER]

eventually support assembly fo
[EIR HCl IIe [ERR IIE EN

In the meantime, we test sever
al popular processors and assiratify Lo €actl. The possivice
atings are:

1. Platinum: Our automated te:
ts did not find any errors. Th

is offers the best possible us
EIFS IT TN

2. Gold: You will rarely encou
nter an error. You will find i

t very useful.

3. Silver: You may occasionallwill likely find it useful wi

th occasional

MOB ClhN

4. Bronze: You are likely to e
ncounter errors, but there are
enough working instructions t
hat the assembler is useful. Y
ou may find it

useful, but it will probably bounter severe errors, and ther
e are few instructions that as
semble. You may or may not fir
d it useful, but we

consider it unusable.

6. Unrated: The processor is n
ot tested, or the test failed
before a rating could be assig
ned. You might get lucky, butAs of this release, our tested
processors fall under Platinu
m, Gold, or Poor.
Platinum
68000:BE:32:default
AARCH64:BE:64:v8A
AARCH64:LE:64:v8A
ARM:BE:32:v7

ARM:LE:32:v7
ar ETE avkandandMIPS:BE:32:micro

 
 
 

[LH Hi)
MIPS 64-32addr
[LH Hi)

MIPS:BE:64:default
pa-risc:BE:32:default
PowerPC:BE:32:default
PowerPC:BE:64:A2-32addr
PowerPC:BE:64:A2ALT-32addr
PowerPC-BE default=palt.DE. Da. USialull
SuperH4:BE:32:default
SuperH4:LE:32:default
TI_MSP430X:LE:32:default
x86:LE:32:default

Gold

x86:LE:64:default

Bronze
avr32:BE:32:default

201dProvided by: Assembler plugin
Related Topics:
Listing View

AEE cv

The Byte Viewer 1/7The Byte Viewer displays bytes
in memory in various formats,
e.g., Hex, Ascii, Octal, etc.

The figure
below shows the Byte Viewer
ugin in a separate window fron
the default tool, the Code Br
owser.Window Bytes: ... menu.

, on the Code Browser toolbar,
OR, choose the

The following paragraphs desc
ibe the Byte Viewer.

Data Formats

TL TTR LT rmefault. tach format is an inst
ance of a

DataFormatModel interface, so
any new formats that you provi
de will automatically show up
in the

Byte Viewer Options dialog tha
t lists the data formats that
may be added to your view. To
add orhe Lovl, press ice

icon to bring up the Byte View
eer Options

dialog. Select the formats tha
t you want and press the OK bt
Jai

57g

The Hex view shows each byte
s a two character hex value. C
hange the group size forall lait § dua Bk ated catalase
you add the Byte Viewer
plugin to a tool and then open
a program, the Hex view is au
tomatically displayed by
EEE

This view supports byte editin
[-}LUCEY ENE vl

Ascii

The Ascii view shows each byte
as its equivalent Ascii chara
cter. For those bytes that

do not represent an Ascii char
LEE the format shows it asg.
Address

The Address view displays a ti
c (".") for all bytes whose fo
rmed address does not fall
within the range of memory for
the program. For those addres
ses that can be formed

and are in memory, the view st

RS Ama |n the

Code Browser, and make a Poit
er data type, the address poin
ted to is in memory.
Conversely, if you go to a "ti

c" address in the Code Browse!
and make a pointer, the
address pointed to is notin m
emory (the operand is rendere
Ee: RLny.

Disassembled

The Disassemble view shows a
box" () symbol for each addre
ss that has undefined

bytes. For those addresses tha
tare instructions or defined
data, the view shows a tic
("."). With this view, you can
easily see what areas of theThis view does not support edi
[IIe R

FE

This format shows four byte nu
mbers represented as an eight
digit hex number.

This view supports editing. Wh
en a byte is changed, all four
bytes associated with thisInteger

This view shows four byte num
ers represented in decimal for
Juki

This view does not support edi
[IIe N

OctalLLC CRY ENE cy

The octal view shows each byt
as a three character octal va
LEER

This view supports editing.
Binary

The binary view shows each by
e as an eight character binaryStatus Fields

The labels below the scroll pa

ne that contains the views sho
ws the following information:

Start

The minimum address of MemcThe maximum address of Mem
Offset

Displayed in decimal, the num
er of bytes

added to each block of memon
that is being

displayed. This number is calcAaa ladusadi caida Elbit tinea

or the number
of bytes per line.

 

[LEST

The address of your current cu
rsor location

Editing Memorydit toolbar button

so that it appears pushed-in.
2. Click in a view that suppor
ts editing, e.g., Hex or Ascii

3. The cursor changes to red t
o indicate that this view can
be edited.

Changing bytes is allowed only
if your cursor is at an addreIf you attempt to change a byt
e of an instruction, an "editi
ng not allowed" message is dis
played in

the status area of the tool.
Changed bytes are rendered in
red. This color can be changed
via the Byte Viewer Edit Opti
ons byChangea bytes are rendered In
red. This color can be change
d via the Byte Viewer Edit Opt
ions by

LLCS CRY ENE
double-clicking on the Edit Co
[Ig CIN

Undo the edit by hitting the U
ndo button (

Redo vour edit bv hittina the) on the tool. The byte revert
s to its original value.

).

To turn off byte editing, clic
k the Enable/Disable Edit tool
bar button

pushed-in.If you have two Byte Viewers r
unning, you can connect the tv
o tools for the "Byte Block
Edit" event so that when you n
ake changes in one Byte Viewe
, the other will reflect those
changes

in red.has focus shows its cursor in
magenta. (Cursor colors can b
e

changed via the Options dialog
) If the byte editing is enabl

ed and the view that is in foc
us supports

editing, then the cursor is re

d.The Byte Viewer Options dialog
can be used to add and remov
views, set the Alignment Addr
ess, set the

number of bytes per line, and
set the group size to be used
by the hex view. To launch the
Byte Viewer

Options dialog, press the

PIL ER LE CO LE 1 TA | TeAlignment Address
LUGE CRY ENE

The alignment address specifie
s what address should appear i
n column 0. Any address

can be specified but the addrALLL SARA LEC LL RR AR LIRR
address. This enables you to v
iew bytes in an offcut manner
and to identify patterns in

the bytes. Changing the alignn
ent address affects the offset

, which is the column that
would display the bytes for ad
dress 0 if it existed. The off

set is affected by both theEat sit

 

phil ah iii Tian il 1 Ll
layed as a label below the
scroll pane containing the vie
ws.

Sometimes you might see a by
pattern such that you want al
| the bytes to line

up in the first column of the
display. Consider the cursor p
osition in the image below.to appear in the first

column, you would enter an ali
gnment address of 0040b003,
indicated by your

cursor position.

The result of setting the alig
nment address to 0040b003 is
Ch) LER The calculatedto create a new

alignment. The first line of t
he display shows the "remaind
r" bytes of 16 (bytes per

line) divided by 13, the offse
t. If you were to put your cur
sor on the starting byte of

the first line, you would see

that your insertion point is 0
DAGWRAN rn Fh le mw rvs rlsLLCS

EE CET RS)

The bytes per line indicates h
ow many bytes are displayed ir
one line in a view. The

default value is 16.

All formats shown must be able
to support the new value ForARAL A AR ASS A AS RR RL
show bytes in groups of four,
the bytes per line must

be a multiple of four. If a se
lected format cannot support a
value for the bytes per line,
an error message will appear a
nd the OK button will be disab
led.

SEC CI IP)RE ht
s asa "unit." For

example, a group size of two Ir
eans to show two bytes groupe
together with no spaces.

View Selection

Each potential view is listed

as a checkbox. Select the chec
kboxes corresponding to the
views to be shown. Red text inBTS the specified number c
f bytes per line.

Reorder Views
The various views in the ByteV
iewer can be reordered by drag
ging the view header to the le

ftor

right Lu 1S] current positionThe various views in the Byte
Viewer can be reordered by dr:
gging the view header to the |
Eide

right of its current position.

The view positions are swappe
d.Writing Your Own Format Plugi
To supply your own format to k
e added to the list of views d
isplayed in the Byte Viewer,

1. Write an implementation of
the ghidra.app.plugin.core.for
mat.DataFormatModel
interface, which determines th
e format of how the bvtes shou<. CUIL your Fiuygin patil Lo 1h
clude your class files if you

are running Ghidra in producti
on

mode versus development moc
in development mode, you will
have to add your class files

to your classpath in your deve
lopment environment.

3. Restart Ghidra.Ht a A
il

Related Topics:

Byte Viewer Options

Pointer data types

Code Browser

Configure Tool

Select BytesCode Browser 1/9

The Listing View is the main w
indows for displaying and work
ing with a program's instructi
on and data.

Listing Viewayed above, the Listing is sho
wh to the right of the Program
Tree. The Listing is current!

y showing a snippet of code fo
r

"WinHelloCPP.exe". Code is ma
e up of various elements such
as addresses, bytes, mnemonic
, and operands. The Listing us

nant Fiza Votre Fre sheer Nave iin ts rms almoverall layout of the Listing
can be changed by adjusting tt
e size and position of the fie
Ids using the Browser Field Fo
rmatter.

The View

The Listing can either display
an entire program or a subset
of a proaram The view deteralc Ulsplaydbic 1h the Listin

g. By default, the

view contains the entire progr
am, but other Ghidra compone
s can restrict the view to som
e subset of the program. For e
xample, the Program Tree can
e used to

restrict the view to a module
or fragment. If the view is laEEE
that allows the display to be
scrolled anywhere within

the view.

Cursor

The Listing maintains a cursor
location. Even though the Lis
ting never actually changes a
program, it plays an importantoperate at a specific address

or even on a specific field on

an instruction at an address.
These plugins use the Listing
's cursor position to determin
e the appropriate

“program location".

The cursor can be moved by us
ng any of the "arrow" keys orSelection

The Listing also maintains a s
election (shown using a green
shaded area). Some plugins op
rate on a particular address.
Other plugins can operate over
a range of

addresses. For these plugins,

ines eas lanrtirern ter ) teeail Foe restrhich to operate.

A selection can be set by eith
er dragging the mouse while hi
Iding down the left mouse butt
on or by pressing the <shift>
key while moving the cursor wi
th the "arrow"

keys.

Pressing the <Ctrl> key down"
hile clickina the mouse will eLCRA ER LA SLL
CECE LRT AVN El [oC]
that line from the

selection.

Clicking the mouse anywhere (
ithout dragging) will cause th
e selection to go away.

FLSince the selection is transie
nt (it goes away easily), the
Listing also has the concept o
fa highlight. The highlight i
s similar to the selection, bu
t it stays around until it is
explicitly cleared. To create

a highlight, first create a setion to a highlight. Later the
highlight can be

converted back into a selectio
n using the same menu. At tha
point an action can be applie
d to the selection.

Highlights are not saved acros
s program sessions. To achieve
a lasting color effect, you cBackground Color
See Listing Background Colors

Navigation

The Listing provides built-in
navigation functionality for a
ddresses and labels. Double-cl
ick on any address, label or r

Bolas rar ats | vss vr DL ve wiidnire bas ) ieattempt to reposition to that
location if it exists in the p
rogram. If the address exists

in the program but not in the
current view, the view is expa
nded to include the

address. If the location refer

s to an external location and

it is associated with another
prodaram that proaram mav beA A LE

the tool Edit Tool Options dia
log for control over certain N
avigation behaviors.

In the XRef field, sometimes t
here are too many addresses tc
display so the the field will
display "[more]" to indicate
that one or more cross-referen
ce addresses are notDouble-clicking on the “[more]
" text will cause a Location R
eferences Dialog to appear. Al
so, double-clicking on the XRE
F header text (XREF[n]:)

will too show this dialog.

This dialog lists all the Xref
addresses, any labels that ar
e at that address and a previethe table will cause the
browser to navigate to that ad
dress. Double-clicking will na
vigate and dismiss the dialog.

Keyboard Controls

The following key mappings ar
used by the Listing:

<Home>ng of the line.
<End>

Move the cursor to the end of
the line.

<Ctrl><Home>

irises Pues wos vem om rmmt Fras +3 celaSe ES Te hg

Move the cursor and the displa
y to the bottom of the program
<Page Up>

Move the displav to the previo<Page Down>

Move the display to the next p
age.

EO ¥.Ve{ 1

Move the cursor up one line, s
croll the display if necessary<Down Arrow>

Move the cursor down one line,
scroll the display if necessa

2

EEC Ned

Move the cursor to the left on[ J 5) [Fe position of the pr
evious line.

<Right Arrow>

Move the cursor to the right o
ne position. If at the end of

a line, move the cursor to
first position of the next linMarkers

Markers are used to indicate s
pecial locations within a prog
ram. These location can either
be specified by the user (Boo
kmarks) or by various Ghidra p
lugins (Search,

Analysis, Changes, etc). There
are two types of markers: Mar

ITE © AT ORE © RT |Code Browser 3/9

Markers

Margin Marker

Margin Markers appear on the |
eft side of the Listing and ar

e used to indicate locations w
ithin the currentlv displavedAA LL ME SS ER I LR LL ELS ER
d Area Markers. Point Markers
are used to indicate individua

| addresses (Ex: bookmarks, se
arch results, breakpoints, etc

) and are displayed using icon
EX

Area Markers are used to indic
ate a range of addresses (Ex:
areas in the program that haveA
hs

Navigation Marker

Navigation Markers appear on |
he right side of the listing a

nd are used to indicate locati
ons within the overall view. T
hese markers provide an overv
ew of all the markers

and an easy way to navigate toe each color represents a diff
erent type of marker. To see t
LER]

assignments bring up the Mark
r Popup Menu as described bel
LZ

To navigate the browser to the
actual location of a marker,
left-click on the marker. Thented by that marker.

The Navigation Marker area is
divided into two vertical area
s. The left area is used to di
splay Point Markers while the
right area displays Area Marke
rs. This prevents the

Point markers from being hidd
n by the Area markers.

EF PPL STL LIL 110 SSR TYrea by right-mouse clicking in

the margin; a popup menu is
isplayed, as shown in the imag
CREA]

markers on and off by clicking

on the appropriate menu item

Marker Popup Menu
The markers shown in the Mark
r Popup Menu are described beAlalysls bOOKITIalks

Bookmarks inserted by the aut
analysis process. Indicates i
nformation about where functi
ns and address tables were cre
ated.

Changes: Conflictingjatably Satablanla  Lasathl
Changes: Latest Version

Areas where changes exist in t
he latest version made by anot

her user.

Changes: Not Checked-InChanges: Unsaved

Areas where you have made ck
ges to the Program.

Error Bookmarks

LCS AUC lu) SulRTT

Areas that are highlighted (no
n-transient selections).

Info Bookmarks

Bookmarks inserts by a plugin

I Tre (ngNote Bookmarks

Bookmarks inserted by the use

Register Values

Areas where the selected regis
ter has defined values AppearALAA AA LE AEA

Register Values

Areas where the selected regis
ter has defined values. Appear
s only when the Register Mana:
er Window is visible.Areas that are selected (trans
IEhI4N

Code Browser 4/9

The marker popup menu is upc
ed appropriately when some pl
gin adds/removes new marker
[EHto set the options in Navigati
on Markers panel of the Edit O
ptions dialog, as shown below.
Select the

Navigation Markers node in the
Options tree. Click the appro
priate checkbox to turn the ma
rker on or off.RENE]

The flow arrows graphically il
lustrate the flow of execution
within a function. They appea
ras arrows on the left side o

f the Listing display indicati
ng source and

destinations for jumps. Condit
ional jumps are indicated by d

J TL SL TT) Is. Flow lines are bolded when
the cursor is

positioned at the source of th
e jump.

RENE]

Selecting Flow Arrows

By default, flow arrows are on
ly shown when either the start
or end address is visible ThYOU WI SEE TIOW alTOWS dppe
ar and

disappear, as the addresses th
e arrows are based upon appes
and disappear in the listing.
You can select an arrow keep i
t from disappearing as you scr
oll the Listing. To select an
arrow, simply click it with th

e mouse. Selected arrows appeYou can select an arrow keep
it from disappearing as you sc
roll the Listing. To select an
arrow, simply click it with t

he mouse. Selected arrows apy
ar

green in color.Disabling Flow Arrows

The panel displaying the flow
arrows can be resized by dragg
ing the border between it and
the main code browser panel. 1
o hide the flow arrows, simply
drag the border until it is no
longer visible. The arrows au
tomatically disable themselvesNavigating Flow Arrows

You can double-click a flow ar
row to navigate to its end poi
nt. Also, if the cursor is at

the end point address, then yo
u can double-click to navigate
to the

start point of the arrow. Each
double-click will go to the o

rrr aad rol bean phrerny | vhs bvasrsan enapoint.

Mouse Hover

The Listing includes the capab
ility of displaying popup wind
ows when the user hovers the |
ouse over a particular field.
This occurs whenever a plugin
has additional

information that it wants to dLpPUpP WINUJOW Ulsappedis WICH
e user moves the mouse off of

the window or field. Some exar
ple popup

windows that can be displayed
Reference Popups, Truncated
ext Popups, and Data Type Pop
ps.

Reference Popupsover a memory reference. A Re
ference popup containing a Lis
ting window is displayed
showing the code referred to b
y the reference. The Listing p
opup uses the exact same form
tting and layout as the primar
y Listing except for the backg
[ITLL]he popup. You can click and sc
roll within the Listing popup,
however, you cannot follow
references within the referenc
e popup. The reference popup
an be quite useful for quickly
inspecting a series of calls
without having to navigate wit
hin thef the program's memory. The fi
gure below shows an example
a reference popup.

EEC TNT IVT)

You can change the size of the
popup can be changed by edit
ng options. Choose Edit

Tool Options..., click on the

lietinm Daniine nade in Fha (ndtree. Select the Reference Cod
e Viewer node to display the h
eight and width values of the
popup. Edit the values and cli
ck on the OK or Apply button.
Truncated Text Popups
Truncated text popups are dis
layed whenever the mouse is h
vered over a field where the s
ize of the text exceeds the fiLalceu. A

tooltip-like window is display
ed showing the entire contents
of the truncated field (provi
ded the contents fits on the s
creen). This is particularly u
seful for

long strings and data within a
program that cannot be fully
displayed. The figure below shhatauaieied auinad salad oat

Data Type Popups

The data type popup is shown:
henever the user hovers over a
the mnemonic field where a di
ta type has been set. The figu
re below shows an example ofa the mnemonic field where a
ata type has been set. The fig
ure below shows an example o
El

data type popup.

Code Browser

Data Type Popup
Address Popupaddress. It shows the relation
ship between the hovered addr
ss and the base of memory anc
lu)

containing memory block. For
ddresses in functions, the fun
ction offset is also shown; fo

r addresses within a complex d

ata (structure, array, etc.),
FreyEh

Function Name Popup
Displays the hovered symbol's
parent namespace for symbols
hat are inside of functions.

Scalar Popup
Displays the hovered scalars a
s 1- 2- 4- and 8-bvte valueLLL ER a bd LR LAA a
Chile

Disabling Mouse Hover
Because the mouse hover popt
windows can sometimes get in
he way, a mechanism for quick
y disabling them is included.
Simply click the icon illustra
tedaniilasiaiiialied i piri bo dah tual
op right corner of the Listing

's toolbar whenever a mouse hi
ver plugin is loaded. When cli
cked,

the icon will change to indica
te the new state.

Clicking the icon has no effec
t when all of the hover servic
es are disable in Ghidra's optattempt to enable popups from
this icon and all hover servic
es are disabled.

Mouse Hover Enabled

Mouse Hover Disabled

Opening/Closing Structures an:of smaller component data typ:
s. By default, the contents of
structures and arrays are not
displayed. There is a Open/Cl
ose control (+/-) that

can be used to display or hide
the contents of structures an
d arrays.

To see the contents of a Struc

FIT, TRE Sed Ta[25]

Code Browser 7/9

To hide the contents of a Stru
cture or Array, select on the
B(<euNUIOTS ald AllTdys Call bE OpCl
d in the same manner.

Actions for Expanding/Collapsi
ng Data

You may also expand and colla
se data structures from the ri
ght-click popup menu via the E
xpand All Data, Collapse All D
ata, Expand All Data In
Selection, Collapse All Data ihpticintt iat abated ntlekiaat diac | ibaa] data
ively. These actions are only
available when the popup men
is activated under certain con
ditions. The actions are descr
ibed in detail below:

Expand All Data - This action
will expand a data element anc
all its children recursively
starting with the data at theonly appear when the cursor is
on a data that is expandable.
Collapse All Data - This actio

n will recursively collapse th

e outer most expandable data
lement containing the data at
the cursor location. This acti
on

will only appear when the cursents at any level.

Expand All Data In Selection -
This action will search the c
urrent selection and find all
expandable data elements and
hen recursively expand each
such data element and all its
children. This action is avail
able whenever there is a selec

ri.BAUS Te el REE Te Re
current selection and find al

| expandable data elements an
then recursively collapse eac
h

such data element and all its
children. This action is avail
able whenever there is a selec
<1,

Toaale Expand/Collapse Data -pPalluel/LollapsEUd stale Ul all ©
xpandable data element. If it
is expanded, it will collapse

it and if it is collapsed, it

will expand it. Additionally,

if the cursor is on a non-expa
ndable data element that is co
ntained in a parent expandable
data

element, then the parent elemcursor is on an expandable dat
a element at anly level or whe
il

the cursor is on a data elemen
tinside another data element.

The Expand All Data and Collay
se All Data actions behave dif
ferently. The Expand All Datathe popup menu. The Collapse
Il Data action, on the other h
and, always works on the outer
most data structure, regardles
s of where in the containing
structure the popup menu was
ctivated.

Cursor es Lal LILsplay the individual elements
of a program (address, bytes,

operand, etc). Clicking the mi
ddle mouse button

on a field places the cursor i

n that field and causes the te

xt under the cursor to become
highlighted along with all oth
er occurrences of that text. F

I URE ST aUSH™ mnemonic at address Ox
04072. Notice that every "PUSH
" on the screen (not just the
mnemonics) is also highlightec
. Specifically,

the "PUSH" in the comment is
ighlighted. The Cursor Text Hi
ghlight makes no distinction a
s to what type of information
is beina hiahliahted To deterthal sToula be fHyriignied, a
case-sensitive whole-word stri
ng compare is used.

Code Browser 8/9
Cursor Text Highlight

This feature has additional fu
nctionality when used on regisbo Bi allah int alba RE alia atl
the "Scope" of a register. The
RET oR IE BET TEST

starts where the register is a
ssigned a value and ends at th
e last use of the register bef
ore it is written with another
value (when a register is bot
h read and written, then it
will be shown as a read).the register is computed. The
register is highlighted from
the point it is initially assi
gned a value (written) to

the point it is last uses that
value. With "Scoping", three
different colors are used. The
read highlight color is used
Ll [RECHELE where the SE]y darker color is used at the
location where the register is
written (dark yellow in the i
mage below). All other matchit
g registers outside of

the current scope will be high
lighted with the default highl
ight color (yellow in the imag

[REN
hy ET a Tr TE oregs (see below).
Scoped Register Highlight

Default Settings

By default, the cursor text hi
ghlight is:

Enabled

Painted in yellow

Onlv activated bv usina the miSLORY dred Oh

Configuring

Use the Tool Options dialog t
o turn off the Cursor Text Hig
hlighting, as well as to confi
gure the color and activating
mouse button.Configuring

There are many options for cha
nging the appearance of the Li
sting. To change the arrangem
nt of fields, use the Code Bro
wser Formatter. All other opti
ons are tool

options. See Tool Options for

a complete description of theErrors in Fields

If an error ever occurs while
the code browser is attempting
to display information in a f
ield, it will show an "*Error*

" field instead. Double-click

on the error field to

display the Log Details dialogProvided by: Code Browser Plu
I}

Related Topics:

Code Browser Formatter

Tool Options

Program Tree

Selection & HighlightingThe Browser Field Formatter is
used to control how the field
sin a listing are displayed b

y the Listing. The format spec
ifies which fields are display
ed, the

order of fields, and the width
of each field. The formatteranytime by clicking on the
icon

located in the Listing's toolb
ar. When the formatter is visi
ble, the button becomes depre
sed, and can be clicked to hid
e the formatter.

The listing displays informatidown into the following catego
ries:
Address Break

Separates non-consecutive adc
[FEES

Plate

[TE TN ar. mmRULER UE eae ly TAR LN]
CERES

PLlelT

Displays function signatures a
nd function related attributes

VariableLAE SAUD ERAS R RE ARAL A BL A
eturn, parameters and local va
riables associated with a
function.

Instruction/Data

Displays information about ins
tructions or data.Displays internals of a struct
ICRI CVA

Each address has one or more «
f the above categories of info
rmation. Each category has a d
isplay format which can be con
figured. The format consists

of multiple lines, each with sthe display of the correspondi
ng field of information in the
program. The listing displays
fields in the same relative or
der, size and positioning as d
etermined by the field control
ler. It is important to unders
tand that

the formats, SCCLICIES of howle address.

Whenever the cursor is moved,
the Browser Field Formatter au
tomatically switches to the ta
b associated with the current
cursor location. In addition,
lu)

field controller for the curre

nt cursor location is highligh
FarConfiguring the Format

Adding Fields

New fields can be added to the
format by right-clicking on t
he Browser Field Formatter cor
ponent and selecting Add Fielc
<name

of field> from the popup menu
The new field will be inserteALAR RA A EE LR A AR LA

y been added to

the format show up in the popu
p menu. If more than one field
appears in the popup, an addi
tional menu item, Add Field Al
I, is

EVCIELIESBrowser Field Formatter 2/4

A spacer field is used to take
up space in the listing. Opti
onally, spacer fields can disp
lay some text (See Set Text).
To add a

El EIS {Cll Mate [ale [Te 1] TT
e a space is desired and selecadding the spacer field, adjus
t its size to take up more or
[EERE TN

Set Text

Spacer fields can optionally h
ave an associated text value.
Each spacer's text will be dis
played at corresponding locati
ons inhe field and choose the Set Te
xt option from the popup ment
Entering empty text into the S
et Text dialog box will remove
any text from the field thus
returning the field to a blank
ELI

REINO RAEICE

Finlde mam ha rammed ki eeeg Remove Field from the popuy
menu. All Fields can be remove
d by right

clicking on the header and sel
ecting the Remove All Fields o
ption from the popup menu.
[CLI REICH

Fields can be moved by draggi
g and dropping the correspond
na field controller in the BroALAS LASER

be dropped onto any line in th
e formatter. Since fields cann
ot overlap, dropping a field c
ontroller onto another field c
ontroller will cause

the dropped field to appear ei
ther entirely before or direct
ly after the other field, depe
nding on which is closer to then moved, the remaining field
controllers always move as far
to the left as possible to fi

Il up any empty

space. So if a field is moved
off of a row, all the fields t

o its right, move left to fill

in the empty space. If a fiel

d is dropped beforee moved to the right to make r
oom for the new field. Spacer
fields can be inserted

before a field to move it furt
her to the right.

Disabling Fields

Fields can be disabled by righ
t clicking on them and selecti
n REEL Field from J 15) llthe overall layout, but they d
on't display any information i
n the listing.

Enable Field

Disabled fields can be enabled
by right clicking on them and
selecting Enable Field from t
he popup menu. The field will
then display

FPS SE SE RT Sr SEA new row for placing fields c
an be inserted by right clicki
ng and selecting Insert Row fr
om the popup menu. A new en
LAI

then be inserted at point wher
e the mouse was clicked. Empt
rows do not affect the listin

g because any rows (even rows
that haveYaRie oration arc sUpPpIress
ed from the listing.

Remove Row

Empty rows can be deleted by
ight clicking on the row and s
electing the Remove Row optic
from the popup menu. The Rel
ve Row

option is not available if the
row is not empty.tly displayed category to the
default settings by right clic
king on the Browser Field Forrr
atter and select

Reset Format on the popup.
Reset All Formats

Reset All FormatsReset the formats for all cate
gories to their default settin

gs by right clicking on the Br
owser Field Formatter and sele
ct Reset All

Formats on the popup.

[SE] LUEcategory format. However, it
is possible to create a custom
format to display the
structure. This custom format
allow you to include members |
f the structure in its display

Create Custom Format
To create a custom format, rig

he mrlirk An Fhe farm attar wham€ and choose the Create Custol
Format

option. A new format will be c¢
reated with the same format a:
the Instruction/Data format.

In addition to all the standar

d fields, a

displayable field is created f

or each member and is availab
ein the Add Field submenua A LAR La
ect its tab, right click in th
e Browser Field Formatter and
select the Delete Custom Form
t option. The
format will revert to the gene
ral instruction format.
Save Custom Format
Newly created Custom Format:
re temporary and must be savethicket Lid
ram is

opened. To save a custom form
t, select its tab, right click

in the Browser Field Formatte
r and select the Save Custom F
ormat option.

The program must be saved aff
r saving a custom format.g of all fields along with a b
rief description of the type o

f information they display. Th
e category from which the
field can be accessed is also
provided. In some instances a
field can be accessed from mor
e than one category.

Field Name[DIT STela ToT)
Address

Instruction/Data; Open
pC]

Displays addresses in the progBytes

Instruction/Data; Open
pC]

Displays the bytes that make u
p an instruction or data

EOL Commentgod

Displays the end of line comme
la}

Field Name
Open Data

Displays the name of the dataFunction Call-Fixup

PLlelT

Displays the name of the Call-
Fixup associated with the func

<1,

Function PurgeDisplays the number of bytes p
urged from the stack for a fun
ction

Function Repeatable
Comment

hlat that will appear at all call
s to that

function

Function Signature

Pte lT

Displays the full function pro

RN rk TTR Jfunction name, return aata typ
e and parameters. In addition
lu)

presence of the following func
tion attributes will be indica
ted:

inline, no-return, and thunk.

If the function has varargs, t
he last

parameter position will includFunction Tags
lel

Displays all tags associated w
ith this function

LabelDisplays all labels for an add
ress

Memory Block Start
Plate

Displays information about theInstruction/Data; Open

Mnemonic

Instruction/Data; Open
eC]

Displays the name of the instrOperands

Instruction/Data; Open
eC]

Displays the input to the inst
ruction or the data value

Parallel ||Displays a parallel indicator
(e.g., ||) to indicate that t
LER Eh

instruction executes in parall
el with the previous instructi
[LR

Plate CommentDisplays the block header com
ent

PCode

Instruction/Data; Open
eC]

Displays the micro-code for anPost-Comment

Instruction/Data; Open
eC]

Displays the comment followin
an instruction or data

Pre-CommentpC]

Displays the comment precedil
an instruction or data

Register

lelction

Register Transition
Instruction/Data

Displays the values of registe
rs at the points where the val

ue

TL TT TnSeparator

Address Break

 

Displays a " RRL R GT
eis a gap between addresses

Signature Source

FunctionMUitales Lhe SOUTLeE-Ly pe ass
ciated with the function signa

Jel)

(i.e., DEFAULT, ANALYSIS, IMPC
RTED, USER_DEFINED).

Space

Instruction/DataDt A it
Spacer
All

Used to separate other fields.
Can optionally display static
[OdInstruction/Data

Indicates the current stack-po
inter offset relative to its s
tate at the

start of the associated functi
on. The field is only displaye
d for

USSR, SLICES] withinthat the calculation failed to
determine the stack depth (i.
Sette or Tete).
Thunked-Function

Function

TR WTREY VUSs
designated as a "thunk" functi
on (see Function Signature fie
Id).

Variable Comment

Variable

Displavs the comment for a vatVariable Name

Variable

Display the name of a variable
Variable Location

Variablebad odie’ dediat blo gledoindbling foi ibe dels

associated with a the variable
(e.g.

register, stack, memory, uniqu
e-hash, etc.)

Variable Type

VariableVariable XRef
Variable
Displays a list of addresses w

EERIE eal EE EET ChE]
variableVariable

Displays the number of referen
ces and offcut references to a
variable

pes

Instruction/Data; Open
yim fmDisplays a list of addresses w
hose instruction refers to thi
s address.

XREF Header

Instruction/Data; Open
Data

Displavs the number of referenALLE
address.

+

Instruction/Data; Open
eC]

Opens and Closes structures ar
d arrays.anit ea a
I}

Related Topics:

Code Browser

Browser Field Formatter 4/4

Listing Options 1/6be customized using the Tool C
ptions Dialog. These are the t
ypes of attributes that can be
customized:

Colors and Fonts

Fields, Highlights, and Select
[LH

Popupsonts for fields of the Listing

, open the Tool Options Dialog
and select the Listing Displa
y node in the Options tree. Th
e Listing Display panel will b
e

displayed as shown below.

This panel is divided into the

FE Wh. TaSets the default font, size an

d style for all text fields in

the listing. The font and siz

e apply to all screen elements
. The styles (bold/italic) wil

| be used as the default for e
ach

screen element unless individu
ally customized using the Styl
FET lauls lo cHER A LL A Ll EL
he customizable items that car
be displayed by the Listing.
Some of the elements are field
s such as the Address field. O
thers represent the type of
information in a field. For ex
ample, the operand field may ¢
ontain a label, scalar, addres
s, or constant. Still others ahiatal en aalattn aetanial: Like iliekl
is

label field. A label can be pr
imary or local. Screen element
s can be selected in order to
change their associated color
and font style.

The table below describes all
the Screen Elements and indic
tes the fields in which they aDescription
Field
Address

FACT IEEEEBackground*

N/A

N/A

Bad Reference Address

Addresses or labels that are n

ak LL SAOperand field
Bytes

Bytes
SCRE]

Comment, AutomaticEOL comment field
Comment, EOL
End-of-line comments
EOL comment field

Comment, PlatePlate comment field
Comment, Post
Below-line comments

Post comment fieldBelow-line comments
Post comment field
Comment, Pre

Above-line commentsComment, Repeatable
Repeatable comment at this cc
e-unit that is displayed where
there are references to

this code unit

EOL comment field

ETDisplays repeatable comment «
fined at code-unit referred to
by this code unit

EOL comment field

Constant

NumbersVperhahnu rieiu
SAIN

Labels that are at Entry Point
sin a program

Label field

External Reference,External addresses or labels
Operand field
Field Name

Name of elements in a structur
e or unionFlow Arrow, Active

Flow arrow when cursor is at t
he source

N/A

Flow Arrow, Not ActiveN/A
Function Name
Function name

Function Signature, Operands

PE TTParameter data types and nam
Function Signature field
Function Return type

Data Type returned by the func
tion

Function Sianature fieldLala EPI

Labels that are local to a fun
ction

Label field
Labels, Non-primary

Additional labels at an addresLabel field

Labels, Primary

Primary label at an address
Label field

Labels, Unreferencedot referenced

Label field

Mnemonic

Instruction or Data (Mnemonic)

Mnemonic fielddefaults for items in operand
ici]

Operand field
Registers

RegistersSeparator

Separator line (...) between a
ddress gaps

Separator field

VariableVariable Type, Variable Locati
on,

Variable Name, Variable Comm
Id

Version Track

Version tracking informationMEH

Cross reference addresses
Xref field

Xref, Offcut

Offcut cross reference addressOffcut references Xref field
Listing Options 2/6

*The Background is a special ¢
ase. Select this element to se
t the background color for the
Listing.

[e:1l]gis section.

EYEE LH

By default, all screen element
s use the style settings set i

n the Font section. To customi
ze individual screen elements,
select the screen element fro
m the Screen Elements section
and select the custom checkbc

CVE NE PE PALLY Ie Cry Ned italics checkboxes which can
be used to customize the styl
e of the selected screen
CERES

Swatches/HSB/RGB

These tabbed components pro
e a variety of ways to choose

a color for the selected scree
EEE Eh

SwatchesLACE Le A
rrently selected screen elemen
4

HSB

This tab allows colors to be c
hosen using the hue, saturatio
n, and brightness scale. The r
adio button selects which scal
e will be controlled by the sl
ider bar. Use theuses the large color box to di
splay all possible colors with
that selected value. Click in
the box to choose a

color.

RGB

This tab allows colors to be c
hosen by entering a red, green
, and blue value.Preview

The preview tab displays some
sample code using the current
set of screen element colors a
IIR

Listing Options 3/6LS
There are other customizable o
ptions in addition to color an

d font. To view or change thes
e options, open the Tool Optio
ns Dialog and then open the Li
sting Fields node in the Optio

LS

tree. Next, select the appropr
Jr FETT Ter TY RTthe options tor that field. Th

e available

Listing Field options are:

Address Field

Show Block Name -This option
repends the memory block nar
to the address in the address
field. For example, 0x1000800
might become .text:0x100080LR a LA
ses to be displayed with leadi
ng zeros to make the address s
tring length the same as the |
ength of the largest
address in that address space.
For example, in a 32 bit addr
ess space program the address
0x100 will be displayed as 000
00100.hi aah at) hati Bb ts rat chad oo
cify the minimum number of di
its that should be used to dis
play the address. The address
Ene RWIINI)

displayed with leading zeros t
o make the length contain at |
east this number of digits. If
the largest address in the ad
dress space has fewer significpadded to the size of the larg
est address. If the address ha

s more significant (non-zero)
digits than the minimum, it wi
Il be displayed with more
digits than the minimum, but v
ill contain no leading zeros.
This field is disabled and has
no Nice ii the SICUCTE halJustification -This option is
used to align the address text
to either the left or right s
ide of the field. If the text

is longer than the space alloc
ated for it in the field, the
text is

clipped to the opposite side o
f the justification.

FTO ecnes whether or not multiple ar
ray elements should be shown
n the same line in the browser
. If checked, this option will
use the Array

format, which typically only s
hows the address, the array in
dex, and the array values. Not
e: this only affects arrays wi

Ea e alan int =I eal atc le sale [D>ALAS LL SAS BELLE AR
Elements Per Line - The numbe
of array elements to show on
a line. This option in only en
abled if the Group Array Eleme
nts option is selected.
SCRA]

Byte Group Size - Bytes in the
byte field can be displayed i

n groups. By default each bytelala oid dhol of Seiibiuiiiad ey” Hialeah
miters. Use this setting to
change the number of bytes di:
played in a group.

Delimiter - The string to use

to separate groups. Normally,
this is set to " " (a single s
pace).

Display in Upper Case - Select
this check box if the hex digcdef.

Maximum Lines to Display - Sp
cifies the maximum number of
ines to use to display the byt
es. Any bytes that do not fit
into this number of lines will
not be displayed.

Reverse Instruction Byte Order
ing - The bytes will be displaapplies to instructions only.

All other code units are
unaffected.

Display Structure Alignment By
tes - Internal structure align
ment bytes will be displayed w
ith the bytes of the preceding
component. These bytes will b
ERIE RT TET

BR I |this applies to structure dat

a only. All other code units a
re unaffected.

[VT ESSE Teal ITT:

Use the following options to c¢
ustomize Cursor Text Highlight
IH

Alternate Highlight Color - Se
ts the alternate color used fo

r cursor text hiahliahtina DoRHNY Up a COI LHNOUSET Ullal
og.

Enabled - Select this checkbox
to enable cursor text highlig
hting.

Highlight Color - Sets the col
or used for cursor text highli
ghting. Double click on the co
lor bar to bring up a color ch
ooser dialog.mouse button will be used to
highlight text (Left, Right, M
iddle).

Scope Register Operand - Chec
this box to enable Scoped hig
hlighting of registers within
the operand field. If turned o
ff, cursor highlighted text wi
thin an operand field isEOL Comments Field

The EOL Comments field disple
s the end-of-line comment at t

his address. If there is no EO

L comment, it displays the rep

eatable comment. If there is n

o repeatable comment,

it displays the repeatable com

ulis hela] SECU addrt displays an automatic comme
[iia

Always Show the Automatic Co
ent - Normally automatic comn
nts are not shown if there is

an EOL comment, repeatable c
ment, or referenced repeatable
comment.

By selecting this option, the

IR Pl I, NAC RRent, repeatable comment, or re
ferenced repeatable comment.
Always Show the Referenced R
eatable Comment - Normally re
erenced repeatable comments
CREEL OH GE EREEL Re]
comment or repeatable comm
. By

selecting this option, the ref
erenced repeatable comment \EUL LOmmert Or repeatable Ct
ment.

Always Show the Repeatable C
ment - Normally repeatable col
ments are not shown if there i
s an EOL comment. By selectin
this option, the repeatable c
omment will be

shown even if there is an EOL
[ena aa =lalbil petit lit alte. ton J stb dhs
nt line is displayed on a line

by itself. By turning on word
-wrapping, comment lines are «
isplayed in paragraph

form.

Maximum Lines To Display - Th
maximum number of lines to
splay for a single comment. Co
mments that cannot be displayMaximum Lines To Display - Th
e maximum number of lines to
isplay for a single comment. C
omments that cannot be disple
ed within this number of lines
will be
truncated.ferenced Comment - Each refei
nced repeatable comment will
isplay an annotated address be
fore the comment. This addres:
can be double

clicked to go to the address w
here that referenced repeatabl
e comment is defined.

Show Semicolon at Start of Eac

[RRIF We SL NY TIEemi-colon.

Use Abbreviated Automatic Col
ents - When possible, the auto
comment will be made as sma
as possible. For example, whe
n showing an offcut string ref
erence, only

the portion of the string that

is used will be displayed.
Format CodeAL ER LA A A
mat Code options panel. The fc
llowing table describes the ef
fect of each format option. Th
e options for displaying
comments are listed in the ord
er in which the options are pr
ocessed when determining whi;
formatting comments are to be
displayed. (The order below ishat fatal odin cai Jathnali afie R da
he comment fields in the Code
Browser are Plate, Pre, and Po
st.)

Option

Show External Entry Plates

Field Type
Plate CommentPlate Comment
Plate Comment

Show Transition Plates
Plate Comment

Flag Function EntryFlag Function Exits
Post Comment
Flag Jumps and Returns

Post Comment

Flam CiihrmiiFima EntryPre Comment

Description

Display an "EXTERNAL" plate c
mment at each label which is r
arked as an

[SAIN

Display a "FUNCTION" plate co
ment at the entry point of eac
h FunctionALLA A LE SALI LA LAS AL
a call

reference to it.

Display an empty plate comme
when transitioning from betwe
en Instructions

and Data.

Display the pre comment:
TEEN

at the entry point of each Funbung ube’ Blaaiad® dad. Ra

easel Th [el a[e])) Exit fou
ERs tl

at the end of each Function, w
here MyFunction is the name o
the Function.

Display a post comment "- - -
line separator following all
unconditional jumps

and returns.BO EO RN EE]
reference to it.

Lines After Basic Blocks
Post Comment

Lines Before FunctionsLines Before Labels
Plate Comment
Lines Before Plates
Plate Comment

Display the specified number o

o£ Is rebr D7 reduce Trad lrnrols mre 01 SimInstructions.

Display the specified number o
f blank lines before each Func
tion entry point.

(Has precedence over Lines Be
ore Plates.)

Display the specified number o
f blank lines before each labe
led code unit

(instruction or data)I Rlallk hes Pelvic alll plat
e comment inserted

during formatting. (Has preced
ence over Lines Before Labels.

)

If comments already exist in t
he listing, then the options t

o show the comments fields fol
formatting are ignored. The oused regardless of whether cor
ments exist.

Applying the format options dc
es not alter the program.
Function Pointers

Display Function Header for Ex
ternal Function Pointers - Sel
ect this option to show the fu
nction prototype header withinFunction reference (enabled by
default).

Display Function Header for No
n-External Function Pointers -
Select this option to show th

e function prototype header wi
thin the listing for any point

er which has a

uh IGE to a FunctioDisplay Namespace - Select thi
s option to include the functi
on namespace as a prefix to th
e name of the function within
the displayed function prototy
pe (disabled by default).

Labels Field

Display Function Label - Selec

t this option to show function
PIER PL 1 RT ll TET RE ray Appear in the function signatur
e. If it's on, the function

name will also appear as a lab
el below the function header.
Display Non-local Namespace -
Select this option to prepend
the namespace to all labels th
at are not in the current Func
tion's namespace. Currently, t
his would onlv affect a1s 1h a falfiespalc OLNCT Liiafll L
he function that contains the
label's address.

Display Local Namespace - Sel
ct this option to prepend the
namespace to all labels that a
re in the Function's namespace

Use Local Namespace Override
Select this option to show a. This option is only availabl
e if the "Display Local
Namespace" option is on. The
ext box contains the prefix to
use for local labels.
Mnemonic Field

 

£3Show Data Mutability - Option
to display the mutability data
setting associated with each
data code unit (e.g., constant
, volatile).

Listing Options 5/6

Underline Fields With LLY prinve hidden (non-primary) refere
nces. This provides a quick vi
sual indication

that the field has references
and that you can double-click
the field to go to the referen
ces.

Operands Field

Add Space After Separator - OyAlways Show Primary Referenc
- Option to force the display

of the primary reference on al

| operands. If a suitable sub-
operand replacement can not t
identified the

primary reference will be appe
nded to the operand preceded
va"=>"pnrefixeal LEE a aL A
orm of the label name for dyna
mic String data types in the d
isplay of operand references (
CX]

STR_01234567).

Display Non-local Namespace -
Select this option to prepend
the namespace to all reference
s that are not in the currenthn hii lad Gh alt ob Bl
label that is not global, but

is in a function other than th

e function that contains the c
PLEhlahB eR

Display Local Namespace - Sel
ct this option to prepend the
namespace to all labels that a
re in the Function's body.

Use Local Namespace Overrideinstead of the function's name
. This option is only availabl

e if the "Display Local
Namespace" option is on. The
ext box contains the prefix to
use for local labels.

Enable Word Wrapping - Optiol
to wrap strings in operand lin
es that are too long to fit incur where spaces exist

in the string.

Follow Read or Indirect Pointe
r References - Option to follo

w referenced pointers, for rea
d or indirect reference types,
to show pointer's referenced
symbol instead of

symbol at pointer. When applie

CE Ae nr | TatuInclude Scalar Reference Adjus
tment - Option to include a sc
alar expression which will ind
icate the relationship between
a replaced scalar and the ass
ociated reference offset

when the offset does not matcl
the scalar value.

Markup Inferred Variable Refer
ences - Option to markup instrA LL AS LEAS ER CR
bles can be inferred. This cor
responding

stack/register markup option n
ust also be enabled for this o
ption to have an effect.
Markup Register Variable Refer
ences - Option to markup instr
uction operands where explicit
[EIR ER CHAE ER i]Liinalucintinniibicduny uibad
replaced within instruction op
erands to reflect an associati
on with a register parameter/v
ariable if one can be determin
ed. Inferred register referenc
es will be included if the
Markup Inferred Variable Refer
ences is also enabled.

Markup Stack Variable Referenack references exist. When thi
s option is enabled, elements
may be replaced

within instruction operands to
reflect an association with a
stack parameter/variable if o
ne can be determined. Inferred
stack references will be incl
uded if the Markup LISEeMaximum Length of String in C
fault Labels - Sets the maximu
mn number of characters from
String to include in dynamic
String labels in operand refer
Ele
Maximum Lines To Display - Th
maximum number of lines use
to display a string in an oper
Pl CF rr rg grt 1)lines will be

truncated.

Show Block Names - This optio
prepends the memory block n:
e to labels in the operand fie
Id. For example, the instructi
on "call printf" becomes "call
text: printf".

Show Offcut Information - Shou
s additional information for oARI LULA LAE ER A LAA LASS)
the offset. For example, the s
tring "foo_bar", with

an offcut reference to "bar" w
ould look like:

PE PE EI EY

with this option on, and with
it off would look like:

ElEY

Underline References - Optionhalialibcdianinl Jalalabad hit cis Mahuta
tify those operands that have
references and double-click to
go the reference. Select

one of the following choices:
Hidden - Underline the operanc
if it has a non-primary refer
ence (i.e. there is no visible
evidence that the operand has
a reference.)None - py not display any unde
rlines.

You can change the color of th
e underline from the Listing D
isplay options panel; select U
nderline from the Screen Elem
LIESdisplay the raw PCode directly
in the Code Browser (i.e., de
tailed varnode specifications
are provided).

Maximum Lines to Display - Th
maximum number of lines use
to display PCode. Any addition
al lines of PCode will not be
shown.

A VSlor used to highlight aitreren
ces between two programs.
Highlight Color - Sets the Bro
wser Highlight color.
Selection Color - Set the Brow
ser Selection color.

RGEC]LA LLL LIAS Ea LL LAS BE 1° I

o use for separating multiple
pCIEN

Display Local Block - Prepends
the name of the memory block
containing the XREF source ad
ress to each XREF.

Maximum Number of XREFs To
play - The maximum number o
ines used to display XREFs. AdLodi dil
Display Non-local Namespace -
Select this option to prepend
the namespace to all XREFs th:
tare not from an instruction
within the current Function's
body. Currently, this

would only affect XREFs that o
riginate in some other functio
iBnamespace to all XREFs that al
e from the current Function.
Use Local Namespace Override
Select this option to show a
fixed prefix for local XREFs i
nstead of the function's name.
This option is only available

if the "Display Local

Namespace" option is on. ThePopups

Popups are transient windows
sed to display additional info
rmation about the item over wl
ich the mouse is hovering. The
re are options for enabling va
rious types of popups and for
resizing the popup window.

TI PT a€ popups, open the lool Optior
s Dialog and then select the L
isting Popups node in the Opti
ons tree.

Reference Code Viewer - Show:
the listing at the referenced
location as a popup.

Truncated Text Display - Displ
ays truncated text as a popup.
Reference Code ViewerTO VIEW DI LhHalyge Le slec OF
popup windows, open the Tool
ptions Dialog and then open th
e Listing Popups node in the O
ptions tree. Next select the R
CECE ERE

all

Dialog Height - The height of
the popups in pixels.

Dialog Width - The width of thProgram Differences
The Diff Tool 1/10

The Code Browser can be used
o view a second program along
ide the tool's program to dete

rmine the differences betweenghts code

units in the second program to
indicate there is a differenc

e. Highlighted code units in t
he second program can then h
e their differences applied to
the tool's program causing it
to change. The

ultimate goal is to apply someol's program in order to get a
nother user's changes into you
r program.

Opening and Closing the Secor
Program

The Open/Close Diff View icon
in the Code Browser tool bar i
s used for both opening and cl

OT WR DF oS J WH LS SY}two ways to open the Diff too
I.

The other is the menu action,
CEE

Program Differences... which i
s described later under Viewin
g Program Differences.
Opening

When there is only a single pr
odaram displaved in the Code BALA]

in the tool bar above the prog
ram to open a program for Diff
. You will be prompted to
select the second program and
then prompted for Diff setting
s just as when viewing progran
differences .

Closing

When you are done working witw LMA SE Ey eee Sel
closed and the Code Browser ri
turns to displaying only the t
ool's program.

Bring Diff View to Front

If you navigate away from the
current diff session to anothe

r program tab, then clicking t
LC)[eI and [0 associated pl
are

action will make the diff sess
ion be the active program tab.

Viewing Program Differences
A Diff can be opened from the
menu action, ToolsDiff tool. The other is the O
pen/Close Program Diff icon
Browser tool bar which is desc
ribed above in Open/Close Diff
View. The following describes

using the menu action to oper
the Diff tool.

in the Codee Browser tool, do the followi
ng to view a second program's
differences.

1. From the Code Browser, sele
ct Tools

Program Differences... .

2. The Select Other Program di
alog is displayed.

3 From the Select Other Proarat LL A A LA A a) ol
d with the tool's program.

The second program must have
he same address spaces define
. In other words, they should
be the same type of program (i
.e. based on the same program
language).

If you wish to Diff against a
previous version of a versioneRU Ld kanal Ra Bd A Fh yi baie ofl
the versioned program from th
tree. Next select the desired
version of the program from th
e history list on the right si

de of the dialog.

VEE CRG RGR TET Rife Tol
he history list on the right sThe Diff Tool 2/10

4. Click the OK button.

5. The Determine Program Diff
rences dialog is displayed. Th
is dialog is displayed wheneve
r you are going to determine t
he differences between two pr
grams. To get all the differensure all the check boxes in th
e Do Differences On area have
checks and the check box in th
e Address Ranges To Diff shoul
d not have a check as shown
LECH

The check boxes allow you to |
imit the types of differences

AL TR 0 LT SOT TWEE || St —the program. lo learn more, se
e Determine Program Differenc
s Dialog.

6. Click the OK button to dete
rmine the differences.

7. An In Progress dialog appea
rs while the differences are b
eing determined. Upon comple
on the dialog disappears and t
he code unit's in the second pWil pe
[Ie LIIIe[s <= R

The selected program is displa
yed as the second program in t
he browser. Only the portion o
f the second program that mat
hes the address set of the cur
rent view is displayed. Highli
Lelefferences.

ALE CLR VE ECE
ogram Diff where differences b
etween two programs are high
ghted.

 

The Diff Tool 3/10splayed on the left-hand-side
of the Code Browser. The secor
d program, where the differenc
es to apply are obtained, is d
isplayed on

the right-hand-side. Markers i
n the right margin of the seco
nd program give an indication
of all the positions in the cuams. The view

of both programs is still cont
rolled by the program tree for
the tool's program. In other
words, the second program's vi
ew will only show addresses th
at match those viewed for the
Jeli]

program.Notice that the difference hig
hlights are light orange above
. The selected difference is g
reen. These are only the defau
It colors. They can be changed
from the tool's Options dialo
g

Options..., open the Listing F
ields folder and select SelecLLL ACL SR A

Blank space is added to each p
rogram as necessary to align t
he addresses between the two
rograms. The vertical or horiz
ontal scrollbar of either prog
ram causes both programs to s
roll in a

synchronized manner. Also, ch.bhi! bd hanbiic obi satis
other program.

The Program Diff colors the tw
o programs where they differ.
These differences can then be
applied individually from the
second program to the tool's p
rogram. Applying a difference
changes

the tool's program so it matchultimate goal is to apply som
e or all of the differences fr

om the second program to the
ool's program.

Program Diff is most commonly
used to compare different user
s' copies of the same program.
With versioned programs, it c
an also be used to determine dthe same program. When work
on a project as a team, each
person can make changes to h
own copy of a program file. T
he Program Diff can then be us
ed to determine where the pro
[clu

differ. Changes that another t
eam member has in his progra

Ae FY pL LES‘I'he toolbar above the displaye
d programs provides buttons fc
r use with a Program Diff. Cli
ck on the icon below to go to
the help section that gives de
tails of that feature.

Apply the selected differences
from the second program to th
e tool's program.

Apbplv the selected differenceALLA A A

Ignore the selected difference
s and go to the next highlight
ed difference block.

Show the details of the differ
ences between the programs a
the current cursor location.

Go to the next highlighted dif
ference block.

Go to the previous highlightedhd ti lbsotul hay Laelia etelitel alee
Settings dialog.

Determine the differences betv
een the programs.

Open/Close the second prograr
and the Program Diff.

Determine Program Difference:
Dialog
Whenever you initiate a Prograo control the following settin
gs:

Do Differences On : the types
of differences to be determine
d and highlighted by the Progr
am Diff. The Select All button
is a convenience for selectin

g all of the check boxes for
FUSER types Likewise, thifference type check boxes.
Address Ranges To Diff : indic
ates the addresses to be check
ed for differences.

Limit To Selection : whether o
r not the Program Diff should
be limited to the current sele
ction in the tool's program.Pressing the OK button will ch
eck the indicated addresses fo
r differences. It then highlig
hts the code units in the seco
nd program where differences
ere found. While the Program LC
iff is

determining the differences, a
n In Prodaress dialoa is displaALRARLLIR AIRES AE dL RE RL LA |
ogram Differences dialog withc
ut performing the Program Diff

If the two programs being com
ared are large, determining pr
ogram differences can be time
consuming. If you are not inte
rested in all of the differenc

es in the program, you can redhii nth dh ale ai boi dlc lif
determine differences by remc
ving some types of differences
being determined or by deterr
ining differences on just a po
rtion of a program.

Do Differences On

The Do Differences On area spe
cifies the types of difference

s that will be determined. Plashould be detected.

Bytes - detect any code units
that have memory bytes that d
ffer between the programs bei
g compared.

Labels - detect any code units
where the labels differ.
Possible label differences areLabels named differently
Different labels could be mark
ed as the primary label

Same named label, but with di
ferent scope (parent namespac
). For example, one program's
label is local to a function a

nd the other label is a global

label.
ETE Rw rr J TRE Ee LL me€ program's label was named &
default and the other label w
as named by the user.

One program's code unit with ¢
label could be an entry point
and the other program code ul
it is not an entry point

Code Units - detect any code u
nits where the code unit or eq
uates differLACH

Different instructions.
Instruction in one program and
Data in the other program at
the same address.

Different equates on the instr
uction in each program.
Different data types when data
is defined in both programs a
t an address.nits where the references diff
Ca

Possible reference differences
are:

One program has a reference a
d the other doesn't.
References are not to the same
address.

References are not on the sam

 

Ah ta ct i dala A danik, External) are different.
Program Context - detect any c
ode units where the values of
the program context registers
ILIA

If the two programs contexts d
on't have the same registers d
efined, the program context is
disabled and can't be comparets where the comments differ.
Possible comment types are:
End of Line Comment
Pre-Comment

Post-Comment

Plate Comment

Repeatable Comment

The difference could be that a

comment exists in one progra
Irs fpr te 1] | Camel We leIcular comment type Is not exa
ctly the same for the

two programs.

Bookmarks - detect any code u
its where bookmarks differ.
Properties - detect any code u
nits where User Defined Proper
[Eh CTEnits where Lhe runcuors uiie
8
Possible differences are:

The Diff Tool 5/10

Function in one program and n
tin the other.

Function comment differs.
Addresses that make up the fula ibe a hea Tail lp al
unction name, return type, or
parameters differ.)

Parameters differ by name, dat
a type, size or offset.

Local variables differ by name
, data type, size, or offset.

Bll gel SECC ER

Stack Frame size differs.
Whether or not the stack growsWhen the Determine Program |
ferences dialog is initially d
isplayed, all the Differences
check boxes are checked. This
indicates that all the types o

f differences will be detected
and displayed.

Address Ranges To Diffwhere program differences wil
| be determined. If the two pr
ograms have different address
sets, then only the addresses
that the

two programs have in common
n be compared. The addresses
here differences are determine
d can also be limited to a set

UE JL rent 4 oe LLL[Sine eae ly]

If there is a selection in the
tool's program when you dete
mine differences, the address
set where differences are dete
rmined can be limited to the a
ddresses in the selection.
Selecting the Limit To Selecti
on box, limits the differences
to the selection's addressesUl aha Multiple Froygraltt fabs
Only one Program Diff can be
erformed at a time. However, y
ou can view another program
ing the tabs in the Listing Vi
ew while a Program Diff is act
ive. This will not

terminate the current Diff. Th
e Diff will reappear when you
change back to the tab for theRit

While a Program Diff is active
, the Diff View icon

is visually pressed down. If t
he Diff is being performed on
a program that is not being ac
tively displayed (in a tab oth
er than

the current tab), then pressinthe Diff to the front.
If you attempt to start a Diff
using Tools

Program Differences... in the
tool menu and a Diff is alread
y being performed, the status
bar will indicate the name of
the program

[UC Sl has a Diff.Selecting the Diff View icon
from the Listing toolbar when
the Program Diff is actively b
eing displayed.

Selecting the Close Window icc
il

from the Listing toolbar when
the Program Diff is actively b
eing displayed. (Normally this

PI Ye gr WI ny LADiff 1s active this closes the
Diff.)

Closing the Diff's program via
the Tool's menu, File

Close, when the Diff is active
ly displayed. (In this case th
e Diff is closed along with th
CYTE TET TEY B)

Exiting the Tool or Ghidra wil
| also terminate an active DifHovering the mouse over the D
ff View icon provides a toolti

p indicating whether the curre
nt action is Open Diff View, C
lose Diff View, or Bring Diff
View to Front.

Diff Apply Settings
The Diff Apply Settings dockabbilder Sn a

s get applied from the second
program to the tool's program,
and how each type gets applie
d.

For each type of difference, y
ou can select one of the follo
wing apply settings:

Ignore - do not change the sel
ected code units in the tool'sReplace - changes the tool's p
rogram to match the second pi
gram for this type of differen
ce.

Merge - (Only available for La
bels and Comments) changes t
tool's program by adding this
type of difference from the s
econd program to what is alreahich label is set to primary.
Merge & Set Primary - (Only av
ailable for Labels) merges lab
els from program 2 into the cu
rrent program and sets the pri
mary label as it is in program
2, if possible.

The following types of differe

IT 1 Sl I TR TeBookmarks - all categories or
bookmarks.
Bytes

Bytes

Code Units - includes code uni
ts (instructions & data) and e
quates.Comments - Plate, Pre, End-of-
line, Repeatable, & Post comm
[1H

Functions - functions (include
s their associated stack frame
s).

& Function Tags

Labels - labels or symbols.
Program Context - program corhi ssssoiunldnibiaiiion Sinks ivi
erties that have been added to
the program by plugins.
References - Memory, External,
& Stack references.

The Diff Apply Settings toolba
r has a Save as Default icon

to save your current Diff Appl

y Settings to the tool as your
new defaults. When you selectdefault Diff Apply Settings.
Whenever you start a new Diff,
the current Diff Apply Settin
gs will get set to the default
settings for that Program Dif
ji

you determine the program dif
erences again for an existing
Diff a] the lL Progrgs will not be affected by the

LECTIN

The Default Diff Apply Setting
s can also be set by changing

the Diff Default Apply Setting

s tool options .

The Diff Apply Settingstoolbar
menu

a Dern ods cs Boats rammee Four 7okems reat i Fare:. I'hey are:

Set Ignore For All Apply Setti
ngs - Changes all the settings
to Ignore. Before you can app
ly anything you would need to
individually set at least one
difference type's setting

to Replace or Merge.

Set Replace For All Apply Sett= LW REPIalc.

Set Merge For All Apply Settin
gs - Changes all the settings
to Merge that allow merging ar
d all others are changed to Re
place. Labels will be set to M
erge & Set Primary.

Getting New Differencesopal alla offi by Lh Kl Satta. 5th al
Changes were made to the too
s program directly (not by app
lying a difference) since you
last determined program differ
[EhI=CES

The second program has been
anged since you last determine
d program differences.

You want to determine differenDiff used. For example, you in
itially determined program dif
ferences limited to a

selection and now you want to
know differences for the whole
program or for a different se

t of selected addresses.

When a second program is alre
dy REECE nl Ri Code Brow:es between that program and t
e tool's program.
i

From the toolbar above the sec
ond program, select the Get Di
fferencesbutton.

or

Press the right mouse in the s

I PRLAIR AE LE ALR Tr TEM[e-N
2. The Determine Program Diff
rences dialog is displayed.

3. From the dialog, select the
types of differences to be de
termined and the addresses to
check for differences.

4. Click the OK button.

An In Progress dialog appears
while the proaram differencesEl ALLEL LAS BRASS LL RA
ences, the dialog is removed a
nd the differences are
highlighted in the second prog
[CIN

Limiting the Diff to the Brows
Clg-CITelale]))

The Limit to Selection box in
the Program Difference SettingRubtucilbabiibtag Ladue alle cii coma)
while there is a selection in
the tool's program in the Code
Browser. When the box is chec|
ed the differences will only b

e determined for addresses in
that selection. This limits th

e differences being highlighte
d and manipulated by the
Program Diff to only those thait the Program Diff select the
target code units in the tool

's program in the browser and
check the Limit to Selection c
heck box in the Program Differ
ence Settings dialog. Notice t
hat the Address Ranges To Diff
area changes as you check or
[LIES lu) Rll toetween the two programs and

ose in the selection.

Once you press the OK button «
n the Program Difference Setti

ngs dialog, the Program Diff i

s performed against the indica
ted address ranges (address se
t). You can make a

selection in the tool's progra

a  . JT TT I Ato get differences againsta d
ifferent address set.

Navigating Differences

When viewing program differer
es in the CodeBrowser, you car
navigate on difference blocks
. A difference block is a cont
iauous droup of one or more hihe seLonu progralti. A Ullierer
ce block can be a single code
unit where a difference was fo
und if the code unit before an
d after it did not have a diff
erence. There can be multiple
code units in a difference blo
ck when each of the code units
next to each other has a diff
erence. To move to the next/prhii att stihl lh i al a leicht al h
arrow keys on the keyboard or
click the mouse on the desired
code unit.

Next Difference

Selecting the Next Difference
button

moves the current location in
the Program Diff to the next dIf only part of the program is
in the current view, the next
difference may be outside the
current view of the program.
If this is so, then navigating
will add the

fragment, with the next differ
ence, to the view.The Diff Tool 7/10
Selecting the Previous Differe
nce button

moves the current location in
the Program Diff to the previo
us difference block.

VE orn Dag as bb oF TR Samp bis bre Lplous difference may be outside
the current view of the progr
am. If this is so, then naviga
ting will add the

fragment, with the previous di
fference, to the view.

Marker Margin

Clicking on a difference marke
rin the right margin will nav
igate to that differenceEAL IEA MAS AT AS EE SE
may overlap in the right marg
in. Therefore, it is best to u

se the markers for navigation
to a region where there are di
fferences and

then use the Next Difference o
r Previous Difference buttons
to navigate to the next/previo
us difference block.ha

Automatically Selecting a Diff
erence Block

Using the Next Difference

or Previous Difference

to navigate to a highlighted d
ifference block selects the co
de units contained in that dif
ference block. Leftdifference block to become sel
ected. You can then right mous
e click and the popup menu ap
EYEE IRC]

apply the selection.

Manually Selecting Differences
Differences can be selected wi
thin the right-hand Diff listi

al] as follows:on the highlighted difference
block. It will become selecte
d, so it can then be applied.
Left mouse clicking on a code
unit that is not highlighted a
s part of a difference block w
ill clear the current Diff sel
Elen

To select individual code unit
rT TH ALT Ee a et 1the second program as you nor
ally would in the Code Browser
. If you

select code units that are not
highlighted as a difference,
they will automatically be rem
oved from the selection when t
he mouse button is released. W
hen the

cursor is released the selectAll) AL LLL LL ARES AL
ighted differences in the sele
ction.

ALES GR CEL RTO ER id
mouse click can be used to ad
d/remove a code unit from the
selection.

The Shift key along with a lef
t mouse click can be used to e
xtend the selection.bia bi iteudiboiot bt calito ll hbo J
rom the second program to the
tool's program, only selected
code units in the current view
will be applied.

Select All

Invoking the Select All Differ
ences from the second progran
s popup menu, selects all the
currently highlighted differention From the Tool's Program S
Clee)

The selection from the tool's
program can be used to select
some of the differences in the
second program. While viewin
program differences in the Co
de Browser,

make El ERLE] in the tool'sFor example, you can use this
to select all the differences

in a subroutine. First select

all the code units in the tool

's program that make up the st
broutine. The Set Diff
Selection icon

will become enabled. Select th
e Set Diff Selection icon . Al

DRT, HL cr. TL ig. (TRIn the second program
become selected. The selectior
of differences can then be ap
plied or ignored.

Applying Differences

Applying a difference, changes
the tool's program to match t
he second program in the Prog
am Diff for each tvbe of diffeLE LL A I LA RA)
types of differences get appli
ed from the second program to
the tool's program (see Apply)
. It can also control whether
some types of differences repl
ace what is in the tool's
program or whether they are nv
rged into the tool's program.
Only the highlighted code unitatte ub chou Haut tide Secon li
ave their differences applied.
To apply a selection

1. Select Differences in the s
econd program.

2. Make sure the difference ty
pes you want to apply have the
ir boxes checked in the Progra
mDiff Settings dialog.

3. Click the Apply Selection bor
Press the Apply Selection hot
[SA

or

Click the right mouse on the h
ighlighted difference and sele
ct the Apply Selection button.
Remember all the types of diff
Leh that Ll] LEC) ReplaceIl be applied for the selected
code units.

When applying differences, cor
ments and labels can be replac
ed with the second program's «
omments or merged with ther
erging comments or labels in t
he Program Diff results

in the union of the two progra

[Lr [AExample:

A code unit in the tool's prog
ram does not have any comme
or labels. The code unitin t

he second program has a pre-c
mment and a bookmark. All Ag
y boxes are checked.

A code unit in the tool's proEAL Er Re A LLL Lh]
the second program has a pre-
omment and a bookmark. All A
ly boxes are checked.

Apply a selection containing t
he code unit. The pre-commen
and bookmark appear in the pr
gram in the Code Browser.
The Diff Tool

Say the Bookmarks box in thehit Biota Eile dic ke acini ale alo ale
ments box was checked when |
difference was applied. The p
re-comment would

appear in the Code Browser's [.
rogram, but the bookmark wot
il

Applying Differences and Goin
ACDext difference in a single ste

p (see Apply and Next). It can
also control whether some typ
es of differences replace what
5

in the tool's program or wheth
er they are merged into the to
ol's program. Only the highlig
hted code units in the seconddifferences applied.

To apply a selection and go to
the next difference

1. Select differences in the s
econd program.

2. Make sure the difference ty
pes you want to apply have the
ir boxes checked in the Diff A
pply Settings dockable compor

wigt button

in the toolbar.

All the types of differences t
hat were last selected under A
pply in the Program Difference
Settings dialog will be appli
ed for the selected code units
. The Diff will then navigate

ld

the next difference and selectIgnoring Differences

Ignoring a difference indicate
s you no longer want the curre
nt Program Diff to highlight t
he code unit. The Diff then na
vigates to the next difference

Only selected code units in th
e second program of the Progr:Rsbaeils 0 hibhioduuilial Frit tt Ait fol
be made on an entire highligh
t block or individual code

units in one or more differenc
e blocks. (See Selecting Diffe
rences).

Note: All versions of Ghidra b
efore 7.4.X did not navigate t
o the next difference after ig
ATs Aecond program.

2. Click the Ignore Selection
button

in the toolbar.

or

Press the Ignore Selection hot
[SA

or

Click the right mouse on the hThe selected code units will b
e ignored. This means they wil
I no longer be highlighted as
a difference. The Diff will th
en navigate to the next differ
ence and select it.

Once a code unit is ignored, i
t will no longer be marked in

IF NR TL meet LI TRL a TTted. If you Determine Program
Differences, any

previously ignored items where
there are still differences w

ill once again be highlighted.

Viewing Difference Details at
a Location

When viewing two programs in
he Code Browser it is possiblalt the Curfenit prograln 10Latio
n. The Diff Details dockable c
omponent displays details
indicating differences, if any

, between the two programs co
e units at the current program
location.

To view the difference details
at a location:

1. Click on the code unit of ibutton

in the tool bar.

or

Press the right mouse button o
n the code unit of interest an
d select the Location Details
button.

2. The Diff Details dockable c
omponent is displayed indication.

The following image shows the
Diff Details dockable compone
t. In Program 1 of the Diff "M
ylLabel" is a global label, whe
reas in Program 2 "MyLabel" is
a local function label.When the Automatically Updat
Details check box is selected,
the Diff Details will update
automatically to show the diff
erences at the current locatio
n whenever the current
address changes. This can be u
seful when you are navigating
through Differences and need t

I eR A Te8/10

When the Only Show Expected
ifference Types check box is s
elected, the Diff Details will
only show Diff Details for th

e types of Differences that yo
u chosealll
esl
when you determined your diff
rences. If this box is not che
cked, you will see all types o
f differences that exist at th
e location regardless of wheth
er it was one of the types of
differences you were seeking.
If you modify the program attbiti Moi i i aes dR i
ess the Refresh button

Why view the difference detail
s at a particular program loca
tion?

The code units appear differen
t between the two programs, b
t are not highlighted.

If a particular type of differ
ence was not selected when diIf the thing that appears diff
erent is due to a difference e
Isewhere in the program, then
it will not get highlighted. F

or example, XREFs are not a di
fference where they are
shown. The code unit where th
reference is from is differen

t, not where the reference isJH

The code units appear the sam
between the two programs, bu
are highlighted. This can hap
pen when there is something d
fferent about the code unit, b
ut that thing is not
displayable. For example, refe

rences are not visually displa
TE rl ny re tar etTerence Is from.

The location is highlighted, b
ut you want to know exactly wl
at is different here.

In other words, are there othe
r types of differences here be
sides the boxes | checked in t
he Program Difference Settings
dialog? Remember, only the d
Ea a ale R aie CR ins Rus 21049 Wil PE applied il all ApPpPI
y Selection is done.

Diff Apply Settings Tool Optio
LS

The Program Diff adds Default
Apply Settings options to the
tool. To view or edit the opti
on settings:

From the tool's menu select EdLabatt hb Be tit nd achiai ud

 

baud sli

the Tool Options Dialog.

Open the Diff tree node.

Click on the Default Apply Set
tings tree node to view its op
tions.

Each time a new Program Diff |
egins, the Diff Apply Settings
will have their values set to
the default ones specified byEach option will have one or m
ore of the following settings
available:

Diff Apply
Setting

FunctionalityDo not change the selected coc
e units in the tool's program
for this type of difference.

Replace

Change the selected code unit:
in the tool's program to matc
h the second program for this

ARR ETMerge

(Only available for Labels, Co
mments and Function Tags.) C
nge the selected code units in
the tool's program by

adding this type of difference
from the second program to w
at is already in the tool's pr
oaram_ For Labels this willLO prithialy.

Merge & Set
Inte

(Only available for Labels.) M
erges labels from the second p
rogram into the tool's program
for the selected code units

in the the Diff and set the prLa th

The Default Apply Settings Opt
ions contains the following op
JT EH

Option

FunctionalityControls whether bookmark dif
erences will be applied. Can b
CRT LINC Tg

Replace.

Bytes

Controls whether byte differen
ces will be applied. Can be: |Code Units

Controls whether instruction,
data, and equate differences w
ill be applied.

Can be: Ignore or Replace.

End Of Line Commentsomment differences will be apj
lied. Can be:
Ignore, Replace, or Merge.

[LleI-I

Controls whether function diff
erences will be applied. Can b
CRT LINC

Ele RRELAIS Ee

Controls whether function tag
differences will be applied. C
an be: Ignore,

Merge or Replace.

Labels

Controls whether label differeprimary label. Can be: Ignore,
Replace, Merge, or Merge & Se
t Primary.

Plate Comments
Controls whether plate comme

differences will be applied.
Can be:Post Comments

Controls whether post commer
differences will be applied. C
an be:

Ignore, Replace, or Merge.

Pre Commentsn be:
Ignore, Replace, or Merge.

[dl TET NETS

Controls whether program conf
xt register value differences
will be

applied. Can be: Ignore or RepLd (ele gu EH]

Controls whether user defined
property differences will be a
pplied. Can

be: Ignore or Replace.
References

Controls whether reference difLARC LLL AS
Replace.

Repeatable Comments

Controls whether repeatable cc
mment differences will be appl
ied. Can be:

Ignore, Replace, or Merge.Repeatable Comments

Controls whether repeatable cc
mment differences will be appl
ied. Can be:

Ignore, Replace, or Merge.

To change an option, click onPE setting from the list

The Diff Tool 10/10

Problems/Limitations

You cannot undo an Ignore Sel
ction

[Chl Undo of an A ply ELSe-highlight the code units wit
LECIIC COICO ET

were ignored. If you want to g
et back differences after undo
of an Apply Selection

or if you want all ignored dif
ferences to no longer be ignor
ed, you must re-Diff the progr
ams

ny ealartine Fhe Cat Niffaram~Provided by: Program Diff Plug
in

Related Topics:

Code Browser

Decompiler

Decompiler 1/9ne UeLOImpHer piugin 1s a sop
histicated transformation engi
ne which automatically conver
s the binary representation of
individual functions into a h
igh-level C

representation. The Decompile
presents a view of a program
which is interactive and dynarr
ically updated as the user addthe program. A Decompiler wir
ow maintains the corresponder
e between the C representatior
and the assembly representati
on displayed in the Code Brows
er window, to the

extent possible. The window al
lows instant visual associatio

n and navigation between C lalons.
To display the decompiler winc
ow, position the cursor on a f
unction in the Code Browser, t
hen select the

Window menu in the tool.

icon from the tool bar, or the
Decompile option from thees of the decompiler include:
Recovers Expressions: The dec
mpiler does full dataflow anal
ysis which allows it to perfor
m slicing on functions. The mo
st tangible benefit to the use
ris that

complicated expressions, whicl
have been split into distinct

J A ome LP RLInstructions by the compiling/
optimizing process,

are reconstituted into a singl

e expression again by the deco
mpiler.

Recovers High-Level Scoped Va
iables: The decompiler underst
ands how compilers use proces
or stacks and registers to imp
lement variables with differenWILT a TUnCLUon. Yalta=liow a
llows it to follow what was or
iginally a single variable as

it moves from the stack, into
a register, into a different r
egister, etc. Thus it can
effectively recover the origin
al programs concept of a varia
ble, minimizing the need to in
troduce artificial variables iThe decompiler understands tt
parameter passing convention
of the compiler and can recon
struct the form of the origina
I function call.

Uses Data type, Name, and Sig
ature Annotations: The decomy
ler automatically pulls in all
the different data types andfunctions, and the C output is
altered to reflect this. High
-level variables are appropria
tely named, structure fields a
nd array indices are calculate
d and displayed with

correct syntax, constant char
pointers are replaced with app
[CLUE quoted LELIeE etc.on, the decompiler does its be
st to fill in information from
what it does know. Variables
whose data type

has not been explicitly labele
d by the user can often by rec
overed by seeing how the varia
ble is used or by allowing the
known data types to propagat:ecover Structure rields: Theda
ecompiler can be leveraged to
recover references to a struct

[IN

Variables

The decompiler will attempt to
combine different locations (
stack, memory, register) for v
ariables within a function DaAEE

gathered automatically from se
veral sources. Any annotated f
unction signatures, both of th
e function and of any sub-func
tions it calls, provide type i
nformation. If

the function contains referenc
es to global memory locations
that have a data type appliedhaba Shade cl al 2 fatal ahasilintelastel
the function

can be annotated directly with
data types. The user can prov
ide data-type information to t

he decompiler by annotating a
| these sources. The more info

rmation that

can be provided the better the
produced C-code will be.ng local type propagation. Typ
ically, assigning data types t
o a few key variables dramatic
ally improves

the readability of the C-code,
as propagation will accuratel
y fill in all the other data t
ypes. Assigning types in funct
ion signatures and to global vof their effect across multip

le functions simultaneously.

If you have C-header files for
an API a program is using, th
ere is a prototype C-Code pars
er than can extract the Data T
ype information from C-Code a
d

create a Ghidra Data Type Arct

Tonng Pl rnin mde ll Ll ahandles most C syntax includin
g macro expansion. The functic
n signatures

and data types extracted can b
e applied to the program. Just
open the archive in the Data
Type Manager window, select t
e archive, right mouse click,
and select

Apblv Function DataTvbes GhiAEA A EL A RAS A BR LRA LS
s API functions and data types
automatically.

Parameter Variables
Specifying data types for func
tion parameters is especially
useful. A function that has da
ta types defined for its param
eters will propagate these typ
EAL ROSpecifying data types for fun
ction parameters is especially
useful. A function that has d
ata types defined for its para
meters will propagate these ty
pes into the

variables of any calling functDecompiler 2/9

C variable argument conventio
s, or varargs, are are also su
pported. For instance, if the
user has identified the standa
rd C library routine printf, t

he signature can

el RUC] Sl LS ACL] ley sr will display the correct num
ber of variable arguments.

Function signatures can be apy
lied from a Ghidra data type d
atabase. Windows data types a
d standard C library function
signatures are included with t

he standard
I Far. IInternal Decompiler Functions
Occasionally, the decompiler mr
ay use one of several internal
decompiler functions that don
't get transformed into more *
C'-like expressions. Use of th
CYT)

indicate that the pcode is inc
orrect or needs to be "Tuned"
to make the decompiler outputhe dcLormplier needs all audit
onal

simplification rule to take ca

re of that particular situatio

iB

SUBA41(x,c) - truncation operat
ion

The 4 is the size of the input
operand (x) in bytes.

The 1 is the size of the outpulahat Satie Cabal
ated

The c is the number of least s
ignificant bytes being truncat
Cl

 

SUB42(0xaabbccdd,1) = Oxbbc
When "c" is 0, the operation i
s almost always a cast betweer
integer sizes, where the decodecompiler didn't figure out t
hat "x" was an integer type or
was forced to assume otherwis
e.

SUBA41(x,0) is usually a cast f
rom "int" to "char".

RIL: PACE RENT A {gels Told
" to "short" and so on.
SUBB84(x,4) is probably part ofther things like division stre
ngth reduction.
CONCAT31(x,y) - concatenates
wo operands together into a la

 

 

rger size object

The is the size of x in by
[EN

The "1" is the size of y in by
LN

Ry WR TIS Tr Ion I Tarth the bits

in "y". The "x" forms the most
signifigant part of the resul

t, "y" the

least.

CONCAT31(0xaabbcc,0xdd) =
[elolelel le]

This usually crops up when a 1
-bvte sized (char) variable isEAE aL LEA SE EA LL LAR
/logical ops on the

4-byte register give the corre
ct result for doing the operat
ion on a 1-byte variable; the
compiler just has to make sure
to ignore the 3 most
significant bytes of the regis
ter. The CONCAT31 is the deco
piler keeping track of these mTL MA
ignoring because it is mistake
nly interpreting the register
variable as being a 4-byte var
iable. In many cases the decon
piler can figure this

out, but especially in looping
constructs, it cannot. This i

s really a dead code issue. Th
e decompiler currently makes jA full fix of this problem wo
uld require a dead code elimin
ation algorithm that could dec
ide if part of a

varnode were dead.
ZEXT14(x) - zero extension
The 1 is the size of the opera
ice

The 4 is the size of the outpuThis is almost always a cast f

rom small integer types to big
unsigned types.

SEXT14(x) - signed extension
The 1 is the size of the opera

ice

The 4 is the size of the outpu

tin bytes

Thic ic mralally a ~eck frame aIg signed Integer.
SBORROWA4(x,y) - true if subtra
cting the signed numbers woul
cause a borrow

The 4 is the size of both x an
dyin bytes

Returns "true" if there is an
arithmetic overflow when subt

actina "v" from "x" as sianedIAL ED ARS)
signed integer comparisons. Tt
ere are rules in place for rec
overing the original compariso
n, but this is a missed one sp
ecial case. These

could also conceivably be gene
rated in extended precision su
btraction.

CARRY4(x,y) - true if there wofisicio bal BS a A Sl att dl ot | i cA
ould be a signed overflow addi
ngxtoy

The 4 is the size of both x an
dyin bytes

The 4 is the size of both x a
nd y in bytesbe a carry adding x to y.

If these are turning up everyw
here in a particular binary, i

t could be a missed simplifica
tion that could be easily fixe
d.

Register Settings
Occasionally a program will usegister> function on the right
mouse pop-up menu, the user
an specify

this value to the decompiler.
The constant will be propagate
d automatically throughout the
function, and the resulting c
ode may be greatly simplified.
Decompiler Options

The fallainime Narmmimilar Amal1t->0ptions Decompiler/Analys
Ss):

Eliminate unreachable code - c
auses the decompiler to elimin
ate branch paths which it cons
iders unreachable as a result
of constant propagation.
Ignore unimplemented instruc
ons - causes the decompiler to
ianore instructions whose semMpPIEmientieu. VLNerwisc a
halt_unimplemented call will a
ppear in the decompilation for
Elle e:1E1N

Infer constant pointers - allo
ws the decompiler to infer a d
ata-type for constants it dete
rmines are likely pointers. In
the basic heuristic, each con
HelldEta or function element in the
program, the constant is assun
ed to be a pointer.

Respect read-only flags - caus
es the decompiler to treat any
values in memory or blocks of
memory marked read-only as ¢
nstant values. Normally global
memory is considered public wlocation. Any global value cou
Id be changed by another
function. For areas of memory
that are really read-only and
never change their statically
initialized value, mark the me
mory area as read only in the
Memory Manager or specific De
a locations as Constant (see Dt process, memory blocks are n
arked as read-only if the memc
ry block is tagged as such in
the imported binary.

Simplify predication - causes
the decompiler to simplify cod
e that employs conditional (pr
edicated) instructions, mergin
g if/else blocks of code that

hu ——Simplify extended integer oper
ations - causes the decompiler
to simplify integer operation
s, where a single logical valu
eis split into high and low p
ieces
that are acted on in multiple
stages. The decompiler tries t
o identify these constructions
and replaces the multiple staUSE IT=plalt assiyglhiiment Vpera
ors - causes the decompiler to

employ in-place C assighment
operators such as += in the de
compiled syntax.

Decompiler Timeout (seconds)
the number of seconds to allo
w the decompiler to run before
terminating the decompiler. C
urrently this does not affecteld
only affects background analys
is that uses the decompiler. s
yntax.

falda tA Bade cali y' J

Data Mutability

Decompiler output can be influ
enced by the mutability of dat
a locations within memory. Suy
ported mutability settings incthat a memory locations value
never changes and the current
ly stored value can be treated
as a constant.

Volatile - indicates that a me
mory location's value may chat
ge asynchronously between re:
s. Reads and writes to such lo
cations are never simplified bwith specially named function
calls (e.g., volatile_read, v
olatile_write). The language d
efinition and compiler specifi
cation

may predefine specific volatil
e regions of memory and may :
so override the default volati

le read/write function names.
lo TT UTR NERY

 

3 el VE RsLEVER
1. Memory Block Settings
2. Data Settings

Tips:

It is important to note that t
he decompiler is only as good
as the definition of the the u
nderlvina assemblv lanauaae cassociated PCODE definition th
at describes what the instruct
ion does, essentially an RTL (
Register Transfer Language). F
or example, the following MOV
instruction which moves a valu
e into an offset onto the stac

k also has a PCODE definition.
MOV local 1c[ESP], 0x804aac8hited wana I I bya Ltad)
STORE ram(temp1), temp2
Irregularities in the produced
C-code can often be attribute
d to errors in this underlying
definition. Such errors can u
sually be fixed quickly. Pleas
ERC Eh

problems or issues you find.
A good way to start using there obviously "char *" string r
eferences. This allows the dec
ompiler to discover

and display any static strings
referenced anywhere the func
ion is called.

The decompiler can work out rindexing given enough inform.
tion about data types. Buildin
g these data

type definitions greatly enhan
ces readability of the C-code
and is a natural way to encaps
ulate reverse engineering knov
ledge. If you notice many offs
C1

TT |from a base value other than t
he frame or stack pointer, tha
t value is probably pointing t
o a structure or an array. Not
ice psParm1 in the code below
There are

several different references o
ff of it. The parameter can be
annotated to point to a struc
ture The user can create a nefidlra Yala Lype

library.

Without knowing the data type
the decompiler produces the f
ollowing C-code.

After applying the appropriate
structure, the code becomes:

The parameters shown where ¢ahhh il! pa hibit Sali Lh ll

e function is defined. This ca

n be caused by several things:
The function takes variable ar
guments.

The parameters are not actuall
y referenced (used) by the fun
ction.

The decompiler does not see tt
e parameter location being filfunction definition are more
[ILC CR LR (=I

Decompiler Window

To display the decompiler winc
ow, position the cursor on a f
unction in the Code Browser, t
hen select the

menu in the tool.Decompile option from the Wi
[lel

Errors from the decompiler pro
cess are reported in the statu
s area of the tool and sometim
es at the end of the C code in
the decompiler window.

Mnatiea ArFinme€ symbol that was clicked.
Control-double-click - Navigat
es to the symbol that was clic
ked, opening the results in a
new window.
Control-shift-click - Triggers
the Listing in a Snapshots vi
ew to navigate to the address
denoted by the symbol that wa
rela1 you plress Lh Imiuudic mousc
button (the button changed in
the tool options under Browser
Field->Cursor Text Highlight)
, the decompiler will highligh
t every

occurrence of a variable or co
nstant under the current curso
r location.he following paragraphs.
Copy/Copy Special...

C Code from the decompiler wi
dow can be copied and pasted
nto any other system text wind
ow. Select the text to copy, a
nd then choose Copy from the
opup menu.
Comments->Set...d in the program database att
he closest assembly line assoc
iated with the generated C-Coc
e. Any type of

comment (EOL, Post, Pre, Plate
) can be attached to the repre

sentative C-Code. When this fu
nction is re-displayed at some

later point, the comment willCommit Params/Return

Decompiler 5/9

By default, the decompiler wil
| analyze the code to try to d
iscover function parameters, r
eturn type, and local variable

a I SE er [2 TE T1function It does this analysis
again. Commit Params/Return
auses any parameter names ar
types and return type to be sa
ved in the program database s
that next time

the function is decompiled the
current definitions will be u
sed. This is useful for "synci
na" the function sianature witEE EE ERLE A

types of parameters and return
s in the disassembly to agree
with the decompiler names an
[aN

Ghidra will do stack analysis
that will recover parameters a
nd return types, but for many
programs, the analysis the dec
ompiler does is better.hinted te BF dda Gl lk a
decompiler derived informatio
n and applies it to each funct
ion as the function is created

If a variable displayed in the
assembly window has an unde
ned type, the decompiler will
still respect the name of the
variable.| analyze the code to try to d
iscover function parameters, r
eturn type, and local variable
s. Each time the decompiler di
splays C-code for a

function it does this analysis
again. Commit Locals causes &
ny local variable names and ty
pes to be saved in the programdecompiled the current local v
ariable definitions will be us
ed. This is useful for "syncin

g" the local variable definiti
ons with the disassembly displ
ay. This causes the names

and types of locals in the dis
assembly to agree with the dec
ompiler names and types.

FC rn TR Neles on the stack, but for many
programs, the analysis the de
compiler does is better.

There is a prototype plug-in t
hat automatically pulls in the
decompiler derived informatio
n and applies it to each funct
ion as the function is created

. The plugin by

default will not commit localAL A LE a LLL A]
tting locals automatically can
be turned on by changing the
analysis options for the
Decompiler Parameter ID plugi
. In most cases it is better t
o commit locals only for certa
in functions that you really c¢
are about, or after the data t
ype definitionsht cca tal i ta Ml fv cial lll Sie
re Reverse Engineering.

If a variable displayed in the
assembly window has an unde
ned type, the decompiler will
still respect the name of the
variable.

Auto Create Structure / Auto F
[URGES Te]

Automatically creates a structt based on the references foun
d by the decompiler.

To use this, place the cursor
on a function parameter variab
le, or any variable within a f
unction that is a pointer to a
structure. It could currently
have a data type of

undefined [l} (CIR char *function).

If the variable is already a s
tructure pointer, any new refe
rences found will be added to
the structure, even if the str
ucture must grow in size. This
is very useful as you

find more places the structure
is used. If you have already

A IC Set Ue een dm CaIn another function. Retype t
he variable to be the

structure, and then use Auto F
ill in Structure to add any ne

w fields recovered for the str
ucture.

This feature is also available

in the assembly listing when
the cursor is placed on a defi
ned parameter or return variabRelA RL ER RED A A A A
he structure by following the
structure pointer through the
current function and any funct
ion the structure is passed in
to within the

current function. Eventually t
his will be put into a global
type analyzer, but for now it

is most useful interactively.haat b
od flow, and all the switch st
atements should be recoverabl

There is also a script called
CreateStructure that you can u
se for automated structure rec
overy. For instance if you hav
e a set of ThisCall routines w
here the firststructure, the script could b
e modified to recover the stru
cture for each this parameter.
Highlight Def-Use
Highlights all places a value
is used, starting at the place
it is first written, and incl
uding all the places where tha
tone value i [5] [CCl Thisisuppears in the function Place t
he cursor over a variable you
would like to highlight and se
lect Highlight Def-Use from th
e pop-up menu.

As an example the a at the top
of the function is under the
cursor when Highlight Def-Use
is chosen.[Bleep] TIE

Notice that the first three re
ferences to a are highlighted
but the final use of a is not
because the value might have
hanged in the else clause.
Highlight Forward Slice
Highlight Forward Slice highli
ahts each variable whose valueALLEL EE A A SE
18

As an example, b, the output o
f max_alpha, is under the curs
or when Highlight Forward Slic
eis chosen.

We can see that c is tainted b
y the value of b all the way t
hrough to the bottom of the fu3 i anata intalalubiii Serak iol
Highlight Backward Slice highl
ights all points in the functi

on that contain a value involv
ed in the creation of the valu

e in the variable under the cu
[E18

As an example the final a of t
he function is under the curso
r when Highlight Backward SliWe can see that the final valu
e of a is affected by the loop
and by the input parameter bt
t never by b and c.

Highlight Forward Instruction
Slice

Highlight Forward Inst Slice h
ighlights each instruction who
se value [L be affected 22 th[TEES

themselves.

Highlight Backward Instruction
Slice

Highlight Backward Inst Slice
highlights all instructions i
n the function that contribute

FA TE a RT mL Naor.

Decompiler 79

Rename Variable

Any parameter or local variabl
e can be renamed. Just place t
he cursor over a variable defi
nition, or any use of the vari
able and choose Rename Varia
e from theLai LL EL AA PE
the next time the decompiler
displays the code for the func
tion, the same name is used.
Rename Function

A shortcut for renaming the fu
nction from within the decomp
ler window.

Retype Variable

The decompiler does its best titchy’ Ji ah rein a LI
y has limited information for
analysis. Explicitly changing
[ERY IN i)

variable can dramatically impr
ove the C-code produced. This
is especially true for structu
res. Changing the type of a pa
rameter variable will affect t
he display forTo change a variables data typ
e; place the cursor over the v
ariable definition or use of t

he variable, select Retype Var
iable from the popup menu, an
then enter

the name of the type. The nam
of any data type known to the
[SIE ICT RET INET)vious string parameters and re
-type the parameter to be a "c
har *". Any references to defi
LCG]

memory will now display the p
ssed parameter as a character
“string”.

Edit Data Type of Variable
Only structure, union, and enu

nt PE a La et ETof these It can be edited. Al
so, if the data type is a type
definition, array,

or pointer based on an editabl
e data type, then the base dat
a type can be edited. For exam
ple, if you have a structure p
ointer for a variable then you
can edit the

structure To edit a variable"LOVED LINE Vallabic Uchnuon Oo

r use of the variable and sele
ct Edit Data Type... from the
popup menu. For

structures and unions, the str
ucture editor will appear, and
for enums the enum editor wil
| appear. If the data type for

a variable can't be edited, t
he action will benikal abit ida
The Edit Function Signature di
alog allows you to change the
function's signature, the call
ing convention, whether the fu
nction is inline and whether t
he function

has no return.

The function signature includereturn type

number of parameters
parameter names
parameter type

varargs (variable arguments)

parameter type
varargs (variable arguments)This features allows you to ed
it a function signature text s
tring to change any of these.
For example if a function is a
ctually printf(), instead of ¢
hanging the name, return type
and parameters individually,
the entire function signature
can be changed

all ak Aree Ta An Fhie tnt mevoid printf( char *rm¢, ...)
within the Signature field and
then select the OK button.

In addition, you can select th
e Calling Convention for this
function from a list of availa
ble calling conventions as det
ermined by the program's lang
age.

Selecting the Inline checkboxLLL a BLL LL A
turn checkbox indicates that t
he function does not return.
The signature of the current f
unction, or any called functio

n can be changed.

To edit a function's signature
from the Decompile window. Ji
st place the cursor over any f
unction name, select Edit Funcand the dialog will appear wit
h the function's current infor
mation.

Override Signature

Overrides the signature of a ¢
alled function at the point it
is called. This allows you to
set the parameter values for
a particular call.ve a previously added function
signature override.

Find...

Find any string of text within
the currently decompiled func
<1,

Debug Function Decompilation
For certain functions, the dec

llc may CEI an error |cing results. Selecting Debug
Function Decompilation, from |
he decompiler provider windov
toolbar, will run the decompil
er again, and save all relevan
tinformation to an XML file.
Instead

of submitting the entire progr

am to be analyzed to discover
FE TY eer IR 4 1 1)Export to C

You can export the current dec
ompiled function to a file by
selecting the

icon in the local tool bar of
the decompiler window. A file
chooser dialog is displayed

for you to select the name of
the output file. If you do not
specifv a file extension " cEAL) El R iA

Creates a Snapshot of the curr
ent decompiler window, which
llows you to leave the current

decompiled function in place

while navigating to other func
tions.

[eT gul

The colors used in the decomp
ler window can be changed byhonda Elite ak ia Ldn hadi Raul
. To edit the options, choose
Edit

Tool Options... from the tool
menu. Click on the C Display n
ode in the Options tree. A pan
el shows the colors that can b
e customized. Click on the col
or bar to

bring up the color chooser tochange the maximum charact
in a line displayed in the de
compiler window, and the num
r of characters for indenting

in the

code.

Mouse Hovers
These LLC Eh] similarly to CoProvided by: Decompiler Plugir
Related Topics:

Code Browser

Snapshots

Code Browser
Snapshots

Raman milar QOFunction ID Plug-in
4

(EX

Function ID Plug-in

The Function ID Plug-in allows
users to create new (.fidb) d
atabases. A Function ID datababing software libraries and th
e functions they contain. Iti

s searchable

via a hash computed over the |
ody of unknown functions (See
Function ID). The databases ar
e selfcontained and can be sha
red among different users. Usi
ng this plug-in, databases can

PL)active Code Browser, and a da
tabase can be populated with f
Shlal])

hashes from programs in the c
rrent Ghidra project.

A Function ID database may hc
d many distinct libraries. Wit
hin a single library, all func
tions must

come from the same processorLafiguayc Iu. Ideally, Tune
LS

should come from a single soft
ware component, all compiled
sing the same compiler and se
[AII-[R

Functions for a single library
can be ingested from multiple
files, usually from a series
[Ie JElind pbaikateiaintin’ AB ali dol Bcd J
spread across multiple files,
accurate

symbol information is necessar
y to properly compute parent/c

hild relationships.

Enabling the Plug-in
All plug-in functionality is a
ccessible from the Function IDorder to access this menu, the
tool must be configured to in
clude the Function ID plugin.
To do

this, from the Code Browser se
lect

File -> Configure

Then click on the Configure li
nk under the Function ID sectiPlug-in Functionality

The Function ID plug-in provid
es the following actions under
Tools -> Function ID.

Choose active FidDbs...

This brings up a dialog that a

llows the user to select which

Function ID databases are act

[Eaet of databases and they are a
Il initially active.

Function ID Plug-in 2/7

Once a database has been dea
ivated, it will no longer be u
sed for matches in subsequent
analvsisAE LA A A A A EE
preference on a per-user basi
EX

Create new empty FidDb...
This brings up a file chooser
dialog that allows the user to
create a new Function ID data
base. This

cannot be located under the GI
idra install directory root, broot read-only. We recommend
nding this database with the e
xtension .fidb for consistency

although not strictly necessar
y. Newly created databases are
attached (which means "know
for the

purposes of tracking) and initAttach existing FidDb...

This brings up a file chooser
dialog that allows the user to
attach an existing Function |
D database.

This cannot be located under t
he Ghidra install directory ro
ot, because Ghidra considers f
IES underpreference system, and retain
[GE

active status across sessions
of Ghidra.

Detach attached FidDb...

This brings up a dialog that a
llows the user to detach an al
ready-attached Function ID dat
abase.

I TUT TTthey can only be deactivated
(see

This brings up a dialog that
allows the user to detach an a
Iready-attached Function ID da
tabase.

None of the databases delivere
d with Ghidra can be detachedsc
Function ID Plug-in 3/7

Choose active FidDbs...)

. Detaching a database remove
it from use in searching, and
also causes

the user preference system to
forget about the existence of
this database.Once a database has been crez
ed (or attached), the user may
populate it with hash values
from a set

of programs in the current pro
ject. Choosing this option bri
ngs up a dialog where users en
ter the

information needed to populatDialog Fields

Fid Database

Pick the database to populate.
Users must select from attach
ed databases that are
writable.

Library Family Name

The name of the library beingLibrary Family Name

The name of the library being
ingested. This is the identifi

er that

will be inserted

Function ID Plug-in 4/7

as part of the comment when &

Ci BR Aree S56 Eons oval Err Fs re pekeion pve iiLibrary Version

The formal version string for
the library. This is frequent!

y the <major>.
<minor>.<patch> syntax but ¢
be anything provided to disti
nguish between

different versions of the same
IITA

lLibrarv Variant=Hngy frafies atl docsi tL 1
itin the formal Version

string. This frequently holds
compiler settings.

Base Library

This is an optional setting fo

r cross-linking with an existi
ng library already

ingested in the database. In t
he event that the user wants tLion Joti cn loca fale ¥ aiid
o this library from another re
lated library, they can

set this option to point at th

e other library. The library m
ust already be ingested

(from a previous use of this c
ommand) into the same datab:
. The Function ID

ingest process will match paresymbols.

Rd

This specifies the set of prog
[CLERC RL RG ERT E
y will be populated.

The user can select any subfol
der in the current Ghidra proj
ect. The ingest

EEEe will recursively searceach program, will collect any
functions it contains.
Language

This is the required 4-field G
hidra Language ID (i.e. x86:LE
:64:default)

specifying exactly what proces
sor the new language will cont
ain. While scanning

LI TL Tp Timodel will be

automatically skipped.
Common Symbol File

This is an optional parameter
that provides a list of common
function symbols to

the ingest process. The parame
ter, if present, is a path to

a text file that contains

the list of function svmbolsEE

functions from consideration a
s disambiguating child functio
ns. (See False

[IGEN]

Once all fields have been fill
ed, clicking OK causes all sel
ected functions to be ingested
for the newhala dis bal Ri et aad die
elected, this process may take
EI

time. Upon completion, the prc
cess will present a summary wi
ndow, containing ingest statis
tics and

an ordered list of functions t
hat were most commonly calle
within the library. This listtailored for the library.

Preparing Libraries for a Func
tion ID Database

Location of Programs

All functions going into a sin
gle Function ID Library must a
Iready be imported and analyz
dAll functions going into a si
ICR LIE RIAN CTA a [VE
already be imported and
analyzed

Function ID Plug-in 5/7
somewhere within a single Ghi
ra repository (shared or non-s
hared). Multiple libraries con
tained

TL TLE TT ST Mr, but a single library must be
written to

the database in a single pass.
The ingest dialog (see Pop
ulate FidDb from programs...
JETER

single subfolder as the root f
or the library. The process ac
ts recursively, so there can b
e additionalTOOL, PUL all prograiris LO pe 1
ncluded in the library must be
under the

one root.

Analysis

All programs must be analyzed
enough to have recovered the |
odies of all the functions tha
tareto

be included in the library. Gemb
's default

auto-analysis. If functions ar

e spread across multiple progr
ams, as is typically the case,
users can run

the Ghidra's analyzeHeadless ¢
ommand to analyze across the
hole set. However, take note
below of some of the modificatod

Function ID results.

Every function to be included
must have a non-default functi
on name assigned. Function ID
uses a

function's primary symbol for
the name. Symbols are typicall
y imported from debug informsames, script based or manual,
will work. Any function that s
till has

its default name, FUN_0O....,
currently will not be ingested

When performing auto-analysis
in preparation for ingest, its
best to disable the Function
ITnYtification analyzer as well) |

n order to avoid cross contami
nation

from different databases. If t
he function symbols are mangl|
d, be sure to turn off the Dem
angler

analyzer. This lets the future
database apply the raw mangl|
d svmbol to new proarams durEAD IEPA RA IR AL A La A
angler analyzer pass run with
complete information.

For an example of these sorts
of modifications to the analys
is process, see the file:
Features/FunctionID/ghidra_sci
ipts/FunctionIDHeadlessPrescri
pt.java

This is designed to be passedul Sit] al Late)

False Positives

A false positive in the contex

t of Function ID is a function
that is declared as a match b
y the

analyzer but has the incorrect
symbol applied. As with any c
lassification algorithm, it iskind of error completely, but
with Function ID there are so
[us

mitigation strategies.

Causes

False positives for the most p
art only happen with small fun
ctions. There are two related
causesIf a function consists of only
a few instructions, it can be
matched randomly if

Tiny Functions

If a function consists of only
a few instructions, it can be
matched

J.there are enough entries in th
e database. The fewer operatio
ns a function

performs, the more likely an u
nrelated function is to do tho
se exact same things.

Code Idioms

A set of functions that are ef
fectively identical can have d
ifferent names and beRL EL
Ra CIR SI Te 11H

check that a particular struct
ure field is non-zero, and the

n pass that field to

free. Another destructor may p
erform the exact same sequen
, but was

designed for a completely unre
lated structure.n apply a symbol that is misle
ading for the analyst.
Mitigation via Threshold

All mitigation strategies, to
some extent, trade-off false p
ositives for false negatives,
which are

functions that should have bee
n reported by the Function IDthreshold or strategy).

Most false positives by far ar

e due to tiny functions. Funct
ion ID minimizes these via the
instruction

count threshold. Potentially m
atching functions with too few
instructions that don't excee
d thisFor users experiencing too mat
y false positives, the instruc
tion count threshold is the ea
siest thing

to adjust. It is fully control
lable by the user as an Analys
is option (See Analysis Opt
ions), and

increasing it will directly re

JOLIE LT SERS TI Atrue matches

whose scores now fall below th
e threshold.

Specialized Mitigation

The default instruction count
threshold is a good starting p
oint for any new database, gen
EE

striking a reasonable balance
limiting false positives withoLER SL

even for an optimal threshold,

there may be a small handful

of functions in the new databa
E

(usually Code Idioms) that exc
eed the threshold and repeatec
ly cause the wrong label to be

placed.

Instead of increasing the thredate dab lofi hiatal litle
it is possible

to turn on one of several miti
gation strategies that target
the offending database entries
directly.

These strategies include:

Force Specific

If this is set on an entry, th

e specific hash must match befial match. This is useful when
a code idiom contains

a known constant that the full
hash would usually miss.
Force Relation

This is probably the most usef
ul specialized strategy. It fo
rces at least one parent

or child match to LS [SIEEhT Llpotential match. So even if an
idiom is big, this forces a s
earch for an additional
confirmation.

Auto Fail

potential match. So even if an

PAT TRE HARE STIT TN —Lesh lgnElelel B

Function ID Plug-in 7/7

This is a strategy of last res
ort. If an obnoxious code idio
m can't be eliminated

any other way, this forces the
particular database entry to
never be considered as

a match.ARLE AR A ES LA A LR LE

m the others, in that it appli

es to function entries

whose scores are slightly too
low. If a low scoring function
has an instruction

sequence that is deemed uniqt
enough, this strategy causes
any potential match

to automatically pass the threbadd uli ddr dt Saal
instruction count threshold to
include a particular function

These strategies can all be to
ggled for individual function
records in the database. To do
this

manually from the Code Browsja

change using the Debug Searc
Window and then make chang:
rom its Result Window. For det
ails

see Debug Search Window.
Strategies can also be toggled
by running a Ghidra script. W
ithin a script the basic instrFidFileManager fidFileManager
= FidFileManager.getinstance(

 

[AESLINIIINS allknownFidFiles
= fidFileManager.getFidFiles(
J
11 Choose a modifiable databas
CRCInRGERIE

 

1 Onan a ernarific dats hacae.getridDB(true);

11 Toggle strategies based on
the full hash of the function(

Bl
modifiableFidDB.setAutoFailBy
ullHash(0x84d01243dfb8b9ch
[OH
modifiableFidDB.setForceRelat
onByFullHash(0x4e0920960b4
ERRILDyrulifasifVAJICIicIa/EC/ 10]
3L, true);
modifiableFidDB.setAutoPassB;
ullHash(0x96a4a6fd5694523b
[CH

1/1 Save and close the database
modifiableFidDB.saveDatabase
comment”, monitor);
modifiableFidDB.close();hal aceot iti iT haiti Bh’ [aiid
functions can be obtained wit
h the FIDHashCurrentFunction
Elda]

4

Function ID

(Ed
Function ID Debug Plug-inFunction ID Debug Plug-in
4

Function ID Debug Plug-in
The Function ID Debug Plug-in
allows users to inspect the in
dividual records in a

Function ID database. This funown databases. Users can look
up individual records based on
name or hash, but

currently the plug-in is not c¢
apable of modifying records. T
he only exceptions are the
Specialized Mitigation s
trategies, which can be modifi

ed using the Debug Search
LmEnabling the Plug-in

The Debug Plug-in adds option
to the Function ID menu, unde
r the Code Browser's

main Tools menu. These optior
are in addition to those intr
oduced by the Function

ID Plug-in, which uses the sam
e menu. In order to access the
Debua options the pludin mu:RL A LE EE

File -> Configure

Then click on Configure link u
nder the Experimental section
and check the box next

to "FidDebugPlugin".

Plug-in Functionality
The Function ID Debug Plug-in
introduces the following actioCreate Read-only Database
Users can convert the read/wri
te (.fidb) database into the a
read-only (.fidbf) form.

This is the more efficient fin

al form used directly by the F
unction ID analyzer. The .
fidbf form is uncompressed on
disk and the analyzer can usefore use.

Debug Search Window
Function ID Debug Plug-in 2/4

LEE ISR I ERIE -ET (el)
dialog for the currently actind to the individual fields in

a function record that can be
searched. If the variant Debug
Search Window (Current Func
on) is invoked, the

same dialog is brought up, but
the Full Hash and the Specifi
c Hash fields are prepopulated
with hashes corresponding to

J I TL STR 1 SH I AA search Is Initiated Tor a sp
ecific search field by enterin

g a value and then hitting the
RETURN key, with the cursor al
d focus still in the desired f
ield.

Search Fields

Function IDFancuon records in tne Udala
base.

Name

This searches through function
names. Searches here will ma
ch any

record whose name contains tt
search string.

Domain Path

This searches through domainpath, relative to the project
root, of a program containing
lu)

function described by a partic
ular record. Searches here wil
I match

any record whose domain path
ontains the search string.

i]any record whose domain path
contains the search string.
i]

Function ID Debug Plug-in 3/4
This searches for records matc

hing the full hash. The text f
ieldIE
string by prepending with "0x"

XH

This searches for records matc
hing the specific hash. The te

patil]

expects a 64-bit value. The ha

I LE IE rtstring by prepending with "0x"

Result Window

Invoking a search will bring u
p the Result Window, presentir
g a row for each

matching function record. Colu
mns list properties of the fun
ction and correspond toAe ARI LL A A LA LB
h record/row lists a few

other columns:

Library

This is the library containing
the function

Code Unit Size

This is the number of (scoring
) instructions in the function
's body.BY SINE AFA)

This is the number of distinct
constant operands fed into th
EET 1dli

hash.

Warn

This lists any special propert
ies that have been toggled for
lu)ngle

character codes, corresponding
to each possible property. Pr
operties

include the mitigation strateg
ies described in Specialize

d

Mitigation.

F - Auto Pass: The record automatically passes.

S - Force Specific: Specific h
ash must match for record to b
e

considered.

R - Force Relation: A parent o
r child must match for record
to be

considered.

11 The fiirnrtinn hada wae |inbeFunction ID Debug Plug-in 4/4
Edit Menu

The Result Window supports a
mall number of actions under t
LER HAnEL TRG EY

allow the user to change the m
itiaation strateaies for a reaA LL SA Pa

d Mitigation. When a menu a
ction is invoked, all records
displayed in the current Resul
t Window are affected. Current
ly there is no way to

select a subset of records to
effect. The actions all set or
clear a specific strategy.
Set/Clear auto-failaiid ial atelier OF
Toggle the Auto Pass strategy.
Set/Clear force-specific

Toggle the Force Specific stra
tegy.

Set/Clear force-relation

Toggle the Force Relation stra
tegy.

Save changes

Changes made using the Edit rto the underlying database unt
il this action is invoked.

LELICAY EE

This invokes an extremely low-
level view into the underlying
tables that back a

Function ID database. It can b
e invoked on any attached datzal records in one table. A dro
p-down menu allows the

user to switch between the dif
ferent underlying tables. Most
of the columns contain

row keys and don't present rea
dable values. The only meaning
ful table is likely to be

the Libraries Table which will

liek carb Liles ms masbimm (1m +Prev

Function ID Plug-in

Function Call Graph Plugin 1/4
Function Call Graph Plugin

The Function Call Graph Plugin
is a simple araph displav thaELMER TER EE A

the function containing the cu
rrent address, also known as t
he Source Function, in the Lis
ting. This display

provides some context for how
a function is used within the
program. The functions are org
anized by Level.

To show the Function Call Gragtool menu.

 

Function Call Graph option on
lu)

The graph of function calls re
lated to the source function b
eing displayed can be explored
by adding existingThe graph updates itself as yo
u navigate within the tool. To
prevent losing graph state (e
EM

expanded functions, node loca
ions, etc), a small number of
graphs will be cached. For exa
mple, ifn, the graph will be restored
les
previous state.

Terms

Source Function: the function
that contains the current addr
ess in the Listing. This funct
ion is

ey ST aeallees added to the graph at a
hE

Source Function: the function
that contains the current add
ress in the Listing. This func
tion is

considered the center of the g
raph with all other callers/cALLS

Function Call Graph Plugin 2/4
level.

Level: Each function node in t
he graph belongs to a level. T
he source function is at level
pT)

source function's incoming cal
Is are at level 2; the source
function's outgoing calls arehit clit billable
by level allows the user to qu
ickly see how many hops, or ca
Ils, a

given function is from the sou
[(SRThlele[T

New levels of calls can be add
ed to the graph by the user.
Direction: Each function node,
other than the source functiodirections: In or Out. All fun
ction nodes in a given level s
hare the same direction. So, a
Il nodes

that directly call the source
function node are considered t
o be the In direction; all nod
£5

directly called by the sourceWhen a given node's level is e
xpanded in the graph, the nod:
s added are based upon the
selected node's direction: for
In nodes, the newly added noc
es will be those nodes that ca
Il the

selected node; for Out nodes,
the newly added nodes will be

ees reretaes wm ited ir Fives omhesnode.

Direct Edges: An edge (a call)
between two adjacent levels.
Indirect Edges: An edge (a cal
1) between two non-adjacent le
vels or an edge within the sam
e

level. These edges are rendere
d with less emphasis than dire
ct edaesALLIONS

Show/Hide Edges Action
Within the Function Call Graph
you can show and hide functio
n calls as desired. Showing ad
ditional

function calls can be accompli
shed multiple ways. From any 1
unction node, you can select thhacodhi ll J BELLE

ode when hovered. When click
, this button will toggle rela
ted

function calls: showing them i
f not already in the graph; hi
ding them if they are in the g
raph.

Additionally, these same funct
ionality is provided from the

 

laid ul toate iitIncoming Edges and Show/Hid
utgoing Edges).

As new vertices are added to t
he graph, any indirect edges w
ill be added to the

ICI-L8

Note here how new vertices me
ap| ear in odd places LLC exin the graph at a previous lev
el).

It is important to understand
that the graph is only a subse
t of the entire program

graph. This graph does not rep
resent all functions and funct
ion calls in the program.too many references to display
in the graph. When

this happens, the function nod
e will be a gray color, with t

he expand icon replaced with
warning icon, as so:

this happens, the function no
de will be a arav color witha
warning icon, as so:

Function Call Graph Plugin 3/4

Show/Hide Level Edges Action
All functions that relate to t
he Level of the selected funct
ion will be shown, not just ca
IIs to theNavigate on Incoming Location
Changes

This action ( ), when toggled
on, upon receiving Program Lox
ation changes from the tool, w
1)

graph the function containing
that location. When toggled of
f, location changes will not aHaving this action on is usefu

| if you wish to quickly see t

he graph of different function
s as you

navigate the program. Alternat
ively, having this action off

is useful when you wish to exp
lore the

eT) by navigating from wigraph.

Layout Action
This action (

) will relayout the current gr
aph and reset the graph to sho
w only the initial nodes.

ran rake TE trerbiirmn hls vve ze?the popup menu of any node ti
t is not the currently graphed
alle

When pressed, this action will
graph the clicked function.

Satellite View

The Satellite View works exact
ly as the Function Graph's Sat
ellite ViewLAA ALSACE) SELLA EL
ph Plugin

Related Topics:

Graphs

Function Call Graph Plugin 4/
4Function Graph Plugin 1/10

The Function Graph Plugin is a
simple graph display that sho
ws the code blocks of the func
tion containing the cursor in
the Listing.

The display consists of the Pr
imary View and the Satellite Vre graph.

What's New

Added the Nested Code Layout
This layout shows the code blo
cks in a structure that more c
losely resembles the flow of C
code.

Small tweaks (6.0)d by default

Added a regroup action to allo
w for regrouping vertices afte
r ungrouping.

Articulated edges will now dis
appear if the connected vertic
es are dragged outside of the
original angles.

Moved some actions to the con

rt rarer bl bh Penal creas ailirms WorsFullscreen Mode

Jump to XRef

Layout Compressing (5.6)
Keyboard zooming and pannin
5.6)

NEE TIN NERY]

Primary View
The Primary View displays the
Vertices (or Blocks) and FdaesLEAS LI EAS LES An LLL AS
ract with blocks, both for edi
ting and

arrangement.

The graph rendered in the Prin
ary View may represent an und
fined function, such as a subr
outine. If this is the case, t

hen the background of the Prin
ary View willDad a

Function Graph Plugin 2/10

By default, as changes to the
program are detected, the gray
h will not relayout to account
for these changes. The image
below shows the bottom of theanges and is considered stale

Once a graph is stale, you can
press the refresh button at a
ny time to have the graph re-c
reate itself without performin
g a relayout. The green box in
the image

above contains the refresh butresh the stale graph and perfo
rm a relayout, which we reposi
tion the vertices

of the graph to their preferre

d locations.

If you would like to change th
e default behavior on program
changes to perform a full grap
h update, then you can change

ME ET ET LT Eeaccess these options by right-
clicking in graph and selectin
g the Properties action. Alter
natively, you can click on the
tool's menu bar Edit->Tool Op
tions... to

launch the options. From there
you can find the option at Fu
nction Graph-> Automatic Gra
RelavoutALLL RA LS

The Satellite View provides an
overview of the graph. From t
his view you may also perform
basic adjustment of the overal
| graph location. In addition
to the

complete graph, the satellite
view contains a lens (the whit
e rectangle) that indicates hohoi ail i
When you single left mouse cli
ck in the satellite view the g
raph is centered around the co
rresponding point in the prima
ry view. Alternatively, you ma
y drag the lens

of the satellite view to the d
esired location by performing
a mouse drag operation on the

a Glw by right-clicking anywhere i

n the Primary View and desele
ting the Display Satellite Vie

w toggle button from the popu
[CLIT

If the Primary View is paintin
g sluggishly, then hiding the
REC View c cause Au PrimaThe Satellite View is attached

, or docked, to the Primary Vi
ew by default. However, you ca
n detach, or undock, the Satel
lite View, which will put the
view into a Component Provide
, Which itself can be moved, r
esized and docked anywhere ir

the Tool you wish.
hh ET a LT IH TAYeselect the Dock Satellite Vie
UAE IRISH

To re-dock the Satellite View,
right-click in the graph and
select the Dock Satellite View
menu item.

To reshow the Satellite View i
f itis hidden, whether docked
or undocked vou can press thAd IR IRA LEC) SLR RR El A]
y visible if the Satellite Vie
w is hidden or undocked.

button. This button is in the
lower-right hand

Vertices (Blocks)
Each vertex in the displayed g
raph represents a code block whain Sl id dati atbaid” JA Bl Aaa
sly with the term vertex. The
block display

consists of a header and a cod
e listing. The fields containe

d in the listing are a subset

of the available fields. You m
ay change the fields displayed
from the Edit Code

Block Fields action.label at that location, or th
at address if no label exists.
The header also contains butt
ons that allow you to

perform some common operat
on the block.

As long as you are within the
interaction threshold, you may
interact with the block's lisThe following actions are avai
lable from the primary view.

The following actions are ava
ilable from the primary view.

Function Graph Plugin 3/10

Selecting Blocks
{ye

 

PTI ISN REIT 1 SI 1Iple blocks, hold down the Ctr
| key (or the equivalent for y
our OS) while

clicking. To deselect a block,
hold the Ctrl key while click
ing the block. To clear all se
lected blocks, click in an emp
ty area of the primary

view. When selected, a block i
s adorned with a haloRL LL A nL SS AREAL
the Ctrl key while performing
a drag operation. Press the C
trl key and start

the drag in an empty area of t
he primary view (not over a co
de block). This will create a
bounding rectangle on the scre
en that will select any

blocks contained therein whenhaat Laut Ulan
If you double-click a block he
ader, then the Zoom Level of t
he Primary View will change. |
f the block is not at full zoo

m (1:1), then the

zoom level will be changed to
full zoom. Otherwise, the zoom
level will be changed to full

y zoomed out. If you are zoomeu can double-click anywhere in
the block to trigger a full z
LIN

Assuming you are not zoomed
st the interaction threshold,
then double-clicking a field i
nside the block's listing will
perform a navigation

as determined by that listing.le-clicking anywhere in the bl
ock will trigger

navigation in the same way as
double-clicking the block head
Ca

Block Information

You can hover over a block to
get descriptive information. D
epending upon the Zoom Level

Fines raribosss is srimone vient s subi rehovers. When zoomed past the
nteraction threshold, the hove
r action will trigger a popup
window showing a preview of t
e block. At full

zoom, you will only receive po
pup windows as determined by
he listing inside of the block

. You may disable popups as de
SRVEIeX ALLions

The

button allows you to set the b
ackground color for the vertex
. You may press the button to
choose the color currently dis
played in the icon, or

you may use the drop-down me
to pick a previously used col| cil adaall LAG de alo bl Aa ciliated
color or choose a new color

Lee
By default, colors applied to

a vertex are also applied to t
he primary disassembly Listing

Thevertices.

Popup Menu Vertex Actions
The

button allows you to set the |

abel for the code block (this
will also change the block heaThe

toggle button allows you to qu
ickly view the contents of the
block in a full window view,
which uses the same format
as Ghidra's primary Listing. T
o restore the graph view from
the full window view, click th
is action again, which will th

WAul

button will show a table of xr
efs to the entry point of the
currently graphed function.

This action will also appear i
n the vertex containing the fu
nection entrv point for convenGrouped Vertex Actions

Function Graph Plugin 4/10

This section describes vertex
grouping, which is covered lat
er in this document.

LGbaits + hat bal ci el
. You may press the button to
choose the color currently dis
played in the icon, or

you may use the drop-down m:
to pick a previously used col
or. Additionally, from the dro
p-down menu you can clear the
color or choose a new color
LeeThis group color feature allow
s you to easily color large nu
mbers of vertices after you ha
ve grouped them and to keep ¢
ready set

user-defined colors as you are
[eI RAVE a eH

The Function Graph will autom
tically color your group verted:

If none, or some but not all,

of the vertices being grouped
have a user-defined color, the
n the group vertex will be mad
e the default

color (which you can change fr
om the options).

If all of the vertices being g

A SL CA Sr aesame, then the group vertex wi
Il be made the

CECT

If all of the vertices being g
rouped have the same user-def
ned color, then the new group
vertex will be made the color
of the

vertices.

When a aroub vertex has a useLES YTroupeu therein will take
on that color.

Via the options you can disabl
e this feature.

The

button allows you to set the t

ext displayed in the group ver
tex. Unlike the action when uslabel at the start address of
the vertex.
The

 

button will ungroup the given
CUO

TheThe

button will add to the given g
roup vertex all other selected
vertices.

The difference between group
nd add to group is somewhat s
btle. The group action createsas a child, contained inside o
f the new grouped vertex. Alte
rnatively, the add to group ac
tion adds to the existing grou
p node chosen all other
selected vertices.

ALERT)
button is included in the head

RL I A Il [remand Con A vemember of a group, where that
group has been

ungrouped. This action will re
group (or collapse) all vertic
es in the same group as the ve
rtex containing the action. To
regroup is to convert all mem
LEIS

of a given group back into a s
indle arouned vertexTO TEMOVE all UlLoliapscUd vVerl
x from group membership, rigt
-click on that vertex and sele
ct Ungroup Selected Vertices.

Edges

The Edges of the vertices repr
esent a flow from one code blo
ck to another. One end of each
edge has an arrowhead that reFurthermore, the color of the
edge provides a visual indicat
ion as to the type of the flow

. The default flow colors are:
Fallthrough - the negative cas
e of a conditional check
Conditional - the positive cas

e of a conditional check
Unconditional - An unconditionlable from the primary view.
Selecting Edges

You may select an edge by left
-clicking it. To select multip

le edges, hold down the Ctrl (
or the equivalent for your OS)
while clicking. To deselect a

il

Le e, hold the Ctrl 157 LL]empty area of the primary view

Navigating Edges

Function Graph Plugin 5/10
Double-clicking an edge will n
avigate to the one of the inci

28rd Ilrermlre Ties mimsirisitmm susnation block If It Is not alre
ady

selected. Otherwise, the navig
ation will take you to the sou
(RII

Edge Information

You can hover over an edge to
get descriptive information. W
hen you hover over an edge yo
will be presented with a npobuLR LULA LA]
blocks for the hovered edge.
You may disable popups as des
red.

Articulated Edges

Some graph layouts create arti
culated edges, which are edge:
that contain bends in them to
route around vertices. As you
drag vertices around the grapin the dragged edge may disa|
pear if the articulation cause

s the edge to contain awkward
angles.

NE og el IIIT Ie]

Selected Vertices - Before Gro
upingYou may select 2 or more verti
ces to be turned into a single
grouped vertex. This allows y
ou to organize vertices to red
uce the amount of information
displayed in thee grouped vertex. This allows
you to organize vertices to re
duce the amount of informatio
displayed in the

graph. As an example, you may
wish to place all branches of

a switch statement into a sing
le grouped vertex.

Function Graph Plugin 6/10to group. This allows you to
annotate a given vertex with t
ext, without editing the label
at the vertex address, which
5

the default behavior of the ed
it label action. In addition t

o setting the text for the gro
uped vertex, it will remove th
e disassemblv In this regardEAL LA A A SR ER A RE LR I LL
ormation hiding.

Before a group vertex is creat
ed you are prompted to enter t
ext that will be displayed in
the body of the group vertex.
By default, the titles of each
grouped vertex will

be listed as the text of the g
rouped vertex.kidnaped leiden

og

The default contents of the gr
oup vertex text entry dialog a
re generated from the titles o
f each vertex being grouped. W
hen grouping a vertex which is
IE

a group, the text of that grouPREY

Grouped vertices may contain
ther grouped vertices.

As you group vertices, the gra
ph may perform a relayout of t
he vertices, depending upon th
e Function Graph Options, as d
adleLl] belowIl restore to the graph all ve
rtices contained in the groupe
d vertex. The layout behavior
of the graph after performing
an

ungroup operation is depender
upon the graph options; speci
fically, the Automatic Graph R
elayout option. The default se

OL SAE SR NI rr TY | CE A LYVertex Grouping Changes Only
This means that as you group ¢
nd ungroup vertices, the graph
will relayout its vertices, w
hich may be a drastic layout
change. To prevent the graph f
rom performing a relayout duri
ng grouping or ungrouping, se
the option listed above to be
Block Mode Chanaes Onlv orYou can access the Function Gi
aph Options by right-clicking
in an empty area of the graph
and clicking the Properties me
nu item.

You can ungroup all group vert
ices in the graph via the righ
t-click popup menu by selectin
g Ungroup All Vertices. Warninwhich is an operation that can
RI ERT CIT

Ungrouped vertices can be reg
ouped by executing the regrou
action. This action is execut
ed from an individual vertex,
but will apply

to all vertices in its group.RR ET] actions are butt
ons in the Function Graph Plug
in header.

The

button will perform a copy act
ion in one or more vertex list
ings. See the Clipboard help f
or more information c on using ¢The

button will perform a paste ac
tion in one or more vertex lis
tings. See the Clipboard help
for more information on using
paste in the Listing and
Listing-based views.

The

ibm rill matrimabe Fa amd coThe

button will navigate to and se
lect the entry point block.

The

button clear all position andAC SALA AA LN SAS EA RE BCR ASA
and relayout of the graph.

Function Graph Plugin 7/10

The

button allows you to both chan
ge the layout used to arrange
the graph and to perform a rel
ayout of the graph using the cer a relayout, whereas clickin
g on the drop-down arrow will
allow you to choose a new layo
ut.

This action allows you to perf
orm a graph relayout without |
osing grouping informationbutton allows you to change th
e fields of the blocks" listin

[-}
By default, the format configu
ration of the vertices is grea
tly condensed. This is done to
fit as many vertices on the s
creen as is possible. You

can CLC Re vertices Cle [3]and removing fields, as well
as adjusting the size

of the fields in the vertex li
sting display, see the Listing
Panel's format help.

The

button will create a Snapshot

IR IRR AERAPath Highlight Actions

The focus and hover path highl
ighting modes are designed to
help show the flow of executio
n through the code blocks in a
function, as well

as illustrate some of the stru
cture. Hover highlights are tr
iggered when you move the m
e over a block Focus hiahliahEASLALLEL® BE SALA LD AR LA
k from one selected block, not
with multiple selected blocks

The focus highlight paints the
edges between certain code b
ocks with a bold stroke, thick
er than the regular edges. The
hover highlight

paints a dashed, thicker strokiod of time.

The path highlighting modes («
escribed in the table below) a
re available for both focus an

d hover, except in special cas
[REN [TN

[3

 

Bahl

NameShow Scoped Flow From Block

Highlights control flow to cod
e blocks that are only reachab
le if

the current code block is exec
uted. This is useful to see a
[IE]Show Scoped Flow To Block

Highlights control flow from c
ode blocks that must eventual
y

reach the current code block.
This is useful to see a local
neighborhood of blocks that pr

A rl We ELShow Paths To/From Block

Highlights control flow from c
odes blocks that can reach the
current code block, as well as
control flow to code blocks t
hat

can be reached from the curret
t block. This is useful to sho

Wwallel the Curfent piotk.
Show Paths From Block

Highlights control flow to cod
e blocks that can be reached f
rom

the current code block. This i
s useful to show all possible
flowsShow Paths To Block

Highlights control flow from c
odes blocks that can reach the
current code block. This is us
eful to show all possible flow

B

before the current block.Highlights the control flow be
tween all possible looped bloc
[5

(cycles) that pass through the
current block. If a function
has

multiple non-intersecting loop
s, this helps resolve the loopthem too close to differentiat
e.

Show Paths From Focus to Hov
(hover mode only)

Highlights the control flow fr
om the currently focused code
block to the currently hovered

JA (RD I TL aed Thpossible, no edges will be hig
hlighted. This is useful to se

e

reachability between two secti
ons of the function.

Show All Loops In Function
(focus mode only)

Hiahliahts the control flow behl

(cycles) in the current functi
on. This mode doesn't actually
depend on a focused code bloc
; instead, selecting it highli
ghts

all loops immediately.

Function Graph Options
The Automatic Graph Relayouthati A cate lil satan le
ayout of the vertices as the g
raph changes. The available va
lues are:

Always - always perform a graf
h relayout anytime the code bl
ocks change or when graph gre
ps changelocks change or when graph gr
ups change

Block Mode Changes Only - onl
performs a relayout when the
code blocks of the graph chang
e (e.g., from an external edit
)Function Graph

Vertex Grouping Changes Only
only UCU a ICE (I'l Atgroup operation)
Never - never perform a relayo
ut of the graph automatically

Plugin 8/10

The Scroll Wheel Pans option s
ignals to move the graph verti
cal when scrolling the mouse s

PA TPIT VRE LE Iction graph

scroll wheel behavior of zoomi
ng when scrolled.

The Start Fully Zoomed Out op
ion causes the initial graph t

0 zoom out far enough that the
entire graph is displayed. Wh
en this option is off a new gr
aph rendering

will zoom all the wav in (no sRL Se A A A a ER A RR
Grouping option signals to the
graph to make the color of th
e grouped vertex be that of th
e vertices being grouped.

The Use Animation option sign
Is to the graph whether to ani
mate mutative graph operatior
and navigations.

The Use Condensed Layout optiby alot dR dab attlii Sait un
s possible when laying out the
graph. Using this option to f

it as many

vertices on the screen as poss
ible. Disable this option to m
ake the overall layout of the
graph more aesthetic.

The Use Mouse-relative Zoom c
tion signals zoom the graph touse. The default for this opti
on is

off, which triggers zoom to wo
rk from the center of the grap
h, regardless of the mouse loc
ation.

There are various edge color a
nd highlight color options ava
ilable to change. The highlighplace.
Creating Program Selections

From Paths

You may create Program Selec
ons from the current path high
lights by clicking Program Sel
ection

[TR I ET,Ighted, then these actions wil
| be disabled.

From Hovered Edges and From
[IEE]

[Rl eC ERTL

You may select all Code Units
in a Code Block by clicking Pr
odram SelectionPOPUP THIENUW OT Dy Usiiyg the tL
Celle

keybinding, Ctrl-A). This acti
on will select all Code Units

in all selected Code Blocks in
the graph. If no Code Blocks
are selected, then a Program
Selection will be created for
all Code Units in all Code Blo
cks in the graph.iia Bitubley Slaicaatcny | Bata od Lb beh bc ER J
ram Selection by clicking Prog
[CLIT Elelae])

Clear Selection from the popur.
[CLIT

Popups
The primary view provides vari
ous popup windows to provideph. To enable and disable popt
ps in the

primary view, right-click anyw

here in the primary view and s
elect the Display Popup Windo:
s toggle button from the popuy
[CLIT

Grou LNunctionality.

Group Selected Vertices - Grou
ps all selected vertices

Group Selected Vertices - Add
to Group - Adds the selected v
ertices to group vertex in the
selection. This action will n

ot be enabled if there is not
one, and

AE TIL Tv TeRemove From Group - Remove:
e uncollapsed vertex from its
group.

Ungroup All Vertices - Ungroup
s all vertices in the graph, n

ot just those selected or visi
ble. This operation cannot be
undone!

Ungroup Selected Vertices - Ur
aroubs the selected aroub vertPanning

There are various ways to move
the graph. To move the graph
in any direction you can drag
from the whitespace of the gra
ph.

By default, to move the graph
vertically you can use the mou
se wheel. In previous releasestamiatcibaabl Shi sl le eal 2 adie
o restore that

behavior, the Scroll Wheel Pan
s option. When this option is
on, you can zoom by holding tt
e Control key (Command key o
the Mac) while using the scrol

|

wheel. Alternatively, you can
move the graph left to right uThe satellite viewer may also
be used to move the primary ¢
raphs view by dragging and cli
cking inside of the satellite
viewer.

Function Graph Plugin 9/10oom, each block is rendered at
its natural size, which is th

e same scale as Ghidra's prima
ry Listing. From that point, w
hichisa 1:1

zoom level, you can zoom out i
n order to fit more of the gra
ph into the display.

To change the zoom you may

FTV Nn, a CT ina key on the Mac). This works
whether the mouse is

over the primary viewer or the
satellite viewer. Also, you m
ay use the context popup ment
from the primary viewer in ord
er to quickly zoom to the bloc
[3

level (1:1) or to the window |
evel (zoomed out far enouah tcALAA LF EER RA AL EL A a
to Vertex and Zoom to
Window, respectively.

To have the scroll wheel zoom
without holding the Control ke
y, you can disable the Scroll
Wheel Pans option.

To zoom the graph incrementa
y using the keyboard you can uult keybindings of
Control-Minusand Control-Eque
EX

The satellite viewer is always
zoomed out far enough to fit
the entire graph into its wind
ow.

Vertex Quick Zoom

If you double-click a block hef the block is not at full zoo

m (1:1), then the zoom level w
ill be changed to full

zoom. Otherwise, the zoom lev
I will be changed to fully zoo
med out. If you are zoomed pa:
t the interaction threshold, t
hen you can double-click anyw
ere in the block | I]While zooming out (away from
he blocks) you will eventually
reach a point where you can n
o longer interact with the lis
ting inside of the block. The
blocks provide
a subtle visual indication whe
n they are zoomed past this le
vel, in the form of a drop-sha

Amin Thea immame hala chmire +CRC US ERY

past the interaction threshold
, but the block on the right i

s, and thus has a drop-shadow.
This example is for illustrat
ive purposes only and during n
ormal usage all

blocks will share the save zoo
m level. So, if one block is z
oomed past the interaction thrLaci CR LAC

Interaction with blocks that a

re past the interaction thresh

old is simplified; for example

, when scaled past the interac
tion threshold, dragging in th
e listing area of a

block will drag the block, ins

tead of making a selection inction threshold.

 

hi io att nf Lettie

Painting Threshold

While zooming out (away from
he blocks) you will eventually
reach a point where contents
each block will not be painted
. Instead, each block will be
painted by aof the block.

Zooming past the painting thre
shold will improve the renderi
ng speed of the Primary View.

Saving View Information
The Function Graph Plugin will
automatically save your changs, zooming and panning. This t
appens as

your change the function displ
ayed in the graph and when yo
close the graph window.

Changes made to Snapshots w
I not be saved. This is done t

marin canflicrt hatiraan ~ha neand any otGraph
the snapshots
PLlelT

Plugin

Provided by: Function Graph PI
ugin

Related Topics:

Code Browser

EY Te ale nc)ALGHIDRA Training 12
TOP SECRET//CYBER//NOFOR!Memory Map 1/11

Memory Map
The Memory Map window displ
a list of memory blocks thatprogram. The component provi
s actions for adding, renaming
, moving, splitting, extending
CILIA]

deleting memory blocks.
Ghidra supports four different
block types through the Memo
y Map window:

FRE CINE I ER Tgp RelaInitialized - The block has an
initial value specified for t

he bytes

Uninitialized - The block has
no initial value specified for

J RYH

2. Bit Mapped - The block prov
ides a bit-addressable map ont
o other blocks. This is usefulin memory directly using an a
Iternative addressing space.

3. Byte Mapped - The block pro
vides a byte-addressable map «
nto other blocks. This can be
useful when the same

bytes can be accessed via two
or more addresses.

4. Overlay - The block is crea

VIE SN EVE TPT. TUTRIINLL LF TAitialized or

unitialized. Using Overlays is

a way to get around the probl
em where the program is too Ie
rge to fit completely

in the target system's memory
Overlay blocks contain code t
hat would get swapped in whe
the program needs

to execute it Note that Overl|L RE TNOVEU, Split OI EApaliucu.
In addition,

Overlays do not relocate with
image base changes.

To view the Memory Map, selec
Window

Memory Map from the main toc
menu, or click on the

in the tool bar. Note that the
current Image Base Address is(1)

Each row displays information
about one of the memory block
. The following summarizes the
information

about each block.

Name - Name of the memory b[DER] memory Ee
Start - The starting address
(in hex) of the memory block.
Memory Map 2/11

SE The Zul address (inhf the memory block.
R - Indicates read permission.
W - Indicates write permission

X - Indicates execute permissi
[LR

Volatile - Indicates a region
of volatile I/O Memory.

Type - Indicates whether the b
[PETE FE, TF Mn TE RIE TrLiles 9

Initialized - Indicates whethe

r the block has been initializ
ed with values; this property
applies to Default

and Overlay blocks.

Source - The name of the file
that produced the bytes that ir
ake up this block as set by th

e file importer:Led PR A I AA LE A
apped source address.
Comment - User added comme
bout this memory block.

Memory Block Edits
Rename

Memory Blocks can be rename
y double-clicking on the nameChange Read Permission

The read permission of a mem:
y block can be changed by left
-clicking on the checkbox.
Change Write Permission

The write permission of a mem
ry block can be changed by lef
t-clicking on the checkbox.
Change Execute Permission[St] on the ee )
Change Volatile Setting

Change Volatile Setting
Memory Map 3/11

The volatile setting of a memo
ry block can be changed by lefA memory block that is current
ly Uninitialized can be Initia
lized by clicking on the Initi
alized

checkbox. A dialog will appear
allowing you to enter a byte
value to be used to fill the b
lock.

Deselecting the checkbox will

Cs Wrst PAA Bd ALRhave the additional side effec

t of removing all functions, i
nstructions, data, and outgoin
g

references in that block.

Edit Comment

Memory Block comments can
hanged by double-clicking on t
he comment field and

enterina the new comment ThSLL A Ed

Memory Block Operations

The memory block operations
e available through the icons
on the header of the Memory M
p window, or

select a block in the table, r
ight mouse click, and choose a
ETLSelect Add to bring up the Add
Memory Block dialog. Fill in
the requested information and
select the OK button.

Memory Map 4/11

Block Name - Enter the name cddress of the new memory bloc
. If the program language
defines multiple address space
s, the address space must also
be specified. The address spa
[3

selection will not appear if o
nly one is defined. Overlay sp
aces are not included in the |ess space, a block may not spa
n across the current Image Bas
e

Address.

Length - Enter the length of t
he new memory block.
Comment - Enter a comment fi
the block if desired.

Read - Sets the read permissioion.

Execute - Sets the execute per
mission.

Volatile - Marks this block as
volatile 1/0 memory.

Block Types - Select the block
type from the combo box: Def:
ult, Bit Mapped, Byte Mapped,
or Overlay.

Default - A normal memorv blo29 spdle.

These blocks cannot overlap ar
y other default block. Default
blocks can be

either initialized or uninitia
lized. If you select Initializ

ed you can enter a

byte value that will be used t
o fill all the bytes in the ne

Ww memory block.either initialized or uniniti
alized. If you select Initiali
PERLITE TC Tor)

byte value that will be used t
o fill all the bytes in the ne

w memory block.

Memory Map 5/11

Overlay - An overlay block is
used to give an alternative sege in memory. This is achieved
by creating a

new address space related to t
he actual processor address sp
ace and placing

the block in the new space at
the same offsets as the start
address in the

processor space. Overlay blockyou select Initialized you can
enter a byte value that will

be used to fill all

the bytes in the new memory k
ock.

Bit Mapped - This is a block t
hat allow bit addressing of a
section of bytes

in memory. For example, the fi

IE ET I aOx1000 might also be addresse
as BIT:0. The second bit at t
he same byte

would then be addressed as BI
:1 and soon.

The illustration below depicts
a Bit Mapped block of Length
16 with a

Start Addr of (BIT:) 0000, and
a Source Address of 0000810CDIL UVETNay aUUICS5Es al dssl
gned from least significant bi
[SCNT

Hehliile TIA

This is used to model certain
processors that allow this sor
(ET IEE Te]

such as the INTEL 8051. When
Bit Mapped block is created yht’ phoiiaby’ Slain Sacoiliatta ok lot dd Sal
ich the bit addressing will be
based.

Byte Mapped - This is a block
that allows access to a range
of bytes in

memory using an alternative a
dress. In other words, it allo
ws the same set

of bytes to be accessed by twomust be specified that contain
s the actual bytes for this bl
ock.

Memory Map 6/11

Moveve action is enabled when
exactly one memory block is se
lected. Enter either a new sta
rt or end address to cause the
block to be moved.

Memory Map 7/11

TT rT TrStart Address - Current starti
ng address of the block to be
moved (not editable).

End Address - Current ending ¢
ddress of the block to be move
d (not editable).

Length - Length of the memory
block to be moved (not editabl
OR

New Start Address - Enter theLE RL ALLL BARA LAE
will be computed.

New End Address - Enter the N
W ending address for the block
. The NEW starting address
will be computed.

You cannot move a block unde
the following conditions:

The changes specified would re
sult in an overlap with the orhaiti Sha dbha

The block is an Overlay block.
Split

Select Split to bring up the S
plit Block Dialog. The Split a
ction is enabled when exactly
one

memory block is selected. Usesmaller memory blocks. There.
re four ways to enter the spli

t point:

SE

SE

SE

SE

an end address Ls RC first b[S][eI{ QT [1 eT

a start address for the second
block (new block), or

a length for the second block
(new block).

Memory Map 8/11

Rlarl Fm Clitng split (not editable)

Start Address - Start address
of block being split (not edit
able)

End Address - New end addres:
of the original block

Block Length - New length of o
riginal block

New Block

Block Name - Name of new bloTE RL EL

changed by editing this field
Start Address - Start address
for the new split block

End Address - End address of t
he original block (not editabl
e)

Block Length - Length of new s
plit blockERE

Expand Up
Memory Map 9/11
Select Expand Up to bring up t

he Expand Block Up Dialog. Th
Expand Up action is enabledock Up Dialog to cause a
memory block to grow by addi
additional bytes BEFORE the n
emory block. The block

can be expanded by either ent:
ring a new start address or a
new length.

New Start CEI LG starstart address.

End Address - Displays the end
address of the block (not edi
[ETN

Block Length - Displays the le
ngth of the block. A new value
can be entered here which wil
|

cause a corresponding change
ET JTexpanded.
Expand Down

Select Expand Down to bring u
the Expand Block Down Dialog
The Expand Down action is
enabled when exactly one men
y block is selected. Use the E
xpand Block Down Dialoda toPALA LLL BEAR RES) a LI =
R the memory block. The
block can be expanded by eith
r entering a new end address o
ra new length.

Memory Map 10/11

Start Address - Displays the shats oh tbadhd wd

New End Address - A new end :
dress can be entered here. It
must be after the current end
address.

Block Length - Displays the le
ngth of the block. A new value
can be entered here which wil
|

cause a corresponding changeexpanded.
[ETS]

The Merge action is enabled wl
ERAT NTR TT N ET TTA IIE
re selected. It attempts to
merge all selected blocks into
one block. Any "gaps" will bea VERY large memory block ca
be created if the

memory blocks being merged
far apart in the address spac
e. Ghidra will display a warni
ng

if a really large block is abo

ut to be created. Disregarding
the warning may cause Ghidre
Er.rror.
Only blocks of the same type c
an be merged. For example, de
ault blocks can only be
merged with another default b
ock.

PEEE

The Delete action is enabled wA Ea LLEC AS A SA
blocks will be deleted. If the
blocks contained defined data
or instructions, a confirmati
on

dialog is displayed; select "y
es" on the dialog to delete th
e block. A progress dialog is
displayed while the block is b
EEE EE CENtr JR iki Facial blond J

instructions, etc., the delete
operation may take a while to
complete. You can cancel the c
elete operation at any time.

operation may take a while to
complete. You can cancel the
delete operation at any time.Set Image Base

The Set Image Base action allo
ws you to change the base add
ess of a program. This action

5

useful when working with reloc
atable code such as DLLs or sh
LICE EULESS All addresses,lative to the new base address

For example, given a program |
ase at 0x01000000 with a mer
y block starting at address
0x01001000. If the base addre
s was changed to Oxeeee0000,
hen the new start address of t
LC)

J Tr SE FA Sr NTlo change the Image base, ent
ra new image base in the text
field and click on the OK but
[CIR

Provided by: Memory Map Plug

HII W hill Cale T I VAYAvdaliely OI aulOiTialeu alld Ihia
ual actions are provided withi
n the tool to annotate

(add information to) the progr
am file. Auto Analysis provide
s an automated way to
disassemble bytes into code, ¢
reate functions along with ref
erences to the stack

variables, and create referencor disassemble code. In additi
on, you can manually define de
ta in the file, set register
values, add labels and commer
s to a code unit, define a nam
e (equate) to substitute

for a scalar value, or bookmar
[ELIE [IEEE

Auto AnalysiseC]
Disassembly
Equates
[LleI.I
Labels
References
Register ContextAuto-analysis 1/6

Auto Analysis watches for chan
ges to the program, such as di
sassembling a new area of mer
ry or definition of a function

. When a change is noticed, it
kicks off Auto

Analyzer plugins interested in

A A SI Tey Imay decide to make further ch
nges to the program. Any chan
es an Analyzer

makes to the program may cat
additional Analyzers to run.
An example chain of auto anal
sis might be:

iS
2nt

5.

User Disassembles

Function Analyzer - looks at a
Il calls and creates Functions
Stack Analyzer - looks at all
new functions and builds a sta

ck based on stack references
Operand Analyzer - looks at scData Reference Analyzer - look
s at references for possible s
trings or pointers to code.
References to code are disasse
mbled.

cen Cycle repeats with 2) as
additional code is disassembl
ed.ctive, however only one Analyz
erisrun ata time. Each Anal
yzer has a run priority. For i
[I=] TA dT)

Operand Analyzer will always r
un before the Data Reference A
nalyzer because the operand a
alyzer could create new refere
nces that the Data Reference AAuto Analyzers normally chang
the program only if the Analy
zer can be certain the change
is correct. For instance creat
ing a function at the destinat
ion of a call is a

fairly safe bet. Randomly look
ing for undefined data that co
uld be disassembled where the

TETRA WS Se LeAuto Analysis

A program imported through F
nt End will have no initial an
alysis applied to it. To force
analysis, use the Analysis
Options dialog is displayed to
allow changes to the analysis
options before beginning anal
VEENULO Ahalysis

The display of this dialog ma
y be controlled from the Auto
Analysis Tool Options. Select
the Auto Analysis node in the
Edit

esl

Auto-analysisait bcibit LE db heii atl adh ible tal
n unchecked, the next time Au
o Analysis is chosen, the opti
ons dialog is

skipped, and analysis begins i
mmediately.

Without a selection in the Cod
e Browser, the entire program’
s memory space is analyzed. T¢
restrict the analysis to certcode browser before choosing /
uto Analysis. If there isa cu
rrent selection, Auto Analysis
will be restricted to only to
those areas of the program wi
thin the selection.

Areas outside the selection ma
y be changed by analysis. For
ClCH the OperandRefereing or a function

could be created at the refere
nced location.

When the Analyze button is pre
ssed, the Options dialog will
disappear. At the bottom of th
e Code Browser window, the be
kground task bar will display.
Any Analyzer

LINTo Cancel the analysis, press
lu)

button.

Analyze All Open

This action will auto-analyze
all open programs. The options
will be displaved onlv one tim.

When you choose options to us
for analyzing a program, they

are based upon the architectu
re of the current program. Whe
n analyzing all open

programs, any programs besid
the current program will only

be analyzed if their architecbaud ugh Baul Jeena el
El

program. Any other open progr
ms with an architecture differ
ing from the current program v
ill not be analyzed using this
action.

If the option to show the anal
ysis dialog is disabled, then
using this action will analyzedisable the analysis dialog go
[N11

Tool Options... to show the op
tions dialog upon which, selec
t the Auto Analysis options an
d de-select Show

Analysis Options.e available as One Shot Analyz
ers in the Analysis menu. Only
those analyzers which support
one-shot use

and are applicable to the curr
ent program will be available
within the One Shot sub-menu

Auto Analysis Options Panel

[TL TLR re Ithe Edit
ProgramOptions dialog.

The Analysis panel configures
Analyzer specific options and
which Analyzers are enabled tc
run. To view these options, c
hoose Edit

the Analvsis node in the OptioA A LL LAS A IR A at
alysis folder node.

Program Options...; then open

 

An analyzer may be marked as
Prototype). These analyzers ca
n be very useful on certain pr
ograms, but have not been exe
cised on a large number of2/6

Auto-analysis 3/6

A separate dialog showing the
Analysis options is also displ
ayed after a new program has |Auto Analysis menu item

Some analyzers only work on ¢
rtain processors. For example,

the MIPS Instruction Analyzer

only works on MIPS processors
. Their options will only

show up if the currently openAuto Analyzers

The following is a description
of the Auto Analyzers that ha
ve been implemented. Please r
te that this list may not be c¢
omplete since additional Analy
zers are

continuously being added to G

FY ie etAddress Table Analyzer

Looks at all undefined data lo
cations to find possible addre
ESR CLICES

You can also find and create a
ddress tables manually via the
Search for Address Tables
Started By: Importing or addin
ato a proaram Auto Analvze cEla) FATS

This analyzer works only again
st the ARM processor. It looks
at multiple instructions to d
iscover references that are pu
t together by multiple instruc
[TEN

Since the ARM is a RISC proces
sor and each instruction is on
ly 32 bits wide, many referencStarted By: New disassembled
ode

ASCII Strings Analyzer

This analyzer searches for val
id ASCII strings and automatic
ally creates them in the binar
y. Candidate strings are found
using the same method (and r
Baeandidate strings found, valid
strings are identified using a
model trained on pre-identifi
ed valid

strings. This analyzer runs at

a very low priority.

Set options for this analyzer
by selecting ASCII Strings on
Ri options SEU] Some REErt
alignment work the same way
in Search for Strings.

Options

Auto-analysis 4/6
Create strings containing exis

PUTER RAE SA Sa pryhey contain existing substring
s (existing strings will be
cleared). The string will be c¢
reated only if existing string

s (a) are wholly contained wit
hin the potential string, (b)

do not share the same starting
address as the potential strin
g, (c) share the same ending a
ddress as the potential strinaAEE ELA Sen LLL ERLE ® BA

e

created).

Create strings containing refe
rences - if checked, strings t
hat contain, but do not start
with, one or more references w
ill be created.

Force model reload - if checke
d, forces the model to be relofil Rall hr Baie Ladi tub Schl ial cl
wishes to see the effect of
changing a model without rest
rting Ghidra).

Minimum string length - specif
ies the smallest number of cha
racters in a string for it to

be considered a valid string.
For this analyzer, null
termination characters are ignREIN
arger number of false positive
s.

String length must be at least
IN

Model file - Specifies the mod
el file built using the BuildS
tringModels class (default is
REI EUl] ) Note thatas models should always be pl
aced in the 'Ghidra/Features/B
ase/data/stringngrams’ directo
2

Require null termination for s
tring - if checked, only null-
terminated strings are created

Search only in accessible mem

RAN LT A Lemhave at least one of the Read
(R), Write (W), or Execute

(X) permissions set to true. E
nabling this option ensures st
rings are not created in areas
such as overlays or debug sec
tions.

String end alignment - specifi
es the byte alignment requiren
ent for the end of the strinaARLLL® ILA BLED AA A LAE Eh
Alignments greater than 1 req!
ire that (a) the ‘require null
termination’ option be enable
d, and (b) if the null-termina
ted string does not end at an
aligned boundary, that there e
xist enough trailing '0' bytes
following the string to allow
alignment. If neither (a) norenforced.

String start alignment - speci
fies the byte alignment requir
ement for the start of the str
ing. An alignment of 1 means t
hat strings can start at any
address. An alignment of 2 me.
ns that strings must start on
an even address. An alignmentmultiple of 4.

Started By: Auto Analyze comn
ae]

Data Archive Analyzer

This analyzer looks at all the
labels defined in the program
and applies function signatur
es from standard data type lib
raries. For programs identifies, the data archive applied we
re parsed from the standard wi
ndows header files. All other
executables will have function
signatures applied from the st
andard * header files (stdio
, fentl, ...). For example, if

a label exists for strcmp upo

n import, the analyzer will as

ET TLand apply a runction signature
of "int stremp(char *, char *
".
Started By: Importing or addin
g to a program, Auto Analyze c
ommand

Data Reference Analyzer
Looks at all data references w
ithin newly disassembled code
for Unicode/Ascii strinas andA A ES EE
sembled

starting at the referenced loc
ation. When a valid string is
found, a string data type is c
reated.

Enable this option by selectin
g Ascii String References, Uni
code String References, or Sub
routine References on the optifii to) cient” eet tients
ode

Decompiler Parameter ID Analy
3

[Le -ETe RTT Teta le] Wel {-F1 dls BE (V1)

the decompiler and import the
information recovered about t
he given function. The informa
al N(CH

passed parameterslocal variables defined in reg
isters

return value

the prototype or calling conve
ntion (stdcall, cdecl, thiscal

|, fastcall, ...)

switch tables recovered by dat
a flow analysis

Applying type information recotype information for library f
unctions. You can apply functi
on

signatures to your library fun
ctions, and as code is disasse
mbled, type information will b
e propogated from the library
functions up into the paramete
rs and

[TL I FoF FY TAURI KVL TUPI WROmrSwitch tables recovered by the
decompiler can be applied to
improve the disassembly of coc
e. At times the basic switch t
able analysis cannot recover
complex jump tables. The decc
piler can also recover the val
ue used to "switch" on for eac
h case in the switch table. Th

e label created at each switchhe A Ee A BLA AS A A
switch value.

This analyzer is being enhance
d to pull more information gle
aned from running the decom
Ca

Enable this option by selectin
g Decompiler Parameter ID on
he options panel for Functionseli Sabai abi ea ah
ith functions already defined.
Demangler Analyzer

This analyzer examines the nat
e of the newly created functio
n. If the name appears to be a
GCC v3 or Microsoft Visual St
udio mangled symbol, then it v
1)

demangle the name and create[hal [ appropriate datatypes
to the parameters and return t
NCH

Started By: New defined funct
[LH

LaCley -analysis E73all Symbols in the symbol tabl
e marked as External Entry Poi
[lH

Enable this option by selectin
g Disassemble Entry Points on
the options panel for Byte.
Started By: Importing or addin
g to a program, Auto Analyze c
ommand

TE LRgram for images. If a valid im
age is found an appropriate im
age data type is applied at th
at location with the correspon
ding

visual representation of the i
mage. Also, a bookmark is add
d to indicate an image.
Started By: Importing or addin
ato a proaram Auto Analvze cFHFo aUUlEss ITialfkKUp Allaly El
This analyzer works only again
st the MIPS R4000 processor. |
t looks at multiple instructio
ns to discover references that
are put together by multiple
instructions. Since the R4000
is a RISC processor and each i
nstruction is only 32 bits wid
e, many references must be cretypes of switch or jump tables
and automatically create a ju
mp table.

Started By: New disassembled
ode

PowerPC address markup Anal;
r

This analyzer works only again
st the PowerPC processor. It |e put together by multiple ins
tructions.

Since the PowerPC is a RISC pr
ocessor and each instruction i
s only 32 bits wide, many refe
rences must be created by mul
[TIER ESV oN

It will also look for "bcctr”

BE switch statements ELCET]Started By: New disassembled
ode

Propagate External Parameters
Analyzer

This analyzer uses external Wi

ndows function call parameter
information to populate comm
ts next to pushed parameters.

In some cases, data is labeled

wadStarted By: Auto Analyze comn
ale]

Scalar Operand Analyzer
Looks for scalar operands that
are actually address referenc
es at each instruction operand
within newly disassembled coc
e.

Enable this option by selectin
dad Scalar Onerand References oEs

Started By: New disassembled
ode

Stack Analyzer

Creates a stack frame (parame
ers and local variables) based
on references to the stack fo
und in newly defined functions

Enable this option by selectinbeth lad seh be ket BL Beal do

Started By: New defined functi
ons

Subroutine Reference Analyzer
Creates a function at each des
tination of a call instruction

. If the destination would cre
ate a complex function, the fu
nction is not created. A compl
ex functionion.

Enable this option by selectin
g Create Functions on the opti
ons panel for Function.
Started By: New disassembled
ode

Windows x86 PE Analyzersor MS Visual Studio data struc
tures and code. They currently
attempt to identify RTTI
structures, virtual function t
ables, and exception handling
code. One also analyzes the ex
ternal functions and attempts
to propagate the data typesAuf
o-analysis

VEE A‘I'hese analyzers only run on PE
[SETTER

Started By: Analyzing the prog
ram or creating instructions o
r defined data with a Windows
x86 PE Analyzer analysis optio
n selected.

(Prototype) Auto Analysis Plug
insLe prototype AULL Allaly sc
rs that have been implementec

Aggressive Instruction Finder
This analyzer runs at the lowe
st priority after there are no
other analyzers needing to ru
n. It looks at undefined bytes
to see if code were disassemb
led at thebe no invalid instructions, a
nd the subroutine must not “fl
Ww" into any existing code.
Needless to say this analyzer
will not work well on every pr
ogram, but on some it finds al
| code with no mistakes. Your
mileage may vary. There's alw:
ag to a program, Auto Analyze c
ommand

Condense Filler Bytes Analyzer
This analyzer searches the pro
gram for all specified filler
bytes and collapses them. Som
examples of filler bytes are:

0, 00, 90, cc. If you do not
HEE]used. The default is the word
Auto and it will allow the pro
gram to determine the best val
ue to use
based on the greatest count. Y
ou also have the option to cha
nge the minimum number of b
s to collapse. The default for
this is 1.

IL TU ST TTProvided by: AutoAnalysisPlugi
il

Related Topics:

Disassembly

[LleI.I

6/6Disassembly

Disassembly is the process of
translating bytes into assembl
y language instructions.
Ghidra supports three differen
t disassembly actions:
Disassembly

Disassembler Options

Static DisassemblyDisassembly

Disassembly starts disassembli
ng at the current cursor locat
(LAN

disassembling an instruction,
it examines all possible execu
tion flows from that
instruction and disassembles a
t all those locations.the first undefined
byte within the selection. Aft
er exhausting all possible flo
ws from the

instruction, disassembly begin
s again at the next undefined
byte within the
selection.

iL [sll lL2. Right-mouse-click

3. Select Disassembly

The disassembly progress is di
splayed in the progress status
area (bottom right)

of the tool. The progress stat
us area displays the number of
instructions

disassembled and provides a "

w= rerensl? Wartime [Sms ses FEE Af mrthe disassembly process. Note:
this will not undo any disass
embly that has

already occurred.

Press the 'D' key to Disassemb
le starting at the current cur
EllgleleElal:I,

Selecting Undo will return the
disassembled instructions to
undefined bvtesDisassembly 2/7

Be aware that some processors
may allow for disassembly in d
ifferent modes

(eg: ARM vs. THUMB). Specific
commands may be provided fo
hese and are

not discussed here.aphladauicias. sl ti iviacc iad adalat il

The following Disassembler op!
ions exist which control certa
in behaviors during
Disassembly:

Mark Bad Disassembly - places
an error bookmark on any instr
FIST]

instruction flow which fails t

o disassemble due to parse errMark Unimplemented Pcode -
ces a warning bookmark on an:
instruction which has unimpler
ented pcode/semantics at the t
[IC]

disassembly was performed (Ei
bled by default). The
MarkUnimplementedPcode scr
may be run to update these waes may implement previously
unimplemented instruction pce
e.

Restrict Disassembly to Execut
able Memory - If enabled will
restrict

disassembly to those memory |
ocks marked as executable (Nc

restricted
hha Aafan +)ed via the program Options dia
log which allows

various program properties to
be examined or modified. This
dialog may be

accessed via the menu action I
dit Options for ... for the cu
rrently active

program. These options are prc
aram specific and stored withiUdlabdst. lhe ablve ployglialll |
operties can be accessed by cl
[LSI R TE]

Disassembler node within the
roperties tree. Any changes to
these options will

be stored when the OK or Appl!
button is clicked within the
dialog.

These option settings will behadi L bal i iniee i aiaaniil bf 3

auto-analysis.

Static Disassembly

The difference between Disasst
mbly and Static Disassembly is
that Static

Disassembly does not follow fl

ow and only disassembles one

Eilestarts at the first
undefined byte within the sele
ction and proceeds sequentiall
y to the last byte.

However, when disassembling
n a selection, the disassembly
starts at the firsty to the last byte.Disassembly
Ely

To perform Static Disassembly:
1. Place the cursor in the Cod
e Browser on an undefined byt
2. Right-mouse-click

3. Select Disassemble (Static)

The disassembly progress is di

ET EE mr a aof the tool. The progress stat
us area displays the number of
instructions

disassembled and provides a
ancel” button. Press the "Canc
el" button to stop

the disassembly process. Note:
this will not undo any disass
embly that has

alreadv occurredress the LiUh-U Rey LO otal
ic Disassemble one instruction
HET he IER)
current cursor location.

Selecting Undo will return the
disassembled instruction to u
ndefined bytes.

Disassembly (Restricted)hile ida bata din’ 0 Jatin utiles lute
t only bytes in the

current selection can be disas
sembled. Flows will be followe
d only if they are in

the current selection. If ther

e is no selection, only one in
struction will be

disassembled.

To perform Restricted Disassene Browser on an undefined byt

2. Right-mouse-click, and sele
ct Disassemble (Restricted).
The disassembly progress is di
splayed in the progress status
area (bottom right)

of the tool. The progress stat
us area displays the number ofancel” button. Press the "Canc
el" button to stop

the disassembly process. Note:
this will not undo any disass
embly that has

already occurred.

Press the 'Alt-D' key to Disa

etiten ve PLE ri F Sry 0 ett) Ear asd gs iusDisassembly 4/7

Selecting Undo will return the
disassembled instruction to u
ndefined bytes.

Disassemble ARM / Disassembl
Thumb
Disassemble ARM and Disasserne prograth

you are working with is an ARM
based processor. ARM process:
rs have two

states, ARM and Thumb mode.
e instructions available in AR
M mode are 4

bytes long. In Thumb mode, th
instructions are "generally"

PASCALhacia lahat 0 alk wll alia
er executing

Thumb encoded instructions or
ARM encoded instructions. Hov
ver, certain

branching instructions can cau
se the processor to switch mod
es. The default

mode for disassembly in an AR
program is to disassemble inhumb code that has not been ¢
sassembled,

Disassemble Thumb will set thi
disassembler into Thumb mod
and begin

disassembly.

The actions work exactly like
Disassemble in that they start
disassembling at theTo perform Disassemble ARM o
Disassemble Thumb:

1. Place the cursor in the Cod
e Browser on an undefined byt

2. Right-mouse-click, and choo
se the appropriate option for
the mode you

[TE Tv TC TE TR‘I'he disassembly progress Is di
splayed in the progress status
area (bottom right)

of the tool. The progress stat
us area displays the number of
instructions

disassembled and provides a "
ancel” button. Press the "Canc
el" button to stop

the disassemblv process Note:CMply thal Nds

disassembled and provides a *
Cancel" button. Press the "Can
cel" button to stop

the disassembly process. Note:
this will not undo any disass
embly that has Disassembly 5/
already occurred."F12" key

to disassemble in Thumb mode
Selecting Undo will return the
disassembled instruction to u
ndefined bytes.

 

Ra

Modify Instruction Flow
With certain processors and si
tuations it may be desirable ter reflect the nature of its f
low. For example a jump

may actually be performing a ¢
all type operation, a call may
be performing a

long-jump. This distinction pr
imarily affects the subroutine
models and flow

analysis performed within Ghicmay be imposed upon the def:
[la [RET]

instruction:

BRANCH

CALL

CALL_RETURN

RETURN

In all situations the conditio
nal nature of the original flo

ETAT Cr |ER gC IeER GRE gel RETR Ed
ruction within the Code Browse
r. Note that

instructions which are purely
fall-through can not be modifi
ed.

2. Right-mouse-click

3. Select Modify Instruction F
(VAN ELVEN

4 Within the Modifv InstructiMA EARL
behavior.
5. Click OK in the dialog

An instruction whose flow has
been modified will have its' m
LEI TCh ITN] lly

modified.Disassembly 6/7

Some processors have "modes
r state information that affec
ts how they will

interpret and execute the byte
s that make up an instruction.
REET oTel a 0 TEN

Ghidra creates a psuedo registcorresponding to the different
modes or options of the proce
ssor. The language

specifies a default for these
modes, but the user can effect
ively change the

defaults using the Processor O
ptions dialog.CRC CIR]

processor manual for a descrip
tion of a processors modes. Wh
enever,

disassembly takes place these
are the assumed values that w
Il be used to initiate
disassembly, unless the user h
as specifically set the values

J I LT | NElo changes the default process
or options:

1. Place the cursor in the Cod
e Browser.

1. Place the cursor in the Co
de Browser.

2. Right-mouse-click, and sele
ct the "Processor Options" mer=. CHIEN UE Valls alll press
the "Ok" button.

Provided by: Disassembler plug
in

Related Topics:

Clear

[pal oeT gale te M11

LanguagesGHIDRA Training 13
'RET//CYBER//NOFORNA newly imported program con
sts of bytes that have not yet
been identified. These bytesare displayed using "??". Disa
ssembly, analysis, and other u
ser actions convert these byte
s into instructions or defined
data. In general, the term "da
ta" refers to defined data.

Data Types
Data is created by applying Da

FOE. FL LA TR unalues and provide a visual
interpretation of those bytes
based on the Data Type used,
.g., a four byte IEEE floating
point number or a two byte
little endian word. Ghidra com
es packaged with a set of "Bui
It-in" Data types (e.g., byte,
word, float, etc). Ghidra

also provides the capability oDA SAE EAU ASE REED FS 4 Sas
def, etc) and supports dynamic
data types whose structure dey
ends on the underlying data.

It is important to note that t
he size of many of the primiti
ve built-in types is determine
d by the language and
compiler specification (e.g.,
the size of an integer can varha

Undefined - Fixed Size Types
Name

EIFS)
undefined (default)

11

undefined?2

2

undefined3undefined4

py

undefined5

I)

undefined6undefined?

7

undefined8

23

SettinasLonstant)

Numeric - Fixed Size Types
Name

Mnemonic
EIFS)

Signhed/Unsignedha a
db

1
Unsigned

sbyteSigned
word

dwBULIC]

sdw

Signed

pruint3
.

Unsigned

uint3

Tix]Ed
Unsigned
int3

int3

kc]dword
ddw

4
Unsigned

sdwordSigned
[lhl]

[lhl]Unsigned
[l=]

[le]

)

Signeduinté

[3
Unsigned
inté

tao)Signed
Shi)

Shi)int7

int7

Signed

[NI]8
Unsigned
sqword

sdqwSigned

Settings

Endian (*default, big, little)
Format (*hex, decimal, octal,
binary, ascii)

Mnemonic-style (default, *asse
mbly, C)

Mutability (normal, volatile,

AARNEMiscellaneous - Fixed Size Typ
£5

Name

Mnemonic

SIF)

Sianed/UnsianedAA

A

n/a

wcharl6Signed
wchar32

wchar32Settings
Mutability (normal, volatile,
constant)

Numeric - Dynamic Size Types
size determined by data organi
PENI RU TT Weel [TI ETS
specification - order is basedSigned/Unsigned
short

Signed

ushort

Tlneimmeardint
Signed
SiLid
Unsigned

longulong
Unsigned
longlong
Signed

ulonglongDalat

Settings (may vary)

Endian (*default, big, little)
Format (*hex, decimal, octal,
binary, ascii)

Data 2/15Format (*hex, decimal, octal,
binary, ascii)

Mnemonic-style (default, *asse
mbly, C)

Mutability (normal, volatile,
constant)

Padding (*unpadded, padded)

Miscellaneous - Dynamic Size Tzation within compiler
specification

Name

Description

char

Signed ASCII characterUnsigned ASCII character
wchar_t

Signed Wide Character
pointer

Pointer to memorv address (ms:ELLA ELC A Sa
float

Floating point data
double

Double-precision floating poin
t datahabla

Long double-precision floating
point data

Settings
Mutability (normal, volatile,
constant)

Blea te mpY ICharset
Charsize
Layout
string

FECTcharset
fixed length
string-utf8
UTF-8

pc]TerminatedCString
FECT

from
charset

null-terminatedUTF16

2 bytes

fixed length
TerminatedUnicode

UTF16a ia
null-terminated
[LICE ps
UTF32

4 bytesTerminatedUnicode32
UTF32

NOY
null-terminated

PascalString255from
charset

pascal 255
max characters

PascalString

coins tu [2Lieu
charset

pascal 64k
max characters

PascalUnicode

UTF16pascal 64k
max characters

Settings

Charset (defaults to US-ASCII
if user settable)

Render Unicode (all, byte sequ
ELICRCTET 1Charset (defaults to US-ASCII
if user settable)

Render Unicode (all, byte sequ
CNTR] 1

sequence)

Translation

Mutability (normal, volatile,
constant)User-Defined Data Types
Name

[DIT STela ToT)
structure

Grouping of data types that arunion
Grouping of data types that sh
are the same memory location

)

[a 15

ETE a TI Lmenum

A list of named integer consta
ls

pointer

A reference to an address (typ
e information optional)A specified number of consecu
ive data objects of the same t
ype

LOL ISLE TTT

A function signature tagged wi
th a generic calling conventioApplying Data Type

Data is created by applying a
data type to undefined bytes i
n memory. There are numerous:
ays to apply data

types. A status message indica
ting whether or not data was c
reated is displayed in the too
I's status area.ed if the data type will fit w
ithin the available

undefined bytes.

Drag from Data Type Manager
Use the Data Type Manager to
hoose a data type from the set
of available data types. To a
pply a data type

from the data type Manager:3.

Open the Data Type Manager (:
lect Window

Data Type Manager)

Select a data type from the Da
ta Type Manager

[5 TI LE I TnListing window

Cycle Groups

Cycle Groups are an easy way t
o apply basic data types (byte
, word, float, etc). A Cycle G
roup is a

collection of similar data typ
es that are commonly associate
d toaether Cvclinag a data tvpLhallging morn Ore Gata Ly pe LU
the next data type in the sam
e group. When the last data ty
pe is reached,

the cycle restarts.

Each Cycle Group has an assoc
ated "hot key". Pressing the "
hot key" cycles from the curre
nt data type to

the next one within the group.had boil cl Lied

Data 4/15

Each Cycle Group has an assoc
iated "hot key". Pressing the
hot key" cycles from the curr
ent data type to

the next one within the group.b

Byte

Ele]
RLIIRNIG]

' (singleAscii
String
[SLITS
hi

[E14[E14
QuadWord
Byte
eel}

To applv a data tvpe from a cv4. FICK d PasiC Uala Lype LU a
pply (for example double-word
2.

=

Place the cursor on the desire
d address or make a selection
Using the keyboard, press the
associated "hot key" until the
data type appears ("b" in thiheat Ki J

 

hair aniiail ht odd Sisson
first time "b" is pressed, a b
yte (db) will appear in the mn
emonic

field. The second time a word
(dw) will appear, and the last
time a double-word (ddw) will
appear.

 
 

4. If you pressed the "hot keyLCR
key" until you reach the data
type again.

Favorites
A Favorite data type is a data
type that you use frequently
and want to apply from the Daf
a popups Favorites. However, any data

type can
be configured to be a favorite

To apply a favorite:

1. Right click on cursor locat
[NIE Ela)

2. Select the Data popup subm
all

TOE TT I Wn 2plied

To quickly assign a key bindin
g to a favorite, use the Key B
indings Shortcut. Key Bindings
allow

you to assign "hot keys" to an
y menu item.

Recently Used Data Type

The last anblied data tvpe isARLES ELC A EL
the "hot key"

assigned to this option is 'Y"

. This feature is a useful sho
rtcut for applying the same da
ta type multiple

CEN

Clearing Data
Data and instructions can be cTo clear defined data back to
an undefined state:

1. Place the cursor on the def
ined data to be cleared

2. Press mouse-right, and choo
se Clear code bytes from the p
opup menu

 

Data 5/15Data 6/15

Deleting data types from the D
ata Type Manager window is a
uick way to clear every instan

ce of a data type in

a program.

Changing Data Settings
eC on the data 7 e,splayed. For built-in datatype
s, the available settings are
indicated in the table above.
For example, the byte data typ
e has a format option which
allows the user to have the da
ta displayed as hex, octal, et
c. The available settings are
defined in the Data Type Table

ORAL IER ea ie Tee item or for all data of the sam
e data type.

To change the settings of a si
ngle data item:

1. Place the cursor on the dat
a item

2. Press mouse-right to bring
up the popup menu

3. Select Data

EY au lale AE velo aisle Bole Ru oT =]In the screenshot above, the s
ettings dialog is shown for a
byte data type applied at addr
ess 0x01007192. The dialog
shows all the available settin
gs for that data type. For eac

h setting, the dialog shows th
e setting name, value, and a
checkbox indicating whether oNe a
To change a setting, click on
its value in the Setting colum
n. This will display a list of
valid choices for that

setting. Choose a value from t
his list of choices and press
OK. To reset a setting to its
default value, set the Use
Default checkbox.hen a default setting has been
changed, every data item
currently using the default se
tting for that data type will
use the new default value. Dat
a items that have a modified
value for that setting will no

t be affected.

To change RS EEE settingsitem of that type

2. Press mouse-right to bring
up the popup menu

3. Select Data

Default Settings... to bring u
p the default settings dialog

Data 7/15erault setting dialog Is shown
for the word data type. The d
ialog shows all the available
settings for that data type. F
or each setting, the dialog sh
ows the setting name and valu

To change a setting, click on
its value in the Settings colu
mn. This will displav a list oSELLNY. LHOLSE a Value TOIT L
his list of choices and press
OK.

Default settings on component
within a structure apply to t
hat structure only. For exampl
e, if Struct_1 has a byte
component with its format set
as Octal, then only other inst
ances of Struct 1 will be affedhl tate J Lali diab adhh
fected.

A typedef has the same set of
settings as its underlying dat
a type. For example, when you
create a typedef on a

byte, the default settings on
the typedef will be the same a
s the original default setting

s of the byte. Changing theta type doesn't affect the def
ault settings of the underlyin
g data

type or typedef respectively.
To change the data settings fo
r multiple data items:

1. Select data items of intere
st (does not work for interior
array elements)3. Select Data
Settings... to bring up the se
ttings dialog

In the screenshot above, the c
ommon data settings dialog is
shown for the current selectio
n. The dialog shows all the
settings common to all defined

J Lralog shows the setting name
and value, where the initial v
alue is blank. Settings left b
lank will not be affected, all
owing specific settings to be
changed without affecting othe
rs.

Creatina Other Data TvbesEA

Ghidra provides two mechanist
to create and modify Structur
es. The Data Type Manager can
be used to

create structures without appl
ying them immediately. It can
also be used to edit them. Alt
ernatively,

structures can be created andThis document describes how t
directly create, edit and app
ly Structures in the browser.
Creating a new Structure
Creating a new structure in th
e browser uses previously defi
ned data to define the
structure. The structure is cr
eated and applied at the sameEs
i

2.
EN
Fl

Select a set of contiguous def
ined or undefined Data
Use the right-mouse popup Daction are used to define the s

tructure

The Create Structure dialog is
displayed. This dialog can be
used to either create a

new structure or apply an exis
ting structure that has a matc
hing format. If a new

structure is created, it will
| FE TE ran DeThe Create Structure dialog is
divided into two parts. In th

e top part is used to provide

El

name if you are creating a new
structure. It is initialized

with a default name. The botto
ul

part shows a list of matchingLLL ES AL
PI

instead of creating a new one.
The method for finding matchi
g structures is either by an e
xact match or by a match on
structure size. You can change
the type of matching used by
clicking the Exact or Size rad
Its)The method for finding matchi
ng structures is either by an
exact match or by a match on
structure size. You can change
the type of matching used by
clicking the Exact or Size rad
3}To create a new structure, ent
er a unique name in the Create
Structure By Name text field
and press OK.

To use an existing, matching s
tructure, find and select the
structure in the Use Exisingns above. The only

difference is in Step (1), sel
ect contiguous bytes within an
existing structure.

Changing a Structure Name

1. Place the cursor on the fir
st line of the structure

2. Press mouse-right over the
structure and choose Data

CA i I RTS UT.Edit Data Type...

Changing the name of a Struct
re member

There are two ways to rename
structure member. The first w
ay is useful for quickly
changing the name of a single
member:ALA LEA BR LAS AA LS
in the Code Browser

2. Choose the Data

Rename Field option

3. Enter a new name in the Ret
ame Data Field dialog

The "Field Name" field must be
added to the "Open Data" tab
[REECE[SE ATTN Rd TN eee]

Data 9/15

The "Field Name" field must b

e added to the "Open Data" tal
in the Code

Browser header in order for thBrowser.

The second way is more useful
for changing the names of mul
TENE EER

1. Place the cursor on the fir
st line of the structure

2. Press mouse-right over the
structure and choose Data

3. Edit the field name for theEdit Data Type...

You cannot set the field name
of undefined member

Union

Unlike structures, unions can
only be created using the Unio
n Editor in the Data Type Mana

FR 1be applied like any other dat
a type.

Enum

An Enum (Enumeration) data t
eis a C-style data type that
allows the substitution of a v
alue for a more

meaningful name. Enums are «
ated from the Data Type Manag
rusina the Enum Editor Whenapply tice chun toa progralii, |
he name of the enum appears
the mnemonic field and the nz
[ERE]

corresponding to the byte at t
hat location appears in the op
erand field.

Example: Define an enum colo
with values red, green, and bl
ue assigned to 0x00, 0x01, 0x0hihiad pda otonini) Jd

olor to:

 

010062ab 01 ??
0lh

the result is:

010062ab 01 color
green

Daa irf the values defined in the en
m, "Unknown value: <value>

s displayed as

the operand.

IC

A pointer data type points to

another data type, including o

ther pointers. Pointers can be
typed o ord-to location. By default, poi
nters have the

same size as the size of an ad
dress for a particular process
or. For example, the pointers
on a 32-bit

processor will be 4 bytes long

To apply an untyped pointer:
NiPlace the cursor over an undef
ined data

2.

Press the 'p' Quick-Key
ye

Data 10/15Lx

ER
£3

Press the 'p' Quick-Key

- or Drag a Pointer data type
from the Data Type Manager w
[leA default-sized pointer is cre
ated

If a valid address can be form
ed at the location where you c
reated the pointer, a referenc
CRE

created to that address.

To create a typed pointer:EN

First create an untyped pointe
r (described above)

Apply a data type to the untyp
ed pointer

The mnemonic will change frot
‘addr’ to the referenced data
type's mnemonic (ie: for a bytPressing the 'p' key invokes t
he pointer action. This will g
enerally create a default poin
ter unless the

existing data is already a poi
nter in which case that pointe
r will be wrapped with an addi
tional pointer (e.

SE ELT NN, | LIT SeYy a default sized pointer. Oth
erwise you can

drag one of the other pointer
types from the Data Type Mana
er window. With existing point
er data, the

base type of that pointer may
be changed simply by applying
another type onto the pointer
(eda abblvinaEACLE ELE ASL A LR LL
is pointer stacking behavior t
o happen, itis

best to clear the code unit(s)
before applying a data type v
ia drag-n-drop or key-binding
actions.

To create a pointer of a speci
fic size apply either pointer8

, pointerl6, pointer32, or poiact aia’ rth ci ita Sand
, 4, 8, respectively.

Ie)

An array is a collection of da

ta items of a single data type

. The number of elements in th
e array is specified

when the array is created. Arr
ays can also be multi-dimensio
nal. In this case, the innermoREECE CELE CVA
1. Place the cursor at the add
ress where you want to create
an array

2. Create one data item of the
base data type for the array.
Any data type is valid, inclu
ding structures

ES as [CH aS CIS 17Create Array

4. A dialog will prompt you fo
r the number of elements in th
e array. It will be initialize

d with the

maximum number of elements
t will fit into the available
undefined bytes. It will also

let you

TT rT —existing data.

5. Enter the number of elemen
s in the array, and press OK

To create a multi-dimensional
array:

1. Create an array using the i
nner dimension for the numbei
of elements

2. Place the cursor over the n
ew arravBARA ER LA Cl RAC LLL AS
array and choose Data

Create Array

4. Enter the number of elemen
s for the next dimension, and
press OK

5. Repeat steps (3) and (4) un
til all dimensions have been c
reatedRICA

Data 12/15

A typedef is an alias for anot
her data type. It is useful fo

r giving a more meaningful nat
e to a data

type. For example, you might t
ypedef dword to be int. Typedeand applied like any other dat
a type.

LI)

A void data type can only be u
sed as the return type (i.e.,
<RETURN> variable) of a funct
on and can be

specified from the Function Ed
itor, Set LICH) ] 2d up actiManager using drag-and-drop.
String Data Types

A String consists of a sequenc
e of characters and is general
ly terminated by a null charac
ter ('0') or has a

length value prefixed before t
he string.

Characters in a string

The rharartare hat make 1m aes In a multitude of ways:
Single bytes from the ASCII or
other character set.

16 bit or 32 bit int values fr
om the respective Unicode cha
acter sets.

Variable length byte/int seque
nces that encode a single char
acter, such as UTF-8 or UTF16.
Size of a strinaRRL)

Null terminating character (*
0').

Containing field length (ie. f
ixed length strings, or length
of an array of characters).
Prefixed length value for Pasc
al strings.

Each Ghidra string data type w
ill document if its null-termiits description or its type na
me.

The difference between null-te
rminated and fixed length stri
ngs is subtle. A null- termina
ted

string will extend until a nul

| character is found (witha s
anity check max of 16k), regarture that contains the string,
whereas a fixed length string
EEE]

is determined by its containin
g field, with trailing null ch
aracters trimmed, but interior
Lil]

characters preserved.

In practice, the user will beCEES

containing field/structure as
the Ul will size the containin

g field to match the detected
length

of the null-terminated string.
However, if the bytes that ma
ke up the contents of the null
terminated string are changed,

en ST Es ee TLLring

instance could use bytes from
outside of its footprint to co
nstruct itself. In this case t

he string

will be displayed in red to in
dicate that there is an issue.
Character sets

Character sets define how char
acters are represented as bvtere
converted into characters.

Not all byte values are valid
character encodings, and may
result in undecode-able values
- for

example, byte values from 128
255 are not valid when usingfairl alah bc Mcill  Eabat HR Lad)
When a invalid mapping is enc
untered, it will be represente
d as the Unicode character *

which will render on your scre
en with an OS and font specifi
c shape (it is called the
"REPLACEMENT CHARACTER"
typically encoded as [uFFFD]re always available:

Us-AsClIl

limited to values between 0-12
A

1SO-8859-1 (Latin 1)

see also windows-1252.

[SRE

variable length 1-3 byte Unico[aIe=ERe [TRUE
indistinguishable from US-ASC
I.

UTF-16, UTF-16BE, UTF-16LE
2 byte Unicode encoding.
variable length, 2 or 4 bytes
UTF-32, UTF-32BE, UTF-32LE
4 byte Unicode encoding.

Fe 1 I CTL» Iava JVM:

IBM437

old school extended ASCII.
Windows-1252

GB2312

Chinese

variable length 1-2 bytes
Many many more...

Unicode Byte Order Marks (BOI
Unicode strinas can start withLER A
string. The BOM character byte
s will be FE FF (16 bit) or 00
00 FE FF (32 bit) if

the string is big endian, othe
rwise it will be FF FE (16 bit

) or FF FE 00 00 (32

bit) if the string is little e
ndian.

If the BOM is present, it willhitch hak Stata aia
the string.

Arrays of character elements
Arrays of character elements (
ie. char[16]) are treated as f
ixed-length string data types.
Arrays of wide char data types
(wchar, wcharl6, wchar32) ar
treated as Unicode strings.
Creating string instancesCreating string instances
Data 14/15

When creating a String at a lo
cation, consecutive characters
will be included in the Strinountered.

When applied to a selection, S
tring data types absorb all by
tes in the selection into a si
ngle

string ignoring terminators.
TerminatedCStrings, on the ott
er hand, create multiple strin
gs for the selected bytes,

1 EL. EO,Settings for string Instances
Each string instance has setti
ngs that can be customized to
change the way the string is d
ecoded

and how it is rendered when di
splayed.

Charset

Any of the currently available
iava nio charsets=SCC LHalotL _THTO.AMIT LO CUSLOTIT
ize display order or character
ErLN

Not available on string types
that have "UTF*" or "Unicode"
in the name.

Render non-ASCII Unicode

all - attempt to render the ch
aracter (display font may or m
ay not provide it)ila ti tated aiid Liable
character

escape sequence - show as an
scape sequence - "ul234"
Translation

Toggles display of translated
string value on and off.

Same as popup menu action D.
| Translate | Toggle show tra
nslated value.Dynamic data types adapt to tt
e underlying bytes to which th
ey are applied. These data typ
es can only be

created by writing a new Java
class. For example, an IP head
er packet that has a header, b
ody, and

terminator might be a good calcify the length

of the body. The Dynamic data
type can change its size and s
tructure based on the informat
ion stored in the

IP header.

The PE (Windows Portable Exec
table) data type is another ex

ample of a dynamic data type t
|hen you apply the PE data type
, it creates (1) a new categor

y (using the

address as the name) in the pr
ogram data type manager, (2)
structure for the DOS header,
and (3) a

structure, PE, that contains t
he DOS header. In order for th
Pe EIR aie Re No Ro lee]ITIUSLHTIPOIL a Uo pProglralll ds
inary file.. The size of the s
tructure varies according to t
he information in

JERI ete TT

Provided By: Data Plugin
Related Topics:abt ai tau ERE J ated
Sle ER ele]
Enum Editor

Data 15/15

Data Type Manager 1/20

Data Type Managerapply data types to a program.
Allowing

the user to build libraries of
data types and to share them
between programs, projects, al
d different

users is a long term goal for
Ghidra.

Prior to Ghidra 4.3, sharing d[elite

(users would have to drag data
types, one at a time, from on
e program or archive to anothe
rto

propagate changes to data typ
s). As of Ghidra 4.3, signific
ant progress has been made to
make

I I I TREIs problem requires users to u
nderstand a

number of basic concepts to ta
ke advantage of the new featul
CE

RET

Basic Concepts

Data Type Manager Window
Workina With Data Tvpe ArchivWVOTKITIY VVILTT aly lies
Working With Data Types
Managing Archives

Basic Concepts

Data Types

Ghidra supports three kinds of
data types: "Built-in", user
Lil RET]The built-in data types are
implemented directly in Java a
nd are

used for the basic standard ty
pes such

as byte, word, string, etc. Th
EZ

be changed, renamed, or moveUser Defined There are four us
er defined data types:
Structures, Unions, Enums, anc
Typedefs. They can be created,
modified, and renamed as nee
d.

Derived

There are two derivative dataand
arrays can be created and dele
ted as

Pointers and Arrays. Pointers
and

arrays can be created and dele
ted as

PR A YT TCE VA TI WIderived from their base type.
Data Type Manager 2/20

Data Type Archives

Data type archives are used to
bundle and share data types b
etween

programs, projects, and users.

There are two different tvpesLredled afChiives. Flic Uala Ly
pe archives and Project data t
ype archives.

Data type archives can be acce
ssed within the Data Type Man
[13

window. When a data type arc}
ve is open, it is displayed as

a node in

the Data Type Manager tree. Aautomatically when a program
s opened which references tha
archive.

Data type archives can be oper
for modification or as read-o
nly. Within

the Data Type Manager windov
here are actions for opening,
closing,Built-In Data Type Archive
The "Built-in" archive is a sp
ecial archive that is always a
vailable in the

Data Type Manager window. It
rovides access to all of Ghidr
a's

Built-in" data types. "Built-
in" types are discovered by seIn the unlikely event that new
data type class files or

jar files are added while Ghid
ra is running, there is a refr
esh

action which will find and add
the new data types to the
"built-in" archive.Fille data type archives (or si
mply: file archives) store dat

a types in files

and have ".gdt" filename exter
sions. They can be located any
where in

the filesystem. File archives
can be open by more than one
ser at the

same time (assuming it is locaut only onc

of those users can have it ope
Rel pleleiieClalel

Project Data Type Archive
Project data type archives (or
simply: project archives) sto
re data types

in Ghidra project database dir
ectories, along with the progr
ams for thathataudut dt ted cb’ A bg’ eel

NEEL RG]

in Ghidra project database di
rectories, along with the prog
rams for that

project. The Ghidra Project Wi
ndow will display project arch
NEEL RG]ow the programs in the project
RHI

archives can be versioned and

shared in a multi-user environ

ment just

like programs. They use the sa
me "check-in/checkout” semar
cs for

updating : EU] sharing BUELLes, data types are also stored
inside

programs.

Any data type used in a progra
m must be stored in that progr
am

even if it originally came fro

m an archive.

Because of this, the "same" da

FU YL EE AR rror program and can be moditie
in different ways in each pla
ce where it

lives. Prior to Ghidra 4.3, ke
eping data types consistent be
tween

archives and programs was a p
oblem because there was no w
ld

maintain an association excebnALES

difficult due to potential con
flicts. Now additional informa
JT RNS EH

source archive, unique ID and
various change times are main
ained to

facilitate keeping data types
consistent across archives and
programs.Raion ib Aube wit
Within a program or data type
archive, data types can be org
anized

using categories. Categories a
re like folders in a filesyste

m and allow

data types to be organized int
o a hierarchical structure. Ca
tegories arewords, the

same data type might be in a c
ategory named "aaa" in an arc
ive and be

in a category named "bbb" in t
he program. As far as Ghidra i

B

concerned, the different categ
ory does not constitute a dataData Type Manager Tree

The Data Type Manager windo\
rganizes data types using a tr
L

structure. At the first level
below the tree root, a node wi
Il exist for each

open archive and the "Built-in
" archive. If a program is ope

BE: be ge pilrepresenting the program. In n
any ways, an

open program behaves like a d
ta type archive.

Applying Data Types

Applying Data Types
Data Type Manager 4/20LYPE 15 LO apply IL LO VallOus
elements in a

program. Data types can be ap
lied to memory locations to pr
ovide

interpretations of the bytes a

t those locations. They can al
so be used to

describe function parameters a
nd local variables.bi adiant ad Batlle eked

and drop

them on an element in the pro
ram Listing. This action will
cause a

copy of the data type to be ad
ded to the program and then a
reference to

the copy will be used to annot
ate the program element. Thera program and they are descri
bed in more

detail later.

Resolving Data Types

When a data type from an arch
ve is applied to a program, a
copy of that

data type is created in the pr
ogram. The process of makingmplicated process because dat
[87 CENT

contain or reference other dat
a types, possibly in a circula

r fashion (via

pointers). These referred data
types may or may not already
exist in the

program and the resolving proc

J 0 Su COR en Arydata type might alreaqy exist
with the same name as the res
ving data

type. Even if the conflicting
data type is equivalent, Ghidr
a may not be

able to determine if the exist
ing data type is really meant
to be the same

as the resolvina data tvhe Gerenaming the new or moved ty
by appending “.conflict" to i
ts name.

For many of the data type acti
ons initiated from the Data Ty
pe tree

window, the specific conflict
resolution is determined by th
e currenthooks cle Za asia katte
type to a

program can cause many new
a types to be added to the pro

gram.

Source Archive

Whenever data types are resol
ed from an archive to a progra
mor

another archive, the default binformation about the archive
from which the data types orig
inated. So

each archive or program maint
ins a list of source archives
from which

it has associated data types.
Ghidra uses the term Source A
chive as ave where a data

type originated. Whenever a pr
ogram is opened, the Data Typ:
Manager

gets a list of source archives
from the program and automa
cally opens

the corresponding data type ar
chives if it can find them. Usce archive object along with |

nformation

from the actual archive and th
e change time on a data type,
Ghidra can

determine if data types are ou
t-of-sync with their correspon

ding data

type in a program or other arc
SHRThe data type tree will indic
ate data types that have a sou
rce

archive association by display
ing the name of the source arc
hive in

parenthesis after the data typ
e name.DataTypeName (SourceArchive
Bl

Client Archive
Ghidra uses the term client ar
chive to represent the archive
that contains
a data type taken from a sourc
e archive. This includes normaUpdate Source Archive Names
When new releases of Ghidra a
e installed, old datatype arch
ives may be

dropped. In some cases these ¢
Id archives may be replaced wi
tha

differently named archive. Whe
n this happens, this popup actdate the old source archive re
ferences. This

popup action is only available
when such an archive name cl
nge has

occurred. Any programs or othe
r client archives which refere
nce the old

archive will have this popup a

J SEI. T NY TI WA IEarchive name reference.
Committing Changes To Source
(HIVE)

If changes are made to a data
type that has an association w
ith a source

archive, those changes must be
applied to the original in th

e source

archive to keep the data tvbesdL LLL

mean propagating changes fro
a data type back to its corres
ponding

data type in the source archiv
e.

Updating Data Types From Sou
e Archive

If changes are made to a data
type in an archive that has asho’ sod tab hast abt ot Ecolab
se changes can be pushed out
o those

associations. Ghidra uses the
term update to mean propagat
g changes

from a data type in a source a
rchive to its associated copie
ERLE

archive.If changes are made to a data
type that has an association
with a sourceData Type Manag
6/20

archive, that data type is now
different from its source dat

a type. Ghidra

uses the term revert to throwback to the way itis in the s
ource archive. If changes are
made in both

the referenced data type and t
he source data type, the rever
t action will

not be available because the o
riginal state is not known. In
this case, you

NT yl ST COR WEN WET TYCR-1eVCN

or update losing the changes i
n the client archive. Current!

y, there is no

merge capability.

See Reverting Changes for mor
information.

Synchronizing an Archive
When changes are made to daf
tvbes in either the source arcAL LR ALL ALAS A A LAA
said to be out-of-sync. Ghidr

a provides a

capability known as synchroniz
ing to find all the data types
that need to

be committed, updated, or rev
rted and allow the user to mak
CE]

decision on each data type.ectories used to search for fi

le archives.

This list is known as the arch
ive path. Ghidra provides a di
alog for

adding, removing, and re-order
ing the list of these director
ies. When

Ghidra maintains source archiyit only stores the name of the
archive and not the entire fi

le path.

Storing absolute paths would n
ake the file archive reference
BY

brittle when the program is sh
ared or moved to another locat
ion. Bythe source

archives in different location
s on their computer and still
be able to find

the archives in their shared p
[CFTC EN

See also: editing archive path
EX

Waerkinm with Rata Tune ArehisI'here are two types of Data ly
pe Archives: File and Project.
File Data Type Archives

Files containing data type
definitions, which have
".gdt" as their file suffix.

Project Data Type Archiveswithin tne shidra project
directory structure, which
also contain data type
definitions. These are

also contain data type
definitions. These are
available in the Ghidra
Project Window and canhatha abet’ battatalinig Ltt J
Data Type Manager 7/20

The data types contained in an
archive are organized into ca
tegories similar to the

way files are organized into d
irectories in a filesystem. Ar
chives are useful fores available for use in

other projects. Normally, file
archives are opened in a read
-only mode, but can

optionally be opened for editi
ng. Project archives are norma
lly opened for editing,

since they support sharing and
version control and thereforeOnly one user at a time can h
ave a file archive opened
for editing.

Opening a File Data Type Archi
\Z

From the local menu

, select Open File Archive...
ASIEN [IE Tg

will armmaar lea Fhe fila ~hAna type archive

to open. A new node will appes
rin the tree for the newly op
CLEE]

archive. Also, the directory c¢
ontaining the newly opened ar
hive will be

added to the archive path if i
tis not already there.

Obpeninda a Proiect Data Tvbe A]ARAL A LA RL

, select Open Project Archive.
... A Ghidra

project data type archive choo
ser will appear. This chooser
will show all

the project archives in the cu
rrent project. Use the chooser
to find and

select the project data type aLil il wil
the tree for the newly opened
archive.

Creating a New File Data Type
Archive

From the local menu

, select New File Archive...

A file chooser will

appear. Use the file chooser t
o select a directory and enteralready exists with that name
, a dialog

will appear asking if the exis
ting archive should be over-wr
itten. A new

node will appear in the tree f
or the newly created archive.
Creating a New Project Data Ty
pe Archive.. A Ghidra

project data type archive choo
ser will appear. Use the choos
er to select a

From the local menu
, select New Project Archive..
.. A Ghidra

rorreims ate miei Sarre Swe Tn rE ob heCIR eRleeb ec]

a Type Manager 8/20

folder and enter a name for th

e new archive. A new node will
appear in

the tree for the newly created

archive.

You can also create a new Proj
ect Data Tvpe ArchiveAASLLLAACE® ALY LL AR LA A
Ghidra Project Window. This wi
Il create a new Project Data
Type Archive populated with tt
e same data types as the
dragged File Data Type Archive

Closing a Data Type Archive
Select the data type archive tClose Archive action. The arch
ive will be removed from the t
ree.

Opening a File Data Type Archi
ve for Editing

When an archive is first opene
d, itis not editable. In orde

r to make any

changes to the archive, it musedit, right-click on it and se
lect the Open for Editing acti
on. If someone

else is currently editing that
ELIE GIR Tad CI RUT R ET)

| and a dialog

will appear explaining that so
meone else is already editing
[ICH EICUlSWhen an archive that is open f
or editing no longer needs to
be edited,

then it should be put back to

a read-only mode so that other
users can

then modify it. Select the dat
a type archive to close for ed
iting,

LI CTT EN SeTthe archive

has unsaved changes, a dialog
will appear providing an oppor
tunity to

save the changes.

Saving Changes to a File Data
NEYO

Whenever a data type archive |
as been opened for editing and
IEAE SA) ARLE LER LL LL EC LL
ached. For

example the archive "MyArchiv
" will display as "MyArchive *
Ar

save these changes, right-clic
k on the unsaved archive and s
Clea)

Save Archive action. The chang
es will be saved and the namehot iui a est ian aii odo atl fal ull

Saving a File Data Type FY
eto a New File

Saving a File Data Type Archi
ve to a New File

Data Type Manager 9/20nd select the

Save As... action. A file choo
ser will appear which can be u
sed to

choose a location and filename
for the new archive that will
be created.

The tree will be updated to sh
ow the new name for the archie file is unaffected.

Deleting a Data Type Archive
Deleting an archive will not o
nly remove the archive from th
e tree, but

will permanently remove it fro
m the filesystem. To delete an
archive,

right-click on it and select t

J TAT LR Tr Namust be open for editing befor
e this action will appear (see
Opening a

Data Type Archive for Editing)

Removing an Invalid Data Type
Archive

When an archive file fails to
open (when Ghidra can't find t
he file in theARLE SA A LE LLL Se
displayed

with the

icon. If you wish to permanent
ly remove the file path

from the tool configuration an
d the current program options,
you may

right-click on it and select t

he Remove Invalid Archive actihla
rogram or Archive

Right-click on the program or
data type archive where data t
ypes are to

be aligned, and select the Ali
gn All... action. A confirmati
on dialog will

appear to make sure you want
o align all the structures and

bled J Ldve. If you continue, all struc
tures and

unions that are unaligned will
be changed to aligned data ty
pes with no

minimum alignment (the defat
) and no packing.

Updating an Archive From a Sc
(RCV)ther source

archive may need updating if t
hey have been changed in the
riginating

archive. If a an archive has o
ne or more datatypes that neec
updating, it

will be marked with either the
or the-click on the node that needs
updating and

select Update Datatypes From
<Source Archive Name>. The
Update Data Types dialog will
be shown allowing you to selec
ja)

select Undate Datatvbes FromUpUdLE Vala | ypes UlalLy Will
be shown allowing you to selec
t the Data Type Manager 10/20
datatypes to update.

Ghidra uses time stamps and fl
ags to determine if an

archive is out-of-sync. This c¢
an result in Ghidra indicating
the archive needs updating whhalahiaa bs ods IE Bak abit ail’ JB cial lacs hd
nged and then changed back, |
will cause Ghidra to think the
data type was changed. In thi
B

case, invoking the update acti
on will cause Ghidra to search
for updates, but when it finds
none, a message dialog will
appear indicating that no chanated.

Committing Changes in an Arc
ve To a Source Archive
Datatypes within an archive th
at originally came from some o
ther source

archive may have been change
and need to be pushed back (ca an archive has one or more
datatypes that

need committing, it will be ma
rked with either the or the
icon.

To commit the datatypes, right
-click on the node that contai
ns the

changed datatypes and select |

AArchive Name>. The Commit L
Types dialog will be shown al
lowing

you to select the datatypes to
commit.

Ghidra uses time stamps and fl
ags to determine if an archive
5

out-of-sync. This can result i

n Ghidra indicatina the archivdL RL® BRL R ASE BASU ALS
es not. For example, if a data
type is

changed and then changed ba:
it will cause Ghidra to think
the data

type was changed. In this case
, invoking the commit action w
ill cause

Ghidra to search for commits,Baia
will appear indicating that no
changes were detected.

The source archive must be edi
table in order to commit File
archives must be open for edit
ing and project archives that
are under

version control must be checke
d-out.Datatypes within an archive th
at originally came from some o
ther source

archive may have been change
and need to be reverted back t
osame

state as the source archive (i
.e. discard the local changes)
If a an archivearked with
either the or the
icon.

has one or more datatypes tha
t can be reverted, it will be
marked with

either the or thelo revert the datatypes, right
-click on the node that contai
ns the changed

datatypes and select Revert Da
tatypes To

<Source Archive Name>.

The Revert Data Types dialog v
HIRE CRE [RY VRE
Clea)

PEI Indo Re RelaALESSI AC EL RL A a LA A
e

Datatypes within an archive th
at originally came from some o
ther source

archive may be disassociated f
rom their source archive. This
A

prevent them from being upda
d or committed back to the solne or more datatypes that have
Ele

archive relationships, the Dis
associate action will be avail
able.

To disassociate datatypes, rig
ht-click on the node that cont
ains the

datatypes and select DisassociName>. The Revert Data Types
ialog will be shown allowing y
ou to

select the datatypes to revert

Refreshing Data Type Sync Indi
cators in an Archive For a Sou
(RIVE)

Datatypes RICH are LEER]update, or conflict icon indic
ating they are out of sync wit
h the data type

in the source archive, when th
e data type actually matches t
he source

datatype. This can happen if a
data type is changed, but cha
nged to

LE TWIN] FOF | TOhe sync

indicators for that source arc
LLCS

To refresh sync indicators for
datatypes associated with a p
articular

source archive, right-click on
the node that contains the da
tatypes and

select Refresh Svnc Indicatorsesd tbl Ra Eh LLL LL te]
Version Control / Multi-user A
ctions on Project Archives

The full set of version contro

| actions from the front-end p
roject window are

available when right-clicking
on a project archive. See the
Version Control section

of the Project Window for moreWorking with Categories
Categories are used to organiz
e data types into a hierarchic
al structure. Categories

can contain data types and oth
er categories. Archive nodes r
epresent the root orcal structure. Categories

can contain data types and oth
er categories. Archive nodes r
epresent the root

or

Data Type Manager 12/20
default category for their cor
responding archive they repres
ent in addition toactions that apply to

category nodes can also be apy
lied to archive nodes. The two

exceptions are Delete

and Rename. The root category
in an archive cannot be delete

d and to rename it,

you must use the Save As... ac

tion, since its name is the na

rNRight-click on the category wh
ere the new category is to be
created.

Select the New

Category action and a new cate
gory named "New

Category" will be created.
Renaming a Category
Right-click on the category to
be renamed Select the RenanLLL LS J SAT LRAT AL LR
in the in-place text edit box.
Deleting a Category
Right-click on the category to
be deleted. Select the Delete
action. A

confirmation dialog will appea
r since this action cannot be
SLLCTeT,

(unless its in the program's ahillaadallids Boulos tetad ade J

Categories can only be moved
ithin the same archive. Attemp
[ER]

move categories across archive
s are converted to a copy acti
on. When a

category is moved, effectively
all categories and data types
are containedve a
category:
RIE RIE I(Te)

Click on the category to be mo
ved and

drag it onto its new parent ca
tegory.Right-click on the category to
5)

moved and select the Cut actio
n. Then

right-click on the destination
parent

category and select the Paste
action.

msi a aben an archive or from one archi
CR

Categories can be copied with
in an archive or from one arch
ive to Data Type Manager 13/2
another, but the behavior of t
he copy is very different for
the two casesELA SA A A BE ER LA A LE]
ECTS

are made of the source categor
y and its children and placed
inside the

destination category. However,
when copying from one archiv
ld

another, the behavior is somew
hat unusual. In this case, thehatanains halide than acta dace lr Lay
types are copied into the dest
ination

category, but if there are add
itional data types that are re
ferenced by the

copied data types, those are c
opied into the destination arc
hive as well.

After the copy, the additionallocation as they exist in the
EINE (TIVES
RIE RIE (Te)

Click on the category to be mo
ved and

copy drag (hold the <Ctrl> key
while

dragging) it onto its new pare2. Copy/Paste

Right-click on the category to
5)

moved and select the Copy act
[LR

Next, right-click on the desti
nation

marant ratarmeary and calart Fheled] 1

Working with Data Types
Data types are the actual usef
ul objects within archives. Th
EYACHE EES Re)
programs to bring meaning to
he data, parameters, local var
iables and function

return tvpes contained in thatea LAC

be arbitrarily complex, consis
ting of other data types which
can be built upon other

data types and so on, until fi
nally they are built on the pr
imitive types (the built-in
data types.)

Built-in types have several re
strictions. They always live ia
enamed.

Applying Data Types to a Progr
am

Data types can be applied in s
everal different ways:

RIT RIE I(T e}

Data types can be dragged dire
ctlyview. If dropped onto undefine
d bytes,

a new Data object is created.
If

dropped onto a function, the r
lati)

type can be set, etc.

2. Favoritesfavorite.

2. Favorites

Data types can be set to be a
favorite.

Data Type Manager 14/20

This causes a popup menu acti

Rar.henever

the mouse is right-clicked ove
r the

appropriate location in the Li
sting

EA

3. Last Used

Whenever a data tvpe is applie[a4hea® LCL UR ER A RA LL A A BE
e "last

used" data type and can be ea:
ily

applied to other locations usi
ng a key

binding or popup menu action:

Applying a data type from an a
rchive will automatically addhibit’ § ictal hod wild Rit hiiolieii ot lad

hive. Also, the archive will b
ecome

associated with the program ar
d automatically be opened whe
ever the

program is opened.

Creating New User Defined Dat
Types

There are seven types of dataUnions, Enums, Function Defin
tions, Typedefs and Pointers.
Structures, unions, enums, and
function definitions can be c
reated by

right-clicking on the category
where the new type should be
located, and

then choosing either the NewEnum or New

Function Definition action res
pectively. Each of

these actions will bring up an
appropriate editor (structure
Clelizelgleld

structures and unions, the enu
m editor for enums and the edi
[a Thlelae])

cimmnatiira arditar far £1imebi nmUCR EH)

data type.

Creating a new typedef is even
easier. Right-click on the

data type to be typedef'ed and
select the New

Typedef on

XYZ action. A new typedef will
be created on the XYZ data
tvpbe in the same catedorv as tAlLEalively, you Lali CHLK IN
GY

Typedef...,

which will show a dialog that
allows you to

choose a typedef name and the
data type from

*

which the typedef will be creai Maui cts beat anal J
folder instead of
directly on another data type.

To create a pointer, you can c¢
[IIL QE

LINES D APA

A new pointer will be created
to the XYZ data type in theclick New

LINES D APA

A new pointer will be created
to the XYZ data type in the
same category as the original
data type.

FsIf you create a typedef or poi
nter to a data type in the
Built-in Data Type Manager, th
e newly created type will

be placed in program's data ty
pe manager at the root
category.

FF TRENT ASR THU NT |See creating structures in the
Browser for details.

Renaming a Data Type
Right-click on the data type t
o be renamed. Select the Rena
CEle le)

and then type in the new name
in the in-place text edit box.
Editina a Data TvpbeLALA a RELL EL
e edited.

To edit one of these data type
s, either double-click on its
lle LoNeTg

right-click its node and selec

t the Edit action. For structu
res and unions,

the structure editor will appe
ar, and for enums the enum edfad a lab
Creating a new Enum from a S
CLE FSH)

Select two or more existing en
ums. Select the Create Enum fi
om

Selection action. A dialog wil

| appear asking you for the ne
w enum's

name. This name must be unigunique name. The resulting en
m will contain a combination o
fall

names and values from the sels
cted enums. NOTE: If more tha
one of

the same value is contained in
the enums, they will all be ad when this

enum is used.

Deleting a Data Type
Right-click on the category to
be deleted. Select the Delete
action. A

confirmation dialog will appea
r since this action cannot be
SLLCTeT,

Iiimlace ite im Fhe mramrs ne aMoving a Data lype

Moving a Data Type
Data Type Manager 16/20
Data types can only be moved

ithin the same archive. Attemp
ts to= dic Lonverieud LU a LOOPY atll
on. There

are two ways to move a data ty
pe:

RIE RIE (Te)

Click on the data type to be m
oved

and drag it onto its new paren
t2. Cut/Paste

Right-click on the data type t
o be

moved and select the Cut actio
n. Next,

right-click on the destination
parent

category and select the PasteCopying a Data Type

Data types can be copied withi
n an archive or from one archi
CR

another, but the behavior of t
he copy is very different for
the two cases.

When copying within an archiv
, the behavior is more naturalced inside the destination cat
TLL

However, copying from one arc
ive to another behaves somewl
Id

unusually. In this case, the d
estination folder is only rele
vant as to which

archive is the recipient of th

ERE © WLS ST IE Iarchive will contain the copie
d data type. However, any data
CH

contained by the copied data t
ype are also copied to exactly
the same

relative (to the root category
node) category paths as the s
ource archive.

There are two wavs to cobv a deal’ SEE

Click on the data type to be m
oved

and copy drag (hold the <Ctrl>
[5%

while dragging) it onto its ne
Ww parent

category.Right-click on the data type t
o be

moved and select the Copy act
[LR

Then right-click on the destin
ation

parent category and select the
Paste

action.Right-click on the structure o

r union to be aligned. Select
the Align

action. If the data type is un
aligned it will be changed to
an aligned data

type with no minimum alignme
(the default) and no packing.
Committing Changes To SourceCommitting Changes To Source
Archive

Data Type Manager 17/20

If changes are made to a data
type that has an association w
ith a source

I FE TT ERAT WYIginal In the

source archive as well to keep
the data types in sync. Right
Rls LR)

data type to be committed. Sel
ect the Commit To Archive acti
on and

the changes will be applied ba
ck to the source archive.
Ubndatina Data Tvbes From SouALIS E® Ai A A a I EL
type in a source archive that
has associated

data types in a client archive
(another archive or the progr
am), the data

type in the client archive can
be updated from the source ar
chive.

Right-click on the data type tArchive action and the change:
will be applied from the arch
ive.

Reverting Changes

If changes are made to a data
type that has an association w
ith a source

archive, that data type is now
different from its source datthe data type can be reverted
back to its
original state. Right-click on
the data type to be reverted
and select the
Revert action and the changes
will be removed.
Disassociate a Data Type
To remove a data type associatthe data type in the client ar
chive (another archive or the
program) and

select the Disassociate From A
rchive action. The data type w
[LIR-EYIn TE)

a local data type within the c
lient archive and any changes
LAVIN

mffart Fhe ~riminal AaFa uneAssociate a Data lype with a 5
ource Archive

Whenever a data type is applie
d to a program, or dragged to
a category

under the program's node in tt
e data type manager tree from
a file or

project archive, a copy of tha

t data tvpe is created in theRL A LA)
ginal data type is created. Th
atis the

normal case and it is designed
to be fairly intuitive. Less
[ERE]

when a data type is originally
created in a program and then
is shared by

dragging a copy to an archive.a data type, a dialog is displ
ayed asking the user if they w
antan

association to be created. If
the user answers yes, an assoc
iation is

a data type, a dialog is dispassociation to be created. If
the user answers yes, an assoc
iation is Data Type Manager 18
20

created, but the archive will
become the source and the prc
ram's data

type is the one that gets the
association [la other words, ithe archive and copied to the
program.

Handling Data Type Conflicts
When you move or copy a data
ype to a category that has a d
ata type

with the same name, a conflict
occurs. If the data types are
not the same,

PRAT CU WD I TNE TN ITas shown
below:

In this example, you dragged (
or pasted) the data type "SIZE
An

one category to the /basetsd.h
category; the one being dragg
edis

different from the one that alLalceyory. ihe
choices to resolve the conflic
[STH

1. Rename the data type that y
ou are dragging to have ".conf
[Ile

appended to it to make a uniqt
e name.

2. Replace the existing data t
ype with the one you are draggLirpdaial ollssiialiiniaakhinioalol fi casing
f the existing data types is r
eplaced

with the new data type; the ex
isting data type is deleted.

3. Use the existing data type;
if you did a cut/paste or dra
g/move

operation, the "cut" or "dragg
ed" data type is removed fromSe AT Eh

Replacing a Data Type

A data type can be replaced by
another data type. This means
that every

occurrence of the original dat
a type in a program is replace
d by Rl 5wo ways to
replace a data type.

data type and the original da
ta type is deleted. There are
two ways to

replace a data type.

Data Type Manager 19/20
Li. TTT TN repsClick on the replacement data

[3 ETIL]

drag it onto the data type to
5)

[CIEL R

2. Copy/Paste

Right-click on the replacement
datacut

action. Next, right-click on t
he data

type to be replaced and select
lu)

Paste action.

Either way, a confirmation dia
log will appear.
Setting Favorite Data TypesRoles alii etiolated Jeeta 1d

in the

Data option menu and the Set
ata Type popup action menu in
lu

Browser. This is a quick way t
o apply a data type to the Pro
gram. The

default Code Browser has most
of the well-known types in theTo make a favorite, right-clic
k on the data type and select
the Favorite

action. Favorite data types ar
e marked with the

icon.

To remove a favorite, right-cl
ick on the data type and deselData Type Manager 20/20

The favorites are identified b

y name and must be unique, sc
bel

cannot have data type "fred" i

n one "categoryA" marked as a

parammarked as a favorite.

Any data type from any archive
type (Program, BuildInTypes,
or

archive) can be marked as a fa
vorite and used as such, howey
EIT

those marked in the BuiltinTyp
es cateaorv will be saved as pbEEL A LALA LS A CA
e Project or exit Ghidra. Your

15403

favorites is restored when you
re-open your project or resta

rt Ghidra.

Provided by: DataTypeManagel
ugin
Related Topics:bik eit fades yh)
Apply Data Types

[SI VST)

Structure Data Type Editor
Data Structure Editor 1/11

The Structure Editor is used ted to create a new structure o
r to modify existing ones. Str
uctures are user defined data
types that contain
components. A component is a
ata type of a particular size
and at a specified offset in t
he structure. The following il
lustrates the editor for a strThe Union Editor is very simil
ar to the Structure Editor, bu
t is used to create or modify

a union data type. All the com
ponents of a Union are atan o
ffset of 0. The following illu
BeClEER GE

editor for a union data type.

A Crritmbiira Editar mr lmimm EAData Type Manager, the Code t
owser, or the Structure or Uni
on Data Type Editors.

The Structure and Union Editor
s are composed of the followin

g:

Edit Actions: The icon buttons
at the top of the editor are
used to modify this structure.
Each button has a different eese allow Lhe user LO. appl
y
changes, insert Undefined byte
s, reorganize the current comp
onents, duplicate components,
clear components (changes the
to Undefined bytes), delete ¢
omponents, create array
components, and unpackage a
ructure or array component ch:Pull Down Menu: The

icon at the top of the editor
provides additional editor act
ions. These are: show the cate
gory path of a component's daf
a type, edit a component's dat
a type,

edit the fields of a component
, apply a cycle group or favortion of the editor contains a
table with the structure's or
union's components. Each com
nent (or row) consists of its
offset, length, mnemonic,

data type, field name, and com
ment. See the Component Fiel
section for more about these
fields. The data type, field ncategory can be determined by
showing the data type categon
. Components can be added, in
erted or replaced in the table
using Drag and Drop or by apg
lying a Favorite data type.

The data type for a component
can also be changed by cycling
the data type.

rod IIE J SN) NETL TE TEnent table with the name, desc
ription, category, size and al
ignment of the structure or un
ion. The structure or union
being edited can be renamed f
om here. Its description can b
e specified here. Also, it can

be changed between unaligne
and aligned.

Immediatelv below the structuiLULARALLA CASE LLL DRE SE Dol Ln

Il appear.

Applying Changes
Select the Apply Changes icon

in the toolbar to apply the ch
anges from the editor back to
the program or archive.ure or union are applied and i
t is assigned to data in the p
rogram, all data items with th
e structure or union as the da
taData

type now

have the newEditor

data type.2/11

In

 

i hei aie li idesition of those data items in |
the program will have changed
due to the apply.

Closing the Editor
Select the Close dockable com|
onent icon

in the CEL I] [is from thialog will ask if you want to
save the changes.

Searching in the Editor

To search for text in any colu
mn on any row in the editor, e
nter the text into the Search
field and press return to sear
ch forward from the currently

LAE ESET, Jog eeell]

and up

arrows next to the search fiel
d can be used to search forwar
ds and backwards respectively.
Searches are not case sensiti
CH

Changing the Name
Bee Flale Ruse 10e Ne Bus N ualdit tne Nathe neid i the Dott
om of the editor. If the name
is valid, the structure's or u
nion's name will change when
LEECH

are applied by pressing the ed
itor's Apply Changes icon

in the toolbar.

Entering a Descriptiona it a Rohn fd tl dah Elan cial

ited, edit the Description fie
Id in the bottom of the editor
. The structure's or union's d
escription will take effect wh
en the edits

are applied by pressing the ed
itor's Apply Changes icon

in the toolbar.cture being edited, edit the S
ize field in the bottom of the
editor and press the Enter ke
y to apply the new size to the
structure. If you are reducin

g the size of

the structure, you will be pro
mpted to determine that you re
ally want to truncate the struILI Chie

At the bottom of the editor is
an Alignment field, which ind
icates how the structure or un
[Ela ETT [Rte Tite RUT TR TNE TN eT)
ed within other data types. Al
| unaligned structures and uni
[LER]

have an alignment of 1 (byte a

IT Tmt 1 NEEL UTE Le op. Wl vetypes. ror aligned structures
and unions the alignment valu
is determined based on the
alignments of the individual ¢
omponents they contain, whet
r they are packed internally a
nd whether they have a minim
alignment specified.

Unalianed vs Alianed© SUILLT IS all Allg CHECK LO
x. When the box is checked the
structure or union is aligned
. Click the checkbox to change
between aligned and unaligne

When a structure or union is a
ligned, additional choices wil

| appear that allow minimum a
ignment and packing to be speWhen a structure is unaligned,
each component immediately
llows the one before it. In ot
her words no automatic alignrr
nt or padding occurs. Unaligne
d structures can contain
Undefined bytes. Unaligned str
uctures should be used to posi
tion components with known dthe structure editor tries to
prevent

defined components (those ott
r than Undefined bytes) from a
ccidentally being moved to a d
ECE RVG Eso Tg0 1]
g operations like drag and dro
p.FICE IS {Ve FE

An aligned structure is define
d similar to a structure in a

C header file. The data types
are specified for each of the
components, but their offsets
will be automatically adjusted
to the

TEIN] TT Crow TWstructure. A default Undefine
d byte cannot be added to an a
ligned structure. The overall
size of the structure is deter
mined by

the components it contains anc
whether or not it is packed.
When you select the Align chec
kbox, the GUI displays buttons
to allow an alian attributeLAE EY

also allows a pack value, pack
( maximum ), to be specified.
The following image shows the
se GUI components for aligning
the data type being edited.

align( minimum )
This indicates the minimum ali
gnment to be used when alignhaan’ JX of iallnt arab bid Shots Lalo
value other than none forces
this structure to be aligned w
ial}

other structures at an offset
that is a multiple of the spec
ified value. Specifying a mini
mum alignment also causes th
end of the structure to be pad
ded so its size is a multiplenone - Sets this data type to
have no specified minimum ali
nment when aligning this data
type inside another data type.
Align this data type based on
ly on its components and their
minimum alignments and pac}

machine - Sets this data typee alignment when aligning this
data type inside another data
type. In this case machine
alignment means the largest a
ignment which is ever used for
any data type on the program’
s intended machine.

by value - The bottom button w
ith a text field next to it al

LTR | ET LARASs data type to have a minimum
alignment that is a multiple

of the specified value when al
igning this data type inside a
nother data type.

The equivalent of having no C
code align attribute on the st
ructure or union is to choose

none The eauivalent fora C cRi LC A EA A
e

alignment. The equivalent of a
lign(4) is to specify a value

of 4.

pack( maximum )

This indicates a packing valu
e to be used when aligning theFl iiaaiaticanitet Floated lial fda did]
ther than none forces each con
ponent of this structure to be
packed

so that its maximum alignmen
within the structure is no mor
e than the pack value. Howeve
, a component will not be pack
ed if the data type or one ofD
Elec]El
StructuredataEditor

minimum alignment value spe
ied that exceeds the pack valu
e. Packing also affects the pa
dding at the end of this struc
ture so that the overall size

of the structure is the smalle
st possibleter than the pack value, the e
nd of the structure or union i

s padded based on the minimu
alignment instead.

none - The components within
his structure should align the
mselves in the default way for
the compiler. The components

are not being packed.
I UV "Vy TT oylows you to specify a pack val
ue. The specified value indica
tes the maximum alignment to
se when packing any
component.

The equivalent of having no C
#pragma pack attribute on the
structure or union is to choos
e none The eauivalent for a CKU) WILHOUL a value 1s LO
specify a pack value of 1. The
equivalent of # pragma pack(:
) is to specify a pack value o
LE

Unaligned Unions

When a union is unaligned, the
union is the size of its larg

est component. There is no ali
gnment padding and the alignER

 

hae A sila

Aligned Unions

In an aligned union the overal

| size is at least the size of

the largest component, but wi
Il be padded based on the alig
nment and packing. The minin
alignment is specified just aignment in the same way. The
ack value is specified in the
same manner as within a struc
ure, but only affects the padd
ing in the overall size of the
union. All

elements in a union have an of
fset of zero, so the pack valu

e Lali 3 affect ul] Sell ELEcified, the minimum alignment
A

override the pack value if it

is larger.

Flexible Array Component

A structure may be defined wit
h a trailing flexible array co
mponent which corresponds to

mw tirceiairl swrmes Jom rbeis rfsts, Is always displayed as th

e last row

within the structure editor wi
th the open edit row for addit
ional components located direc
tly above it. The DataType col
umn for a flexible array alway
s shows the base type of the u
nsized array

which can be modified similarALR) A EA LA A
a structure by adding a last
row specified by the base Data
Type (e.g. char) then invoking
the array

action and specifying an eleme
nt count of 0. Attempting to s
pecify an element count of 0 i
s only permitted on the last c¢
omponent row when a flexibleE giiad ahesd
The presence of a flexible arr
ay component does not affect t
he size of a structure and wil

| not appear within the struct
ure when applied to Data withi
n memory as it corresponds to
the memory

location which immediately fol
lows the end of the structure.ted in decompilation results.
Its primary purpose if to refl

ect the C source definition of
a structure with correct alig
nment and

structure sizing.

structure sizing.[Selita de1

The edit actions are available
both from the icon buttons in
the editor and from the popup
menu for the component table
To display the popup menu, ri
ght mouse click on the compor
la}

Tom bla Tiles rah was ds lew GIR stthe edit actions.

Insert Undefined Byte
Undefined Bytes can only be in
serted into a structure that i

s not aligned. A single Undefi
ned byte is inserted before th
e current selection by clickin

g the

Insert Undefined Bvte buttonnd.

A contiguous group of compon
ts can be moved up or down in
the structure. Select a block

of one or more components. Ea
h time the

Move Up button is pressed, the
group of

components is moved up one r
. In other words, the componenhia Liadhuid Aout italic tll Ct
can be done until the group o
f selected components is at th
e

beginning of the structure (of
fset 0).

Move Down

Select a block of one or more
components. Press the

Move Down button to move theimmediately followed them is
now before them. The selected
components can be moved dov
ntil they are at the end of th

e structure.

Duplicate Component

To duplicate a component with
n a structure or union:

1. Select the component.3. A single copy of the compon
ent is created immediately fol
lowing the selected one.

If the structure is not aligne

d, then there must be enough |
ndefined bytes following the c
omponent to accommodate the
plicate. In an unaligned struc
ture, Undefined bytes get repl

JRnt.

Duplicate Multiple of Compone
Lo

To create multiple copies of a
component:

1. Select the component.

2. Press the

Duplicate Multiple of Compone
t... button.

3 The number of duplicates diSLrUCLureE, you Call Oftly ihdiCa
te as many duplicates as will
fit in place of Undefined byte
EX

4. Enter a valid number of du
plicates and press the Enter k
EAR GNC GTN

5. The specified number of cophint auitletetehr’ Selita

ted one.
Data Structure Editor 6/11

Delete Component(s)

One or more components can t
deleted from a structure or un
ion. Deleting components in a
structure will cause the compofsets.

REYES Relea Tole T To oH

1. Select one or more compone
[SR CCCI

2. Press the

Delete Component(s) button.
3. The components are remove
from the structure or union.t into Undefined byte compone
ts that take up the same amou
t of space as the component be
ing cleared. Components can k
cleared in unaligned
structures, but not in unions
or aligned structures. This is
because the resulting Undefin
ed bytes are not valid compone

[IPT {ET | SLE CR J.lo clear components In a struc
[IH

1. Select one or more compone
ts in the table.

2. Press the

Clear Component(s) button.

3. Each selected component is
replaced by Undefined Bytes. T
he number of Undefined Bytes
ill be eaual to the lenath ofClearing a component will also
erase its Field Name and Comi
hid

Create Array

To create an array from a sing

le selected component:

1. Select a component in the t
able.

2. Press thehab ieat lad BE acu rindi hadi Seis: Lakdosed

the number of elements in the
array.

4. Specify the number of eleme
nts. For an unaligned structur

e, the maximum size of the arr
ay is limited by the number of
Undefined bytes following the
selected component.mes an array of that same data
type with the specified dimen
sions.

In a structure, an array can b

e created from a selection of
multiple components. The date
type of the first component in
the selection will be used foction of multiple components i
n a structure:

1. Select multiple contiguous
components.

2. Press the

Create Array button.

3. An array is created. The da
ta type of the first component

in the selection is used as t
| TE ar A Try Teed by how many of that data ty
|:

will fit in the space that was
occupied by the selection. Th
e size of the array will be th

e array that can fit in the se
lected number of bytes. Any le
ft over (unused) bytes at the
end of

the selection will become Unde[GEER EYNI EW

To create an unsized flexible
array as the last structure co
mponent (assuming one is not
Iready defined):

i

2.
£4
4SEL Ne HAE 1 Ae We Cr, Cet elon
corresponds to the base type
of the unsized array.

Select this last structure com
ponent in the table.

Press the

Create Array button or the '['
action key binding.

A dialog pops up to request th
e number of elements in the arand click OK.

Unpackage Component
Unpackaging takes a single col
ponent and replaces it with it
s own component parts. When
iting a structure, array and s
tructure components can be ur
LECCE] by selecting thatr example, the array componer
Word[4] would become four W
d components. If the structure
struct_1 was

composed of a Float and a DW«
d, then unpackaging it would r
eplace the struct_1 component
with a Float component and a |
Word component.Create Structure From Selecti
on

Data Structure Editor 7/11
Creating a structure from a se
lection takes a contiguous sel
ection of components in the st
ructure editor and creates a n
ew structure from those compc
ents It then replaces the selWILT a SiTTgle CLOMpPONEnt Wwihost
data type is the new structure
. The components that were in
the selection will become the
components that make up the
w structure. The user does thi
s by

selecting the components in th
e editor and clicking the
Create Structure From SelectioLil i tak al fh ltl ie a a rd ot
structure. Once a unique name
is

specified the new structure is
created and a component con!
ining it replaces the selected
components.

Component Fields
Each row displays informationName, and Comment fields are
ditable.

The following summarizes the
nformation about each field fo
ra component.

Offset - The byte offset of th

is component from the beginni
g of the structure. For unions
RS byte BUSES [Ell componLength - The length of this co
mponent in bytes.

Mnemonic - The mnemonic (br
identifier) for this componen
t's data type.

DataType - The data type of th
is component. This field is ed
itable.

Name - The field name associa!

ar with Fhe cA anant in FheTied, the Tield names must be
unique for the components in ¢
structure or union. This fiel
dis

editable, except on component
that are Undefined bytes.
Comment - A comment associé
with this component. This fie
Id is editable, except on comp
onents that are Undefined bvteTo rearrange the order of the
component fields position the
cursor over the header for the
table column. Left mouse clic
k and drag the column left or
right to its new position.

Editing Component Fields
The DataType, Name and Comteditable when the component"
DataType is an Undefined byte
To place an editable field int

o edit mode:

Double click on an editable fi
eld.

or

Select a single component row
and press F2 to begin edit modinto edit mode. Tab will then
move to the next editable fiel
d.

Applying an Edit

In the editable field, pressin
g Enter applies the value to t
he field if it is valid and en
LS the edit session. If as hilstatus line and the

field remains in edit mode.
Canceling an Edit

In the editable field, pressin

g Escape cancels the edit sess
ion without applying the chang
es to that field.

Editing More Than One Compo
[AEG]

Nis mur rere Wives Ermer salicomment tield to editing anoth
er by pressing Tab, Shift-Tab,
UpArrow or DownArrow. The k
press only moves the

edit session if the current fi

eld edit can be applied. Other
wise, an error is displayed in
the status line.

Tab

I alee Tele ICR ua = Nets)ALLEL SA RA A LE AL

f the current field is the las

t editable one in this compone
nt then it moves to the first
editable field in the next com
ponent. This key moves the edi
t session left to right and to

p to bottom in the table.
Shift-Tab

HEE REE ELE CERbch io tatiana be lk hc il al
e table. If the current field

is the first editable one in t

his component then it moves t
the last editable field in the
previous component. This key
moves the edit session right t
o left and bottom to top in th

e table.

Up-Arrowto the same field of the previ
ous component in the table if
that field is editable. This k

ey moves the edit session
bottom to top in the table.
Down-Arrow

Pressing the DownArrow key aj
lies the current edit and move
s to the same field of the nexmoves the edit session

top to bottom in the table.
Editing the DataType Field
This can be any data type that
is available in the data type
manager. To edit the data typ
e double-click the data type c
CUR LIER AGERE ICH
ype Selection Dialog, which alt can also be Undefined, a pol
nter to a data type, or an arr
ay.

This can be any data type tha
tis available in the data typ

e manager. To edit the data ty
pe double-click the data type
cell This will show the DataPAA

to easily enter a data type. |

t can also be Undefined, a poi
nter to a data type, or an arr
ay.

Basic Data Type

Data Structure Editor 8/11

This can be a built-in data tyhi Rl a Sabi) Sd ll chattel
For example, Word.

Pointer Data Type

This can be the basic Pointer
data type or a pointer to a da
ta type. A pointer to a data t
ype is indicated by following
the data type with an *.

For example, Word * is a point
er to a Word.array of any data type.

For example, DWord[2][4] is ar
array with 2 elements, where
each element is an array with
4 elements that are DWords.
Array of Pointers

Arrays of pointers can also be
EINER

For example, Float¥[5] isan aFloat.

Effect of Changing a Compone
EEL]

An unaligned union's size will
always be the size of its lar
gest component. If you change
a data type for a component ar
d the component size changes,
the union size will

RAT TL LNT WR TTTsize a multiple of the union's
alignment.

How a structure is affected by
changing a component's data
ype depends on whether the st
ucture size is aligned or unal
igned.

Unaligned - If the structure i

s unaligned, then the new com
onent must be less than or eauBATA SL ERED Sd AA LEA SS A
components

that immediately follow it in
the structure. In an unaligned
structure, decreasing the com
ponent size will create Undefi
ned byte components following
it to

maintain the structure size. |
ncreasing the component sizeandi’ BRE tity Bhi dias: hd
The last component of a struc
ture can

be always be changed which c:
cause the structure to grow |
arger.

Aligned - If the structure is
aligned, the component can ch
nge size, which affects the st
ructure's overall size and thefollow it.

Editing the Name Field

When specified, a field name n
ust be unique for the compone
ts in a structure or union. It
cannot contain blanks.
Editing the Comment Field
The comment can be any AsciiIES]

Pressing the 'p' key invokes t
he pointer action on a compon
nt. This will generally create

a default pointer unless the
existing data is already a poi
nter in which case that pointe
r will be

wrapped with an additional poi

EN | LRN TP A 2 J premereays apply a default sized poin
ter. Otherwise you can drag on
e of the other pointer types f
(I RE]

Data Type Manager window. W
existing pointer data, the ba
se type of that pointer may be
changed simply by applying al
other type onto the pointer (e
‘a apblvina bvte to defaultUO NOL Walll this pOInter stalk
ing behavior to happen, it is
best to clear the code unit(s)
before applying a data type v
ia drag-n-drop or key-binding
actions.

Cycling a Component Data Typ
Some data types are part of a
cycle group. A cycle group ishalla hail deat aad
associated with one another.
Cycling a data type facilitate

B

changing a component from or
data type to the next data typ
e in the same group. Each cycl
e group has a short-cut key as
sociated with the group. Press
ing the short-cut key cycles fext one in the group. For exam
ple, the b key is associated w
ith the Byte cycle group. This
group is Byte, Word, DWord, a
nd QWord.

A single row of the component
table must be selected to cycl
e a data type.The first data type in a cycle
group can be added to the enc
of a structure as a new compo
nent.

To add a data type using a cyc
le group key:

1. Select the last row (the bl
ank row) of the component tab

=A
~ Drace tha chark mitt Lav farexample, the b key will add a
Byte; the f key will add a Flo
at; the apostrophe key will ad
d an Ascii.

Cycle groups can also be appli

ed from the component table's
popup menu under Cycle.

To cycle a component's data ty
pe to another one in the same4. SEIECL LUC LOmponent in the
table.

1. Select the component in th
CRCIIER

2. Press the cycle group key u
ntil the data type has cycled
to the desired data type. For
example, if the current data thail che' Micah ats at Lit
twice would change
id

eC]

Editor

Leal LICR

9/11

When the current component ¢ressing the cycle group key of
the desired data type will ch
ange the

component to the first data ty
pe in the desired cycle group.
The data type can then be cyc
led to any other data type in
the group.

UCll ues) Sled]n aligned structure. The only
exception is that the user can
only cycle to data types that
will fit within the data
boundary of the current compo
ent. If Undefined bytes follow
the selected component, the L
ndefined bytes can be replacec
by cycling the data type to a

LMS Ran NFL IRs Man glydata type will add Undefined
bytes after the component beir
g cycled. However, the last co
mponent is not restricted to a
particular size.

Drag and Drop Basics

Data types can be dragged fror
the Data Type Manager to the
combohent table in the StructUTOp Tesults 1h the COImponerit
in the editor being replaced b
b

the one being dragged. Holdin
the Ctrl key during the drag
and drop causes the dragged d
ta type to be inserted instead
of being replaced.

Known Problem: Holding the C
| key to perform an insert ofesas Bal
sing the Alt key to insert rat
her than the Ctrl key.

The "+" should then appear at
[NCI] RN

When a data type is dropped ol
a pointer component, the com
onent becomes a pointer of the
t data type instead of simply
being replaced by that data tyesults in a Byte*, which is a
pointer to a Byte. Drag and Dr
op is discussed further in Add
ing a Data Type, Inserting a D
ata Type, and Replacing

a Data Type.

Favorites Basics
ICSI] LEC) La are defineorites are available through t
he popup menu in the compon
table. Applying a favorite da
jc]

type is similar to dropping a
data type. Favorites can be us
ed to insert a component of th
at data type or to replace a c
omponent's data type. Favorite

J a Tie LA LY —selection. I'herefore, individu
al favorites are only enabled
when they can be applied (i.e.
they fit at the selection and
the selection is contiguous).
When a favorite data type is a
pplied to a pointer component,
the component becomes a poi
er of that data type instead o
fsimblv beina replaced bv tha1 yOu Hight mouse Clik Oh a
component where there is no s
lection, the selection becomes
a single component selection
containing that component anc
the popup menu will appear.
Favorites are discussed furthe
rin Adding a Data Type, and R
eplacing a Data Type.halal lil ait AL alii Sui aii badd
component by replacing Undef
ed bytes. When editing an unal
igned structure, there must be
enough Undefined bytes for th
e data type to replace. A data
type can also be added to the
end of a structure or union.
Drag and Drop

Drag a data type from the dataable and drop it. The data typ
eis added to the end of the s
tructure in the editor.

If the data type can be variou
s sizes, the user is prompted
for the desired size. The foll
owing illustrates the dialog d
ue to the drag and drop of a s
tring.es desired for the data type a
nd press the Enter key or clic

k the OK button.

For information about drag anc
drop with pointers, see Drag
and Drop Basics.

Favorites

Right mouse click on the empt
row at the end of the table a

werd pial vivid Tm cma Fae Cmiiraythe popup and It Is added as
the last component.

For information about Pointers
as a Favorite, see Favorites
Basics.

Inserting a Data Type

In an aligned structure or a u
nion, a data type can be inser
ted as a new componentIn an aligned structure or a
union, a data type can be inse
rted as a new component.

Data Structure Editor 10/11
Drag and Drop

1. While holding down the Ctrl
key, drag the data type you w
ant to insert from the data tyland clini all iat i ale ekiathatbsiieted
ure editor, the drag

icon will have a "+" on it ind
icating insert mode.

2. Release the mouse button w
en you are on the desired comy
onent and the dragged data ty]
eis inserted before it.

3. Known Problem: Holding the
Ctrl key to perform an inserty using the Alt key to insert
rather than the

Ctrl key. The "+" should then
appear at the drop site.

For information about drag anc
drop with pointers, see Drag
and Drop Basics.type replaced with a different
data type. If an unaligned st
ructure is being edited then U
ndefined bytes are created or
consumed as necessary to mail
ain the

position of other components v
ithin the structure. For union

s and aligned structures, the

ELE AR Fa LE I Lr TRIze Is adjusted accordingly.
Drag and Drop

Single Component Selected
Drag a data type to a single s
elected component in the editc
r or to a non-selected compone
nt in the editor. If the mouse
pointer is a ‘circle with a s
lash' then thereplace Ue Lomporcent. this 1
s probably because the data ty
pe being dropped won't fit in
the structure in place of the
original
component. If editing a union
or an aligned structure the da
ta type should always fit and
the drop is allowed. If editin
g an unaligned structure, thehe alti
nent will fit. (see Effect of
Changing a Component's Size)
Contiguous Selection of Multip
le Components

Drag a data type to a block of
selected components. Whethe
the structure is aligned or un
aligned doesn't matter when d
opping a data type on a blocke new component (s) will occuj
y the same space as the curren
tly selected components.

In a union, all selected compo
nents will be replaced with a
single component containing ti
e data type dropped.

In a structure, as many comport
ents kd J 5) dropped data LTEction. In an unaligned structu
re any left over

bytes in the selection will be
come Undefined bytes.

For information about drag anc
drop with pointers, see Drag
and Drop Basics.

Favorites

Cimmla Farman CalamkanIf you right mouse click on a
component where there is no s
lection, the selection becomes
a single component selection
containing that component anc
lu)

popup menu will appear.

To replace a component's data
type with a favorite data type
select itin the table riahLHLE. UVhly TaVOTILEs Lal Wil

| fit in place of

the component will be enabled
(see Effect of Changing a Com
ponent's Size)

Contiguous Selection of Multip
le Components

To replace a contiguous select
ion with a favorite data type,hla iaiatll Jthaieieltikatiadiadl
rite.

In a union, all selected compo
nents will be replaced with a
single component containing ti
e favorite data type.

In a structure, only favorites
that will fit in place of the
selection will be enabled. Ju
st like with drag and drop, whdoesn't matter. The selection
becomes as many of the data t
pe as will fit and left over b
ytes become Undefined bytes f
ran unaligned structure.

For information about Pointers
as a Favorite, see Favorites
Basics.Every component has a data ty
e: Byte, Word, Float, etc.. Th

e category is where that data
type is located. Since you can
have two data types with the
same name in different locatio
Lh

(categories), the editor provi
des a way to see the category

FSR I LE PY PAhh
i

8
ER
£3

Select a single component.
Right mouse click on the comp
nent in the table.

From the popup menu select ©ne Calteyory 1ormnation appe
rs in the editor's status line
at the bottom of the dialog.

Editing a Component's Data Ty

C]

Another Data Type Editor can
be brought up from within thehail” Bhat databank ab
able data type, such as Struct
ure, Union, or Enum. In additi
on,

another Data Type Editor can b
e brought up for any componer
whose base data type is an ed
itable data type. For example,
a Typedef on a StructureData
would allowStructure

Editor

pRViNS

Structure. Likewise, you can e
dit a Structure wherever the c
omponent is a Pointer to the S
tructure.

To display another editor for

a component that has an editadata type that is a structure

, union or enum or that has on
e of them as its base data typ
e.

2. Right mouse click on the co
mponent in the table. Select E
dit Component... from the popu

p.
3. The editable data type for

ELA ER LE ET,18

Showing Numbers in Hexadeci
The Component Table contains
umeric fields such as the comp
onent's offset and length. The
structure information area al
so shows the overall size and
alignment of the structure. By
default numbers are initiallvure cUitor. 1rnere 1s a tool op
tion, Show Numbers In Hex, th:
t lets you override the defaul

t and set whether these numbe
B

should be displayed in hexadec
imal when an editor is initial

ly displayed.

There is also a toolbar menu i
tem in the editor that allowsIta baat fok ad fii lei air’ fac oil
in hexadecimal or decimal. Che
nging this only affects the cu
El

editor where it is changed.

The Union Editor does not disp
lay offsets since they are alw
ays zero.

To switch between decimal anc
hexadecimal display of numeri2.
EN
ps
Right mouse click on the table

A check mark next to Show Nu
ers in Hexadecimal indicates t
hat numbers are CHIC Closently shown in decimal.

From the popup menu, select ¢
ow Numbers in Hexadecimal.
The numbers being displayed \
Il change from decimal to hexa
decimal or vice versa. The che
ck mark next to Show Number:
n Hexadecimal indicates whett
r the numbers are

PUL NRE PI I TL I FeStructure and Union Editor Too
| Options

The Structure and Union Editor
s add options to the tool. To
view or edit the option settin
gs:

From the tool's menu select Ed
id

Tool Options which displavsPEN LHNE CUILOfs Lee nouc.
Click on either the Structure
Editor or Union Editor tree no
de to view its options.

The StructureEditor and Union
Editor tabs contains the follo
wing options:

EditorFunctionality

Structure
Editor

Show Numbers In Hex

If selected, the component off
sets and lengths asstructure will be displayed in
hexadecimal when

a new Structure Editor is init
ially displayed.

Otherwise, the lengths are ini
tially in decimal.

Union EditorIf selected, the component len
gths as well as the

overall size and alignment of
the union will be

displayed in hexadecimal wher
a new Union

Editor is initially displayed.
Otherwise, the lengths are ini
tially in decimal.ck on the check box.

Provided by: Data Type Manage
Plugin

Related Topics:

Data Type Manager

Enum Editor

Data Type Selection DialogEnum Data Type Editor

An Enumeration data type ("Er
m") is a C-style data type tha

t allows the substitution of a
value for a

more meaningful name. Ghidre
rovides a special editor for E
num data types.

Create an Enum data type usinown below.

[Salle Rel SEI]

The Name column in the table
s the name of the enum entry.
The Value column in the table
is the value of the enum entry

The Name field below the tablename.

The Description field shows a
short description for the enum
; edit this field to update th

e

description.

The Category field shows wher
the enum resides which corres
ponds to the folder you werehowever, you can move it usin
g

the Data Type Manager after yc
u have created it if you want
to move it.

The Size field shows the numb:
r of bytes required when you a
pply the enum. To edit this
field, use the dropdown menu

RIN reer a EF PTdata definition and do not see
expected results in the decom
piler it is probably because t
LC)

size is incorrect.

When you make any change to
e enum, the

(Apply ) button is enabled.EI LLL LLL LLL
able, select an entry; double
click in the field that you wa
glee)

change, OR press F2. A cell ed
itor is displayed; enter the v
alue (press the <Enter> key).

While editing, you can use thhui Bani eiidea ual th baad J
the Shift-Tab key to navigate
backwards, the Up key to move
editing to the cell

above, and the Down to move ¢
iting to the cell below the cu
rrently edited cell.

Enum Editor 2/3Add an Enum Entry

Create an new enum entry by ¢
lecting the

(Add) button on the editor's t
ool bar. An entry with

default values is added to the
table; the default name is "N
ew Name;" the default value isthe fields to change the entr
ies.

Delete an Enum Entry

To delete enum entries, select
the entries that you want to
remove. Right mouse-click and
choose

the Delete option, OR select t
|18

Apply Changes

When you have completed mal
changes, select the

button on the editor's tool ba
r. If you

have changed the name of the
num, the Data Type Manager d
plav is undated to reflect theLLL SLL LL So

Change the Sort Order

As with most tables in Ghidra,
you can change the sort order
of a column by clicking on th
e

column header. The icons on tt
e header indicates the sort or
der, ascending (EEN

(

). You can also rearrange the
columns in the table by clicki
ng on the column header and
dragging it to the new positio
n. Changing the sort order has
no effect on the enum.Related REeJ=]<H

Related Topics:
Create Enum using the Data M;
ager

Enum Editor 3/3GHIDRA Training 14
TOP SECRET//CYBER//NOFORN[Mranslate Strings 1/3

Translate Strings
The Translate Strings Plugin p
rovides a framework to allow s
trinas found in aALCL RE A CU ER A
meaningful to the Ghidra
user.
This plugin doesn't perform an
y natural language translation
by itself. The user must
install string translation ser
vices that do the actual trans
lation. Extensions to Ghidra
are installed via the Filehd Antacid al + J fetid iittala

ted, the translated value will
be shown in place of the
original value, bracketed with
chevrons

Translate Menu

The Data

Translate menu will appear in
the popup menu of the Listingd in the Defined

Strings table (found under Win
[lel

Defined Strings).

Manual string translation
Allows the user to specify a t
ranslated string value manuall
a7Select an existing string inst
ance in the Listing window and
[gl]}4

click and select Data

Translate

Manual to enter a manual
translation.

In the Defined Strings table s
elect a row or a range of rows

JR]1

Manual.

Clear translated values
Removes the stored translated
value for the selected string
data

Removes the stored translated
value for the selected strinanstalices.
Translate Strings 2/3

The selected string instances
will default back to their tru

e value.

Select an existing string inst
ance in the Listing window and
rightClear translated values to

clear the translated value.

In the Defined Strings table s
elect a row or a range of rows
and

right click and select Transla
lS)

Clear translated values.
Toggle show translated valuesal value.

Select an existing string inst
ance in the Listing window and
right

click and select Data

Translate

Toggle show translated

values to toggle the display o
f the translated value of eachIn the Defined Strings table s
elect a row or a range of rows
and

right click and select Transla
lS)

Toggle show translated values.

String translation services
String translation services, w

[INS RIN, SE NTT acan be Installed that will all
ow the user to translate strin
EX

Once installed, the translatio

n service plugins, like all pl
ugins, can be found in

the File

Configure... window and must |
e enabled before they will app
earinIraflisiale menu.

Each string translation servic
es will operate in a different
way, please consult the
documentation from the servic
for specifics.

The Manual string translation
service is always available.

Creating a String translationCreating a String translation
EEL)
Translate Strings 3/3

Please see the SampleStringTr:
nslationPlugin.java source fil

e for an example of

how to create your own translamize the TranslateStringsScrip
t.java file and

operate directly on the string
instances without using this
plugin.

Provided by: Translate Strings
Plugin
SEES JELabels 1/8

Labels

A label is a name associated w
ith an address. Labels are use
d to make code easier to read.

For example,
rr rea rir." ris PLE"printf”. The name "printf" ha
s been associated

with the address "0x103f2d". |
n other words, the address "0x
103f2d" has been labeled print
i

Label Name

All labels have an assigned sy
mbol name which has either e
licitlv been established or aYEeheraled Naltie. VvWiCh assigil
a label name (or any other na
mespace or symbol name) the
llowing

naming restrictions apply:
Reserved Dynamic Name Patte
- certain dynamic name pattert
s are reserved for Ghidra use
and may not be explicitly set.
A dynamic pattern generally cLAB_, DAT_, UNK_, EXT_, FUN_,
OFF_) followed by an address (
e.g, LAB_01234567).

Space and Non-printable Char
ters Not Allowed - a blank spa
ce character or other
non-printable ASCII character
(e.g., backspace, linefeed, et
c.) are not permitted within ae rer may not exceed 2000
haracters/bytes

In addition to the above restr
ictions, the use of '::' withi

n a label name may cause prok
ems with

certain name edit dialogs whic
h may use this as a namespaceLabels can be created or renar
ed by importing information, w
hen auto-analysis is performed
ls

directly by the user. The labe

I source indicates how the lab
el was created or renamed.
User Defined - Label name spe:
ified by the user.

Iron rertiasad AT sivas wilvesssrd 7404 wirYy some other imported
information (for example, exte
rnal libraries or C libraries.

)

Analysis - Label created by au
to-analysis that do not have d
efault names.

Default - Label with a default
name. (Ghidra generally creat
es default-named svmbols at aA AEE EDR ERAS A AS AS
some other location.)

Default Labels

Some labels are automatically
generated during disassembly.
They use a standard naming cc
vention to

derive the symbolic name from
the address. The current convebb cal Ca
information about what is at t
he address, followed by the ad
dress. For example, the autom:
tic label

generated for address "0x0123
" would be "LAB_01234" if thei
eis code at that address. If
there was a

data item at that address, thesare

known as default labels. The i
mporter, auto-analysis, or the
user can also create labels (
or rename

default labels) using more mea
ningful names.

Default label prefixes can be
any of the following:default labels) using more me
aningful names.

Default label prefixes can be
any of the following:

Labels 2/8
EXT - indicates address is an

external entry point.

EIIN _ imdiratac Fhara ie a finSUB - Indicates that code at t
he address has at least one "c
all" to it.

LAB - indicates there is code
at the address.

DAT - indicates there is a dat
a item at the address.

OFF - indicates that the assoc
iated address is offcut, i.e.
inside of an instruction or daALLS LULA A A
above cannot be recognized.

Label Properties

Entry Point - Indicates that t
he address associated with thi
s label is an external entry p
oint. External entry

points are those addresses tha
t can be used to initiate exechi neal wih bib lad
have a single "main" entry poi
nt. (Usually having the label
"Entry".) Shared libraries (DL
Ls) usually have

many entry points, one for eac
h function in the library. Sin
ce the "entry point" property
is really associated

with an address and not a partPrimary - Indicates that this
label will be the one used to
represent the address everywh
re the address is

displayed, such as in the oper
and field of an instruction. S
ince multiple labels can be as
sociated with an

address, one ELl] Sul one musAdd/Edit Label Dialog

The Add Label dialog and the E
dit Label dialog are identical
except for the title and the
way the dialog's

fields are initialized. The Ad

d Label dialog will be filled

in with suggested values for a
Il fields. The Edit

1ahal Aialam Am Fhe Athar hanurrent values of the label bel
I RCCIIER

If you add a label where there
is a function with a default
label name, the label you add
will become the

function's new name.

Dialog FieldsUlalLy ricids
Labels 3/8

[Sa CIgETLL]

Text field for entering the na
me of the label. A combo box i
s included which allows
selecting recently used label
names.ws the format:
<namespace_namel>::<nams
name2>::<..>:<label_text>
For example, the following str
ing denotes a full namespace
ath that starts at the

Global namespace and ends at
he label name mylLabel:
Global::foo::bar::myLabelparent namespace

for the label name and any inc
luded namespaces. However, if
the you provide a

namespace path that starts wit
h Global, then the value of th

e Namespace combo box

will be ignored.

Cul EEe based upon the current
address. When editing a label,
the available namespaces are
not necessarily those in

the namespace hierarchy in wk
ch the label is located, but r
ather are those based upon
the address of that label. The

Global namespace is always in
PO TT FE gt er AT the current label, IT one Is
being edited.

This field is disabled, if the

re is a function with a defaul

t name at this

address. The namespace will st
ay set to the parent namespace
of the function

and the label name vou enter vSAIN

Sets the entry point property
for address associated with th
is label. Setting this

property on one symbol, chang
s it for all symbols at the sa
me address.

Primary

Sets the primary property forats chan bt kl rk ta ai
the checkbox will be selected
and disabled, since it must be
primary. Whenever the
checkbox is selected, it will

be disabled because the only w
ay to make a symbol

become non-primary is to selec
t another symbol at the same a
ddress and make itat is primary. If there is a
function at this address and y
ou add a new label, the checkk
ox will be enabled such

that if you select the checkbo
X, the function is renamed to
the new label that you
entered. The function symbol n
ust always be the primary symPinned
Labels 4/8

Sets the label to pinned. A pi
nned label will not move if th
e image base is changed

LIEN Crew ap Ri i er Imove with the code or

data if a memory block is move
d or the image base is changec
. Also, a pinned label

will not be removed if the men
ory block that contains it is
removed. Only code,

data, or function labels may b
e pinned.NOTTally, the pPriimialy abel 1s
used to replace an address re
ference in the operand field o
f an instruction

or data item. Ghidra allows us
ers to change which symbol is
used to replace the address us
ing the Set

Label dialog.show all symbols associated w
ith the address shown in the
dialog title. Choosing a label
from the list will cause that
symbol to be associated with
lu)

operand reference being modif
ed. Typing in a new name will
cause a new symbol to beoperand reference.

Label Operations

JL Th WET)

Adding a label will place a la
bel at a particular address in

a listing. Labels may be of a
ny length but

may not contain spaces. To adc2.
EN
Fl

Right-click and choose the Add
Label menu option.

Enter the name of the label in
the text field (or accept the
EES Re SEIN

hn re pa 25 Servs sal Seats | dain 1 mealsPress the OK button.

Labels 5/8

Adding a label to an address w
here there is a function with

a default name results in the
function

name becomina the new labelAACA RAR LIAL® BC lA)

To change the name of a label
or referenced label appearing
in an operand:

1. Right-click on the label, o

r referenced label appearing i
n an operand, then choose the
Edit Label

item from the popup menu.Label dialog.
3. Press the OK button.

If the label appearing in an o
perand corresponds to an extel
nal location the Edit Label ac
el m1]

be replaced by Edit External L
ocation.ociated with the primary refer

ence of an operand, an externa
I location

referenced by an operand may
e renamed or modified. Right-c
lick on the operand which refe
rences an

external location and choose t

io LIS External [CECE] ilExternal Location for more dis
cussion on the use of the edit
dialog).

Removing a Label

Labels may or may not be eligi
ble for removal depending on t
he following rules:

Labels that have no references
to them can always be removeIn more than one label can alw
ays be removed.

"Default" labels with at least
one references and no other |
abels at that address can not
5)

removed. (The menu option wi
be disabled.)

"User-defined" labels with at
least one reference and no othremoved, but will be replaced
with a "default" label at that
address.

A "default" function label can
not be removed if there are no
other labels at the address.

LL]

remove a "default" function la
[ERR OTE EV CRU ER le| can be removed. If there are
no other labels at the addres
s then

the function label becomes a
default” label. If there are o
ther labels at the address, on
e of these

will become the new function |
abel.be removed and choose the Re
ove Label menu option.

Ghidra gives no confirmation o
n Remove Label. A status mess
ge is displayed if you try to
remove

a default function label.Labels 6/8

A Namespace defines a scope,
uch that symbol names are uni
ue within a namespace. The ty
es of

namespaces that Ghidra suppc
s are Global, External, Functi

TE IEE kr YS US ——reside In the global namespace

To set the namespace:

1. Right click on a symbol and
choose the Edit Label menu of
<1,

2. Select a namespace from the
namespace combo-box in the
bel dialog. Or, you may enter
PyELL) das d faltie sEpalralurl.

If a specified namespace does
ale}

exist a simple-namespace will

be created.

 

Any use of a class-namespace |
equires that it first be creat

ed prior to associating a labe

| or otherhad sittin Lal led uli doi at
omplished via the Symbol Tree
Setting an External Entry Poin
Id

External Entry points can only
be created at addresses that
have at least one symbol. To s
et an external

entry point:

1. Right click on a symbol and2. Check the Entry Point check
box in the Label dialog.

Making a Label Primary
Making a label primary gives i
t priority over other labels t
hat are associated with the sa
me address. The

primary label is displayed bn the

subroutine view, the subroutin
e names are primary labels. If
another label were added and
made the

primary label, then the subrou
tine view will display that la
bel instead of the label beari
ng the subroutineress, Its name Is the primary
label; if you set another labe

| at this address to

be primary, then the symbol fo
r this label is removed, and t
he function is renamed to that
label that you

were editing. The function sym
bol must always be primary.
To make a label primarv:El CLAS ILA RAL |
<1,

2. Check the primary checkbox
in the Label dialog.

Selecting a referenced Label f
or an Operand

Referenced labels appear in in
struction operands. By default
, the primary label associatedLice Batibo Tb brake iil id
and will be displayed within t
he operand. To have the opera
d display a

different label corresponding
to the primary memory referen
e:

1. Right click on the operand
symbol and choose the Set Ass
ciated Label... menu option fr1. Right click on the operand
symbol and choose the Set As:
ociated Label... menu option f
(RE

Labels 7/8

pop-up menu. This action only
appears if the primary referenialog or type in a name for a
new label

that will appear at the referr
ed-to address.

Provided by: the Edit Labels P
lugin

Show Label History

You can show the history of ch

Pr 10 a I 1label history

for all lables looking for old
label names that no longer ex
ist. Either way, a dialog is s
hown containing

a table of lable changes. The
"Action" column indicates whe
her the label was added, remo
ed, or

renamed If the label was renaie Lid Naltie fefialned LO ie 1
Ww name.

The "User" is the user who mac
e the change. The "Modificatio
n Date" is when the change wa
made.

Labels that were added as a re
sult of disassembly are not re
corded in the history; however
aIhe ait atid bt ar Hh hatte
as shown below.

A column for "Address" shows
p in the table if you are view
ing the history of changes on
labels at

all addresses.

To display the history of labe
| changes at a specific addres| (either in the label field o

r the operand field).

2. Choose the Show Label Histc
ry option.

You can sort the label history
by any of the columns and in
ascending or descending ordere (i.e., oldest date first). Y

ou can also reorder

the columns by dragging the h
ader to another column positio
iB

To seach for label history fo
r a past or present label nameLabels 8/8
Label History...

2. A dialog is displayed so th
at you can enter a label name
(or part of a label name)
Enter a string you would like
to see matches forLh all Lhe label Lhallyes, 1€av

e the field blank.

3. Select the OK button or pre
ss the <Enter> key in the text
field.

If label history was found, a
dialog similar to the one show
n above is displayed with the
addition of an "Address" colurr
n. The input dialog remains diFrom the label history dialog,
you can navigate to each addr
ess by clicking on the row in
the table.

Provided by: the Edit Labels P
lugin

Related Topics:

Symbol TableComments
Comments 1/3
Comments can be added to an

nstruction or data item. There
are five CIEE of commenDisplayed to the right of the
instruction.

40)

Displayed above the instructio
iB

[Displayed below the instructio
iB

Plate

Displayed as a block header ab
ove the instruction. Plate com
ments are automatically surrot

nded by
joyREPCalabic

Displayed to the right of the
instruction if there is no EOL
comment. These comments ar
[E14]

displayed at the "from" addres
s of a reference to this code
unit, but only if there is no
EOL orYou can create, edit, or delet

e comments. You can also view
a history of comment changes
or each comment type. You ma
also use annotations to change
the display characteristics o

f data entered into the comme
t fields.t Comment)

Comments can be added or ed
d using the Set Comment(s) di
log as follows:

1.

2.
3.
Flw, select the Comments
Choose the appropriate tab for
the type of comment that is t
o be added or edited.

Enter the comment text in the
text window.

Press the OK button to save th
e changes and close the dialogIf the Enter accepts comment «
heckbox is selected, you can s
imply press the Enter key to s
et the comment and close

the dialog. When the checkbox
is not selected, the Enter key
simply adds a new line to the
current comment for a multipl
eDeleting Comments

Delete Comment will remove a
pecified comment from the list
ing. No confirmation is displa
yed before the delete.

To Delete a Comment:
1. Right-click on the commentDelete <comment type> Comt
from the popup-menu.

 

Comments 2/3

To undo a delete comment ope
tion, use the Undo Operation.

Navigating in the Code Browseaddress or a label, you can n
avigate (in the Code Browser)
ld

that address or label by doubl
e clicking on the address or |
abel in the comment. If the st
ring matches more than one
address or label, a Query Resu
Its dialog displays the matcheDisplaying Comment History
Comment history is maintainec
for each change made to a con
ent. The history includes the
name of the user who made
the change, the modification d
ate, and the comment. Comme
changes are sorted in descendi

ng date order (most recent
ry ar peanlo view the history of changes

1. Right-click on the comment
that you would like to view th
CILIE CIA

2. Choose Comments

Show History for <comment ty
Ee

If you are not over a specific
comment riaht mouse click atShow History...

3. A dialog containing a tab f
or each of the comment types i
s displayed.

If the comment does not conta
n history, then "No History Fo
und" is shown in the tabbed pz
nel for thatistory for that comment type.

 

Only comments that are placec
at the start address of data o

r instructions are displayed.
Comments on addresses other
than the start (interior) addr
ess will remain hidden until t
he data or instructions are clProvided by: Edit Comments PI
ugin

Related Topics:

Bookmarks

Browser Field Formatter
Labels

AnnotationsReferences 1/1

References

Within Ghidra, the term "Refer
ence" covers two very broad ar
eas:

1. Forward References from a c
ata or instruction code unit t

EV Cm, aa<2. Back References to a locati
on of interest (e.g., code uni
t, variable, data-type, etc.).

Forward References

Forward References can be ex
icitly defined within the prog
ram, on data or

instruction code units. This i

s accomblished durina disasse]ALAR ARS) LL ES EL RA LY
ion, Forward References to fun
ction parameters and
variables may also be inferred
GROG ET [RTS CN
orward References can

affect the code unit rendering
and XRefs (i.e., Back Referen
ces) displayed within the
CodeBrowser listing. The effecbi tiltalesal publ Balchin tcl
operands can be somewhat cor
olled by means of various Code
Browser Options (see
Operands Field options).
Management capabilities for e
plicit Forward References is p
rovided by the
ReferencesPlugin and is discus
sed in detail within the ForwaBack References

Back References (also referred
to as "Location References")
include both the inverse of
Forward References, and the id
entification of listing locati
ons where specific

Laich RAE are utilized The 2LocationReferencesPlugin and
iscussed in more detail on the
Location References

Dialog help section.GHIDRA Training 15
TOP SECRET//CYBER//NOFORNHorward References
Forward References 1/14

This page covers the follow to
pics relating to explicit forw

PO LL i SL IR TE aee
ReferencesPlugin:

Introduction

Types of References

Reference Destination Symbols
FERC

Actions for Creating and Delet
ing References from a Code Un
Id

Viewina and Editina ReferenceEne BEA AS Ah A

Memory Reference Panel
External Reference Panel
Stack Reference Panel
Register Reference Panel
Adding Memory References fro
a Selection

Introduction
Explicit forward references exhi data
lationship between a ‘source’
referent and a ‘destination’.
Inferred forward references ar
e sometimes rendered automa
ally within the Listing to aid
lu)

user (e.g., inferred function
variable references). This pag
e only covers the managementwhich are stored within the Pr
ogram file.

A forward reference source is
either an instruction or data
code unit within the program i
dentified by a memory address
In addition, the source is qua
lified by an operand-index whi
ch identifies Rs JliCllLIS oris making the reference. Assoc
iating a reference to the corr
ect operand allows the Listing
to render the data or instruc
tion

in a more friendly fashion and
also facilitates navigation w
ithin the program when you do
ble click on an operand field

writhim Fhe | ienean operand, It will only chang
e the rendering of that operan
d within the program

listing if the reference is ma
rked as ‘primary’.

If a reference is placed on an
instruction mnemonic within t
he Listing, the instruction mn
CITA VIRENTL I El Ee

If a non-nrimarv reference exiRAC RA EL LL A A I
arkup), the corresponding
instruction operand within the
Listing will be underlined.

Types of References

The following types of explici

t forward references may be de
fined from a mnemonic or opel
nd of an instruction or dataial aie anal J Salata asians
set and Offcut references)
External Reference

Stack Reference

Register Reference

Ghidra does not permit mixing
"types of references" fora g
iven mnemonic or operand.With the exception of Memory |
eferences, only a single refer
ence may be placed on a given
[LETTS ETE TC

Memory References

All Memory Reference have a d
stination defined by a memorytypical memory reference is th
e Offset Reference which perm
ts the destination address to
be specified as some base
memory address plus a 64-bit
igned offset.

Memory References are used tc
specify either a data access o

r execution flow within the Pr

mrmmn Thic dick imekimm ie maddby specifying an appropriate R
ef-Type on the reference. Addi
ng and removing certain flow r
eferences may change the set
of instructions which make up
subroutine and code blocks. Si
nce function bodies are establ
ished based upon the Block
Models, it may be necessary to
redefine the bodv of FunctionALLAN

Any Memory Reference can be
aracterized as an Offcut Refer
ence if its destination addres

s is contained within a data o

r

instruction code unit and does
not correspond to the minimul
address of that code unit. Su
ch Offcut References producen, since the corresponding lab
el is hidden within a code uni
t a

special OFF_<address> label a
pears on the containing code u
nit within the Listing. Double
-clicking the similarly

colored XRefs within the Listi
ng will allow you to quickly iNavigation). In general, the p
resence of an Offcut Reference
may indicate an error within
the disassembly.

External References

External References are used t
o define either a data access
or execution flow to a memory
destination located within aused when linking to a library
module. An External Reference
destination is defined by a Ex
ternal Program Name and men
location which may be identif
ied by a label or address
contained within the External
Program File. The resulting de
stination symbol takes on the

FIRE CI LI ial address was specified. All
external destination symbols h
ave a hamespace which
corresponds to the associated
External Program Name (e.g., |
SVCRT.DLL::_controlfp).

An External Program Name is c
nsidered to be "resolved" wher
it has been linked to a Progr
am file contained within theLead LAE PSR AS SARA EE IAL
resolved External Program Nan
s, will be displayed in red.

The External Program Names...
action/dialog can be used to s
et or modifying these external
Program file linkages.
External References currently
utilize the single RefType of
EXTERNAL.ccess to a function parameter
or local variable located on t
he stack. All Stack References
have a destination defined by
a stack offset within the cont
aining function's stack frame.
If a real frame-pointer is no

Id

used, the Function analysis wick frame for the purpose of de
fining

stack parameters and local var
iables. When creating a Stack
Reference, a corresponding sta
ck parameter/variable may be
explcitly bound to the referen
ce (see Function Variables), a
Ithough this is generally unnegenerally be determined from f
he stack offset. The sign of t
he stack frame offset makes th
e distinction between a
parameter or local variable as
signment. Stack usage convent
ons are established by the Lan
guage module in use.

Stack References should be ple

IIR Berroa rlStack References may only be
pecified for source code units
contained within a function.
Register References

Forward References 3/14

Reaister References define datAUR AL CE ee AL
ithin a register. All Register
References have a destination
defined by a register within t
he context of a containing fun
ction. When creating a Registe
n

Reference a corresponding reg
ster variable may be explcitly
bound to the reference (see Fis generally unnecessary since
this relationship can general
ly be determined from the regi
ster used.

Register References should be
placed only on register variab
le data assignment operands.
Register References may only k
e specified for source code unReference Destination Symbols
An important characteristic of
all references is that a symb
ol is created for all destinat
ions. These symbols generally
appear

within the listing and can alw
ays be LECLE within J 15) ALLare produced by the creation o
f a reference.
Symbol Name Format

Type
Namespace

LAB_<address>[ell]

A memory address "label"
identifying a branch flow mem

ry
reference destination.

SUB_<address>[ell]

A memory address "label"
identifying a call flow memory
reference destination.

DAT_<address>

[E132A memory address "label"
identifying a data memory
reference destination. If the
address correspnds to defined
data,

the DAT prefix will be replace
d by

the corresponding data-type (eDWORD_<address>).
OFF_<address>
Memory

[ell]

A memory address "label"tan

offcut address within a code u
Ll

These labels only appears with
in

the listing to flag the exista
[Ie=Ne i)

hidden offcut label.
Double-clicking the corresponche
code unit which has the offcut
reference,

Stack/Register/
Memory

Function Name

A function parameter associateWILE Stalk, Teyisiel DE Imemory
location. Parameter references
identified by a parameter nam
which by default includes its
ordinal position.

Register

Function Namewith register references. In
param_<ordinal>

local_<reg-name>[_<firstUseC
set>]

Descriptionwith register references. In
Forward References

addition, the first-use-offset
NZia tT WY vi

the function is included if no
n-zero.
local_<offset>[_<firstUseOffse
t>]Stack

[SAEGE]

Function Name

A local function variable asso

ciated

with stack references identifi
ry vrstack

frame. In addition, the
first-use-offset within the fu
nction

is included if non-zero.

EXTERNAL_NAME A external pr
am location

associated with external refer
encesal

address within the external pr
ogram

file. Each EXTERNAL_NAME car
be associated with a specific
program file within your Ghidr
El

project (see External Program
Names). If only an address is
specified when creating an extEXT_<addr> is used.

The above symbol name colors
orrespond to the default color
scheme (see Code Browser Op
ons). Memory Reference
destinations outside the Progr
am's memory map, and unreso
d External Reference destinati0000) in place of the normal c
[STE Te

The presence of

The actual default label utili
zed for a memory location can
change dynamically and is prox
uced by considering the
following naming precendence
listed ALE 11] NC] ACa

reference, but are considered
when producing the default lak
el name.

Lag BLEGHIDRA Training 0d by

the corresponding data-type (e
EM

FIER Te [I
DWORD_<address>).

OFF_<address>

MemoryA memory address "label"
identifying a memory reference
destination which is located a
tan

offcut address within a code u
Ll

These labels only appears with
I}

tha liekimm Fm flan Fhe avierahidden offcut label.
Double-clicking the corresponc
le]

offcut XRef will take you to t
LC)

code unit which has the offcut
reference,

Stack/Register/
1 =331e]a2LEE Ll LEE

A function parameter associate
d

with stack, register or memory
location. Parameter references
identified by a parameter nam
which by default includes its
ordinal position.Function Name

A local function variable asso
ciated

with register references. In

param_<ordinal>

local_<reg-name>[_<firstUseCDescription

[[eICTIN

with register references. In
Forward References
addition, the first-use-offset
NZL al WV vi

the function is included if not>]
<ext-label>
Stack
[SAEGE]

Function Name(ell

with stack references identifi
EN

an absolute offset within the
stack

frame. In addition, the
first-use-offset within the fu
nction

is included if non-zero.LL
associated with external refer
[Ele

and identified by a label name
or

address within the external pr
ogram

file. Each EXTERNAL_NAME car
be associated with a specific
program file within your Ghidr=
Names). If only an address is
specified when creating an ext
ernal

reference, a label format of
EXT_<addr> is used.

The above symbol name colors
orrespond to the default color
scheme (see Code Browser Opam's memory map, and unreso
d External Reference destinati
ons utilize the "Bad Reference
Address" color (e.g., DAT_0001
0000) in place of the normal c
[STE TI

The presence of

The actual default label utili
Ed for E) memory [REE canfollowing naming precendence
listed highest to lowest). Not

e that some of the following |
abel types are not a result of

a

reference, but are considered
when producing the default lak
el name.

i

-LS
5.

FUN_<addr> : Function entry |
[ll

EXT_<addr> : External entry p
[ll

SUB_<addr> : Call flow referer
ce destination

LAB <addr> : Branch flow refehg aad LL EE lib
stination

FERC

The term Ref-Type, as used wit
hin Ghidra, is rather ambiguou
s - and will hopefully be chan
ged in a future release of
Ghidra. While the following "t
ypes of references" are supporSea a
define Ref-Type as the "type o
f data access" or "type of flo
w" associated with a reference
. The following table attempts
ld

clarify the various Ref-Types
and when they can be used.
KER

DATA[l]
[USL

eC]
General data/pointer reference

MGeneral indirect data referenc
e

MSR
pC]

Direct data read reference

REAM INDLu

pC]

Indirect data read reference

LS

[USLDirect data write reference

M

eC]

Indirect data write reference

LETSDirect data read/write referen
[3

LAY 1\'1o}
READ
WRITE_IND

NLRREAD_WRITE
MSR
eC]

Direct data read/write referen
[3M
eC]

Indirect data read/write refer
EI

Save Nol B)

rData

Direct stack read reference
STACK_WRITE (Note 1)

BS)

eC]EXTERNAL_REF (Note 2)

3

INDIRECTION

mMIndirect flow via a pointer (r
eference should be from an
instruction to a pointer). Alt
ernatively, a COMPUTED

CALL or JUMP reference could k
e placed from an

instruction to one or more ind
irect destinationCOMPUTED_CALL
M
REY

Computed call flow from an ins
tructionM
RE

Computed jump flow from an ii
truction

UNCONDITIONAL _CALL

MLas

Unconditional call flow from a
n instruction

UNCONDITIONAL_JUMP
]

[3badd iin billing LL LLL ALL LE ELE
n instruction

CONDITIONAL_CALL
M
RE

Conditional call flow from anCONDITIONAL_JUMP
M
RE

Conditional jump flow from an
instructionExternal program reference (fl
ow or data access
unspecified)

*In the above table, the Refer
ence column indicates the "tyf
e of reference" for which the
Ref-Type is applicable: Memory1. The use of STACK READ and
TACK_WRITE Ref-Types will like
ly be replaced with READ and \
RITE Ref-Types in

a future release of Ghidra.

2. The EXTERNAL_REF is a gen
al purpose Ref-Type used for a
Il External references. At thi

s time, the type of flow or
I TL AER3. ITyou need to alter the FA
LL_THROUGH flow behavior of
instruction, modify the Fallt
hrough Address instead of
adding a memory reference.

Actions for Creating and Delet

ing References From a Code Ur
Id

There are three actions providLat LL Lhe Lh il lb LL
eBrowser Listing while the
current cursor location is on
the mnemonic or operand of ar
instruction or data code unit.
The create and delete referen
[3

actions may be disabled under
certain conditions.

References fromitem varies based upon curren
t operand)

Delete References (menu item
aries based upon mnemonic/of
and current references)

  

Default key-bindings for actio
ns are indicated with {}'s.
Add Reference Fromrence on an operand (see Crea
ing a Default Reference below)
ul

arbitrary reference may be als
o be added directly to a mnem
nic or operand by using the po
pup menu action References
Add Reference from... . This w
ill cause the Add [EST Di)
permitted reference types.
Creating a Default Reference {
FA Ii8

Creating a Default Reference
RI

a rrWhile the current cursor locat
ion is on the operand of an in
struction or data code unit wi
thin the CodeBrowser Listing,
lu)

popup menu item References
Create Default Reference* may
be selected to create the defa
ult primary reference for an
operand. This action will be dLL bid LL LR LL
erand field or a default refer
EI

can not be determined.

When creating a default Memo
reference on a scalar operand
, for programs with multiple m
emory spaces, repeatedly
invoking this action will cycl

e the default reference througused in creating the Memory re
ference, simply repeat the act
ion.

When adding a Stack or Regist
r reference, a corresponding p
arameter or variable may be cr
eated. If a local variable is
created, the first-use-offset

of the variable will corresponrecommended that the first ref
erence to a variable be create
d on the the first "assignment
"instruction. If a newly crea
ted

variable is unwanted, it may b
e deleted by clicking on it wi
thin the Listing and hitting t
he "Delete" key. Keep in mindy explicit bindings to that va
riable will be cleared.

*The popup menu item name (
te Default Reference may diffe
r based upon the type of refer
ence which will get

created: Create Memory Refere
ce, Create Stack Reference, Cr

eate Register Reference.
Nalatinm Rafarancac fram a (arWhile the current cursor locat
ion is on the mnemonic/operar
of an instruction or data cod

e unit within the CodeBrowser
Listing, the popup menu item |
eferences

Delete References* may be sel
cted to delete all references
on the current
mnemonic/operand. This actiotlLR hl EE hb Ll
to a mnemonic/operand field
or references do not exist on
the current mnemonic/operanc
*The popup menu item name [
te References may differ based
upon the existing reference(s
JRE ER UET Ts

References, Delete Stack Refer
ence, Delete Register ReferencViewing and Editing Reference
(Add/Edit...) {'R'}

All references "from" a data o
r instruction code unit can be
edited and/or viewed by click
ing on the code unit (or a spe
cific

operand) within the Listing an
d activating the Add/Edit... aJAGCIT/=C TI ANE

Each time this action is invok
ed a new instance of the Refer
ences Editor panel will be dis
played. Once the panel is
displayed, the

toggle button may be pushed-i
to have the source location f
ollow the current location witForward References 7/14

Source

The references displayed and r
anaged within this panel are a
Il "from" a single source inst

ruction or data
A ETtop or the References Editor p
anel as it

would appear in the Listing. U
sing this display, you can cli
ck on either the code unit Mne
monic or an

individual operand to highligh
t the corresponding references
within the table below and to
Raa)Lidl Li br fl RR ES ho
ed Source operand will be trea
ted as the

"active source operand" used f
or Add actions. These operand
labels will also act as drag-n
-drop target

zones for code unit selections
dragged from the Listing (see
Adding Memory References frcThe table entries that match t
he selected source element wil
| be gray in color.
The Home Button

can be used to set the current
Listing location to the Sourc
e code unit address.ClTY LL ERITH ETE IE

d within the table with the fo
llowing columns:

Operand - Indicates on which
ortion of the code unit the re
ference has been placed
(MNEMONIC,OP-0,0P-1,0P-2,...
IB
Destination - Indicates the deation

displayed for each type of ref
erence utilizes a different fo
rmat:

<address> : indicates a memo
destination
<address><signed-offset> : ir
icates an offset memory refere

nce relative to a base
Joaates a stack reference with a
specified stack frame

[yt

<register> : indicates a regis
ter reference for the specifie

d register.

External : indicates an extern
al reference

Label - Indicates the namespac
e-qualified symbol hame assocRill LiatiBcLiBN yin ie

*Ref-Type - Identifies the typ

e of data access or instructio

n flow associated with a refer
CIE

*Primary? - Allows the user to
choose a single memory refere
nce which will be reflected in
the*Primary? - Allows the user t

o choose a single memory refei
ence which will be reflected i
n the

rendering of a code unit opera
LIK

Forwardwillere manually added by the use
or by means of auto-analysis
have a check displayed.

*With the exception of Externa
| references, both the Ref-Typ
e and Primary? choices may be
changed directly within this t
ELIEes outside of the program's de
fined

memory blocks will be displaye
din red (e.g., DAT_00000000).
These red references frequent
ly

correspond to well-known men
y locations, although they cou

Id point out a bad reference.
Ferri.memory locations (e.g., memo
mapped I/O regions) will help
to resolve

some of these apparent "BAD"
CE CHIEEN

Actions

The following actions are avai
lable from the References Edit
or panel. For those actions wi

th a defaulttell hl Ll Be LIE ll
LIN

Add Reference {Insert-key} - |
nvoking this action will launc
h the Add Reference Dialog for
lu)

current code unit (see Adding
a Reference).

Delete References {Delete-key
BR eR IE Tea eT RUouble-click a row} - Invoking
this action will popup the Edi
Id

Reference Dialog for the selec
ted reference (see Editing a R
eference). This action is only
available

when a single reference row is
selected.

Et

 

>y references selected in the t
able,

invoking this action will caus
e the corresponding locations
within the Listing to become s
elected.

Follow Tool Location Changes -
Once enabled (i.e., button pu
shed-in), any location changewill cause the currently disp
layed source code unit and ass
ociated

references to reflect the new
location.

Send Location Change for Sele
ted Reference Destination - On
ce enabled (i.e., button pushe
d-in),

TT FV TRVa location change to the tool
corresponding to

the selected destination. This
will have the effect of scrol
ling the Listing to selected d
estination. In the

case of an external location,
an attempt will be made to ope
n the corresponding program a
d scrolling tohoddi dali SELLER LE ih hl
GoTo Reference Source Locatic
- Invoking this action will s
end a location change to the t
ool

corresponding to the source co
de unit. This will have the ef
fect of scrolling the Listing

to the current

source code unit.Invoking the Add... action fro
m the References Editor windo
will cause the Add Reference
Dialog to be displayed for the
current Source code unit. Once
displayed, the Source code un
it mnemonic or operand may b
selected by clicking on it, as
well as the Type of Reference.ned based upon [I choosen
operand.

Forward References 9/14

In general, only flow referenc
es should be set on an instruc
tion mnemonic, unless of cours
CRE] LEECH Ch has ale)r) should always specify the s
calar operand as the source, n
ot

the mnemonic (i.e., data-type)

Stack and register references
may only be specified for sour
ce code units contained within
om finrbinan Ramictar[esl llleR- Rel CH
egister and in general should
correspond to a WRITE
KERN

With the exception of memory
eferences, only a single refer
ence may be set for a given op
erand or mnemonic.

An External reference may not
be set on a mnemonic.Ldnieiafol J Lb hb ELE Ll
Reference, the lower portion
of the dialog will change. The
following sections discuss th

e

input panels for each of the f
our possible choices:

i

2.

EWMemory Reference Panel (inclu
es Offset and Offcut reference
Bl

External Reference Panel
Stack Reference Panel
Register Reference Panel

Once the appropriate reference
panel has been filled-in as r
equired, the Add button may bWhen adding a Stack or Regist
r reference, a corresponding p
arameter or variable may be cr
eated. If a local variable is
created, the first-use-offset

of the variable will correspon

d to the source instruction lo
cation. For this reason, it is
recommended that the first Slinstruction. If a newly crea
ted

variable is unwanted, it may b
e deleted by clicking on it wi
thin the Listing and hitting t
he "Delete" key. Keep in mind
that

when a variable is deleted, an
y explicit bindings to that va

RSNA ig PIA llEdIting a Rerterence

Editing a Reference

Forward References 10/14
Invoking the Edit... action fr
om the References Editor wind
w will cause the Edit Referenc
e Dialog to be displayed for
the current Source code unit.hdl tbl had Ed LE Ll
responding to the edited
reference will be selected, as
well as the Type of Reference

. Neither the Source operand n
or the Type of Reference may k
e

changed when editing a refere
ce. If you wish to change eith
er of these settings you mustThe Edit Reference Dialog uses
the same layout as the Add Re
ferences Dailog with the only
exception being the dialog tit
C]

and the Add button which is ne
med Update in the Edit mode.
imilarly, the lower portion ofRE he] discuss t
he input panels for each of th
e four possible choices:

i

2.
9
Fl

Memory Reference Panel (incluExternal Reference Panel
Stack Reference Panel
Register Reference Panel

Once the specific reference pa
nel settings have been modifie
d, the Update button may be cl
icked to complete the operatio
iB

TT To ny . mna data access or instruction T
low to another memory locatio
within the same program
space. A memory reference ma
optionally be specified as an
Offset Reference relative to a
specified Base Address. The
term Offcut is used to charact
erize a memory reference or it
s resultina label whose destinfal
to the start of a data or inst
ruction code unit (see Offcut
References).

Below is an image of the Memc
y Reference Panel as it might
appear in the Add Reference or
Edit Reference Dialog. The
two views reflect a regular me
mory reference and an Offset rat anladidaaanbatat ugi

fo selection state).

[0);54

If the Offset checkbox is "che
cked", this memory reference v
ill be treated as an Offset Re
ference relative

to the specified Base Address.
The actual "to" address willOffset value to the Base Addre
ss. The number format is assur
ed to be decimal unless the "0
Peli eH

used when entering a Hex valu

Offset value to the Base Addr0x" prefix is
used when entering a Hex valu

Forward References 11/14
To Address
[

Offset] The To Address entry i

s required for normal memory |
PALES IE ey VSdestination as a memory offset
. This entry is always interpr
etted as a unsigned hex value
(i.e., the "0x"

entry prefix is assumed). For
those processors with multiple
address-spaces, a pull-down i
s also provided

allowina the address-space toht al Lh

[

Offset] The Base Address entry
is required for offset memory
references and specifies the

offset base

location as a memory offset. T
his entry is always interpretthe a
prefix is assumed). For those
processors with multiple addre
ss-spaces, a pull-down is also
provided

allowing the address-space to
be selected.

Address History Button

The Address History pulldown |
utton may be used to recall aAddress entry. Only the last t
en (10) address entries are ma
intained for each open Progran

KER

Allows selection of the data a
ccess or instruction flow type
associated with this referenc
e (see Ref-Types).An External Reference identifi
es a memory destination withir
another Program file. Such re
ferences are generally used to
indicate a library module link
age. The memory location with
n the External Program is iden
tified by either a Label or an
Address.

LI Cg 1 SUTtappear in the Add Rererence
or Edit Reference Dialogs:

Name

This field identifies a names
pace name corresponding to tt
External Proaram and may beLE dt hh ed
choosen from the pull-down lis
t of those previously defined.
This is a required input.

Path (Clear/Edit)

This field identifies the Prog
ram file within the Ghidra Pro
ject which corresponds to the
selected Name.

Associating the External ProgrAIR]
facilitate navigation to an as
sociated library if it is cont
ained within the same project.
This Name/Path

association can easily be "res
olved" at a later time via the
External Program Names Dialoithin the External Program is
identified by either a Label d
efined within

the corresponding Program file
, or via a specific Address. |

f both a Label and Address are
specified, the

Label will take precendence du
ring navigation. The Address f(i.e., the Ox entry prefix is
assumed) offset within the def
ault address space.

Stack Reference Panel

A Stack Reference identifies a
data access to a function par
ameter or local variable withi
n the containing function's st
mapelow Is an Image of the Stack
Reference Panel as it might a

ppear in the Add Reference or

Edit Reference Dialogs:

Stack Offset

Specifies a signed offset with
in the containing function's s
tack frame. The number formalegion LE LI Een dL CU iL
fix is used when entering a He
PQ'EINEN

KER

Allows selection of the data a
ccess or instruction flow type
associated with this referenc
e (see Ref-Types).

Variable Name

An optional entry which identiSelecting an
existing variable will automat
ically change the Stack Offset
to match the selected variabl
e. Entering a

new name which does not exis
will cause a new stack parame
er or variable to be created w
[I R15)keeping the initial default va
riable choice.

Register Reference Panel
Forward References 13/14

A Register Reference identifievariable within the containin
g

function's stack frame.

Below is an image of the Regis
ter Reference Panel as it migh
t appear in the Add Reference
or Edit Reference Dialogs:

Register

Indiratac Fhe calartard Anarandegister variable reference wil

| be established.

KER

Allows selection of the data a

ccess or instruction flow type

associated with this referenc

e (see Ref-Types).

Variable Name

An optional entry which identi
fies the variable name to be alandbecod LB LS ELLA Lb LL
does not exist will attempt to

create a new local register v

ariable with the reference. Cl

earing this field will have th

e

same effect as keeping the ini
tial default variable choice.

Adding Memory References froCodeBrowser Listing may be d
agged and dropped onto the Ri
erences Editor panel to

create Memory References in b
Ik for the current Source. Thi

s capability must be used care
fully since a seperate referen
[3

will be created "to" every codThe specific mnemonic/operan
which will be used as the sour
ce for the new memory referen
es depends on where the
selection is "dropped" within
the References Editor panel (s
ee figure below). The preferre
d method is to "drop" the
Eel on the correct monc/ific Drop Zone). Alternatively

the selection may be "dropped
on the reference table (i.e.,
Active-operand Drop Zone) to
utilize the current
mnemonic/operand choice fror
he Source code unit area. Whe
"dropping" on the table, be c

I NC TE€ unit area since this coulda c
hange the active Source mnerr
ic/operand for the panel.

selection across te Source co
de unit area since this could
change the active Source mner
nic/operand for the panel.
Forward References 14/14hit lb Jes ARR LL tlc iG
Related Topics:

Resolving External Names
Show References to a location
Code Browser Navigation

Location References Dialog 1/4

Location References Dialogdisplays all the memory refer
ence destinations to a specifi

c code

unit that is described by the
item under the current locatio
n. For example, if the current
location is a

referenced label, then the dia
log will show references to thfollowing snippet, the label
LAB_40768a" is the field at th
CE Eh dl TeE ale] 8

Showing the Location Referenc
s Dialog dialog at this locati

on will show all references to
the label
RV. lopk-lc Paurrent location is a data type

, then all

places that data type is appli

ed will be shown and the data
type will be highlighted in th

e Data Type

Manager tree.

As another example, if the loc
ation is an XRef field locatio

mn than tha dialan will chew Fthe aadress that the AReT Tiel
d represents. In the following
snippet, the Xref field "0040
FEY IN AH

the field at the current locat

ion.

Location References Dialog 2/
achill J LL br rs br
s Dialog dialog at this locati

on will show all references to
lu)

address 0040767d.

You can also show references t
o data types from the Data Typ
e Manager. In this

case, all locations where theTo Find Location References
1. Right-mouse anywhere on tt
code unit*

2. Select whichever of the fol
lowing

Select References

Select References

Select ReferencesLIB

Show References to from the p
pup menu.

Find References to from the po
pup menu.

Find Uses of from the popup m
LCRthe location that was clicked
, then the menu item will be d
isabled.

The results of performing this
action depend upon the locati
on the cursor when the popup
s shown.

Here are some examples:

WN rer seria ss: slim Ipviae IU oasis menthat data type, such as in fu
nction

signatures and locations that
type is applied in memory,
When over an address, all refe
rences to the code unit contai
ning that address will be show
n,

(which is what the Show Refere
nces to Address action does)Risilite ARI Fiallel
This title displays the item t
hat is the destination of all
the references in the Referenc
65)

table.

The

button will cause the code bro
wser to return the cursor to t
he location frombutton will refresh the table
of references. This button wil
| appear disabled when

the data is not stale. However
, if Ghidra detects that the d
ata may be stale, then the
button will become color fille
d, as it is here. You may push
the button for a refresh inThe

button will create a selection
in the code browser with the
reference

entriesReferences Dialog 3/4
Location

selected in the table. You may
also access this SIS by r<1,

The

button toggles the highlightin
g of the matching references.
In this case, the term
highlight refers to the backgr
ound color of the item in the
Listing and not a Program
Selection Highlight.ction Highlight, use the selec
t button

mentioned above. Then, click f
rom the menu bar Select
Program

LIL

[SCRE Eela le)

Search Results
This table displays a lista rpil otb Edible LLL LL LE
selected destination instructi
on or data item. There are fou
r fields by default that are
displayed in the table:
Location - Shows the source ad
dress.

Label - Shows the primary labe
| at the source address (if on
EOE SRddress.
Context - Shows the type of re
ference to the current locatio
n. If the result is a Ghidra
in-memory Reference, then thi
column will show the type of
reference. If the result is

found by way of the Decompile
, then the line from the decomYou can make a selection in th
e Code Browser from the entrie
sin the table:

1. Click on an entry in the ta
ble, or Ctrl-click to select m
ultiple entries.

2. Right mouse click and choos
e Make Selection.

The current selection in the [eothat you selected in the Addre
ss table.

To Find Location References to
Data Types

From within the Data Type Mar
ger you can right-click on a d
ata type and select Find Uses
of. This

and I evans 23 | rergiidre ry IS ast raryons where the selected data ty
pe is applied,

such as in function signatures
, return types, structures, et

c. For FunctionDefinition

s the action

will display all places that f
unction is applied.-

By default, finding uses of da
ta types will search not only
for applied data types,

but also will perform dynamic
discovery of data types using
the Data Type

Reference Finder service. This
causes the search to be sloweht) pasha

e e the dynamic searching, use t
he Search

Dynamic

Data Type Discovery tool optio
iB

   

To Show Location References t
Code Unit
1. Right-mouse anywhere on ttShow References to Address fr
m the popup menu.

This will show all references

to the current address, as wel

| as all addresses consumed by
the current

instruction or data.

*If the Location References Di
alog cannot show references tcisabled.

This action will show only dir
ect references to the current
code unit. No other special re
ference

finding will take place.

Renaming WindowsWindows

Provided by: LocationReference
sPlugin

Related Topics:

Forward References (Reference
Editor)

Data Type ManagerEquates 1/7

An Equate is a string substitu
tion for scalar (a numeric val
ue) in any code unit (instruct
ion operand or data). For exam
ple, consider

the instruction below:

MOV R2, $0xb_CRITICAL. This will yield the
following:

MOV R2, BATTERY_FLAG_CRITI
The substitution of "BATTERY _|
LAG_CRITICAL" for $0xb is call
ed an equate. That is, $0xb is
equated to
"BATTERY_FLAG_CRITICAL". Nc
that the default choice for th"BATTERY_FLAG_CRITICAL" wil
eplace the scalar value $0xb o
nly at the current cursor loca
tion unless you choose a diffe
rent

option. However, when replacir
g another scalar of the same v
alue, a list of previously dec
lared Equates for that scalarScalars can only be equated to
strings. The string can be of
any length and may contain sy
aces and special characters. D
uplicate

equate names are not allowed.

It should be noted that for th

e purposes of this document, "
RU wn. {peat | ep 1)SCE

unit is an instruction operand
or other data element.

There are several operations t
hat are associated with Equate
ELEC

Set Equate

Rename Equate

Remove Equate

Apply Enumhil bo

Set Equate

The Set Equate action will cre
ate one or more Equates in the
Listing.

To set an Equate:

1. Right-mouse-click on the ta
rget scalar value, and select
Set Equate or press <E>.Equates 2/7

2. When the dialog appears, ei
ther type in an equate string
or choose one from the list of
strings that are known to be
associated with

the given value. As you type i
n the "Equate String" field, tcontain the
text that has been typed.

3. Select one of the choices f
rom the "Apply To" list. Curre
nt Location is the default cho
ice unless a selection is made
, in which case

the Current Selection option w
ill be set. The SC option icted the equate will be applie
d to the scalar value at the c
urrent location of your cursor
only.

b. Current Selection: When sel
ected the equate will be appli
ed to all of the scalar values
in your current selection tha

t match
Ab zn p30 4 dt volt Hho gs ‘@rid Viv SARE xu make a selection In your pro
gram this button will become
enabled. If you do not make a
selection then it will not be
enabled and the option will be
grayed out. Note that scalars
I}

your selection that already ha
ve an equate set will not be a
ffected bv this unless vou alsLal ih LE LEE
ed the equate will be applied
to all of the scalar values in
the entire program that also
match

the value of the scalar that y
ou originally right-mouse-clic
ked on.

d. Overwrite existing equates:
This option is only enabled woption is selected, all scalar

s and all named equates in the
selection or entire program,
depending on which option is
selected, will be set with the
user-given equate name. If th
e overwrite option is not sele
cted, only scalars not alreadyhe user-given equate name.
4. Double-click on an entry in
the list, or select an entry

in the list and press OK, or t
ype in the string and press OK
. If any item in the

list is selected it will be us

ed, otherwise the text in the
"Equate String" field will beThe list of strings shown in t
he Set Equate dialog are gener
ated from two sources. The fir
st source is all the

currently assigned equates to
the given value. The other sou
rce is all the Enum datatypes
that exist in all the open

datatype archives. If an Enum
Aaratrvna aviete that hae a maryquate value, then that string
AURCERR EIS

The open data type archives cc
ntain valid enums and "fake" e
nums. The fake enums are cree
ed from #define

values (parsed from .h files),
specifically so that they wil

| be available in the Set Equa
te dialoa.Each entry in the dialog is ¢
olor-coded based upon how it i
s being used as an equate.

Equates 3/7
a. Blue: Blue entries are exis

ting user-defined string equat
es that are being used for thaisting enum field equates bein
g used for that scalar.

c. Gray: Gray entries are sugg
ested enum fields that have th
e same value as the scalar. Th
EEERRIIEEET ER
suggestions, and have not yet
been made equates.rename one or more instances
f a named Equate in the Listin

[-}

To rename an Equate:

1. Right-mouse-click on the cu
rrent Equate, and select Renan
e Equate or press <E>.

2. Select one of the choices iice unless a selection is made

, in which case

the Current Selection option w
ill be set. The other option i

s Entire Program.

a. Current Location: When sele
cted the equate will be applie

d to the scalar value at the c

urrent location of your cursor
-_smected the equate will be appli
ed to all of the scalar values
in your current selection tha
t match

the value of the scalar that y
ou originally clicked. When yo
u make a selection in your pro
gram this button will become
enabled. If you do not make a
selection then it will not beLh dr nd

c. Entire Program: When select
ed the equate will be applied
to all of the scalar values in
the entire program that match
lu)

value of the scalar that you o
riginally clicked. Scalars tha

t already have an equate set t
hat is different from the one3. Double-click an entry in th
e list, select an entry in the
list and press OK, or type in
the string and press OK. If a
ny item in the list is
selected it will be used, othe
rwise the text in the "Equate
String" field will be used.selected it will be used, othe
rwise the text in the "Equate
String" field will be used.

Equates 4/7

Remove Equate
The Remove Equate action will
[URS an Equate(s) from a lisar

value.

To remove references to an Eq
ate via the context popup men

1. Right-mouse-click on an exi
sting Equate, or select a grou
p of equates and right-click o

n an equate within that select
PSEd

2. If you made a group selecti
on, a confirmation dialog will

appear to ensure you want to
remove all equates in the sele
ction; equates

within the selection matching
the one you clicked will be re
moved.EAfMetle Wid LTE LLCS Leite
LULT[VS

1. Select the Code Browser me
u option Window Equates Tabl
to bring up the Equates Table
AULA

2. Right-mouse-click on the Eq
uate to be deleted and select
Delete.

3. A confirmation dialog will4. Select Delete to remove all
references to the equate and
the Equate's definition itself

Apply Enum

The Apply Enum action will ap
ly enum member names to sca
s in the current selection if[LR
To apply an enum to the select
ion:

1. Make a selection and then R
ight-mouse-click, then choose

Apply Enum. Note that the Apg
y Enum action will only appear
in the

Right-mouse menu if there is aEquates 5/7

2. A dialog similar to the one
below should appear. Select t
he enum that you want to be a
plied to the selection. The da
ta type must be

ET FN TR TTApply to sub-operands - Applie
s the enum to scalars within o
perands.

Once the data type is selected
, the scalars in the selection
will have equates applied to
them as shown below.

View EaquatesUM sie Ye 6 WILMNYY WIILL Tis
ts all of the Equates and thei

r references in a tabular form
at.

Equates 6/7

The left panel, Equates, lists
name, value, and number of rea
lu)
address and operand index of ¢
ach location that references t
he Equate selected in the left
panel. Selecting an address o
n the

References panel will cause th
e Code Browser to go to that a
ddress in the listing. The Equcan each be sorted by any colu
mn. The ascending and descen
ng indicator displays the sort
order of the information.

To view the Equates Table sele
ct the Code Browser menu opti
n Window

LULAYou can re-order the columns i
n the Equates table by draggin
g the header to another positi
on in the table. Sort the colu
mns by

double-clicking on the header.
By default, equates are sort

alphabetically. You can re-ord
Br tha Erde ras mrss 5 Ria nel rhoperand index, Up Index. By de
fault, the references are sort
ed by reference address in asc
ELIT NI [ST

You can also rename the equat
by double clicking in the nam
e field and entering a new narr
e. If the equate is based off

of an

enum. then an enum editor dizhail Ti AL SEL SLL ELC Lh
hange the equate name.

Each equate is color-coded bas
ed upon how it is being used.
a. Blue: Blue equates are exis
ting user-defined string equat
es that are being used for tha
tscalar.

b. Black: Black equates are ex
isting enum field equates beina bil ey
uates. A bad equate could eith
er mean that the enum that th
s equate is based off of

was deleted, the field inside
the enum was deleted, or the f
ield's value was changed.

Convert
The various convert actions aryed in the code browser. These
actions are available whenever
the cursor is on a number in
the operand field, or the valu

e field of a data item (byte,
TR

dword, qword). Note that these
actions and equates are not c
el supported for composiar number is converted visuall
y by replacing the number witt
an appropriately named equat

Such a conversion can be clear
ed by removing the equate fror
the operand. For data value f
ields, a combination of data
format settings and signed/uns
Frmucin. BO COSC Pn tm SeI'he available tormats are as T
ollows.

Signed Decimal

The existing scalar value will
be displayed as a signed deci
mal number. This action is onl
y available if the value can b
e

interpreted as a negative valu
I.hah ta Bl EL LLL]
be displayed as an unsigned d
ecimal number. If the value wo
uld be positive even if the si
gned

decimal format was selected, t
he action will simply be name
Decimal instead of Unsigned D
cimal.

Unsigned OctalUnsigned Octal
Equates 7/7

The existing scalar value will
be displayed as an unsigned o
ctal number.

Signed Hex

The existing scalar value willonly available if the value c¢
an be

interpreted as a negative valu
e, and is only supported on in
struction operands since the d
ata hex format currently suppo
43

unsigned rendering only.
Unsigned Hexexadecimal number.

Char / Char Sequence

The existing scalar value will
be displayed as either a sing
le ASCII character or a sequen
ce of ASCII characters, whiche
ver is

more appropriate. Invalid and
non-printable ASCII characters
will has rarnptarard iv Faw fa rmunsigned Binary

The existing scalar value will
be displayed as an unsigned b
inary number.

[El

The existing scalar value will
be displayed as a IEEE 754 si
ngle precision floating point
number. The floating point siz
eisLandi LL Lh
type. This action is only sup
ported on instruction operands

Double

The existing scalar value will
be displayed as a IEEE 754 do
uble precision floating point
number. The floating point siz
5a type. This action is only su
pported on instruction operanc
EX

The convert actions also work
on an instruction selection. |
ust make a selection then choc
se an operand scalar value to
convert. All matching instruct
ion scalar values in the selecis implemented by its' associa
ted language module, a hexads
imal operand which appears
to be negative may in fact be
a positive scalar with negativ
e sign '-' character prepended
. In such cases, the convert a
ction may

not produce the expected resurence on an operand may preve
t rendering of the converted s
calar value since reference
markup takes precedence over
quates and data formatting.

Provided By: EquatePlugin and
EquateTablePluginFunctions 1/7

Functions store information ab
out locations within a program
that may be referenced by a c
all instruction, although no
direct reference to a function
is required. External Functio
ns may also be defined and assNetfitco Jette. MA TMTL ASD Sefer
on consists of:

An entry point address or exte
rnal location symbol

A body of instructions (does n

ot apply to External Functions

)

A function signature/prototype
specification, consisting of:

Rs3

Function Name (same as prime
label at entry point)

Calling Convention (available
conventions defined by active
compiler-spec)

Return data type (with storage
)Optional function attributes,
including:

1. Varargs enablement

2. No-Return enablement (if en
abled, calls to function will

not return and can prevent fal
Ithrough from

call)on code)

4. Custom Storage enablement
if enabled, return and paramet
er storage to be explicitly de
fined)

ERE IRAN]

Additional function listing ma
rkup (does not apply to Extern
al Functions):

bBE

Local variables (with storage)
Parameter and local variable r
eferences from instructions
Code and data references from
instructionsbag Clb LL SLI dh
omment
Function Tags

When displayed in the browser
a function includes:

The entry point is usually cal
led by another instruction, al
though there may be no direct
reference to theECA
ust be an instruction.

The body of the function is un
der user control, but can be a
utomatically calculated when t
he function is

defined. The body can be a con
tiguous range of addresses or
may be multiple address range
. Data may alsoe and optional attributes are
displayed within the listing a
t the function entry

point. This information may al
so be displayed at pointers wh
ich reference a function provi
ded the appropriate

tool option for displaying fun
ction WCE is enabled (seeFunction Signature, Attributes
and Variables

Please refer to Function Signa
ture and Variables for details
on this subject and how to mo
dify a function
signature/prototype specificat

ion, including function attrib
IRE SEYLreate Function

Create Function creates a func
tion with an entry point and a
body of instructions.

To Create a Function,

Functions 2/7high i eb Ru)
a defined instruction.

2. Right-mouse-click, select t
he Create Function popup men
item

As part of creating a function

, function parameters and loca
| variables may also be create
[ITFunctions may be automaticall
created via Auto Analysis.

If a function starts with an u
nconditional jump instruction,
the function will be created
as a Thunk

Function if possible.

The entry point for the functi
on is the address at the curreselection, the entry point is
the minimum address in the se
Elen

The current code browser selec
tion is used as the function b
ody. In the absence of a selec
tion, Create Function will
follow the control flow from t
iS entry Sls to determine thcontiguous.

To see the body of the functio
n that has been defined, place
the cursor on the first instr
uction

within the function and choose
ELIE

Functions from the Code Brows

JTIs used as the name of the Tun
ction. If no symbol exists at
the entry point a default

label starting with FUN_ is cr
eated. Prior to creating the f
unction, the symbol may have
tarted with SUB_ if it was

a default symbol and there wer
e call references to it. If a
symbol does exist at the entrviL.
you can change the suggested
unction name, FUN_ <address:
After the function is created,

a symbol is created

with the name from the dialog.
If the symbol name is changed
the function name displayed w
ill also change. Rename Functi
on can be used toate Function will try to ident
ify parameters and local varia
bles used by the function.

By default, the variables data
type will be UndefinedN where
N is the size (in bytes) of t

he stack reference. See
Function Signature and Variab
es on how to modify the stackvariables.

ELIE

Subroutines will display the s
cope of a subroutine from any
address within the scope of th
e subroutine. It

is helpful to use the Subrouti
nes option to determine what t
us potential Ea of a functiRe-Create Function

Re Create Function rebuilds a
function's body of addresses w
ithout destroying any paramet:
rs or stack references

that may have already been cre
ated. This action is useful wh
en additional code has been fo
[ERR rar uF WAwas not Know when the origir
al function was created. Most
likely auto-analysis
will have fixed the function's
body already and re-creating
the function won't be necessar
y.
With no selection, the functio
n's body is re-calculated base
d on the flow of the instructi| a tlt he lL LLL Bod
n, the body of the function is
set to the current selection.
To Re Create a Function,

To Re Create a Function,

Functions 3/7a al
eady Jr LTT TN

The cursor can be on any field
at the entry point of the fun
ction.

2. Right-mouse-click, select t
he Function Re-create Functior
popup menu item

To Re Create a Function, with
a forced new bodybody of the function. The cur
sor should be at the

top of the already defined fun
ction.

The cursor can be on any field
at the entry point of the fun
ction.

2. Right-mouse-click, select t
he Function Re-create FunctiorRecreating a function will kic

k off auto-analysis on the fun
ction if there are any changes
to the

function's body. New paramete
s or locals may be created sin
ce more code may how be part
iia

function's body. See Variables
FV. WTR rR WEThunk Functions

Thunk Functions are a commor
rtifact of compiled code and a
re frequently used to facilita

te access to external

functions, functions located f
ar from the caller, and other
relocation scenarios. Ghidra h
as the ability to specify aA HOLIET Tu LAAT SM SLE: Lists
the same function signature ar
d parameter storage as the
real function (also referred t

o as the thunked-function), al
though its name may differ. A
thunk function within

Ghidra acts as a proxy to the
real/thunked-function where al
| parameter and attribute chanto this is the name. If a thun
k is created without a name, i
ts name will reflect the name
of the thunked function. Renar
ing the thunk allows the thunk
to have a name which differs
LHCInRGE)

thunked-function. Local variab
les are not supported for thune-clicking on a thunk function
name will navigate to the ass
ociated thunked

function, while thunked functi
ons will display back-referenc
es (i.e., XREFs) to the associ
ated thunk functions with a
FERN CE

To Create a Thunk-Function:the new thunk function, or pla
ce your cursor on a

single unconditional jump inst
ruction which jumps to the thu
nked-function.

2. Right-mouse-click, select t
he Create Thunk Function pop!
menu item

3. If unable to determine the
Fhiinbard-fiinetinn tha Hear wilhunkead-runction by

label or address. The specifie
d location must correspond to
an existing function.

To Edit a Thunk Function (i.e.
, set the associated thunked f
unction) or Convert a normal F
Pllc LRN TTT

Function:

1. Place the cursor in the Codid Abt LE LLL ib
The cursor can be on any field
at the entry point of the fun
ction.

2. Right-mouse-click, select t
he Function Set Thunked Func
on... popup menu item

3. The user will be prompted t
o specify the thunked function
by label or address. The spec~

 

<1,
To Revert a Thunk Function (i.
e., revert a Thunk Function to
a normal Function):
1. Place the cursor in the Cod
e Browser at the top of an alr
eady defined thunk function.
The cursor can be on any field
at the entry point of the funhe Function Revert Thunk Func
nN... popup menu item

i

The cursor can be on any field
at the entry point of the fun
ction.

2. Right-| mouse- Jl Rh 93. The user will be prompted t
o confirm the action.

Functions 4/7

External Functions

Defining an External Function
allows a function to be define
d which does not reside within
ha rrirrant "rac ramaddress Is unknown. similar t
o a simple External Location,
these external symbols

are associated with named Lib
ary namespaces and are most ¢
sily managed via the Symbol T:
ble or Symbol Tree

under the Imports category. If
the actual Library name is un
known. the "<EXTERNAL>" LikLh els EL J Bi J
a parent namespace.

From either the Symbol Table «
r Symbol Tree, an existing Ext

ernal Location may be converte
d to a function using

the Create External Function p
opup action on the selected no
de. The resulting External Fun

ction may be convertedra o
node. To really remove the fun
ction and its location will
require a second delete on the
External Location.

From either the Symbol Table «
r Symbol Tree, an existing Ext
ernal Function may be modifies
using the

Function Edit Function... popuCreating an External Reference
is currently the only mechani
sm within the Ghidra GUI to es
tablish an External

Location. Once an External Loc
ation has been established, it
can be converted to a functio
n (see above). This

limitation should hopefully beCreate Multiple Functions
Create Multiple Functions crea
tes functions from a selection
in the listing. It works from
the minimum address to

the maximum address in the s
ection trying to create functi

ons if possible. Any addresses
LC ASR Ii aused to determine new Tunctic
ns. Also whenever a function i
s created by this action,

all the addresses in the body
of the created function are al
so discarded from being possib
le addresses for starting a

new function.

A common use of this action is
on a selection containing theLariat dh Lc i
create.

[SHAR le TT

For information on editing fun
ctions, see Function Signature
Help.

Rename Function
Rename Function renames ann name is the same as
the primary label at the funct
ions entry point.

To rename a function,

1. Right-mouse-click on the fu
nction header in the Code Brov
Eo

2. Select the Function Rename
Function popup menu itemhe name may also be entered \
th a fully

qualified namespace (e.g., myr
amespace::myfunction). The *
‘is used as a namespace delim
IST

 

 

[EIEN IT elale]))Delete Function removes a func
tion. There is no confirmation
for the Delete Function opera
tion. However, the

results can be undone using th
e Undo operation.

When a function is deleted all

stack variable definitions ar
25 vaErvererisel | 3a rA rea

 

In ol paiLLCS ERE RE LR
unction's body. If a stack ref
erence refers to a stack varia
ble that is deleted, any
references will be replaced wi
th Stack [offset], where offse
tis the relative offset to th

e stack.

To Delete a Function,

1. Right mouse-click on the fuonli ont l LIL ELL Eo
Function popup menu item
When a function is deleted, al
| stack and register reference
s from instructions within the
function body are removed.
The function comment (which
really the plate comment for
that address) remains intact i
f you had made changesas created.

If there are still call refere
nces to this address, the labe
| changes from FUN_ to SUB_.

   

Function Purge

A function purge is the numbe
of additional bytes (not incl
uding the return value) a funccalculated as the difference b
etween the stack pointer's val
ue exiting the function and
its value coming into the func
tion but excludes the final po
p of the return address.

For most calling conventions,
the function purge is always z
ero. A major exception is themay pop off its own stack par
ameters in addition to the ret
urn value. The function

purge in this situation can be
positive indicating that more
values are popped from the st
ack. For other unusual
situations, a negative functio

n purge can be set indicating
BIL) LR IFor architectures where the st
ack grows in the positive dire
ction, the meaning of the func
tion purge sign is reversed.

A positive function purge indi
cates additional bytes are pus
hed to the stack, and a negati
ve function purge indicates
bytes are popped from the stac
k.bh RS GER Lol Ll
ion header

Select the Function Edit Funct
ion Purge... popup menu item
Enter the new function purge s
ize in the dialog that appears

Function Repeatable Comment
When a repeatable comment e
ts at the entry point of a funFunction Repeatable Comment
eld rather than the EOL Comm
t field. See Edit Comments for
more information

on comments.

Stack Depth Change
You can specify a relative cha
nge in the stack depth at theSet Stack Depth Change
Functions 6/7
To set a change in stack depth

Right mouse-click on the Listi.. from the popup menu.

The Set Stack Depth Change d
log is displayed. The Stack De
pth Change textfield initially
contains the

current stack depth change val
ue. If the stack depth change
is not explicitly set at this
address, the default

walite will ha hacad An Fha ineon, the dertault stack depth ch
ange will be based on

the function purge value of th
e called function.

Enter the desired change in st
ack depth. This can be either
decimal or hexadecimal. Hexac
cimal is indicated

[SE-B GT a Cla er Nad dad hl LE
change.

If you are not on a Call instr
uction, the stack depth change
LER

Otherwise, you will you will s
ee a dialog allowing you to ch
oose whether the value should
be applied as a

stack depth change at the currigi adsl
J (Global).
Choose Local to set the stack
depth change or Global to set
the function purge.

 

Remove Stack Depth Change
To remove a change in stack d
pth where it is currently set:
Put the cursor location on thePress the Delete [eA

or
Right mouse-click on the Stack
Depth = StackDepth + ... line
in the Listing.

Select Remove Stack Depth Ch
ge from the popup menu.Function Signature and Variab
£5

Auto Analysis

Stack References

Comments

[CLle dL E)
FLAG(3/4): tiondl_sNariables 1/8and Variables

Function Signature

A function's signature conveys
the following information abo
ut a function:

i

vi
ER
£3[Ite RTT)

The function's return data typ
e (void indicates no return va
I')]

The function's name

Ordered list of named paramet
rs and associated data types.

lel NETantic analysis and may be set
via the Edit Function dialog.
Custom Storage

The Custom Storage option, if
enabled, provides the ability
to explicitly specify return/p
arameter storage. By default,
storage will be dynamically co
mputed based upon calling cor
A EL IV Ee)storage Is computed, hidden “e
uto-parameters” may be inject
d as well as the use of "force
d-indirect" storage.

[LIILEY

Any Inline function called by
another function may be treate
d as inline code instead of a
function call during analysis.
No ReturnLg bliin) LiL LE LE] LR)
d continue flowing to the next
instruction, marking a functi
on

as No Return forces an implied
return immediately following
a call to such a function. Dep
ending upon the state of
disassembly, marking a functic
n as No Return may help to preinstruction during disassembly
. If disassembly has already b
een done and the fall-thru has
been improperly disassemblec
the Clear Flow and Repair acti
on may be used to cleanup the
bad fall-through.

Varargs

Designated by a trailing "..."of parameters is allowed. Com
[th

C functions which employ Vara
gs are printf and scanf.
Call-Fixup

A function may be tagged with
a predefined Call-Fixup which
can be used to alter/simplify
the semantic effect of callingare defined within the compil
er specification (*.cspec file

J

associated with a program. Thi
s feature is typically used wh
en the effects of calling a we
ll-known function need to be
simplified so that the caller

can be more easily analyzed ar
Tre i rrbrdt nnnVariables

There are two classes of funct
ion variables: Parameters and
Local Variables. The term Para
meter also includes the Functi
on

There are two classes of func
tion variables: Parameters andhls BR LEE LS
ion

Variables 2/8

return value which has an asso
ciated data type and storage b
ut has no ordinal.

Many processors use a stack as
part of their calling convent
ions and/or for local variable
HelC CR RE CRC ECR Eh= a
ck during the call operation.
Any references to the stack (e
.g., references and variable s
torage) are

relative to the stack pointer
when the function is entered.
For a negative growing stack (
like the X86 processor), the s
tack wouldLocal Variables

Saved Registers
Return Address
Parameter 1

EIElnEES
oles as well as the builtin pri
mitive data types. To define s
LUTE

see Data Structure Editor
Parameters (includes Function
Return)

Storage for return/parameters
can be computed dynamically

sed upon the associated callin
I Lp Ca Le SOM)complete function signature).
The ability to properly comput
e the correct storage is limit
ed by the current capabilities
of the

function prototype models and
Decompiler within Ghidra. In s
ome cases it will be necessary
to enable Custom Storage for
FYitl Lb Rl ES LL
eturn/parameters including the
ability to join multiple stor
age elements

(i.e., varnodes) for a single
parameter.

When parameter storage is det
rmined dynamically, the callin
g convention may dictate the u
se of hidden parameters which(auto). In addition, the "forc
ed-indirect” (ptr) condition m
ay be imposed on parameters \
hl

large data is forced to be pas
sed by reference. When either
of these is in use for the ret
urn or parameters, the (auto)
or (ptr)for each parameter. The param
ter names 'this' and
'__return_storage_ptr_'arer
eserved for the two supported
auto-parameter cases. The "thi
s' auto-parameter is imposed b
y the

__thiscall calling convention,
RLS fel EN CITT SE impoize of

any parameter passed by value
If forced-indirect is imposed
on the return storage, the '_
_return_storage_ptr_'

Fe parameter will be impose
to allow the function caller

to specify a pointer to the fu

Il return storage data locatio
[REY TTR.sumed any auto-parameters wi
be explicitly defined as norm
al parameters if applicable. W
ithin the

Program API, auto-parameters
ay not be directly manipulated
and are immutable.

The Function Editor is the mos
t affective means of modifying
the function signature eitherwithin the Decompiler
Local Variables

Currently, there is no specifi

c user interface action for cr
eating Local Variables. Stack
and register variables will

be created automatically when
a suitable stack or register re

Decompiler's commit actions w
Il create Local Variables as n
eeded. They can also be create
d programmatically.

In addition to register and st
ack locations, Local Variables
also have the ability to be d
efined by the Decompiler to re

 

hr ay a hash value. Please note th
at these hash type variables c
an sometimes not work as expe
ted

within the Decompiler. In addi
tion, the scope of a local reg
ister variable is determined b
y its first-use-offset which r
CCE SR GThich the variable is first wri
tten. The variable will remain
in scope from

that point forward until anoth
er local variable comes into s
cope for the same storage loca
tion. Local stack variables as
EVOKE

first-use-offset of zero (0).Derine Variable Data lype or
Function Return Type

Variables 3/8

Variables can be annotated wit
h one of the built in or user
defined data types. The undefi
ned or previously defined
variable will be redefined tohi tRl BL Cn Lt LLL
parameters and return, can be
defined one of four ways:
Using right-mouse-click on the
return type or a parameter wi
thin a function signature disp
layed within the listing.

1. Right mouse click on the re
turn type or parameter within
the function signature|:

; if the cursor is over a para
meter, select

Set Data Type

The pull right menu lists data
types that you have marked as
REVCIICER

After you apply a data type, t
his becomes your most recent!

 

hi baad

diane ilthe menu with the 'Y* as the "
hot key."

Using right-mouse-click on a p
arameter, <RETURN> or local \
riable listed within the funct
ion variable listing

1. Right mouse click on a para
meter, <RETURN> or local variThe pull right menu lists data
types that you have marked as
RCVCIICER

After you apply a data type, t
his becomes your most recent!
used data type and is shown o
n

the menu with the 'Y* as the "
hot key."ndow (drag ana drop)

1. From the Code Browser tool
bar select Display Data Types
(1)

2. In the Data Type Manager wi
ndow select the appropriate da
J RaY I]

3. Drag and Drop the data type
onto the target parameter, <R
ETURN> or local variable in thBrVvio el
Assigned Quick key,
Place the cursor on the target
parameter, <RETURN> or loca
variable
Press a quick key i JeeTo Lote}
fy a data type (i.e., "b"-byte

, "p"-pointer, .

 

 

Edit Functionof the function and its parame
ters that can be changed. The
Function Editor Dialog allows
you to make those changes. To
edit a function do the followi
ng:

i

2.

ENPlace the cursor on a function
signature

Right-mouse-click, and select
[STV lelaleT

Edit any attributes of the fun
ction using the dialog.

Press OK to save your changes.Function Signature Field

The area at the top of the dia
log is used to show the comple
te function signature. It will
update as you make changes t
lu)

various fields in the dialog.
You may also use this field to
directly edit the signature,

I Icurrent parser Is severely lim
ited. Once you make a change
n this field, all the other fi

elds will be disabled temporar
1%

until you complete your chang
s and press either <TAB> or <I
ETURN> to continue. You may
so complete the edit by
clickina outside of the siagnatLE i eit SLL LR
fully parse your changed signa
ture field, a dialog will appe
ar giving you the option to co
ntinue

typing in the field or abortin

g your edits in that field.

Due to limitations in the pars
er, there are many function siEnd
Fir enter " [37 IIR RY]

e function signature field. Fo

r example, you cannot use the
signature field to enter
templated types. Also, the par
ser currently only supports co
mmon datatypes and datatype
hat are currently

used in your program. To enters, use the more

precise controls that the dial
og provides.

Function Name

This text field can be used to
change the name of the functi
[LR

Calling ConventionVariables 5/8

This field is a combobox that
allows you to choose a calling
convention from the list of k
nown calling conventions for t
LIS

processor and compiler specifi
PTE

 

POA AC TEstom Storage checkbox has be
selected.

Function Attributes

This sections contains a set o

f miscellaneous checkboxes th:
t affect the function.

Varargs - sets the function to
have a variable number of arg
Sli oR

In Line - indicates this functLL LRb i Lieb © RC bt
No Return - used to indicate i
f this function does not retur
iB

Use Custom Storage - If select
ed, the user can edit and chan
ge the storage of the return v
alue and the parameters.
Otherwise, the storage is dete
remind by the selected callingParameters/Return Type Table
LUCE ICTR CIEE Ra" CRY
le allows the user to add or r
emove parameters as well as c
anging their names and
datatypes. It also displays th
e return value datatype and st
orage. Also, if the Use Custom
Storage checkbox is selected,return type can be changed.
Table fields

Index - indicates its ordinal
position in the signature (sta
rts with 1). This field can't

be edited directly, but can be
affected by the Up and Down b
ttons. Note: this field is bla

nk for the Sl value.type. Clicking on this field

will bring up a DataType
Chooser Dialog.

Name - the name of the param
er. This field can be edited d
irectly in the table cell. Not

e: the name of the "return
value" is <RETURN> and can't

e changed.
CEAarane - Fha etarame far rhethe Use Custom Storage check
x is selected, this field

can be edited by clicking on i
t and bringing up the paramete
r editor dialog. If not using
custom storage,
auto-parameters or forced-indi
rect storage may be imposed a
determined by the selected ca
lina convention and isWILE LT Misiieyld LUITIMULEM. 5
JET

Table Buttons

Add - Adds a new parameter tc
the function

Remove - Removes the selecte:
row (parameter) from the table

Up - Moves the selected parammeter later in the signature.

Call Fixup

This field is a combobox that
allows use to use a predefined
Call-Fixup. A function may be
tagged with a predefined
Call-Fixup which can be used t
o alter/simplify the semanticpredefined Call-Fixups are def
ined within the compiler speci
fication (*.cspec file) associ
ated with a program. This feat
PI

is typically used when the eff
ects of calling a well-known f
unction need to be simplified
so that the caller can be moreEdit Parameter Storage Dialog

This dialog is invoked by cli
cking on the storage column in
the Edit Function dialog. Thi

s dialog allows your to precis
C1

aeter. Ihe parameter can even «
e divided amongst multiple sto
rage locations. Each row

of the 6/8

table specifies a storage loca
tion used by the parameter.

Size Information
The top of the dialog shows tw
o sizes. The Datatvpe size isLaat a hel LL
Id

datatype. The Allocated Size s
hows how much storage as bee
allocated based on the rows in
the table.

Storage Table

A table of storage locations w
here each row represents a sto
rage location. You must add enSE Jia ada
he size of the parameters data
RLS

Table Columns

Type - the type of storage. Ca
n be either Stack, Register, o
r Memory. Clicking on the fiel
d will bring

up a table version of a combo-
box.stack, it will be an integer
offset. For

register, it will be the name
of the register. For memory, i
t will be the address. Clickin
g on this field

will bring up an editor approp
riate for the storage type.
Size - The size for this storave bytes to use

for this storage. For a regist
er, it will the number of byte
s to use within the register,
up to the size of the
register.

Table Buttons
Add - Adds a new storage locat

Fynrow (storage location) from th
CRCIIER

Up - Moves the selected storag
e location earlier in the allo
cation.

Down - Moves the selected stor
age location later in the allo
cation.Li Lob Lb LEE L
ocation.

Variables 7/8

Create Function Definition
Once you have defined a functi
on, you can make a function si
gnature definition which is a
new data type that can bee. —_ data type appears vs
the program node in the Mana
e

Data Types window.

To create a function definitio
n, position the cursor on a fu
nction signature, right mouse
click and select Create Functi
one name of the data type is the
same name as the function.

To create a new function signa
ture definition using the one

you created, drag the data typ
e from the Data Type Manager
window and drop it on the exis
ting function where you want t
WS new function signature to bction definition on one thaty
ou have already defined, nothi
ng happens.

Rename Variable

Rename Variable will change t
e name of a variable from its
default name to a user-defined

name.
A Tr TTget variable within the tuncti
on variable listing

2. Right-mouse-click, select F
unction Variables Rename Pare
eter... or Function Variables
Variable...

3. Type the new variable name
in the dialog and press<Enter:
, OR click on the OK buttonDelete Variable

Delete Variable will remove th
e target variable from the lis
ting. There is no confirmation
with Delete Variable.
However, the operation can be
undone using the Undo operat:
iB

To delete a variable,Ebr ha
on variable listing

2. Right-mouse-click, select F
unction Variables Delete Pararr
eter or Function Variables
Variable

 

[EIEN ITE]

Edit Commentiated with them. The comment
s free form text. If a

comment already exists, the cc
mment is modified.

To add/edit a comment to a val
iable,

i

ha
ERPlace the cursor on the target
variable

Right-mouse-click, select Edit
Comment

Enter the comment.

Select OK

Remove CommentTo remove a function variable
comment,

1. Place the cursor on the var
iable comment

2. Hit the <Delete> key

Recently Used Data Type
The data menu shows an optio
for the data tvpe that was mosLAL ER Rl Lh J
option is

'y,' however, you can change t
he key assignment through the
key bindings panel on the Edit
Options dialog.

Provided By: Function Plugin
Related Topics:
Data Structure EditorFunction Tag Window
Function Tag Window 1/3
The Function Tag window prov

es a list of function tags def
ined in the currently open proare assigned to the currently-
selected function. Tags may be
created by the user, or loade
d from a predefined set (see s
ection on

loading tags below).

To display the Function Tag wi
ndow, select the Window Func
on Tags option on the al merking on a function header in t
he listing and selecting the E
dit Function Tags option.

Window Components

This window has five distinct
sections:

Available Tags List: Displays

all tags that are available to

mecirnn FA Fha rlirrant flinectinAssigned lags List: Displays a
Il tags that have been assigne
d to the current function.

Tag Input Field: Allows users
to create new tags. Multiple t
ags may be created at one time

Filter Field: Allows users to
filter what is shown in the Avtel RTH

Assigns the selected tag(s) to
the current function

Removes the selected tag(s) fr
om the current function
Deletes the selected tag(s) fr
om the program and removes t
m from all functionsCreate

Tags can be created by using
the Tag Input Field described
above. Users may enter multipl
e tag names

delimited by a comma. All newand Function

are NOT Tag Window 2/3
assigned to any function.

Each tag may have an associat
d comment that is visible as a
tooltip. This can be assigned
after the tag

has been created (see edit sec
LT NLTa set of tags and pressing the
following:

icon. Users will be prompted w
IRIS)

If confirmed, the tag will be
removed from the system and
om all functions to which it h
I a a)lag names and comments ma)
edited by double-clicking the
item in the list. If the tag i
EH ETI GE

user will be presented with th
e following warning:

If editing is allowed, the fol
lowina dialoa will be shown:inno BL BLL LLL

Tags may be added to a functi
n by selecting a set of tags a
nd pressing the

removed from the Available Ta:
s List and added to the Assign
ed Tags List.

button. The tags will beTags may be removed from a fi
ction by selecting a set of ta

gs and pressing the

removed from the Assigned Ta
List and added to the Availab
le Tags List.

Function Tag Window 3/3
button. The tags will beTags may be loaded on startup
from an external source if des
ired. These will be shown in b
lue and cannot be edited or
deleted, with one caveat: once
a tag has been assigned to a
function it ceases to have any
special protections and can b
eTo make these available there

must be a file named functionT
ags.xml available on the class

path. Edit (or create) this fi

C]

and add tags as needed. The fc
rmat is as-follows:

Sled

<tag>

marmmawTACT «Jnana —</tag>

<tag>
<name>TAG2</name>
<comment>tag comment</cc
ic Ed

</tags>

Be aware that any external tag
s that have removed/edited wil
| reappear with Ghidra is restEde EE SLE LL
Provided By: FunctionTagPlugil
Related Topics:

[LleII

Register Values

Register Values Plugin 1/4HIE that i 5 [EIRP % th
e program's language. When a
rogram is actually running, th
e

registers contain values that
make up the processor state at
any given instant. Since Ghid
ra programs represent a static
A UAINCNsee register values. The best
approximation is to assign reg
isters

values at addresses. This is u
seful if the register value ca

n be determined to be constan
anytime the instruction at th
at address is

executed.20", then it might be possible
to assume that the value of r
egister ax

will be 20 for the next severa

| instructions (assuming there
are no "jumps" into that code
).
Setting register values can so

metimes be the critical link f
RR Yr em 1[euulgle mu yo]

correct disassembly. For examy
le, some processors have a "mc
de" that is stored in some reg
ister. Depending on the mode,
lu)

processor may have completely
different instruction sets. To
disassemble properly, the moc
e redister must be set at theLb RL Lh tL LER Lh J ER

Register Manager

The Register Manager displays
the assigned values of registe
rs at addresses within a progr
am.

To display the Register Manage
r, select the Register Manager
menu item from theWindow nrThe left side of the Register
Manager is a tree containing a
Il the registers defined for t

he program's language. If the
registers have been grouped in
to categories by the language,
those registers will appear u
nder a folder with that group
name. Registers that break doyicon. These nodes can be furth
EIT IS ISe Re)

reveal their component registe
rs. For example, EAX can be op
ened to show AX, which can th
n be opened to show AL

and AH. Registers that don't h

ave sub pieces use the

icon. - The LHUER OEE]used to quickly find any regis
ter. As you begin to type the
name of a register, the tree w
ill shrink eliminating any reg
isters

that don't contain the filter
fo

Tha rinht cide Af the Ranictalays ranges or addresses that
have assigned values for which
Ev

Register

Values

register is selected in the re
gister tree. Initially, the ta

ble only contains values that
have been explicitly
associatedLol fe
selected register and addresse
s. There is an option in the d
rop down menu that will cause
the table to also show default
values for a register. Default
values are assigned by the la
nguage and usually only apply
to context registers.Toggles whether or not to sele
ct the row in the currently se
lected register value table wh
ose address range

contains the current address o
f the cursor in the listing vi
ew. For example, in the Regist
er Manager image

show above, if the user clicksw of the table will

be selected if this action tog
gle ison.

Deletes the register value ass
ociations for all the selected
ranges in the table.

Creates a selection in the bro
wser for all the address range
H Ei in the register valhe register tree that don't ha
ve any associated values (defa
ult or otherwise).

Menu Actions

Show Default Values - if selec
ted, the register manager will
show default register value r

anges mixed in with
1Hear car ranictar valiie ranfnacEdIting an Address Value Rang
Double click on any row in the
register value table to bring
up the Edit Register Value Ra
nge dialog.

Using the dialog, you can adju
st the start or end address an
d/or change the value associat
ed with the ranae. Ifbatho kl Ut labo) Ld
maller, then value association
s for address range that

was trucated is effectively cl
eared. For example, in the dia
log shown above, if you change
the end address to

01001b47 and change the valt
to 111, then addresses 01001k
3 to 01001b47 will have the vavalue.

 

Setting Register Values Over A
ddress Ranges

Setting Register Values Over
Address Ranges
Register Values Plugin 3/4create a selection in the bro
wser and then invoke the Set R
[Eel

Values action by either using
the right-mouse popup or using
the <CtrI>R quick key. The fo
llowing dialog appears.

Choose the register for whichtton. The Address(es) field sh
LH

the set of addresses that will
be affected. By default, the
Value field is entered as an u
nsigned hex value, but the for
mat

can be changed using the adja
ent drop-down menu.

Jr NAL LEE. I FInvoked, then the register comk
o will be set to that register

Clearing Register Values Over
Address Ranges

To clear a register value over
an address range, first creat
e a selection in the browser a
nd then invoke the Clear Reaisith nd LL LEI JE BLL
ht-mouse popup. The following
dialog appears.

Choose the register for the as
sociation and press the Ok but
ton. The Address(es) field sho
ws the set of addresses that w
1)

be affected.Choose the register for the a
ssociation and press the Ok bu
tton. The Address(es) field sh
ows the set of addresses that
A

be affected.

Register Values Plugin 4/4

Delete Exiting Register Valuester values using Delete Regis
ter Value Range action when o
er a Register Transition field

in the browser ("assume ESI =
0x20".) Activating this action
will remove the register asso
ciation over the entire range
associated with that "Assume"
statement.Bookmarks 1/4
Bookmarks

Bookmarks are used to flag ad
resses of interest in a Progra
m. Each Bookmark consists of :
PR RTL ME a SN Sw)ription (optional). Bookmarks
[UE

be organized using the catego!
y field. Ghidra places various
Bookmark icons in the Marker
Margin of the Code Browser to
indicate locations of defined
bookmarks. The tooltip (shown
when the mouse hovers over tt
Bookmark icon in the Marker Nan ll kahit bob
The type refers to how the boo
kmark was added. Ghidra supf
es five types of bookmarks:
Bookmark Types

Type (icon)

How Bookmark is Added

Navigator ColorAdded via the Note Bookmark
alog; Notes are intended to

be user-defined only.

Purple

InfoCyan
Analysis

Added during the Auto Analysi:
process. Indicates

automatic changes which have
een made to the programOrange
Sel

Added by the disassembler or /
uto Analysis process when

an unexpected condition is ide
ntified at a specific address

1m re art Ervatrs srbirmrmtLh)

Represents a custom Bookmar|
ype which was added by a
plugin not currently configure
d into the tool. A properly
designed plugin will assign a
custom icon and color to its
custom type.Magenta

Ghidra also places a marker fo
r the bookmark in the Navigati
on Margin of the Code Browser
Clicking on the Navigation Ma
rgin causes the Code Browser t
o go to that address, and

centers it in the browser.how to add and remove bookn
ks.

Add a Bookmark (in the CodeB
LAST)

To add a Note Bookmark,
i
2.5.
[2B

Position the cursor at an addr
[ES

Right-mouse-click in the Code
Browser, select Bookmark

The Address field on the Note
Bookmark dialog shows the locEnter a Category (optional) or
choose an existing one from t
he combo box

Enter a Description (optional)
; if an end of line comment ex
ists at this address, then thi

s text becomes the default des
cription of the bookmark, as s
hown in the image above.
Clirk An ha OK kiranvvhen adding a bookmark with
Itiple selections in the Code
Browser, the Bookmark Top of
ach Selection checkbox is both
enabled and selected by defal
It. Leave the

checkbox selected to create a
bookmark at the start of each
address range in the selection
Deselectinag the checkbox wileh hb ELL Lt LLL

Before Adding Bookmarks to S
ection

After Adding Bookmarks to Sel
ction

The following image depicts th
e Code Browser with Bookmarkthe markers in the Navigation
Margin on the right.

Bookmarks 2/4

Remove a Bookmark (in the Co
Browser)
To remove a bookmark,[EIEN EE]

2. From the Marker Margin, rig
ht-mouse-click, select Delete
Bookmark

<type>: <description>

Bookmarks Window
The Bookmarks window lists alype, category, description, ad
dress, label, and code unit wh
ere the bookmark was

placed. Click on a Bookmark to
navigate to the selected addr
ess in the Code Browser.

To display the Bookmarks winc
w, click the bookmark iconr select the Window

Bookmarks option from the me

Each of the columns may be sc
ted by clicking on the header.
The sort graphic illustrates
which column is being sorted c
n. and whether it is ascendingFR dL Lil
In the image above, the Previe
w column is sorted in ascendin
g alphabetical order. By defau
It, the bookmarks are sorted i
n ascending order by the Type
[ITT

).umns are editable. To edit ent
ries in these columns, double-
click on the appropriate cell
and begin typing. Click
outside of the cell to apply t
he changes. When the Categor
column is being edited, it sho
ws a combo box, listing all of
the categories. Choose an exired, the combo [15 5 updated.

The list of Bookmarks displaye
d can be filtered by clicking
the Filter button

checkboxes in the Bookmark F
ter dialog.

in the toolbar of the Bookmarkcted

You may also filter the conte
nts of the bookmark table by u
sing the filter text field.
Bookmarks 3/4

Tia Frnllminrirnre rHaeeriiese ths famarks window (Note: some of 1
ese features are also availabl
e from inside the CodeBrowser

Edit Category
i

2.
EN
FlLR lil A) JEL LR LE LT
Click on the down-arrow buttor
in the cell editor to display
the list of categories.

Select a category from the lis

t OR enter a new category in t
he cell editor.

Press the <Enter> key or click
outside of the editor.oncell to display the cell edi
jl

2. Enter a new description.

3. Press the <Enter> key or cl
ick outside of the editor.

Change the Sort Order
Click on the desired column he
ader to change the sort order.avigate to the bookmark.
Filter Bookmarks

pRNelil gl

button in the local toolbar of
the Bookmarks window to dis
ay the Bookmark Filter dialog.
2. Configure filter informatio

iB

3. Click on the OK button.the filter types, then the fi
Iter icon will show a checkmar
13

).

You may save the settings of t
he bookmark filter dialog by s

aving the tool.
[Pye

 

TT.so Tilter the contents of the
bookmark table by entering te:
tinto the filter text field f
[ILI IR ERT ln Ne

the bookmark table. This filte

r will include only those Book
marks whose Category or Desc
ption contain the specified te
xt. For example, to show only
the entrv pointLo ELE alta LE
results would show only those
bookmarks with a Category or
escription containing the word
"entry". The

text filter is not case sensit

ive, nor does it support regul
ar expressions.

Reorder Columns

Reorder columns in the Bookmin the table.
Make Selection in the Code Brc
NESS

i

2.
3.
Fl

Select one or more rows in thelL]

button in the local toolbar.
The corresponding addresses a
e selected in the browser.
Navigate to the selected addre
ssed by using the navigation b
uttons (Remove Bookmarks

1. Select one or more rows in
the Bookmarks table.

2. Hit the <Delete> key, or pr
ess the

icon on the Bookmarks toolbar,
or right mouse click and choo
se the Delete option.Click the Dismiss button to ex
it the Bookmarks window.

Provided by: Bookmarks Plugin
Related Topics:

Navigate on Selection

Marker Margin

Navigate on Selectionhab dE ull

Bookmarks 4/4GHIDRA Training 17
TOP SECRET//CYBER//NOFORNClear Code Bytes 1/7

Clear
Clear Code Bytes
Clear Code Bytes reverts disasundefined state. It can also b
e used to clear the component:
of an applied

structure directly from the br
owser.

To Clear a single instruction,
1. Position the cursor on a de
fined instruction or data code
unitwindow, select Clear Code Byte
B

Alternately: press the 'C' key
RCN ETE TEN

1. Select the defined code uni
ts (data and instructions)

2. From the right-mouse pop-u
menu over the Code Browser
window, select Clear Code ByteTo Clear components of a struc
ture directly in the browser,

1. Select the structure elemen
ts in the open structure

2. From the right-mouse pop-u
menu over the Code Browser
window, select Clear Code Byte
B

Alternately: press the 'C' keyure from the Codebrowser, cha
ges the

definition of the structure an

d will affect all occurences o

f the structure.

Clear With Options

Clear With Optionshada Lid ll Le hdl)

Clear With Options more select
ively clears information defin
ed in the program.

While Clear Code Bytes only cl
ears code units and their asso
ciated data, Clear

With Options can selectively r
emove additional information,The Clear dialog has check box
es for each type of informatio
n that can be

cleared. If the checkbox is se
lected, that item will be remo
ved everywhere within

the selection when the OK butt
on is pressed.ode Browser containing instruc
tion

1. Create a selection in the
Code Browser containing instru
ction

Clear Code Bytes 3/7

and/or defined data to be cleamenu over the Code Browser
window, select Clear With Opti
[iE

3. De-selected the check boxes
from the items that should no
t be

cleared.

4. Click OK.

TE ry TRU. I Tr ToThe following paragraphs desc
ibe each option.

Symbols

Any User defined symbol in the
program. Automatically gener:
ted

symbols won't be cleared if re

ferences still exist to the sy
mbol'sThis option will not clear fun
ction names. To

delete these you must select t
he functions option.

Comments

Clears Pre, Post, End of Line
(EOL), Plate comments. It will
notThis option will not clear rep
eatable or automatic
comments. To delete those cor
ents you must delete

the associated reference.

[eT gulesses in a program by plugins
to store Clear Code Bytes 4/7
information. This information
is usually only understood by
lu)

plugin that placed it there or
other cooperating plugins.
Select the properties icon ()
on the tool bar to display alLAL RENT ITN

Code

Data and Instructions are clea
red.

User-defined References

Any references added by the u:
er are cleared.

Analysis References

Any references created by anal
eis Mache nim rimmedANy references created auring
the import process are cleared
, such as

calls to external library func
tions.

Default References

References automatically creat
ed by Ghidra during disassemk
y are

cleared. This includes referenae J
of a function.

[LleI-I

Defined functions are cleared,
including comments and any ¢
fined

Defined functions are cleared
, including comments and anytack variables within the body
of the

function will be cleared as we
[IN

Registers

Registers within the selection
with a defined value will be
cleared

and set to undefined. RegisterRegister Values.

Equates

Instructions with Scalar Opera
nds set to display an alternat
EET]

with an Equate are cleared.
Bookmarks

All types of Bookmarks are cle
ared.Clear Flow and Repair is inten
ded to be used to clear and op
tionally repair code

which was produced in error. T
he duration of this action wil

| vary depending on

the extent of the instruction
flow. If good code with extens
NERC

ancratinfarad fhe artinn Mav F-the Tlow analysis Is

lengthy, a task dialog will be
displayed with a Cancel butto
n. The Cancel button

may be pressed to terminate tt
e action.

You can undo clearing of code
units if it has an undesired e
ffectLh Ld ilo fl a CL RELL OE ad
behavior. Pressing

the OK button will begin the c¢
lear process using the selecte
d options.

Clear Code Bytes 6/7

To Clear instructions producedhhc casual Lal dh ac

by a data reference:

1. Click on the first bad inst
(ial)

2. From the right-mouse pop-u
menu over the Code Browser
window, select Clear Flow and
Repair...

3. Choose the desired Clear Fl
ow Options.To Clear instructions referenc
ed by one or more pointers :
1. Select all pointer data uni
1S

2. From the right-mouse pop-u
menu over the Code Browser
window, select Clear Flow and
Repair...

3. Choose kal [ESIC REE A]Note that clearing pointer ref
erenced code will also clear a
[INT palo Rie

references to the address(es)
referenced by the selected poi
CEN

The following paragraphs desc
ibe each option.

Flaar Cur bhmleared code unit locations will
5)

removed.

Clear Data

Clear Code Bytes 7/7

All data whoose onlv referencehil ELLER LE LL LL

Repair

Following the clearing of the
flow, attempt to repair the di
sassembly

of references into the cleared
region.

Provided By: ClearPlugin[pal oeT gale t- M11
Property Viewer
Property Viewer
Property Viewer 1/2

The Property Viewer window sted to a code unit and can stor
e values at addresses. Plugins
can define

their own properties for stori
ng plugin specific information
at an address. The display pr
ovides a convenient way to see
all the properties that exist

in the Programowser shows a pink marker for
each location of that property

. The window provides a quick
way to

remove all properties at once.

To display the Property Viewer
window, select Window

Nizam rem Drrvasrime frame fheIn this example, a plugin has
placed several source related
properties on code units. Sele
ct the row for "Source File" t

o see all the locations in the
Code Browser

where a "Source File" property
is defined, as shown in the i
maae below. The left marain olKe Fle MIC LLY, Lhe-ridite
margin

shows the other locations whe
e the Space properties exist;
click on the right margin to n
avigate to that location.

To delete all properties in th
CRE ICTnN
1. Select a property to deletejell EN
The property will be removed f
rom the list of properties in
the dialog.

To undo the delete, select the
button on the tool.

 

Property Viewer 2/2ugin

Related Topics:
Code Browser
Navigation Margin
Marker Margin

Override Fallthrough Addresse:Fallthrough Address

LUE CLG LET [EER ET
instruction is the address of
the next instruction that will
be executed. You can change t
e fallthrough address by using
the Set Fallthrough

Address dialog, as shown belov
. By default, an instruction's
JL NAN msthe language processor. ror e
xample, a “return” or a
"jump" instruction does not ha
ve a fallthrough address.

Set a Fallthrough Address
The dialog shows the default f
allthrough address of the inst
ruction. The radio

buttons below the FallthrouahLie eviMins 1s Lie
default fallthrough or user de
fined. When the Default button
is selected, the

Fallthrough Address field is d
isabled. If an instruction has
no default fallthrough

(e.g., "jump"), the Fallthroug

h Address field is empty. Choo
se the User button toected, the
Fallthrough Address field is u
pdated as you move the cursor
in the the Code

enter a new fallthrough addre
ss. When the User button is se
lected, theinOverride

the the

Code Addresses 2/4
Fallthrough

Browser.

Select the Home button to nav
gate the Code Browser back to
this address. The

home panel shows the addressoption.

To change the fallthrough addr
[ES

i

2.

)

ES

Position the cursor on an installthrough set... to display t

he dialog.

Select the User radio button.
Enter an address, or click in
the Code Browser at the addre:
s of the new

fallthrough.

5. Select the Apply button to
change the fallthrough and lea
ve the dialogbball LL LAG AER LR
ismiss the

dialog.

You can see the effects of set
ting the fallthrough address b
y selecting the limited

flows from option; the instruc
tions that are skipped over vi

a setting the

fallthrough address are not inL aie
ess will be a comment indicati
ng the

override, containing the text
Fallthrough Override, along wi
th the updated

fallthrough address.

To clear a fallthrough address
using this dialog, select the
None button, thenAuto Override

The "auto override" feature sk
ips over data following an ins
truction, finds the

next instruction following the
data and sets this address as
the fallthrough

address. You can automatically
override the fallthrough addrlithrough addresses over a sel
Elen

To auto override,

1. Make a selection in the Cod
e Browser or position the curs
oratan

instruction.

ET Er LI asoratan

instruction.

Override Fallthrough Addresse:
3/4

2. Right mouse click and selec
t Fallthrough Auto override

The Auto Override option is di
sabled for a single instructio
REIR =)tthe J AR SL bl

Clear Overrides

To clear overridden fallthroug
hs,

1. Make a selection in the Cod
e Browser or position the curs
oratan

instruction whose fallthrough
address was overridden.The Clear Overrides option is
disabled for a single instruct
ion if the

instruction's fallthrough addr
ess was not overridden.

Provided by: FallthroughPlugin
Related Topics:FEIT
Code Browser
Languages

Override Fallthrough Addresse:
2

Navigation 1/10Often, users need to navigate
to specific locations in a pro
gram. Ghidra provides several
different ways to do this:
Enter a particular address or
label (Go To)

Double-click on any displayed
label or address in the Code B
rowser tool

im directv Fa Fhe Navt/DrasUse the Navigation History to
return to a previously visited
location

Go To Address, Label, or Expre
ssion

To perform a Go To:
i
i“Jd

In the menu-bar of a tool, sel
ect Navigation

Go To...

The Go To dialog will be displ
ayed, as shown below:

Enter either an address, label
, or expression as specified b
elow and press "OK"ser will be repositioned to
that location and the dialog w
ill be dismissed

5. If the address, label, or e
xpression is not valid, the di
alog will display an error
message

Go To Address, Label, or ExpreGo To Address

Enter an address into the text
area of the dialog. The value
entered will be

assumed to be in hexadecimal.
That is, "0x1000" and "1000"
re the samee entered will be

assumed to be in hexadecimal
That is, "0x1000" and "1000"
re the same

value.

When the program has multipl.
address spaces and the destin
tion

address is ambiguous (based o
Pg 2 Ea I a Ee i aeWill be displayed.

Consider the following example
S:

Given:

A program with the following n
emory blocks which

reside in different address sp
aces:

NameEnd Address

BLOCK1 BLOCK1:00000000 BL
[ole[o]o}iii
BLOCK2 BLOCK2:00000000 BL
0000ffff
BLOCK3 BLOCK3:00000080 BL
[ole[o]e}iii
Example #1 - Unambiguous acBLOCK1:00001000
2. Goto address "5"
3. The destination is not ambi
guous:

The BLOCK block has an addr
s "5" so the
listing will move to address 5BLOCK3:00000080

2. Goto address "5"

3. The destination is ambiguou
s because:

The BLOCKS block does not ha:
an address "5"

Both the BLOCK1 and BLOCK2
cks have an

address "5"image below.

Navigation 2/10

Navigation 3/10
Ambiguous Destination Addres

Cha Tal akhallabel into the text area of th

e dialog.

Case Sensitive

By default, the values entered
are case sensitive. That is,
"LAB1000" is not the same as
1ab1000." If you want to find
both

of these labels, turn off the
case sensitive option. If moreLil SER db Bl ALL RL)
ayed in a Query Results dialog

Even if the case sensitive opt
ion is off, if a label has an
exact

match, no other labels will be
found.

Dynamic Labels

This option only affects querimultiple results, i.e when as
earch must be performed verst
El

lookup. This occurs when eithe
r the case sensitive is turned
off or

a wildcard is used. Specifical
ly, this option tells Ghidra,
whenynamic

symbols (symbols that are not
stored, but are generated on t
he fly

because of a reference to that
location.) If this option is

off, only

defined labels are searched.
Turning off this option can reNavigation 4/10

Go To Expression
Enter an arithmetic expression
that can include addresses, s
ymbols, or can be

relative to the current locati
I Tn CL LLSupported operator are "+ -*
/ << >>". Also, parentheses a
EREIVTe oJ Yg =I Re)

control order of expresion eva
luation.

For example:

ENTRY+10

0x100000+30
0x100000+(2*10)

+20Lib LER LE LL
dress 0x10 addresses past the
EULESS

Positions the cursor at addres
Ea lelo[ok]0n

Posiitons the cursor at addres
5 0x100020.

Positions the cursor at an add
ress that is 0x20 past the cur

rent location.RoBi anil
Py Query performs a case-insen:
itive search for all labels th

at match the criteria.

A Query is specified using wil
dcards.

Using Wildcards

Wildcard characters ("?" or "*
") can be used when searching
forI name

or don't want to type the enti
re name.

SCE EG)

You can use the asterisk as a
substitute for zero or more ch
aracters.

Ella

If you're looking for a labelthe following:

gloss*

The Go To Address or Label dia
log will locate all labels tha
[Te 11)

with "gloss" including Glossar
y.txt, Glossary.doc, and
Glossy.doc. To narrow the sear

ch to a specific extension, ty
Rogloss*.doc
Navigation 5/10

In this case, the Go To Addres
s or Label dialog will find al

I labels

that begin with gloss but have
the extension .doc. such asbe bbl LE PSL LEE To
Use the question mark as a suk
stitute for a single character
ina

name.

[Elle

If you typed gloss?.doc, the G
o To Address or Label dialog w
ould

locate the label Glossy.doc orExample 2

Suppose that two of the labels
in a program were FUN_00408
d

and FUN_004081bd. A possible
uery string to match these two
labels would be FUN_0040817«
The results of the query are
displayed in a Query Results dQuery Results Dialog

Repeating a Previous Go To
Each time a Go To Label ora Q
uery is performed, it is store
din the

drop-down box as shown in the
image below.image below.
Navigation 6/10

Previous Go to List

To repeat a previous Go To or
Query:

1. Select the item from the En
ter an address or label: drop-

I VIN ar ip)Error Messages

When a Go To or Query fails, a
n error message will be displa
yed in the status

area of the dialog.

1. Entering an invalid address
or non-existing label

The dialog displays "This is n
ot a auerv. label or address.&. JAI od MCL at els
no results

The dialog displays "No result
sfor..", where "..." is the
query

string.

Provided by: Go To Address or
Label pluginThe Next/Previous Code Unit f
eature allows the user to jump
directly to the next or Navig
ation 7/10

previous Instruction, Data, Un
defined, Function or Non Funct
ion. The search starts at the
current cursor location and prWhen searching for Instruction
s, Data or Undefined items, Gh
idra will skip all

contiguous items of the same t
ype. For example, if the curso
ris on an address with an
Instruction, and you go to the
next Instruction, then all In
structions immediately followid until a non-Instruction is f
ound. Once that non-instructio
LEE]

found, then Ghidra will take y
ou to the next Instruction aft
er the address of that
non-Instruction.

Search Direction

The

Fonraiy drive beona Sinn eaten mek consi HI)

direction, and the

icon indicates the search will
be performed in the
backward (previous) direction.
To change the direction of th
e code unit search,

toggle the arrow icon on the t
oolbar.

Navigate to InstructionLib aR in bbiid h LEt bl d]
gate by Instruction

icon, . This icon is disabled
when no more instructions exis
tin the current

search direction.

Navigate to Data

To move the cursor to the next
data code unit, click on the
Navigate by DataPE ALRGE
current search direction.
Navigate to Undefined

To move the cursor to the next
undefined code unit, click on
the Navigate by

Data icon, . This icon is disa
bled when no more undefined
de units existNavigate to Label

To move the cursor to the nex
t Label, click on the Navigate
by Label icon, .Navigation 8/
pL}

This icon is disabled when no
more labels exist in the curreThis ( ) action will move the
cursor to the next function in
the current

direction. If inside a functio

n and the direction is towards
lower addresses, then

this action will go to the cur
rent function's entry point.

Navigate to Non-Function
Thic tack { \ will attam nt Fnuction block not

contained in a function. This
can be useful when manually c
eating functions and

stepping over them to identify
potential function candidates

Navigate to Different Byte Val
ue
This task ( ) will attempt toLE LL RL LL
is different from the byte val
ue of the first byte of the cu
rrent code unit. This can

be useful when trying to navig
ate past a series of Os or FFs

Navigate to Bookmark
To move the cursor to the next
bookmark, click on the Naviga. This icon is disabled when n
0 more bookmarks exist in the
current

search direction. You may use
the pull-down menu to choose
specific type of

bookmark (,,,,,) to navi
gate to as opposed to all type
)Provided by: Go To Next-Previ
ous Code Unit plugin

Navigation 9/10

Next/Previous Function
Navigating to the next or prev
ious function is a commonly us
ed lS As such lSd for each direction.

Next Function

This action navigates the curs
or to the closest function ent
ry point that is at an

address greater than the curre
nt address. The default keybin
ding is

Control-DownArrowI'nis action navigates the curs
or to the closest function ent
ry point that is at an

address less than the current
address. The default keybindin
gis

Control-UpArrow.

Provided by: CodeBrowser plug
nLl bd ll LURE

As the user performs various t
ypes of navigations, the curre
nt location is pushed onto the
navigation history stack. The
navigation history feature all
ows the user to revisit previo
us

locations.
Go To Next/Previous Locationer the Go to previous location

(
) button or
1. In the tool-bar, click eit

her the Go to previous locatio
n () button orNavigation 10/10

2. The Code Browser will be re
positioned to the saved locati
on

Some Operations that add to tt
e navigation history:

Go To Address or Label
LI SCL] on operands [<d in the Code Browser)
Clicking on the start or end a
ddress of a memory block using
lu

memory map dialog

Clicking on the address of an
equate reference using the eq
ates table

Performing a search (Memory, |
raram Tavr: ate)Aus

button is only enabled after p
Ellin)

Clear History

To clear the navigation histor
y stack, select Navigation
After clearing the history, th
eFide UY. NCAR IVMs MIU
gin

Related Topics:

Query Results

Code Browser

Search Memory

Search Program Text

andbuttons are disabledGHIDRA Training 18
TOP SECRET//CYBER//NOFORNBelecting 1/4

Selecting

Selecting is the process of hi
ghlighting all or portions of

a program in order to performtion. Selecting can be done ma
nually in providers that suppo
rt selection, like

the Code Browser. Selecting ca
n be done based on subroutine
, functions, or by following c
ertain types of

control flows in the program.
Selections can be created man
allv within the Cade RrowearLypes ui
selections that are available
from the tool Select menu. Eac
h predefined type of selection
exposes different
characteristics of the program

To create a selection using on
e of the predefined methods:
clu) Lu [SLT ELE selectSelectionType.

The SelectionTypes and their d
escriptions are as follows:

[JECEHLE RE Ee aL REG LEE
Selection

Type

Program ChangesAll Flows
all

This follows all program flows
from the cursor location if n

o selection

or from the selected code unit
s if there is a selection. Sel
act All FloweRat LR lL LE a]
| the code

units that are traversed are s
elected.

All Flows
LL

LIEEEIE CET NTT TET Ril
to the cursor location if nothere is a selection. Select A

Il Flows To

will traverse all branches con
ditional and unconditional. Al

| the code

units that are traversed are s
elected.

In other words, this follows a

Il program flows backwards fro
m theLimited
Flows From

The types of program flows to
be followed in this case are b
ased on

options configured on the Sele
ction by Flow Options tab. Lim
ited

Flowe anlv fallowe the indicatRLS

cursor location if no selectio

n or from the selected code un
its if there is

a selection. All the code unit

s that are traversed are selec
ted.

Limited
Flows Tobe followed in this case are b
ased on

options configured on the Sele
ction by Flow Options tab. Lim
ited

Flows To only follows the indi
cated types of program flows t
o the

cursor location if no selectio

n or to the selected code unitthat are traversed are selecte
d.

In other words, this follows t
he types of program flows, as
indicated by

the options, backwards from th
e location or selection.

SUITE)Ea LLL LES IRA
subroutine that

SUITE)

Dead Subroutines

If there is no selection, this
EEE the code units of thecontains the current cursor lo
cation. If there is a selectio

n, this selects

all the subroutines that conta
in the selected code units.
Selects the code units of all
subroutines that not directly
referenced, also known

as "dead" code.If there is no selection, this
selects the code units of the
function that

contains the current cursor lo
cation. If there is a selectio
n, this selects

all the functions that contain
the selected code units.

All in ViewA LIA ALLL AT LE
isplayed in the browser view.

Clear
Selection
Complement

Clears the current selection i
n the browser view.
Changes the selection to everyselection.
pC]

Selects all the defined data i
n the current program if there
isn't a selection.

Otherwise, it selects the defi
ned data within the current se
lection.Selects all the instructions i

n the current program if there
isn't a selection.

Otherwise, it selects the inst
ructions within the current se
lection.

Undefined Data
Farward RefeSelects all the undefined data
in the current program if the
re isn't a selection.

Otherwise, it selects the unde
fined data within the current
selection.

Selects all addresses that the
current address is referring
JHSelections are meant to be ten
porary. For example, a left mo
use click outside a selection

in the Code

Browser will make the selectio
n go away. Also, creating a ne
w selection replaces any previ
ous selection

rather than adding to it. Toreit to a highlight.

At any time you can restore th
e previous selection for the ¢
urrent program by pressing the
Select Restore Selection.
Selection by Flow Tool Options
The Select By Flow plugin adds
options to the tool. To view

or edit the option settings:
From the tool's meni select Fdabl LAA A LI ARI A LS
tree node

The Selection by Flow tab cont
ains options for indicating th

e types of flows that will be
followed

when selecting Limited Flows.
LER CIE EAT CRG ERE
ction by Flow options and thei
J CEThe box to check it.
Flow Type to Follow

Default
HII Te 0 Ye RET
false

Follow computed jumpFollow computed jump
false
Follow conditional call

falselat)

[HITTITE

false

Follow unconditional call

false[tC
Selecting 3/4

Example: Given Follow conditic
nal jump and Follow unconditit
nal jump are the only types ch
CCR

As the program flow is followeection,
wherever the program jumps w
| also get added to the select
ion and the program flow is al
so followed

from there. If a conditional c
all is encountered, then this
instruction gets added to the
selection. But

the canditional call ie not foLEE LL Li
ince this type

isn't being followed. The code
for the subroutine at the cal
I's destination could still en
[CRT R

selection, if it is flowed to

by a different flow path using
the flow types being followedugin

Navigating Over a Selection

A selection will often consist
of one or more address ranges
. The address ranges do not ha
ve to be

contiguous. The navigation ma
gin can be used to directly mo
ve the location to a particulas selection range relative to
the current cursor location us
e the Next Selected

Range and Previous Selected R
[CR-V EN

Using the Navigation Margin
One or more green markers wil
appear in the Navigation Marg
in, where each green

marker caorreenonde to an addrLLL ALS LR L® IL RR ® LA
marker will cause the Code Brc
wser to navigate to the beginn
ing of the corresponding
address range.

Next Selected Range

To move the program's cursor |
ocation to the beginning of th
e next selected range of addreFrom the menu-bar of the Code
Browser, select Navigation

Next Selected Range
Selecting 4/4

OR
From the tool-bar of the CodePRI ladeTs)

When the Code Browser is on c
after the last address range

in the selection, the "Next Se
lected

Range" menu-bar and tool-bar
ptions will be disabled.

[I PI I LAT ere BF al}an LUA LAE AS SA PALA RAE IS BR)
e next selected range of addre
EHH

From the menu-bar of the Code
Browser, select Navigation

Previous Selected Range
OR

From the tool-bar of the Codebutton

)

When the Code Browser is on ¢
before the first address rang

e in the selection, the "Previ
ous

Selected Range" menu-bar anc
ool-bar options will be disablProvided by: Go To Next-Previo
us Selected Range Plugin
Related Topics:

Margin & Navigation Markers
Navigation

Highlighting

FECT VASLOpeU FOV Is Lhe POLETitial T
low through a function, removi
ng any flow that is not in

the selected scope. This is us
eful for determining how to re
ach a set of instructions.

Forward and Reverse Scoped F
Wg
Forward scoped flow is the Eithrough the Basic Block contai
ning the current address.
Reverse scoped flow is the set
of addresses that must pass t
hrough the Basic Block
containing the current address

To create forward or reverse s
coped selections, use one of t
he following twoId
[RE

From the menu bar choose Sel
Id

Provided by: Select By Scoped
[AISA DCI

Related Topics:

Selecting in Ghidra
HiahliahtinaSL0peU Fovw
Forward Scoped
Ieee Ale]

Reverse Scoped Flow

Highlighting 1/4A highlight is a more permaner
t variation of a selection. As
you may recall, a

selection can be cleared simpl
y by clicking in the Code Brow
ser. In order to clear a
highlight, you must explicitly
select the Select

ELLE

option.PE) a selection. For

example, you just used Search
Memory to search for all the o
ccurrences of a particular
Ascii string. From the Query R
esults window, you selected al
| of the results. Now you

wish to visit each code unit i

n the selection and perform so
me oheratione A celectionPELaUSE, IT yOU LHLREU ally WiC
re in the Code Browser,

the selection would be lost. C
onverting this selection to a
highlight enables you to visit
each code unit and click aroun
d in the browser, without losi
ng the highlight for the

search results.

To set a highlight from a seleode Browser

2. From the menu-bar of the Cc
de Browser, select Select
Highlight

Selection

OR

From the right mouse popup rr
u of the Code Browser, select
Highlight

[CEE Eee]1. From the menu-bar of the Cc
de Browser, select Select
Highlight

Clear

OR

From the right mouse popup rr
u of the Code Browser, select
PL a

ClearRe L0LS

1. From the menu-bar of the Cc
de Browser, select Select
Highlight

LCE Ela]

1. From the menu-bar of the C
ode Browser, select Select
ELHighlighting 2/4

OR

From the right mouse popup rr
u of the Code Browser, select
a

LCE Ele]

To subtract a selection from a
PEHighlight
Ele cle SEI EY]

OR

From the right mouse popup rr
u of the Code Browser, select
a

Ele cla SEI EY]

To create a selection from a h
iahliahtanil iT

2. From the menu-bar of the Cc
de Browser, select Select
Highlight

ll

OR
From the right mouse popup rr
u of the Code Browser, selectProvided By: Set Highlight Plu
gin

Navigating over a highlight

A highlight will usually consi
st of one or more address rang
es. The address ranges do

not have to be contiguous. Twc
methods exist to allow navigaUsing the Navigation Margin
One or more yellow markers wi
| appear in the Navigation Mar
gin,

where each yellow marker corr
sponds to an address range inc
[TCE]

in the hiahliaht Clicking onanid

Browser to navigate to the beg
inning of the corresponding ad
dress

[ETN

Using the Navigation Menu
From the menu-bar of the Code
Browser, select either
Navigation

CC] iLL] Range orFrom the tool-bar of the Code
Browser, select either the Go
ld

previous highlighted range ()
and Go to next highlighted
range ( ) buttons.

Clicking on the menu-bar or to
ol-bar options will cause the
Codedress
range.

When the Code Browser is on ¢
before the first address rang

e
in the highlight, the "Previou

s Highlight Range" menu-bar a
d

tanl-bar antione will be dicahARAL EE

is on or after the last addres

s range in the highlight, the
RE

Highlight Range" menu and to
bar options will be disabled.

Provided By: Next Prev Highlig
ht Range PluginRelated Topics:
FEET]

Code Browser
Navigation Margin
Query Results

Highlighting 4/4Searching

Ghidra offers a variety of sea
rching capabilities. The Searc
h Program Memory feature
performs fast searching for by
te patterns in program memory
The Search Program

Text feature searches for text
strings in various parts of t

he lietina stich ac commentsEERE AS A I IR BEE ® Ea
ure automatically finds
potential ascii strings within
the program memory.
Related Topics:

Search Memory

Search Program Text

Search For Strings

Search For Address Tables
Cle i Direct ReferencesGHIDRA Training 19
TOP SECRET//CYBER//NOFORNBearch Memory
Search Memory 1/8

Search Memory locates sequen
s of bytes in program memory.al numbers or
strings. The byte sequence ma
contain "wildcards" that will
match any byte (or possibly n
ibble). String searching also
allows for the use of

regular expression searches.
To Search Memory:

1. From the Tool, select Searc
hEEESLLSS EEL RL BLL
alue field

This will create a Hex Sequenc
e for searching.

3. Choose "Next" to find the n
Delete)

- or Choose "Previous" to find
LENT IV-R Tele Tg Ts Ie]

- or Choose "Search All" to fi
nd all occurrences.4

String

Decimal

Binary

Regular Expression

Search Options

SearchSearch Value

Search Memory 2/8

The value to search. The value
s entered will be interpreted

based on the Format options.

[ER IIa Ta]ELLER RAS A LRRD Sah A A
exact hex byte sequence that v
ill be searched for in memory.

Format

Hex:

Value is interpreted as a sequ
ence of hex numbers, separate
12) BEES Wildcard characterdigit (i.e. any 4 bit value).
Either the '." or '?' characte

r can be used for the wildcard
character.

Each hex number (separated b
spaces) will produce a sequenc
e of bytes that may be reverse
d depending on the Byte Order
The byte search pattern is for
med by concatenating the byte[SETI
Value:

"1234 567 89ab"
Little Endian Hex Sequence
34126705 ab 89

Ria Fndian Hex SedlienceELA CRASSA

Silo

Value is interpreted as the sp
ecified character encoding. Th
e center panel of the Search M
emory dialog shows

the Format Options, described
below.by the specified encoding. No
te that byte ordering determin
es if the high

Search Memory 3/8

order byte comes first or last

Case Sensitive - Turning off t
his option will search for the
string regardless of case usi
ng the specifiedEscape Sequences - Enabling t
is option allows escape sequen
ces in the search value (i.e.,
allows n to be

searched for).

Decimal:

Value is interpreted as a sequ
ence of decimal numbers, sepa
ated bv enacee The center nanRASLRLAAD ARS ERS BER AA LER RL at]
| Options, described below.

Only numbers that fit the spec
ified Decimal Options are allo
wed to be entered.

The byte search pattern is for
med by concatenating the byte
from each number.

Valid decimal Cll] EICHWord - any fixed point 16 bit
number (-32768 to 65535)
DWord - any fixed point 32 bit
number (you get the idea.....
)

QWord - any fixed point 64 bit
number

Float - any 32 bit floating po
int number

Double any 64 bit floating poiBinary:

Value is interpreted as a sequ
ence of binary numbers, separ:
ted by spaces. Wildcard charac
LIEN Iara Ta |

can be used to match any bit.

Search Memory 4/8wWihdCalu LhialatClelis (70. ) alc
allowed to be entered.

The byte search pattern is for
med by concatenating the byte
from each number.

An additional Mask byte which
is not shown, is generated for
each search byte to handle th
CRUICIET CENRegular Expression that is ma
tched against memory as if all
memory was a

string. Help on how to form re
gular expressions is available
on the Regular Expression Hel
p page.

Regular Expressions can only b
e used to search forward in meor regular expressions.

Memory Block Types
Search Memory 5/8
Selects which initialized memc

ry blocks are searched. Ghidra
Pe Ene er ae IE ea a etAUR
special memory blocks. These |
locks do not live in the progr
am's address space, but instea
d are stored in the "OTHER" ad
dress
space. Memory blocks which w
[CRC CIHR EERE IER TLL]
ng version of the program are
referred to as "Loaded Memoryly "loaded" memory blocks (me
ory blocks that would appear i
n an actual running instance
of the program) and not "Othe
" information memory blocks.
UNIS CRETE TL ET
emory blocks including "Other
blocks.

Selection Scoperch all memory in the tool.
Search Selection - If this opt
ion is selected, the search wi
II be restricted to the curren
t selection in the tool. This
option is only

enabled if there is a current
selection in the tool.

Code llnit SconeRl LL LC LL LIAL ne
ven address.

Instructions - includes instru
ction code units in the search

Defined Data - includes define
d data in the search.
Undefined Data - includes unde
fined data in the search.ti-byte values. Has no effect
on non-Unicode Ascii values, B
inary, or regular expressions.
Little Endian - places low-ord
er bytes first.

For example, the hex number *
234" will generate the bytes "
34", "12".

Big Endian - places high-order
bytes first.EP ARRCY AN
ILI Chid

Generally the alignment defaul
ts to 1, but can be set to any
number greater than 0. The se
arch results will be limited t

o those that

begin on the specified byte al
ignment. In other words, an al
ianment of 1 will aet all mateEEE

where each begins. An alignme
t of 2 will only return matchi
ng results that begin on a wor
d aligned address.

Searching

Next / Previous - Finds the ne
xt/previous occurrence of the
byte pattern from the currentthe Code Browser to move focu
there, you can choose Search
Repeat Memory Search to go tc
[GERI EVER EY]
found.

Search All - Finds all occurre
nces of the byte pattern in a
Query Results display.

For very large Programs that mtime. For these situations, a
progress bar is displayed, alo
ng with a Cancel button. Click
on the Cancel button to stop
the search.

Dismissing the search dialog
automatically cancels the sear
ch anerationtu LLL LL i

Highlight Search Option

You can specify that the bytes
found in the search be highli
ghted in the Code Browser by ¢
electing the Highlight Search
Results checkbox on the Searcl
Options panel. To view the Se
arch Options, ECs Editode in the Options tree in the
Options dialog. You can also
change the highlight color. CI
ick

on the color bar next to Highl
ight Color to bring up a color
chooser. Choose the new color
, click on the OK button. Appl

bs
your changes by clicking on thHighlights are displayed for t
he last search that you did. F
or example, if you bring up th
e Search

Program Text dialog and searcl
for text, that string now bec
omes the new highlight string.
Similarly, if you

invoke clirear text hiahliahtinPLLA

Highlights are dropped when y
u close the search dialog, or
close the query results window
for your most recent search.

Search for Matching Instructio
LS

LEE ISL RU ER VAL IER
lection of code. It uses the sern
that is then used to populate
the search field in the Memory
Search Dialog. This enables s
earching through memory for &
particular ordering of instruc
tions. There are three options
available:

Include Operands - All bits th
at make up the instruction andthe search pattern.
Exclude Operands - All bits th
at make up the instruction are
included in the search patter
n but the bits that make up
the operands will be masked of
f to enable wild carding for t
hose bits.

Include Operands (except cons
Fle A Ee Rs a NIT}nthe seafth patie and

all bits that make up the oper
ands, except constant operand
, which will be masked off to
enable wild carding for

those bits.

[SETTER

A user first selects the follo
wing lines of code. Then, from
La RCI menu they choose[IAT Tele elu lela

Option 1:

If the Include Operands action
is chosen then the search wil
| find all instances of the fo
llowing

instructions and operands.All of the bytes that make up
the selected code will be sear
ched for exactly, with no wild
carding.

The bit pattern 10000101 110¢
00001010110 01101010 000:
01011110 which equates to
the byte pattern 85 c0 56 6a 1
4 5e is searched for.

Ontion 2ELLE LR AS LAS LA
| find all instances of the fo
llowing
instructions only.

Only the parts of the byte pat
tern that make up the instruct
ions will be searched for with
lu)

remaining bits used as wildcar01011... is searched for where
the .'s indicate the wild car
ded values.

Option 3:

If the Include Operands (excep
t constants) option is chosen
then the search will find all
instances of the instruction a
nd all operands except the 0x1The bit pattern 10000101 110¢
00001010110 01101010 .......
01011110 which equates to tt
byte pattern 85 c0 56 6a xx 5e
is searched for where xx can
be any number N between 0x0
d

0xff.

The nrevinlie oneratione can onSYIon Ir Tnuitipie 1eyiofis arc
selected, the following

error dialog will be shown and
the operation will be cancell
ed.

Provided by: the MemSearchPI
inRelated Topics:
Searching Program Text
Query Results

Regular Expressions

Search Memory 8/8

Search Program Text 1/7The Search for Program Text fe
ature allows you to search for
textual strings within functi
ons, comments,

labels, instructions, and defi
ned data. You can search incre
mentally or get a list of all

of the search

results. You can search the en
tire nroaram or limit the ceaALLEL

Browser.

To bring up the Search Prograr
Text dialog, as shown below,
ECT LEY ely]

tool menu.

Program Text... from the

Sea [eal DTCDatabase Search and the Listi

Ji]
Display Search.

The Program Database Search

tion searches the program datz
base, not what you actually se
Can

the Code Browser. Conversely,
the Listing Display Search sea

rches exactly what you see indifferent results because the
listing includes derived and

the Code Browser. Conversely,
the Listing Display Search se

arches exactly what you see in
the Code

Browser. These searches yield
Peat a Er eee ISedith Frograltt 1€At 77
auto-generated information th:
tis not stored in the databas

e and the database can contair
information that is not curren
tly displayed, such as offcut
comments. The following table
summarizes the pros and cons
f using each search type:
Program Database SearchAdvantages

- Faster than the Listing
Display Search

- Can search information that
is not currently displayed.
For example, comments that
are offcut are not displayed,
but the database search can- Search Results reflect what
you see in the Code Browser
Listing window.

- Allows a search of all field

B

that are displayed in the
Code Browser, which
includes auto generated and
derived information that is
Pele ne re BR aa Ne Fl}MisaUvallitallto

- Search Results may not
match what the Listing
displays, since this search
looks at information that is
directly stored in the databas
e

and not the derived and
enhanced information that iso
specific fields and may not
cover all the fields shown in
the Code Browser listing
window.

- Assumes a specific search
order of the fields; you may
have rearranged the fields in
your Code Browser such that
they appear in a differentmovement for incremental
searches to appear "random
within the content for a
Ele] [IER

- Can be MUCH slower than

a database search. For
example, if you have a large
program with one comment,
the databace search can find astalilly, Whe Lhe Hating
display search will have to
render every address in the
program one at a time until it
finds a hit.

- Does not find information
that is currently not
displayable by the Listing
window. For example,

Slulu hls at offcut [LECELEnot find them.

By default, the Program Datab:
se Search Type type is selecte
d.

If you select the All Fields b
utton, the Listing Display Sea
rch Type button

automatically becomes selecteDatabase. The Selected Fields
option applies to either the P
rogram Database or the
Listing Display .

Incremental Search

Search Program Text 3/7AASLALASIELCS

1. Select the Search Program T
ext from the Code Browser tool
[CLs

2. In the Search for field, en
ter the string for which you w
ant to search, using wildcards
(*or?)

as needed. The * matches any |
haracter. The ? matches a singgular expressions.

If you need to search for one
of the wildcard characters, th
en escape the

character with a backslash. Fo
r example, to search for any o
ccurrence of an asterisk,

you would enter * as the sear
ch string.

Use the combo box next to theyou previously entered.
If you have selected text with
in a single field, then if you
invoke the dialog, it

will automatically load that t
ext into the Search for text b
ox for your convenience.

3. Select the options for wher
ein the Program to search.
Functione - cearch fuinction heHable Lypes, vallabic

names, and comments on varie
£5

Comments - search Plate, Pre-,
Post-, End of Line Comments,
and Repeatable; by

default this check box is sele
cted

Labels - search Labels
ECS) Mnemonics - ECCthe Operands of instructions
Defined Data Mnemoncis - sear
h Mnemonics of defined data
Defined Data Values - search V
alues of defined data

The Program Database Search
pe does not include componen
of

Structures or Unions. Use the
Listing Display Search Type fonions, they must be open in th
e Code Browser.

If you have made a selection a
nd it has been loaded into the
Search for text box

then the dialog will automatic
ally select the field that the
text was found in as your
choice of Field to search. You
have the antion to add more o1 you Wistl.

4. Select whether or not to se
arch "Other" memory blocks (k
ocks that not actually loaded
ina

running program); Loaded Bloc
s is selected by default which
means "Don’t search the
CLUE IIT CR

5. You =) EEE or deselectour
search to consider case.

6. If you make a selection in
the Code Browser, the Search ¢
election check box will be sel
[CeCe]

by default. If you do not want
the search to be restricted t

o the selection, then deselect
theus button to search forwards o
r backwards in the program, (o
r

from the Search for field, pre
ss the <Enter> key to search f
orward).

The start of the search operat
ion begins at your current loc
ation in the Code Browser.RRL I A Sa
tion begins at your current lo
cation in the Code Browser.

Search Program Text 4/7

8. If a match is found, the cu

rrent location in the Code Bro
wser is moved to the location
of theisplayed in the dialog.

9. If you mouse click in the C
ode Browser to move focus the
e, you can choose

Search Repeat Text Search to ¢
o to the next match found.

Search operations do not "wray
" once the you have reached th
e maximum address in memorox to search backwards from ye
ur

current location.

For very large Programs that m
ay take a while to search, you
can cancel your search at any
time. For these situations, an
indicator for "search in prog
ress" is displayed with a Canc
al buttonSLOP UIE SsEalclt
Dismissing the search dialog a
utomatically cancels the searc
h operation. For search all, p
artial

results are ignored if the sea
rch dialog was dismissed while
the search was still in progr
ess, therefore,
the "View Results

 

question diTo find all matches in the Pro
gram (or a selection in the pr
ogram),

1. Follow the Steps 1 through
6 for searching incrementally.
(Skip Step 4 as Direction is
irrelevant in this case.)

2. Click on the Search All but
[CIN

3. The Query Results display sSearch Program Text 5/7

When performing a "Search All
on large Programs, the result
s table will appear before the
search is completed. At the bo
ttom of this window, there wil
| be a cancel button that you
cal lca toTE May PE ITIUILIPIC STLHeEs
for the same address, dependit
g on what you search for. For
[SETI ICR
a string may appear multiple t
imes in the same pre-comment
so you will see as many entrie
ERLRGE
Query Results display. When yc
u click on a row in Rut QueryCode Browser is moved to that
location where the match was:
ound. So, if the match was fou
nd in

an operand, then the location
is moved to the matching strin
[RVI ROGERS CTR

The tool has an option for the
number of search results. The
search will stop after this nwn below warns you of the par
ial results. To see more searc

h results,

increase your search limit.

Highlight Search Option

Highlight Search OptionYou can specify that the strin

g found in the search be highl
ighted by selecting the Highli
ght Search

Results checkbox on the Searcl
Options panel. To view the Se
arch Options, select Edit Tool
Options... from the tool menu,
then select the Search node iYou can also change the highli
ght color. Click on the color
bar next to Highlight Color to
bring up a

color chooser. Choose the new
color, click on the OK button.
The option for Highlight Colo
[hile

Current Match indicates the co
lor used to highlight the matcin the Code Browser. Apply you
r changes by clicking on the O
K or Apply button on the Optio
Lh

dialog.

The highlight options also app
ly to searching memory.

Other notes of interest on hig
[lil] }elo 1-H

Hiahliahte are dienlaved for +AR RY SLAPS And

bring up the Search Memory di
log and search for bytes, that
EN RII EE

the new highlight string. Simi
larly, if you invoke cursor te

xt highlighting, that

becomes the new highlight stri
aR
Highlights are displayed onlyexample, you did not select La
bels to search but a label mat
ched the string you

searched for. Thus, the field
for that label will not be hig
hlighted.

Highlights are dropped when y
u close the search dialog, or
close the query

results window for your most rDefault Search Order for Progr
am Database Search

For the Program Database Seal
h option, as you incrementally
step, the order in which the
cursor is

positioned at the match in the
Listing fields is as follows:
Functions

Plate CommentsLala El

Instruction Mnemonic
Instruction Operands
Defined Data Mnemonics
Defined Data Values

End of Line Comments
Repeatable Comments
Post Comments

Within a [LEE the order iFunction Signature

Function Comments
Function Signature
Stack Variable Type
Stack Variable Name
Stack Variable Offset
Stack Variable CommentThe Query Results display will
show the search results in th
is default search order.

If your Listing fields are org
anized in a different order fr
om the search order (e.g., Pla
LS)

Comment is after the End of Li
ne Comment), then as you seal
h incrementally volir clireorAA LR A A LAE La
ere there are multiple matches
all at

the same address. In this case
, the cursor movement may loo
“random.” This is the case on
ails

Program Database Search; the
isting Display Search searches
in the order of the displayedProvided By: TextSearchPlugin
Related Topics:

Query Results

Search Limit tool option

Data

Listing Fields

Search MemorySearch for Strings 1/3

Search for Strings searches th
e entire program or a specific
selection for possible Ascii

or Unicode strings from the ma
in menu. The results will be d
isplayed in a table that can b
e

filtered and sorted and nrovid=.

String Search Dialog

To search for strings, select
Search

For Strings... This will bring

up the String Search Dialog w
here you can configure the sea
rch criteria before initiating
the search.Minimum Length - determines
e shortest length of possible
strings to display.

Alignment - indicates the sear
ch should only return results
that start at an address with
the indicated byte alignment.
Require Null Termination - if
checked, the string resulting
from the search must be null tarch may or may
not be null terminated.

Pascal Strings - if checked, o
nly strings that are valid pas
cal, pascal 255 or pascal unic
ode strings will be found.

Word Model - specifies the Str
ings Analyzer model file used
to detect high-confidence worc
PLE I LR iT le Bl Ra es IIe |ALE
'StringModel.sng'), the result
ing table will contain an "Is
Word" column and an option tc
filter by whether the string i

s a word or not.

This field can be left blank a
nd the word-related options wi
Il be omitted from the results
[LC]Base/data/stringngrams direct

a
Memory Block Types - Allows tt
e user to specify if only load

ed memory blocks should be s¢
rched for the strings, or all
(unloaded + loaded).
Selection Scope - Allows the u
ser to specify if the entire a
ddress space should be search:find all strings using the cur
rent search options.

String Search Results

The results are displayed in t
abular format. Strings can be
created by selecting one or mo
re rows from the resulting tab
le and pressing the "Make Stri
Pleo i lnne ale lllAl Ea LIEU A BR ASR
g(s) start can be specified to
change the starting location(
s) past the beginning of the s
tring. String(s) can be
automatically labeled.

Search for Strings 2/3ndicates the status of the str
IB

indicates a string that has al
ready been defined.

indicates a string that is not
defined.

indicates a string that has be
en partially defined at some octs with an instruction or som
e other data already defined a
t that address.

Location - The address of the
found string.

Label - If one exists, the lab
el at the location of the foun
d string.

Praview - If data or code alreA A IE LC FI LIE LS
ode or data exists, the undefi
ned byte at the location of th
e found string.

Ascii - What the string at the
LCT CRTC eT RUT RII Ql 11
e if it were created.

String Type - What type of str
ing has been found. Currently,
we support ascii strings, uniunicode strings.

Length - The number of charac
ers in the string.

Is Word - Whether the word mc
el has determined, with high c
onfidence, that the string is

a valid word or sequence of wo
rds. NOTE: this table field is
only available

if the String Search Dialog 'WString Filters

There are four toggle buttons
in the table window's title ba
r that are used to control whi
ch strings are included in the
table base on the strings "de
fined" state.ate LER LA A
toggles inclusion of
toggles inclusion of
toggles inclusion of

defined strings.

completely undefined strings.
partially defined strings.
strings that conflict with an
instruction or some other dataNOTE: this icon is only availa
ble if a String Search Dialog

‘Word Model’ field contains a
valid model file.

Make String Options

Make String - press this butto
n to create either a string of
the appropriate type (ascii o
r unicode) at the address(es)automatically label is checked
, a label will be placed at th

e beginning of the string(s).
Make Char Array - press this b
utton to create an array of ch
ars at the address(es) selecte
d in the results table - if th

e option to automatically labe
| is checked, a label

will be nlaced at the heainninMITSEL = allOWs LTTE User LU 5
ecify a different starting poi

nt for the string or ascii arr

ay. The automatic label will r
eflect the changes in address
and name. NOTE: This

option is ignored for pascal s
trings because changing the of
fset would result in making th
e string an invalid pascal strel will be created when the st
ring is created, that matches
the string

Include Alignment Nulls - if ¢
hecked, strings will be create
d including any alignment null
s after the string, up to the
alignment value.tring is created, that matches
the string

Include Alignment Nulls - if ¢
hecked, strings will be create
d including any alignment null
s after the string, up to the
alignment value.

Truncate if Needed - if checke
d, a truncated string will be
created if the <trina conflictA EL CL EL LS RE
[REET ION

Otherwise, 3/3

Search

for Strings

no string will be created if a
conflict exists.

The "Make Strings" panel can |
e hidden/shown using thetoggle button at the end of th
e text filter.

Refresh

This action will cause the tab
le to reload. The table attemp
ts to keep the table up to dat
e, but for efficiency reasons,
not all external program chanif those changes result in a
conflict or partially defined
string. A refresh will force t
he table to completely reload,

resulting in accurate results

Make Selection

See Make Selection.
Selection Navigation
Cae Salection NaviaationFIOVIUCU DY. olny habiceriugin
Related Topics:

Search Memory

Search Program Memory
Search Program Text
Searching

Search for ScalarsSearch for Scalars locates sca
lar operands and values in the
current program. The search i
s based on a value entered as
hex or decimal numbers. The s
alar

can be in instructions, data,

or structures.

To Search for Scalars:EN

ES

From the Tool, select Search
For Scalars...
Select "Scalars i
"Specific Scalar:".

Once the search type is select

ed, enter scalars into the val
Ri Ie Ra Heal eels: a

 

Range:" orNOOSE oRallll LO PEYIN LHE S
earch.

Once a value is entered ina t
ext field, Ctrl+M toggles the
value display between the deci
mal and hex representation of
the value in

that field.Search Type

Scalars in Range

Search the program for all sca
lars within the given range.
Specific Scalar

Search the program for all ins
tances of one scalar value.

Selection ScopeThe search will search all mem
ory in the program.

Search Selection

The search will be restricted
to the current selection in th

e tool. This option is only en
abled if there is a selection

in the tool.Search for Scalars 2/3

After the user begins a scalar
search, the plugin will displ
ay a results table to the user
. The table shows the address
of the scalar, a preview

of the item at that address, t
= scalar in Hex, and the BlEach element of the table is a
scalar found in either data o

r an instruction in the progra
m. Any new code units contain
ng scalars added to

the program will automatically
appear in the table.

To bring the Scalar Table, cho
ose Windowenu. hs table can be ie]
in the tool if desired.

The Scalar Table contains the
following default columns:
Location - displays the addres
s of the code unit containing
the scalar.

Preview - displays the code un
it containina the scalarnex nummer.

Decimal (Signed) - displays th
e scalar as a decimal number.
Function Name - displays the n
ame of the function containing
the scalar.

Decimal (Unsigned) - displays
the scalar as a decimal numbe
(this column is hidden by def
ault).The scalar table has the follo
wing filters at the bottom of
the table:

1. Text Filter - allows you to
filter based on any text in t
he table.

2. Range Filter - allows you t

o filter on a range of scalars
based upon their signed valuealues.
Actions

Make Selection

See Make Selection
Selection Navigation
See Selection Navigation
Remove ItemsREMOVE ILElTs
See Remove Items

Provided by: ScalarTablePlugin

Search for Scalars 3/3[ES {Teale WEY a dT T=]4

 

This dialog allows users to se
arch the current program for s
pecific instruction sequences.
Operands and mnemonics ma:
masked to allow maximum fle
bility in modifying the

search pattern.RL A LR A EL ELC
two main components: the Inst
uction Table and the Preview T
able. The former contains all
instructions selected by the u
ser; the latter displays

the string (in binary or hex)
that will be used for searchin

Instruction Tableselection is made in the code
listing and the

[(CLEEEEIEE SW RICI ER
the selection range will have
an entry in the table,

even non-instructions. Users m
ay click on an item in the tab
le to mask it from the final s
earch string.

Color-coding is used to indicaata items are tan.

Instruction Table Toolbar

Instruction Table Toolbar

Search Instruction Patterns 2/
4

Thece tonle nrovide wave to mzLLL LLL
elow:

[] Clears all masks.
Masks all data (non-instructio
LENMasks all address operands.
Reloads the table from what is
currently selected in the lis
[IIe N

Allows users to manually enter
bytes to be loaded.

Navigates in the listing to th

e location defined by this set
of instructions.The Preview Table shows what
he search string will look lik

e, in either binary or hex for
mat. It will change dynamicall
y as masks are applied/remove
in the Instruction

CLICS

When viewing the table in bina
ry mode, any masked bits willbyte has masked bits, the hex
value will not be shown; inste
ad, the binary value with the
masked bits will be displayed
inside

brackets. ie: [001..011]

Preview Table Toolbar

These tools provide ways to me1 Switches to binary display m
ode.
1 Switches to hex display mode

1 Coniec the nreview tahle conSearch Bounds

By default any search will be
run against the entire program
. If you only want to search a
particular range, that can be
done using the options below:

Selection Scope
IS the user to s| Se LLLBEET R (TRG INT CR Te [TN
If Search Selection is chosen

Selection Scope

Allows the user to specify wha
t region of the program will b
e searched. The default is to
search for the entire program.whatever region is currently s
elected in the listing will be
used as the search bounds.
Search Instruction Patterns
Search Direction

Indicates whether subsequent
nvocations of the Search butto
n will look forward or backwar
d in the listing for the searc
Sr —"Edin
Manual Entry

If the user clicks the

button, the manual entry dialo
g above will be displayed. Use
rs may enter either a binary o
r hex string here (full bytes,
no nibbles!) and if the strinructions for the loaded progra
m, then activating the Apply b
utton will cause them to be di
splayed in the Instruction Tab
le.

Search Results

If the user clicks the Search
All button, all search results
will be shown in a single win
dow, where each entry represewill take you to that spot in
the listing.

If the user clicks the Search
button, no results table will
appear but the cursor will imm
ediately move to the next matc
h in the listing. Whether the
cursor moves to the next or
previous match depends on the
Ceaarch Direction settingREA LA I EL A
arch will look for exact byte
pattern matches, not simply th
e mnemonic and/or operand te
. eg: If you load a program an
d select a RET

instruction, you can't expect
to use that same search patter
n to find a RET instruction in

a differentrepresentations will likely be
different.

Usage

The most basic usage of the se
arch dialog is as follows:

1. Select a range of instructi
ons in the code listing.

2. From the Tool, select Searc
hPE with J 15) Ia
ES

3. Select/deselect items in th
e table to mask the desired in
Baia .1

4. Click the Search All button
. A dialog will pop up showing
all occurrences of the patter
nin the program.UsEls Tay LOPY alll save LE Y
nerated search pattern by righ
t-clicking on the preview tabl
e and selecting one of the opt
ions; the text will be copied

to the

clipboard.

Constraintscapped at 500.

Only one range of addresses m
y be selected in the code brow
ser. MULTIPLE SELECTIONS ARE
OT ALLOWED.

Search Instruction Patterns 4/
4

Multiple Programsgram currently selected in the
listing. If you select a set

of instructions in Program A,
then switch over

to Program B and select the Se
arch button, Program B will be
searched for the selected ins
tructions.

Provided bv: InetriictionSearchSearch for Address Tables
Search for Address Tables 1/3

The Search for Address Tables
feature searches the program f
or possible address tables. Th
e search can span the entire psults are presented in list fo
rm, allowing the user to make
tables and disassemble the ad
resses in those tables.

Searching for Address Tables
To search for address tables,
1. Select the Search For Addre
ss Tables... option

2. Select the Search button; tSearch Options

Search Selection - limit the s
earch to the current selection
in the Listing. (The checkbox
is disabled if there is
EECA)

Minimum Length - determines
e shortest length of the possi
hile addrece tables to dienlavLL EL SR LR A LR AA)
ted byte boundary. For exampl.
, 2 indicates

alignment on a word boundary
Skip Length - the number of by
tes to skip between address m:
tches. This is useful when fin
ding addresses in

structures that are known to h
ave non-; -address byte ECCSforcancel

Address

PIE]

For very large Programs that m
ay take a while to search, you
can cancel the search at any
time by Search

[lial 1)

( TablesEY] as needed.

Search Results Table

PE EI FeI1I]5 [i EH

Location - location of the pos
sible address table

Label - primary label at the |
ocation of the possible table.
Data (Hex/Ascii) - Ascii and h
ex views of the bytes pointed
+a hv the firet element in theLehngtn = ie iehytn or ie pos
BEELER CIE

Making Address Tables

To make an address table,

1. Select one or more rows in

the Possible Address Tables ta
ble.

2. Select the Auto Label check
box to automatically create laPll

of the addresses contained in
those tables, and at the top o
f the indexes to the tables if
there are any.

3. If necessary, enter an offs
et (number of addresses to be
skipped) to be added to the st
arting address(es) (offset mul
tiplied byered offset cannot be greater
than one less than the length
of the possible table.

For multiple address tables, t
he offset value cannot be grea
ter than one less than the len
gth of the smallest selected
table.

The field next to Offset shows
the adilieted <tart address foa LL I LE ELL SS a
multiple table selections.
4. Select the Make Table butto

LR
5. An address table gets creat
ed at the location you chose,
containing defined addresses v
hich now point to to the addre
ss

CECIEth These addresses nowexists immediately after the t
able, it

will get created as an array o
f bytes, as well.

A warning dialog is displayed
if address tables could not be
created due to a collision wi

th existing data at either

the start of end of possible adetermine from [a label JE
ald]

those address tables that were
not created.

To disassemble the address tat
les,

1. Select one or more rows in
the Possible Address Tables ta
ble.

EEN ees RPI IIT 2 121 Ne: dAE AEA ASE EL REL
ddress tables.

Actions

Make Selection

See Make Selection.
Selection Navigation

See Selection Navigation.mblerPlugin

Related Topics:

Search Memory

Search Program Memory
Search Program Text
Searching

Search for Address Tables 3/3Search for Direct References

Search for Direct References w
ill search the entire program
for possible direct references
to the current location or to
locations within the

current selection in the progr
am Thie esearch attemnte to fiup tie auuress Of Lhe current
location/selection.

The search takes into account
the endianness of the processo
r. The results are displayed i

n a Query Results table. The f
ollowing table

shows the results of searching
for direct references to a lo
CEL (i.e. the program doesnresulting reference by selecti
ng it in the table.

The Search Results Table show
the following for a search on

a location:

From Location - address of the
possible direct reference
Label - primary label at the |
ocation of the possible direction of the code unit at the lo
cation of the possible direct
[CECE

To Location - address that is
being referred to directly

To Preview - current definitio
n of the code unit at the "ref
erred to" location

To search for possible direct
references to an addreceLous browser.

2. Select Search

for Direct References...

3. If the search will take a w
hile, an "in progress" dialog
pops up so that you can see th
e search progress, as well as
cancel the

search at any time.

4. A Query Results window is dIf you have a selection in you

r program when you perform tt
search, Search For Direct Ref
erences will search for
possible references to any of
the addresses in the selection

. This can be very useful for
finding references into an are
a of

memory that currently has no 1erences within the current pro
gram's memory space, press Ci
[ENCES GIN a)
program before performing the
search

If you use this search multipl

e times on different addresses
without closing the window, o
ne window will chow all the reTESUIL TOT all aUuUlcss 1s Ulspl
ayed when you click on the tab
at the bottom of the window.
This plugin works with 16-bit,
16-bit segmented, and 32-bit
programs.

Restoring the Search SelectionSearch for Direct References 2
23

If your search results came fr
om searching on a selection, y
ou can restore the program's s
election that was used for the
search. To do

this, click theore Search Results. This will
ES Rd TNT ete [Yo]

selection back to what it was

when you initially performed t
he search.

Filtering Results Based on Ali
gnment

Once you have search results y
PIE Rill Rea eer I Eee]LLL A A LP Ee LLL EPIL LS
lu)

menu button in the Search Res
Its button bar, pull right on
Alignment, and select the desi
red alignment (1, 2, 4, or 8).
LIER]

limit the displayed results to
those where the From Locatior
is an address that matches jlActions

Make Selection

See Make Selection.
Selection Navigation

See Selection Navigation.

Provided by: FindPossibleRefer
encesPlugin
Related Topics:Query Results Window 1/3

Query Results Window

The Query Results window dis
ays search results from variou
s sources (plugins). The
window is useful for navigatin
TT TrA A EA LAA A
peration that requires a selec
tion. The information
displayed in each column may
iffer depending on the search
operation that populated

the window. However, the winc
w's capabilities are the same.
The image below shows

the I] LK a search YouwTo for matching a wildcard ent
2

EI RCE RG ER CERES
iated with an address or locat
ion within the

program. There may be multip
entries for the same address,
depending on the

type of search. For example, wtimes in the same e pre- commer
So, you will see an entry for
each in the Query

Results window. The title bar
shows the number of entries be
ing displayed.

The tool has an option for the
maximum number of search re
Its. The searchLR LE I SARL A BR

e maximum number of search
PlSA GE]

search

Query

Results Window 2/3

will stop after this number ha
s been exceeded. To see more
earch results,

increase pals search limit.you may change the location c
ARERR GT]

the tool by clicking on the va
rious table cells. The locatio

n to which the cursor is

moved depends upon which ta
cell is clicked. For example,
clicking on the

location column will move the
cursor to the location where tabel in the label column will
move the cursor to the
corresponding label in the lis
ting panel.

Marker Margins

When searching strings or men
ry, a yellow arrow marker
Make Selection

A selection in the Listing can
he created from the entriec iEAL I LL i a BE
input to another operation tha
t uses the current

selection, e.g., a follow-on s
earch that is restricted to th

e results of the first

search using the current selec
<1,

To create a selection from all
the result items,2. Click on the

in the tool bar, or right mous
e click and

choose Make Selection.

3. The current selection will
be set to the address of each
result

item.

To create a selection from a s
ubset of the items,Shift+left-mouse.
2. Press and hold the right mo
use button over the results ta
ble.

Rel gL RTE

in the tool bar, or right mous
e click and

choose Make Selection.LLL SL BR EE LAL RA
e click and

choose Make Selection.
Query Results Window 3/3
4. The current selection will
be set to the address of all t
iC)

highlighted items.

Remove Itemsare only removed

from the table--no program dat
a is changed. This can be usef
ul when you wish to

exclude results that are of no
[IEE CRYCITR

Selection Navigation

This action causes the Listing
to navigate to the address re
presented by a rowu to use the up and
down arrow keys to change the
selection in the table while a
Iso navigating to that

address in the Listing. You ma
y also use this action to trig
ger navigation when
single-clicking a table row.

Renamina WindowsSEC UOULKITIY WINUWOWS = RElialh
Windows

Related Topics:

Tool Options

Text Search

Go ToPy =eBearching 1/1

[31]

Ghidra offers the ability to d
ownload and apply PDB debug
formation for Microsoft
programs. The Download PDB |
e feature allows users to down
load a PDB file thatLok th
ol Server. The Load
PDB File feature allows users
to apply a local PDB file to t

he current program. The

PDB Analyzer also automaticall
y applies PDB symbols (attemp
ing a search for

matching PDB files locally) du
ring Auto-Analysis.Load PDB File

Auto Analysis

PDB Parser Application
PDB Parser Application 1/2

GHIDRA includes a bundled aps. This application is

used to parse program debug i
formation provided in the form
of PDB files which are associ
ated with specific

executable programs and libra
ies. PDB files are produced du
ring the compilation and linki
ng process and may be

Br I PTI RTL on J rerePrerequisites

The native PDB parser applicat
ion has been built with Micros
oft Visual Studio 2017 using t
he 8.1 SDK to allow for
possible use under Windows 7,
8.x and 10. For this applicati
on to execute properly the folMe At ty tsa,
Microsoft Visual C++ Redistrib
utable for Visual Studio 2017
with its' prerequisite updates
REL

DIA SDK runtime support.

PDB File Processing
Execution of the native PDB pa
rser for a specified PDB fileI
GHIDRA during PDB Fr i
running under windows the ne
ive PDB parser may be invoked
directly if the

appropriate PDB file can be lo
cated locally, while on other
platforms only the XML file fo
rm produced by the PDB
parser is supported. Batch coneatePdbXmlFiles.bat script.

In the near future GHIDRA will
adopt a pure Java implementa
ion which will eliminate the M
icrosoft Windows native
execution issue and the use of
an intermediate XML format.

Microsoft Symbol Serverly stored PDB files during ana
lysis, the ability to
interactively download individ
ual PDB files from a web-based
Microsoft Symbol Server is al
so provided. This

capability is accessed via the
GUI while a program is open v
ia the File->Download PDB File

Ir D—DIA SDK Dependency

In order for the native PDB pa
rser to work on your Microsoft
Windows machine, you must:
1. Ensure you have msdial40.c
| on your computer, and

2. Register msdial40.dll in th
e Windows registry.

NOTES:

The following instructions ass¥ sysieill. ILYyUM ITVS MAIL.
pdb.exe with a newer

version of the DIA SDK you wil
| need to register the corresp
onding version of the 64-bit D
LL. The DIA SDK 14.0
corresponds to Visual Studio 2
017.

The PDB format is known to ch.
nge over time and may be inco= ha
within Ghidra. A Microsoft Vis
ual Studio project is provided
within the Ghidra/Features/PD
B/src/pdb directory

which will allow you to rebuil
d it with a newer version of V
isual Studio and DIA SDK.PDB Parser Application 2/2

First, check to see if you alr
eady have the msdial40.dll lib
rary installed on your system.
It is generally installed
installed with Microsoft Visua
x Studio 2017 when C/C++ [LISoft Visual Studio2017DIA SDK
binamd64msdial40.dll

This file is commonly located
here, although it may be insta
lled in other locations as wel
|. Any 64-bit copy may be
registered provided it is the
correct version. There is no n

eed to register more than one.
Ramictar 'rmedia1A0 All" in FheFlease register 64-bit msdial4a
0.dll even if you already had

a copy of it on your computer
since it is not registered by
the Visual Studio installation
process. You will need admini
strative rights/privileges in
order to register the DLL in
the Windows registry.

1. Start a command prompt ashcl Kiel Rd BLL LLL
r CMD in the search box to loc
ate CMD program.

Right-click on CMD program an
then click Run as administrat
18

If the User Account Control di
alog box appears, confirm that
the action it displays is wha
tyouad
ran Admin password to elevat:
permissions.

2. At the prompt within the di
splayed CMD window, navigate
o the parent folder that conta
ins the 64-bit

version of msdial40.dll or spe
cify the full path of the DLL

to regsvr32 command below.regsvr32 msdial40.dll

When the registration has com
leted you should see a popup t
hat indicates that "DIIRegiste
rServer in msdial40.dll
ELEY RN

Download PDB FileGhidra offers the ability to d
ownload and apply a PDB file t
hat corresponds to the progran
currently open in the CodeBro
wser. Successful downloading |
equires,

ata minimum, that:

1. A Symbol Server URL is avai

LR I LW myre running Ghiara.

2. The program open in the Coc
eBrowser is a PE file that was
compiled by a Microsoft compi
ler.

A Note for Windows Users

If set, Ghidra parses the _NT_
SYMBOL_PATH environment va
le that is used to specify a PLR bi Ebb To ARLE lL

for _NT_SYMBOL_PATH is show
elow:

srv¥[local symbols location]*[
Symbol Server URL]

The _NT_SYMBOL_PATH symbo
cation is used to pre-populate
the dialog that asks for the
local storage location (as lon

g as that location is valid).hi
EEE pre- TI th
e dialog that asks for the Sym

bol Server location.

Although multiple Symbol Sen
r URLs can be specified in the
_NT_SYMBOL_PATH variable, C
dra only uses the first listed

URL.1. From the menu-bar of a tool
, select File

Download PDB File

2. A dialog appears asking whe
ther you want to download a .P
DB or .PDB.XML file. Select th
e type of file you want to dowA Symbol Server should always
have PDB files available for d
ownload. In contrast, .PDB.XML
files are Ghidra-created file

s, and are only

available to download from the
Symbol Server if Ghidra tools
have been used to create then
and the server's admin has me
i ——— ILE eT.Tile and It is not found on th

e server, you will see a dialo

g message telling you so. For
more information on

creating and using .PDB.XML fi
les, see the Load PDB File sec
<1,

3. A dialog appears asking whe
re to save the downloaded file
Pick a location to store vouLabs tell Lo Bl ghd SALLY
4. At this point, if a PDB fil

e of the type you have chosen
(either .PDB or .PDB.XML) alre
ady exists in the selected loc
ation, you will see a message
indicating that a potential ma
tching PDB has been found. Yo
will then be asked if you wou
Id like to continue with the dRad A a

 

Bik
CWA
If you select "Yes", please ke
ep the following things in min
d relating to a found .PDB or
fanl- P1110

If the found file is not in a
directory that contains the cu
rrent binary's GUID (i.e, C:
Symbols<pdbfilename><GUILn exact match for the current
binary (when there is no GUID
subfolder, a matching file is
found based on

expected PDB filename).

If there is any doubt about wh
ether the found PDB file match
es, itis a good idea to try t

[3] SRCULIEEE] the matching file,a directory of the form <down
load location>/<pdbfilename>
<GUID>).

If you do choose to continue t
o apply the found PDB file, an
d its GUID does not match the
GUID of the current binary, yo
u will be

warned and given the option of
Pre] Ar eho TET5. Next, you will see a dialog
asking for the Symbol Server
URL.

5. Next, you will see a dialo
g asking for the Symbol Server
URL.If a list of known URLs exists

in your distribution (the fil

e will have the extension .pdb
url), the dialog will also inc
lude a button with the text
"Choose from known URLs". WI
this button is pressed, a sep
arate dialog appears showing k
nown Symbol Server URLs.Sinai s ida EL

Ls or manually type one in. If
manually typing in a URL, be
sure to include the protocol (
[gad TR Nae)

Always be sure to check your o
rganization's security policy
before downloading any file fr
om the internet.

6. Next, if the Symbol Serverchose earlier, it will return
with a message indicating that
lu)

download was successful. The
essage also contains the path
where you can find the downlo
ded file.

7. If the download was successher you want to apply the PDB
to the program.

You will not be asked if you w
ant to apply the found file if
the file is of type .PDB and
you are not on a Windows syste
m. This is because

.PDB files can only be parsed

when running on Windows, wh
PAR YMI filac ram ha marcaTroubleshooting

If you are connecting to a Sym
bol Server that requires user
authentication using PKI, you
must first set your PKI Certif
icate before attempting to
download from the server. See
PKI Certificate for more detai
Is.download from the server. See
PKI Certificate for more deta
[1

Download PDB File 3/3
Related Topics:
Load PDB[HELICES

The Program Tree shows a prog
am organized into folders and
fragments. Fragments

contain code units (instructio
ns, defined data, or undefined
data). Code Units can

reside in one and only one fra
gment. A folder is a containeranalogous to a folder in a "fi

le system." Any folder,

except for the root folder, an

d any fragment can have multi
le parents. When you

copy a folder or fragment to a
nother parent folder, you are
not creating a new instance

of the folder or fragment, butthe copied folder or fragment.
This means that if you make a
change to Folder "A"

(e.g., create a new fragment o
r folder), the change is refle
cted where ever Folder "A"
appears in the tree, regardles
s of the parent. Moving code u
nits from one fragment to
annthar dase nat affart Fhe 111fou can manipulate the tree or
ganization by cutting, copying
, and pasting folders and
fragments to other folders. Yo
u can also use drag and drop t
o reorder the contents of a
folder. You can apply algorith
ms to produce organizations b:
sed on a Block Model.

The followina paraaraphs descFolders and Fragments

Create Folders and Fragments
To create a new folder,

1. Select a folder in the Prog
ram Tree.

2. Right mouse-click, choose t
he Create Folder option.Folder." (A one-up number is a
ppended to "New Folder" if
that name already exists.) The
cell editor for the tree is
displayed immediately so that
you can change the name of th
folder you just created. Names
are unique across all foldersram Tree,
2. Right mouse-click, choose t
he Create Fragment option.

1. Select a folder in the Pro
gram Tree,

2. Right mouse-click, choose t
he Create Fragment option.ated with the default name of
New Fragment. (A one-up num
is appended to the "New
Fragment" name if that name :
ready exists.) The cell editor
for the tree is displayed imme
diately so that you can change
the name of the fragment you |
ust created. Names are unique
PR SAATLer you are done editing the
name, the icon for

the fragment indicates that it

is empty (

JAR (TINT

drag code units from the Code
Browser and drop them

onto the empty node. The icon
changes to indicate that

the fraament is not empty.Lut RL Sd]
1. Drag code units from the Co
de Browser.

2. Drop them onto a folder.

The default name of the fragm
nt is the name of

the first address in the set o

f code units that you

dragged. This operation actualde uni the set that you
are dragging has a label, then
the name of the fragment
defaults to this label name.

   

Delete Folders and Fragments
You can delete a folder or fra
gment if (1) it is empty, or (
2) if it exists[SJL RIN)
disabled if this criteria is n
ot met.)

To delete a folder or fragment

1. Select a folder or fragment
JCI
2. Right mouse-click, and choo2. Right mouse-click, and cho
ose the Delete option.
Program Tree 3/12

You can delete multiple folder
s and fragments; the option wi
Il be enabled

if at least one folder or frag
JOR ESR IT TL Lhget an error message for the o
ther ones in the selection tha
[Teo aT)

deleted.

Rename Folders and Fragment
To rename a folder or fragmen!

1. Select the folder or fragme
IlaLe tL Bb SCL Rg LE
3. The cell editor for the tre
eis displayed. Enter a new na
me.

Duplicate folder or fragment n
ames are not allowed, regardle
ss

of where they are in the hiera
rchy. If you enter a name thatiat bl
ESE the name reverts [yey
leis

original name. Hit the <Esc> k
ey to cancel editing at any ti
me.

Expand/Collapse Folders

You can recursively expand a f
older. Select a folder that ha

s subfolders;LC)

descendant folders are expand
d.

Similarly, you can recursively
collapse a folder. Select a f
older that has

subfolders; right mouse-click
and choose the Collapse All op
tion Whenfolders are
collapsed.

Merge a Folder with its Parent
ele

You can "flatten" a folder suc
h that all of its immediate ch

ildren are

moved to the folder's parent.
Err dvairnrsla lanndidar tAlrmr Acontains tolder b; Tolder b co
ntains five fragments and anot
LCi

folder, C. You can select fold
er B, right mouse-click, and c
hoose the

Merge with Parent option. This
operation results in the five
fragments and folder C in fold
er B get moved to folder A. FoMerge with Parent option. Thi
s operation results in the fiv

e

fragments and folder C in fold
er B get moved to folder A. Fo
Ider BProgram Tree 4/12

is removed.

You can make a multiple selecnot contain at least one folde
r, the Merge with Parent optio
LEE]

disabled.

Move Code Units to a Fragmen
To move code units to an exist
ing fragment,

1. Make a selection in the Cod
e Browser.and
drop it.
The code units are moved from
the source fragment to the
destination Fragment.

Drag and drop the selection on
a folder to create a new

fragment.
Tool Tips on a Fragmentprise

this fragment. The tool tip is
displayed when you let the mc
use

pointer hover over a fragment
node in the Program Tree.

Sort by Address or Name

You can sort the descendants c
f a folder by address order or
Wy0 sort by address,
1. Select a folder in the Prog
ram Tree.
2. Right mouse click and choos
e the Sort

by Address option.

All descendants of the folder
are rearranaed such thatAll descendants of the folder
are rearranged such that
they appear in address order i
n the tree. This is a

recursive operation.

Program Tree 5/12

To sort by name,2. Right mouse click and choos
e the Sort

by Name option.

All descendants of the folder
are rearranged such that
they appear in alphabetical or
der. This is a recursiveProvided By: ModuleSortPlugin
Auto Rename on a Fragment
From the Program Tree, you ca
automatically rename a fragm
alee)

the label at the minimum addr
ss of the fragment. Also, you
can

rename a fragment to Lod labemenu in the code browser.

To automatically rename a frac
ment,

1. Select a fragment (or fragm

CII RGR GER Te [CT NTN

2. Right mouse click and choos
e Auto Rename.

To automatically rename a frac
ment to any label in the fragm
ant1. Position the cursor over a
label field.

2. Right mouse click and choos
e Rename Fragment to Label.

Provided By: AutoRenamePlugi

Program Tree 6/12Lr ieigimient
To select all the addresses in

a folder or fragment,

1. Select a fragment or module
in the Program Tree.

2. Right mouse click and choos
e the Select Addresses option.
All addresses contained within
the selected folders,
fragments are shown in the CoThis option is available for a
multiple selection of fragmen
1S

and/or folders.

Provided By: ProgramTreeSelec
ionPlugin

Control the View in the Code Bs controlled by the following:
ELE STAI ET Tn Eh RR]
Code Browser

You control what you see in th
e right side of the Code Brows
er tool

by adding folders and fragmen
s to your view.

Select a fragment EE 5 LHe the Go To in View

),

1. Right mouse-click and choo
se the Go To in View Program T
ree 7/12

option.

9 Tha frre (nite im Fhic framLode Browser. Ihe fragments

con in the Program

Tree changes to

to indicate that it is part of

lu)

view. The cursor in the Code B

rowser is moved to

the minimum address of the fr
gment or folder.

Select an open folder that is),

1. Right mouse-click and choos
e the Go To in View

option.

2. All of the descendant folde
[SELECT [Eh SE TERT ET]

to the view.

The folder's icon in the ProgrIf the folder is closed and is
in the view, then the
icon is

If a closed folder not in the
view has descendants

that are in the view, the icon
isiew, the cursor in the browser
moves to the first code unit i

n the first fragment of the fo
Ider.

When you add a fragment to tt
EAGER ANTE Ry}
browser moves to the first cod
e unit in this fragment.

You can add multiple EES aagments that you want, and
choosing the Show in View opt
[LR

The Go To in View option is al
ways enabled regardless of
whether the folder or fragment
is in the view or not.

Remove Folders/Fragments fro
Fhe via im Fhe Cade RrmearSs from the view In the code br
owser,

1. Select a folder or fragment
that is in the view.

2. Right mouse-click, and choo
se the Remove from View optic

The icon for the folder or fra
gment updates to indicate that
Hshee bd UE Ll LE LLL CE EL SLL

ALERICHR {CEG ICSI ig
agment updates to indicate th:
tit

is no longer in the view. The
code browser updates its Progr
am

view Tree 8/12s and fragments by selecting t
hose folders

and fragments that are markec
as being in the view, and choo
EIR)

Remove from View option.

 

Replace the View in the Code E
rowser with other Folders/Frage browser with other folders a
ICRC Toth

1. Select a folder or fragment
(or select multiple folders a
nd

fragments),

2. Right mouse-click and choos
e the Replace View option. The
codeChih

The program tree can be confi
ured, via tool options, such t
hat

a double-click performs a simp
le navigation, or the Replace
aE

action. The default behavior f
PIE LI alll YLT HL TmReplace View action.
(Double-clicking on a folder a
lways causes it to expand if i
[a5

collapsed and to collapse if i
t is expanded.)

Navigation

You can navigate to the first
address of the code unitin a
fraamenthd iid
If the fragment or folder is a
Iready in the view, the code
browser navigates to the first
code unit in the fragment.

If the fragment or folder is n

ot in the view, it is added to
lu)

view; then the code browser ne
vigates to the first code unitProgram Tree 9/12

Cut/Copy/Paste and Drag and [
Ll

Cut and Paste
You can move fragments and fpasting.

1. Select a folder.

2. Right mouse-click, and choo
se the Cut option.

The icon for the folder change
s to indicate the cut
operation. Choose another fold
er that does not already
Sul this folder, right mou(and all of its

descendants) should now show
p in the destination

folder. You can select multipl

e folders and fragments

for cutting and pasting.

You can merge fragments by ci
ting and pasting.

1. Select a fragment (or multi
a nyse the Cut option.

3. The icon for the fragment c
hanges to indicate the cut
operation; choose another frag
ment.

4. Right mouse-click and choos
e the Paste option.

The code units from the "cut"
fragments are moved to

the destination fraament. Thetbo Lobb cb LLL LEI Ch LAL
If you paste a folder or fragm
ent not in the view to a folde
rthatisin

the view, then the view in the
code browser will be updated
fea

the code units for the folder

or fragment that was pasted at
theCopy and Paste
Program Tree 10/12

You can copy fragments and fo
ders to other folders by copyi
ng and

pasting.se the Copy option.

3. Choose another folder that
does not already contain this
folder,

4. Right mouse-click, and choo
se the Paste option.

The copied fragment or folder
should now show up in the
destination folder."Cut" and "Paste" by using Dr
ag and

Drop.

Drag a folder or fragment or t
o another folder and drop it.
The

folder or fragment is moved to
this folder. If the fragment

or folder

a lrmn Ag viele mim FAINGr thDrag and Drop (Copy)

You can get the same effect of
"Copy" and "Paste" by holding
down

the Ctrl key while dragging. (
If you release the Ctrl key, t

he drag

operation becomes a Move.)
Draa/Cobpyv a folder or fraamentLiTetiiyles.
to indicate the copy operation

. Drop the folder or fragment;

a copy

is made and placed in the dest
ination folder.

As stated earlier, you can dra

g code units from the Code Bro
NESS

view and drop them onto a folcan existing fragment (moves tt
e code units to this fragment)

 

If you try to drag/copy a fold
er or fragment to a folder tha
t already

If you try to drag/copy a folcontains the folder or fragmen
t, you will not get a valid dr

op target.

Reorder Folder Contents using
Drag and Drop

Using Drag and Drop, you can |
eorder the elements within a f
older. As

you drag between nodes in theindicate that a reordering ope
ration is possible; you will s

ee a solid bar

between the nodes (

). When you release the mouse
the dragged

folder or fragment will be rep
ositioned at this location, i.

e., between the

LL EE IIT you are dragging to a dirre
rent parent, in addition to th

e reorder, the

drop operation will also cause
the dragged fragment or folde
r to be moved

to the parent of the destinati
on drop site. To make a copy o
ARUN (CET)

fraament hold down the Ctrl kLi bb ll LiL
change to

depending on where the curso
is. If you release the

mouse when the cursor indicat
s a potential reorder operatio
n, the dragged

folder or fragment is copied t

o the parent of the destinatio

n drop site, andY Llead

ES that
if the dragged folder or fragm
ent already exists in the pare
nt, then you
will not get a valid drop targ
et for reordering purposes.)

 

Menu Enablement
If you select multiple nodes iin the popup menu (right mou:
click) may not be enabled if
lu)

multi-selection is not valid.

A valid multi-selection meets
lu)

following criteria:

If a folder is selected, then
either all of its immediatedescendants is selected.

The root folder is not part of
the selection.

A valid multi-selection will c
ause the Copy, Cut, Delete, an
d view

options to be enabled.

The Delete option may be enat
ed for a multi-selection, howe
var iflowed on a particular folaer o
r

The Delete option may be enat
led for a multi-selection, how
ever, if

the delete operation is not al
lowed on a particular folder o

aLib “Arbab i LL JR LELLE “Lt bs
ication of why the delete fail
ed.

Provided By: Program Tree Plug
in

Related Topics:

View Manager

Program Organizations

Code BrowserProgram Trees are used to orgz
nize programs into a tree stru
cture. Nodes within the a prog
ram tree can be used to naviga
te to the corresponding addres
s in the Code

Browser. Also, the program tre
e can be used to restrict theer. The Program Tree Manager
llows you to create
, delete, rename, and close pr
ogram tree views.

The following paragraphs desc
ibe features of the Program Tr

ee Manager.

Create a Default Program Treerogram; the fragments are nan
d the same as the memory bloc
s.

When you bring up a Code Bro
er, the Program Tree Manager |
the tabbed pane on the left si
de of the Code Browser) shows
a default view with no program
open.

er NE TL€ a tab Tor each tree view tha
tis in the program. When you
re-open the project, the Progr
am Tree

Manager will show the view fro
m when you last closed the prc
JC

You can create a new default p
rogram tree by selecting the
icon. A new tab is displaved w=, FOIE free, © IT « WeW
named

"Program Tree" exists, then th
e name has a one-up number &
ended to it to ensure the name
is unique, e.g., "Program Tre
e(1)."

Provided by: ProgramTreePlugiProgram Trees in the Program
by selecting the

icon. Select the program tree
name from the popup menu; a
b is created in the panel

for this tree, if one does not
already exist. The selected t
ree becomes the current tree i
n the tabbed pane.Provided by: ProgramTreePlugi
il

View Manager 2/2

Select Fragments Correspondir
to a Program Location

The icon

is a toggle button that contro
Is whether the fragment(s) Bielected in the Program Tree. O
il

means to select the fragment(:
) that contain the address of
the location. While the button
is On, the Program Tree will
track the location in the brow
ser by selecting

the appropriate fragments. The
Laramie USE ny FibsiileFrovidea by: FrogramireerFiugi
[SENT ET NET)

To close a program tree, right
-mouse click on the tab of tha
t program tree and choose the
"Close" option. Closing a prog
ram tree does not affect the P
[CFICTnN

Re-open the program tree by se
lectina it from the list of vihilton Shel lu BULL RL hs
ram tree..

Rename a Program Tree

To rename a program tree,

1. Right-mouse click on the ta
b of the program tree.

2. Choose the "Rename" optior
3. A text field is created ove

r the tab; the value defaults

to the current view name and iis name, a message is displaye
d in the status area of the to
ol. The list of existing views
will show the new name.

If you move focus out of the e
dit window, the edit window is
removed, and no change is me
e to the name.button to undo the rename.

Delete a Program Tree

To delete a program tree,

1. Right-mouse click on the ta
b of the program tree.

2. Choose the "Delete" option.

You cannot delete Lu) last prolete your other tree.
Click the

button to undo the Delete.

Change to Other Program Tree
To switch to another tree view
, either click on another tab,
OR select a program tree nam
TAI TA AE I A.Provided By: View Manager Plu
in

Related Topics:

Program Tree

Program Organizations

Code Browser

Validate Proaram 1/3Lda bi BEL Lh]
Post-Analysis Problem Detectio
il

After running Auto Analysis, t
here may be problems with yol
program due to aggressive
analyzers or strange executabl
e patterns (functions that do
not return, calling stack cana
ryfot a ail dl

ntial problem areas after
analysis has run.

Program Validator

You can launch the Validate Pr
ogram window by using the An
YEH

Program} menu item.This command option will oper
the Validate Program window
oviding a list of program
validators to run.

Validate Program 2/3

“Validate Program" alle]y (they are all on by default)

Once you press the Run Validaf
ors button, each selected vali
dator will run in the order
presented in the window. As th
ey run, each will display its
progress and then an icon whic
h

TT TE Ir TeSplayed using a normal Ghidra
task

monitor and each validator can
be aborted individually by pr
essing its stop

button.

At completion, each validator
will be followed by an icon sh
owing its results: a green

[elal=1el 4AWellHIY =, MI & tl st
(errors). By selecting each
completed validator, you can s
ee the warnings or errors enco
untered in the text area below
the validator list. For exampl
e, this test program had one w
arning:Results after running validato
5

Related Topics

Auto Analysis

Relocation Table 1/2

Relocation Tableion defined in the

program. Relocations are addre
ss locations that need to be u
pdated to reflect where the
program is loaded into memorn
The relocation information is
specific to the original

format of the program and it i
H REESE] by the Automatic |Relocation Table

Displaying the Relocation Tabl
e

From the window menu of a to
, select Relocation Table

Relocation
The dialog displays a table of

an Srl U AE Pry. ra rere Firs [TEsIn the table are:
Address

address where the
relocation is defined

Type

type of relocation to
performType

No EI [TeE Yu [Ty le)
perform

Values

the values to use when
performing relocationthe original bytes to
use when performing
relocation

Provided by: Relocation Table
plugin

Relocation Table 2/2Ghidra Script Manager

Ghidra Script Manager 1/4

The Ghidra Script Manager allo
ws for rapid development of ex
tended Ghidra functionality. U
nlike conventional Ghidra plug
LH RUE require a el IDE foof Ghidra while it is

running. You can interactively
change your script and immed
ately re-run it.

See Ghidra Script Developmen
for details on how to write a
Elda]

Script Category Tree

vas ary ink eves teases ving eases ri)IT you click on a node or the
tree it will only display scri

pts in the table that are in t
hat category or any sub-catego
ries. Each script defines its
own category,

which is arbitrary and optiona
I. Scripts without explicitly
defined categories will appear
in the root "Scripts" cateaor<LI IYL [SV
The script table displays info
rmation about the scripts.

The first columnn indicates if
an action should be created f
or the script. If a script has

a menu path or default key bi
nding, then selecting this col
umn will cause an action to be
created with that menu path afor a script that has no menu
path or key binding set will
have no effect until the scrip

t is modified to have a menu p
ath or key binding. Deselectin
g this column will also remove
any

key bindings that were defined
via the script manager gui.nk field is a happy field. If
the column contains

, then that script contains an
CT8

The Filename column indicates
the filename of the script.
The Description column indicatCE]

The Key Binding column indica
EEROGE CAC IL [EEE EYL)
to that script. If the field i

s blank, then a key binding ha
s not been assigned to the scr
ipt. Setting a key binding wil

| cause an action to get creat
ed and

Tak aErram. Fas Fi vat relive wilLal

The Search Filter allows you t
o narrow the list of scripts d
isplayed in the table. Only th
ose scripts, whose name or des
cription contains the string t
hat you enter as the filter, w

ill be displayed. As you type,
the table is

updated to reflect the filter.LE he tL Ll ERR LL LL Ld LEE 2
ou to view meta data about the
selected script in the Script
Table, including such things
as author, description, key bi
nding, etc.

Script Manager Actions

Run ScriptRE

 

f date, then it will first be
compiled. If the compilation i
s successful, then the script
will be run. If the script doe

s not compile, the compilation
errors will be

displayed in the Console and a
LEE gTe)

will be displayed in the firstRun Last Script

Runs the last run script. This
action is available as a keyb
inding from within anywhere ir
the tool, whether or not the
Script Manager is showing. To
ECR GER ERI CIN Riel
this action, hover over its iEdit Script

Edit Script

Edits the selected script. For
more information on script me
ta data, see Ghidra Script Dev
elopment

Chidra Crrint Mananar 2 IARefresh

Will load the contents of the
current script from the file o
n the filesystem. This action
is useful if you have edited t
he script outside of Ghidra an
d would like to have the edito
r update to show those
changes.

SaveLt SL LE LE RL
option is only enabled when c
hanges have been made.
Save As...

Saves the script (with any cha
nges) to a new script file. Th

e default directory is your ho
me directory, however if addit
ional script directories exist

, then you will be prompted too La a
tive script in the editor. Whe
n selecting Save As..., Ghidra
will prompt for a filename.

Undo

Undo reverts the editor to the
state prior to the last edit.
You can undo up to 50 edits.
REGIE)Select Font

Changes the font for all open
editors. It will also set the
CECT Ia ell GE AIT RIER TET]
for all future editors. The d
ialog allows you to specify th
e font type, size, and style.

Sl Script Adil LEEFI} 8

Before a script can be edited
IEEE RE TE HT
ation and workspace directory
must be defined in the Tool's
Eclipse Integration options.

For more information on develc
mim Chidra errinte in Erlineaabev/GhidraDev_README.html

SLE CA ILINT]

Ghidra Script Manager 3/4
Allows you to assign a key bin
ding the selected script.

1. Click in the text field and
tvpe the kev or kevstroke comSL EL RE LS

The script key bindings are st
ored in the Tool's Key Binding
options.

Delete Script

Deletes the selected script. Y
ou will receive a confirmation
dialog.I
You cannot delete scripts in t
he system directory, as this m
ay affect other users. If you
attempt to delete a system scr
ipt, you will receive a warnin

g dialog.

Rename Script

Renames the selected script. W
hen selecting Rename, GhidraCreate New Script

Creates a new empty script anc
displays it in a Script Edito

8

If more than one GhidraScriptP
rovider exists, then you will
have to choose what type of sc
ript to create.script.

Refresh Script List

Refreshes the script list by r
e-scanning the script director
ies.

Blea pl Ela del I=]

Allows you to add and remove
irectories to search for scrip

FE i VO TL Pavarious system airectories (e.
d., $GHIDRA_HOME/Features/B
/ghidra_scripts

). You

can save directories, but igno
re them in the Script Manager
dialog by selecting/deselectin
g the "Use" column checkbox.Ll WL

can save directories, but igno
re them in the Script Manager
dialog by selecting/deselectin
g the "Use" column checkbox.

Ghidra Script Manager 4/4

Help
Opens the Ghidra help viewerProvided by: Ghidra Script Man
ager Plugin

Related Topics

Key BindingsSymbol Table 1/6

The Symbol Table displays a ta
bular view of each symbol curr
ently defined in the program.
A symbol, also known as a labe
I, is an association between a
name and an address.lullehillale

From the menu-bar of a tool, s
Clea Uh

Symbol Table

From the tool-bar of a tool, c
[IL QT RT]

button

The columns in the table are:
LabelNe Vi sy ITIVE.
Location

Address where the symbol is d
fined.

5

Symbol type (Function, ExterneDatatype

Datatype (i.e., byte, float, e
tc.) applied at symbol address

Namespace Namespace of the
bol; i.e., the scope.
Sourcee came from.

Reference
Count

Total number of references ma
e to this symbol.

You can n sort the table on anyorted in ascending or descendi
RIS

The colors for bad references,
entry points, dead code, offc
ut code, function names, local
symbols, primary and non-prin
ary symbols

correspond to the colors used

in the Code Browser. Any chan
PULL Yn nL eri WNoptions will be

The colors for bad references

, entry points, dead code, off
cut code, function names, loca
| symbols, primary and non-pri
mary symbols

correspond to the colors used
in the Code Browser. Anv chan:LE UL od lg bl
options will be

reflected in the Symbol Table.
Symbol Table

2/6
Filter Text Field

The filter text field allows y
ou to filter the list of symboEi al
Pr. [or behavior to be "Sta
rts With",

"Matches Exactly”, or "Regular
Expression”. See Filter Optio
ns for more details on the var
ious filter text strategies.

The Name Only checkbox allow

you to toggle whether to filte

r on only the name column or ¢ept basic globbing characters
such as *' and '?" within the
filter text unless the "Regul

ar Expression" filter strategy

is selected, in

which case you should use star
dard regular expression syntaxDeleting Symbols

You can use the Symbol Table
o delete symbols from the prog
[CIN

To delete symbols:

1. Select the symbols in the S
ymbol Table (hold the <Ctrl> §
ey down to add to the selectio
UE |t "Delete Trom the popup men
Ie Te qT)

button in the Symbol Table too
LETS

Notes on deleting a symbol:
1. You can only delete a defau
It symbol when it has zero (0)
references.

2 If vou delete a user-defineLie Lb SLE RL EEL LL tbl
ically be created and assigned
those references.

3. You can delete a non-primar
y symbol with references, but
those references will be reass
igned to the primary the symb:
I.

Renaming a Symbolbaal’

To rename a symbol:

 

hal RL ol

In the Symbol Table, double-cl
ick in the "Label" field on thThe field will become editable
Enter a new name and press re
PI]

The new name for the symbol
ould display in the table and
Code Browser

If the table is being sorted o

n the "Label" field, then the
new name should be sorted intEdit External Location

You can edit the external loca
tion and associated library de
tails for any External Data or
External Function symbol with
in the symbol table. Right mou
se click on

the symbol table row and choo
a tha Edit Eviarnal | nratinme symbol Iree - Edit External
Location for more discussion o
n the

use of the edit dialog).

Making a Selection

You can make a selection that
corresponds to the symbol add
esses that are selected in the
Svmbol Table.Lead sicib il bo R ALLEL CL LEE LL
ymbol Table (hold the <Ctrl> §
ey down to add to the selectio
n) to be added to the selectio
iB

2. Right-mouse-click and selec
t "Make Selection" from the po
pup menu.

Or, click thebutton in the Symbol Table too
LETS

[HELIER lo]
Symbol Table 3/6

Code, data, or function labels
may be pinned which keeps ttk move or an image base chan

To pin a label:

1. Select the symbols to be pi
nned in the Symbol Table (holc
the <Ctrl> key down to add tc
the selection) to be added to
the selection.

2. Right-| mouse: Sell qT Le] EsTo unpin a label:

1. Select the symbols to be un
pinned in the Symbol Table (hc
Id the <Ctrl> key down to add
to the selection) to be added
to the selection.

2. Right-mouse-click and selec
t "Clear Pinned Symbol(s)" fro
m the popup menu.I'ne list of displayed symbols
is determined by the currents
ymbol table settings. These se
ttings can be adjusted by clic
king the Filter

button in the toolbar of

the Symbol Table window or fr
m the right-mouse popup men
The displayed symbols will co
rrespond to the selected checkdialog.
Symbol Table Filter Dialog

The Symbol Table Filter dialog
consists of three sets of fil

ters - Symbol Source, Symbol T
ypes, and miscellaneous Advar
ed filters which are not initifer divided 131] label symbo
Is and non-label symbols. This
grouping is for informational
purposes only. For most situa
[ls EH

only the Source and Type filte
rs need to be set. This will g
enerate a query that will incl
ude all symbols that have one[ERE ETel ite Ra Yo SEN

Symbol Source Filters- this gr
oup determines which symbols
based on how they originated)
should be included in the quer
y. At least one of the source
MISS

must be selected.

User Defined This filter incluImported This filter includes
all symbols named by some im
rted information.

Analysis This filter includes

all symbols created by auto-an
alysis that do not have defaul
t names.

Default (Function) - This filt

er includes all function symbo
[EEN a Lerncludesl all non-function symb
ols that have default names (G
hidra generally creates defaul
t-named symbols at any
address that is referenced by
some other location.)

Symbol Type Filters - This gro
up of filters determines which
types of symbols to include i
n the auerv. All symbols in GhYes. AL
least one of these type filter
s must be selected.

Symbol Type Filters - This gr

oup of filters determines whic
h types of symbols to include
in the query. All symbols in G
hidra are one of the followingCA aa
s must be selected.
Instruction Labels - labels at
addresses with instructions .
Note these do NOT include lab
els where functions exist.

Data Labels - labels at addres
ses with data or external labe
Is. Note these do NOT include
labels where functions exists.fined (includes external funct
[HEN

Namespaces - Namespace nar
mbols.

Classes - C++ class names syn
ols.

External Library - External li
brary name symbols.
Parameters - Function parametal variable name symbols.
Global Register Variable - glo
bal register variable name sym
bols.

Symbol Table 4/6

Use the Select All button to s

elect all symbol types and the
lami AI rr risassmdard 20 twAdvanced symbol Filters - Adve
nced filters are used to furth
er refine a query to only incl
ude symbols that meet various
specific criteria. Each of the
advanced

filters only applies to a subs

et of the symbol types, so to
use one of these filters, the
appropriate symbol tvpe filterMl. ILLS Fg. LID SEAS

not have any of their associat
ed type filters set, are disab
led. Advanced filters can be t
ricky to use because each filt
er only applies to a subset of
the types and has

no effect on the other selecte
d types during the query. See
the examples below for more irdial asd
symbols which are external.
Non-Externals - Accepts only t
hose symbols which are not ex
ernal.

Primary Labels - Accepts only
labels that are the primary la
bel at an address. Applies to
Labels and Functions.
Non-Primary Labels - Accepts o

SB hatinlies to Labels and Functions.
Globals - Accepts the symbol i
fitis in the global namespac
e. Applies to Labels, Function
s, Namespaces, and classes.
Locals - Accepts the symbol if
itis NOT in the global names
pace. Applies to Labels, Funct
ions, DELS EEE and classes.riables that are register base
d. Applies to Parameters and |
ocal variables.

Stack Variables - Accepts func
tion parameters or local varia
bles that are stack based. App
lies to Parameters and local v
ariables.

Entry Points - Accepts labels

PANE Ea a LmFunctions.

Subroutines - Accepts labels t
hat are "called" by some instr
uction. (Does not include labe
Is where functions are defined
.) Applies to Labels.

Not In Memory - Accepts labels
that are at an address not co
ntained in memory. Applies to
Labels.BRL ae bl RL BE adh bE Eh
rences to them (also known as
"dead code"). Applies to Label
s and functions.

Offcut Labels - Accepts labels
that are at an address that i

s not the start of an instruct
ion or data. Applies to Labels

Advanced Filters affect the quhes the selected source(s) and
symbol type(s):
i

 

2.
ER

Find all selected advanced fil
ters that are appropriate for
the symbol's type.symbol.

If at least one advanced filte
ris appropriate, then the sym
bol is included if at least on
e of those filters accepts the
symbol.

Select the Use Advanced Filter
s checkbox to see the advanceThe Reset Filters button sets
all checkboxes back to their d
efault states.

Sample Queries

Sample Queries

Symbol Table 5/6

RAMes are selected:

Symbol Source: User Defined
Symbol Types: Instruction Labe
Is, Data Labels, and Function
Labels

Advanced Filter: none

Result:

All labels and functions that
are "user defined" will be sho
wh in the symbol table.LLL)
FETS

Symbol Source: User Defined, |
mported, Analysis, and Default
Symbol Types: Instruction Labe
Is and Data Labels

Advanced Filter: Subroutines
Result:

All labels that are the start

of a subroutine (not includingRE BF Eland

ines including those [or have
been defined as functions, al
so select the Functions type f
ilter.

 

[=Elnl EER

FETS

Symbol Source: User Defined, |
mported, Analysis, and DefaultAdvanced Filter: Stack Variabl
CE

Result:

All functions are displayed

All parameters that are stack
based are displayed. (Register
parameters have been filtered
out.)

Note LE Ju advanced filterore did not affect the display
of functions.

[= ElnlIERS

FETS

Symbol Source: User Defined, |
mported, Analysis, and Default
Symbol Types: Instruction Labe
Is, Data Labels, and Function
[ELE

Ardvancad Filtar Primary | ahalResult:

All labels are displayed

Note that since all labels are
either Primary labels or Non-
primary Labels, selecting both
of these advanced filters acc
omplished nothing.

The results would have been tf
e same if neither was selectedLE db Bs ALE JL
in
Related Topics

Related Topics
Labels
Listing Display Options

Symbol Table 6/6Version Tracking Introduction
pv

Version Tracking Introduction
Version Tracking refers to the
process used by reverse engin
[EIR Ole I= 113%

matching code or data betwee
different software binaries. Oent versions of the same binar
y. Alternatively,

version tracking techniques ca
n be used to check for the pre
sence of of a

particular piece of code withi

n a given binary of interest.
Perhaps the most common ver:
n tracking scenario is when yoanalyzed, identifying importan
t areas of interest and
annotating the code with comr
nts and labels. Suppose the so
ftware developer

releases a newer version of th
e software including bug fixes
and feature

modifications. Since customers
JIE NNN SAL "RR aanalyst will probably want to
continue evaluation with the n
ewer version as well.

However, it can be very time-c
onsuming to have to initiate t
he analysis from

scratch. In order to leverage
the existing work, version tra
cking enables the

reverse endineer to port commBASAL,
Perhaps the second most comr
version tracking scenario is
where you wish to

check for the presence of exis
ting code within a given binar
y. As an example,

given a small collection of fu
nctions, say from some library
of routines or codesearch for that code

in a given binary.

The remainder of this documer
describes high-level version
tracking concepts

use by Ghidra, followed by lin
ks to documents that describe
how to get started

VEE CHRIS RT Neh IIRAssociations
Matches
Markup Items
Correlators
How to Start

Version Tracking Session2/4

A session is created as a resu
It of running one of Ghidra's
matching algorithms

(a.k.a., a correlator) against
two binaries. The newly creat
ed session is stored in

the Ghidra Project Window. The

TIAL seman a LY eewithin that session (e.g., app
lying markup). Furthermore, si
nce changes are

saved, you may close and reop:
n a session to continue work a
ta later time.

Sessions can be updated with 1
ew data by running additional
matching

algorithms at anv time.Lbb lL Ch Ra lL
An association is any pairing
of information between the tw
versions of the

same program, which suggests
hat the items correspond with
one another in

some way. An association is ch
aracterized by a collection of
metadata includingmemory address

reference locating the items i
n each version, and the type o
f the items being

associated (data or function).
Sometimes a variable or functi
on in the source program will
be associated with

several variables or functionsthe version tracking algorithm
has found enough evidence to
support each

candidate as a possible corres
pondence between the two ver
ons. When this

happens, we say that they are
conflicting associations. It m
ay be that only one Nithe program has

changed sufficiently and none
of the associations is quite r
ight. Ultimately, the

analyst has to inspect the act
ual code to make a determinat
on about which

associations represents a vali
d match.

NTTlations which may be
conflicting because they inclu
de either the same source or t
he same destination

address will become blocked b
cause the tool only allows one
-to-one mappings.

Blocked and conflicting associ
ations which lead to other inc
onsistencies can be ahb Ll hb dt Lb
t versions.

Version Tracking Matches

A match is an association that
has been assigned a score. As
a correlator finds an
association it will assign tha

t association a score, thus cr
eating a match. Thehaut haballaab crt oboutlibed Bashy Sith

tors run within a

association it will assign th

at association a score, thus c
reating a match. The

matches table contains all mat
ches discovered by any correla
torsVersionIntroduction 3/4

given session. Users can use t
he score to help determine the
accuracy of a given

match, as not all matches crea
ted by the correlators are cor
rect.

When the you determine that ¢
match is valid, then you can arelated matches. When you ap
y markup for a

given match, then that match i
s automatically accepted. Fina
IACI RET [1 4-1+1+1)"2

markup for a match that has b
en blocked by another already
accepted match.

Ghidra also has the concept of
ei WCU LEY athen Ghidra will generate impli
ied matches for any functions
called by the two

functions that make up the fun
ction match.

Version Tracking Markup Items
During analysis of a program,
the analyst will develop a gre
ater understanding ofLadin ini Autti LLL
bels, data type

information, and parameter an
variable names to document t
e code and to

make it more readable. Ghidra
refers to all of these annotat
ed details as markup

ICInEN

For any given match we can afan appropriate manner so that
the labels and comments appe
in the

corresponding locations in the
new binary. This is the ultim
ate purpose of

version tracking, to retain an

y progress that has already be
en made inanges [2 the REILE
binary.

NE CLR CI RE EEG
There are many strategies for
identifying how different vers
ions of the a program

are related to each other. Any
ESS or algorithm that detes a correlator. Correlators ma

y be based on the

underlying bytes in a program,
the program flow, or any othe
r aspect of the code

upon which similarities may be
observed. Additional documen
ation is available

for the specific correlators u
ERLas UR RlC hg e

Version Tracking Introduction
2

This list presents a few diffe
rent useful links for getting
started with version
tracking.hhobl cL of BREE Lh IRL
Version Tracking Wizard

Provided by: Version Tracking
Plugin

Related Topics:

Workflow

NEGLECT te RET]

Version Tracking Wizard
Version Tracking Matches TabHeadless Analyzer
Headless Analyzer 1/2

The Headless Analyzer is a corn
mand-line-based (non-GUI) ver
ion of Ghidra that allows user
s to:r existing binaries

Run non-GUI scripts in a proje
ct (scripts may be program-dey
endent or program-independer
The Headless Analyzer can be 1
seful when performing repetiti
ve tasks on a project (i.e. i
mporting and analyzing a
[CHE TA RICERCA TT IT Te]Headless Analyzer Options
The following options are avai
lable for the Headless Analyze
|

analyzeHeadless [<project_loc:
tion> <project_name>[/<folde
path>]] |
[ghidra://<server>[:<port>]/<
epository_name>[/<folder_pat
1m+1 | [-process | <project _file>
Jil

[-preScript <ScriptName> [<a
ig!

[-postScript <ScriptName> [<:
g>1¥]

[-scriptPath "<pathl>[;<path:
=

[-propertiesPath "<pathl>[; <j
[LymLEAL af
[-log <path to log file>]
[-overwrite]

[-recursive]

[-readOnly]

[-deleteProject]

[-noanalysis]

[-processor <languagelD>]
[-cspec <compilerSpecID>]
[-analysisTimeoutPerFile <timeLi ahaa Rak

[-connect [<userID>]]

53]

[-commit ["<comment>"]]
[-max-cpu <max cpu cores to L
e>]

[-loader <desired loader name!

|

 

Accessing the Headless Analyzthe Headless Analyzer can be
found in your Ghidra installat
ion's support folder.

ghidra_x.x/support/analyzeHea
less[.bat]

Execute the analyzeHeadless s
ell script from the command li
ne with the desired options.Execute the analyzeHeadless s
hell script from the command |
ine with the desired options.
Headless Analyzer 2/2

Headless Analyzer Documenta
il

The analyzeHeadlessREADME.}
file contains details on Head
mee Arnshymy hams snd ArianGhidra Installation’'s support
LClCIS

ghidra_x.x/support/analyzeHea
lessREADME html
Glossary 1/33

Ghidra GlossaryFw ira 1 UV VE

XYZ

I:

Action

An operation the user can perf
orm in Ghidra. All menu items,
keybindings, and toolbar butto
ns are actions.cific location in memory.

 

Address Range

A sequential set of addresses
within a single Address Space
identified

by a minimum and maximum ¢
ss.XC IEEE oF Tel)

The set of all legal addresse

s in memory for a given proces
sor. The

nature of each address space i
s defined by the processor andAddress Table
Two or more consecutive addre
ses in memory.

Analyzer
A software module that examir
s and annotates the code in a

program to help reveal the beh
PRET IE IT VIL FREE CWTdisassembly, Tunction generati
on, and stack analysis.

Archive
See Data Archive.
See Project Archive.

Assembly Language
Programming language closely
ssociated with an individualAuto Analysis

Automated way to run all the a
nalyzers in the appropriate or
[1

(Example: function creation be
fore stack analysis).

BB
Glossary 3/33
Back Reference

Another name for the Source A
dress in a reference.ckground allowing the user to
perform
other tasks.

Base Address

An address from which other a
dresses are derived using offs
1Ht has no flow into or out of t

LC)

sequence except for the top an
d bottom (i.e., no branching).

Basic Block Model

A Block Model which partitions
code into small runs of instr
Ie

[A | TT FrEll

Branch instructions will cause
the execution flow to

change. Arithmetic and store/|
oad instructions do not break
a Basic

Block because they do not chal
ge the execution. A label will
also

end one block and beain anothBinary Data

Binary Data
Bytes that make up a program.

Big Endian
Byte order for storage such th
at the high-order byte is at te below, where increasing men
84

addresses are going from left
to right.

Block Model
A model which partitions the ¢
ode into address ranges based
on some[}
ELIT IN

Bookmark

Marker used to designate frequ
ently-visited or important loc
ations.

Bookmark TypeNote,
Info, Analysis, etc.

Browser Field

Glossary 4/33

Browser Field
PYRRTY

 

Tnlisting
window.

Byte Viewer

A Ghidra component used to d
play and edit the bytes in a p
[CF ICTnN

Cc
Call Block ModelCall Graph

Graph displaying the relations
hips between "function calls"
ina

program.

Calling Convention

Determines how a function rec
ives arguments and returns resons are currently determined b
y the

program's language specificati
[LR

  

Check-In

The process of contributing an
d merging changes from a "che
kedout" program to the globallGlossary 5/33

out" program to the globally
shared version of the program.
Glossary 6/33

Check-Outgram for
the purpose of making change:

Classpath
Path to search for Ghidra java
code.

Clear

Process of removing informatio
PRR VNR IR RA Cini ieetc).

Code Browser

A Default Ghidra tool for disp
laying and working with progre
ul

listings.

Code Block
RF: [ee 4fib LL
An Instruction or Data Item in
the listing.

Computed Call

Call instruction whose destin
ation is dynamically computedcuted conditionally.

Conditional Jump
A jump instruction that is exe
cuted conditionally.

Connecting Tools
Process of coordinating two or
more Tools with respect toContext Sensitive Menu

Menu that changes depending
cursor location. In other wor
ds,

only actions which are appropr
iate for the type of informati
[-]

which the cursor resides are a
vailable from the menu.Term used to indicate user-con
tributed plugins.

Core Plugins

Term applied to plugins that a
re supported by the Ghidra tea
m.

Cycle GroupCycle Group
Glossary 8/33

A sequence of data types appli
ed using the same action repex
[A(R

e. byte->word->dword->qworcLili Lili Lhl 4
Bytes in the program's memo
that are not interpreted as
instructions.

Data Type Archive

File used to store user-define
d data types independent of a
specific

program.oo Ai
A data item inside a structure
or array.

Data Type

A generalization of data which
uniquely defines its specific
attributes

such as size, structure and fo
rmat. Example: byte, float, doDead Code
Unreachable code.

Decompiler
Decompiler

Ghidra module for translating
assembly language to C.1 A pre-configured CodeBrows:
Tool that is ready to use whe
il

Ghidra is installed.

2 The tool that has been desig
nated to run when you double
lick

on a program in the Project Wi
ITAI'he "lo" address In a referenc
e "From-To" address pair. An
address that is referred "To"
by an instruction operand or p
ointer.

Diff
See Program Diff.

Direct ReferencesMyies idkic UY LITE diiliress UIT
LC)

current location in the browse
r. See Search for Direct Refer
[Chl

Disassemble

The process of interpreting pr
ogram bytes as assembly instru
ctions.[ell EET ATK

Disassemble, Restricted
Glossary 10/33

The Ghidra disassembly mode
ere disassembly is restrictedDisassemble, Static

The Ghidra disassembly mode
ere code flows are not followe
d

and only bytes at the current
location or selection are disa
ssembled.Library. A shared library on a
Windows platform.

Docking Window Component
Ghidra user interface compone
t that can be positioned and s
ized by

the user.

FLT. T PnDynamic Data Type

Data types whose structure var
ies depending on the data byte
Ed

which they are applied.

3Glossary 11/33

Abbreviation for Executable Li

nking Format. File format used
by

Unix and Linux operating syste
ms for storing executable prog
rams.dol aint Lainie

the right of the instruction.

Endian
Byte ordering. See Big Endian,
Little Endian.

SAIN
Location in a program where e;
ecution begins.Ghidra data type for modeling
C-type enums.

Equate

A string substitution for nume
ric values appearing in instru
ction

operands.ram information in various fil
e

formats (XML, HTML, ASCII, etc
).

formats (XML, HTML, ASCII, et
c).
Glossary 12/33A reference trom a location in
one program to a location in
another

program.

3
Fall Through Address

The address of the next sequer
tial instruction to be execute
IhFeVMILE Lisle YM.
Ghidra data types that can be
accessed via the popup-menu.

RE

A.K.A. Instruction Flow or Con
trol Flow. This the sequence o
hi

instructions that are executed
as a program runs, includingFlow Graph
Graph that shows basic instruc
lL RA

Forward Refs
Another name for the Destinati
on Address in a reference.ion Address in a reference.
Glossary 13/33

Fragment
A set of addresses used by the
Program Tree to organize code

Front EndPLlelT

A program element that is refe
renced via a call instruction.

I:

function has an entry point, a
body of instructions, a retur

n data

type, and optionally parameter

s, local variables, and local
ranictarFunction Signature
The name, return type, and pal
ameters of a function.

[c}

Ghidra

Ghidra is a java-based framewc
rk for reverse engineering. It
provides built-in capabilitieskn
support for user-provided plug
ins.

Ghidra File

Any file that is part of a Gh
idra Project.ation about a program.

Ghidra Project

Ghidra organizes work into pro
jects. All work is performed i

n the

context of a project.

Ghidra Project WindowGlobal Namespace

Symbols that are not in any sp
ecific namespace are said to b
ein the

"global" namespace. The globe
namespace is the default nam
ELHprogram database files that h
ave been
“zipped up".

H

REGIE

A display format in the Byte V
iewer used to display integer
values inA display format in the Byte
Viewer used to display integer
values in

LE

Hijacked File
A local program file in a proj
ect that is "hidina" a sharedbooth LEER RRR ld
ot access the shared program t
ntil

the local file is removed.
ERE L

A more permanent type of sele
<1,

HistoryIDA Pro
A commercially available rever

se engineering tool.

Importer
Reads a file (.xml, .dll, .so,
etc), and converts its contens multiple importers (correspo
nding

to a specific set of formats).
Additional importers can easi
ly be

added.

Initialized BlockInitialized Block

Memory block whose byte valu
exist as opposed to uninitial
ized

blocks whose byte values are u
nknown.

Instance Settings, Data Type

Nierlnw Ardea foe rm iv

 

aelil ~lERel

byte can be displayed as decin
al while another is displayed
as

hex. Also see Data Type Defaul
[Tl IIe T-R

Instruction
An assembly level command st
as MOV IMP etc.Libba SL
Binary file format specified b
y Intel generally used for ROM
images.

Isolated Entry Model

A block model defining subrou
ines. A subroutine block must
have

only one entry point, but mayy will stop if another is call
edora

source entry point is encounte
red.

 

S

[CALCITE]

Keyboard shortcut for invoking
Ghidra functionality.Keyboard shortcut for invokin
g Ghidra functionality.

L

Label

Symbol name associated with :
address in memory.The set of instructions associ
ated with a computer processo

Little Endian

Byte order for storage such th
at the low-order byte is at th
CE Taan le]

address, as shown in the figur
Nn ES ey WIaddresses are going rrom right
[CREE

Listing
The display of the assembly la

nguage along with comments
other markup information.

Local MenuLocal Menu

A menu that is associated with
a specific Ghidra docking win
[IVR

Local Symbol
A symbol that is local to a pa
rticular function.Marker

Used to indicate a significant
location in a program (ex: bo
okmarks,

search results, analysis probl
ems, etc).

Memory
The component of a program tladdresses where those bytes al
e located in the program's add
ress

ELH

Memory Block

A contiguous set of bytes anch
ored at an address. Memory col
sistsMemory Map

Ghidra GUI that allows the use
r to view and edit the Memory
FI

of a program.

Glossary 18/33

A"Memory Reference

A reference from a mnemonic
operand to another address in
lu)

same program.

[ETS]
1. The process of resolving th
e differences between a checksheb tb fot SL LIL AL ER i TL LL
shared version of a program.
2. The process of retrieving c¢
hanges made by others to the
globally shared version of the
program and incorporating
those changes into your progra
m without introducing your
changes into the shared versio
n (i.e. doing a check-in).Low-level instructions used to
implement a machine instruct
[LR

Mnemonic

The name of an instruction as
it appears in the assembly lis
LAL CARN

mov, add, jmp, etc.)Dialogs that prevent user inte
raction with any other Ghidra
component until the dialog is
dismissed.

[IIIT RL Te

Binary file LSE HEE]images.

Multiple Entry Model

A block model defining subrou
ines. A subroutine block may h
ave

multiple entry points and may
not overlap code from other
ELIT INerm used when multiple user:
are working together using sha
red

projects and programs.

N

Name Space

Defines a scope such that all
symbol names within that sco.
PY)NE

Abbreviation for New Executab
e. File format used by Windows
3.1.x operating systems for st
oring executable programs.

[e)
OffcutA reference into the middle o
f some instruction or data ite
ul

Offline

A situation when a shared Ghic
ra project cannot connect to t
LC)Operand
The arguments of an assembly
Eile

Overlapped Code Model

A block model defining subrou
ines. A subroutine block is al

| code

accessible from a single entrymay be shared with other subr
utines. Each subroutine is def
ined to

include the overlapping code a
s part of its body.

Overlay

A memory block that occupies
he same memory address rang
ap
Partitioned Code Model

A block model defining subrou
ines. There is exactly one ent
ry

point which may be a call or a
ny other flow instruction. Eac

h

instruction belonas to exactlyMLAS

Glossary 21/33

PCode

A form of microcode used by G
idra to model the semantics of
machine- or assembly-level ins
[Iai ENAbbreviation for Portable Exec
utable. File format used by
Microsoft for storing executab
le programs.

PKI Authentication

One of the ways a Ghidra clien
t can use to identify itself t

o thePlate Comment

Comments that are displayed &
a block header above the
instruction. Plate comments ar
e automatically surrounded by
*'s,

Plugin
ERLE bundles AG can optiadditional functionality.

Plugin Dependency

The required presence of addit
ional plugins before a particu
[Eg

plugin can be loaded.

Plugin TablePlugin Table

A table view of available Plug
ins that can be added to a too
I, as

shown in the Configure tool di
alog.

GH m=)LE Llu db bl LE hb
tool, as

shown in the Configure tool di
alog. The Plugins are grouped
by

functionality and displayed in
a tree-like format.

Popup menu
A context-sensitive menu thatmouse button.

Post Comment
Comments that are displayed k
low the instruction.

[FEN
Comments that are displayed &
ove the instruction.Project compressed into a sing
le file for archival or transf
SY ITe EES

Program

Ghidra's representation of an
executable binary, its analysi
sandGhidra's representation of an
executable binary, its analys
[FELL]

annotations.

Program Diff
Abbreviation for Program Diffe

rence. It is the process of
SPRY. SEL | Le SAPI SRls
similarities and differences.

Primary Label

The most important label at a
location. It is the label that
will appear

by default in all references t
o that location.LRELL Rhus ELE ll LL EL
ocessor.

[lI NETS
The set of register values at
any location in a program.

Program Tree
The Ghidra GUI module that all
ows the user to organize the mProject

A collection of files (program
s, etc) and user configuration
information.

Glossary 24/33Project Repository

A directory on a server that i
s used by Ghidra's Multi-User
lel TV]

to store shared programs.

[die] 4a%
La) RSI mechanism used 22program at specific addresses.

3

Read-Only Project

A project that can be opened f
or viewing but cannot be chang
ed (i.e.

someone else owns this project

).I'ne process of repeating the |
ast change that was "undone".

Reference

A link from the mnemonic or o|
erand of an instruction to a
destination. The destination i

s an address, stack variable,

or external

address in another proaram.Fd lati

A special-purpose storage loc
ation in a processor.

Regular Expression
A character sequence used to
atch patterns in strings.ons that need to be updated [e
[CCled

where the program is loaded ir
LENT"

Running Tools

An area on the Ghidra Project
Window that displays a list of
iconsBS)
ELIE
A numeric value in a program.

Scope
The set of addresses for which
a variable is defined.hat are displayed by the code
browser (i.

e. address, mnemonic, operanc
comment, etc.)

Glossary 26/33

The individual listing items
A TT TIVR RTI€. address, mnemonic, operanc
comment, etc.)

Select Limited Flow

A Ghidra process that involves
following a programs logic
but

excluding all branches (condit
ional and unconditional). Sele
ctbhi" Ahatli ls “Ll LEE ta
CA

a program. Select Limited Flow
is an option in the Code Brow
EI

Selection

A set of addresses that have b
een chosen by the user in orde
rtoShared Project

A project that is associated w
ith a Ghidra Server. The files
ina

shared project are accessible
by other users.

Shared Program
A program that can be modifiereside in project repositories
on a server rather than in lo
cal projects

on the user's workstation.

Simple Block Model
See Basic Block Model

SLEDsfora

Glossary 27/33

Table-based mechanism for sp
cifying the syntax and semanti
cs fora

processor language.Improved version of SLED. Allo
ws language-writers to more
accurately represent all featu
res of a language.

Source Address

The "From" address in a refere
nce "From-To" address pair. Ar
address of an instruction or p
ointer that refers to anotherStack Reference
A reference from a mnemonic
operand to a stack variable.

Stack Variable

A parameter or local variable
definition on the stack frame
defined

by a function.= a nd

A version of disassembly where
jump and call instructions ar
e not

followed.

Status Window

Area at the bottom of a Ghidra
tool used to display messages
to theGlossary 28/33

user.
Glossary 29/33

Subroutine Model
A Block Model which partitions
code into address ranges baseecific model. Subroutine mode
B

generally define blocks whose
entry point(s) correspond to c¢

alled

locations.

Symbol
A label that associates a name
PTTL IASymbol lable
A component of program conta
ing all the label information.

Symbol Tree

Ghidra GUI module used to dis
lay symbols in a tree structur
e.

Tilk bil SEE LLL Bb SE LE
e sub-windows that can be sel
cted

using tabs.

Terminator
Any assembly instruction that
has no flow (ex: Halt).Text Highlighting

The mode in the Code Browser
here all the uses of a given w
ord

are highlighted in yellow.

LLITLIS
Thunks are functions, called ban indirect or external functi
on call.

LINES

An area on the Ghidra Project
window that displays icons for
lu)

configured and saved Tools wh
ch are available to a user.A collection of Plugins that w
ork together to produce a usef
ul GUI

for performing some user level
task.

Tool Tip

A popup description that appe:
rs when the mouse is hovered «
_—Toolbar (local and global)
An icon bar used to invoke Ghi
dra functionality.

Glossary 30/33Unconditional Call
A call instruction that always
executes.

Unconditional Jump
A jump instruction that always
executes.

Undefined DataL iid
ions or

data. By default, all bytes in

a program begin as Undefined
Data.

 

Undo
The process of removing the la
st change made to a program.wn frame and can be positione
and

sized independently from othe
Ghidra windows.

Unresolved External Reference
An external reference that has
not been linked to any progra
[uRL ROE]User Access List

The list of users that have ac
cess to a particular shared re
pository on

a Ghidra server. The list cont
ains usernames and permissior

 

lear AiFhantica:daentity of a client user to th
e server.

Vv

NES Chel ale]

The process of maintaining mu
tiple versions of a program as
changes are made.

Version HistoryRR ELL A LEER LE hy ll
. Any

previous version of the progra
m can be selected for viewing
from

the View History dialog.

Versioned Program
A program that has been place
under version control in a Gh= hand Lol
history of all the changes ma
de to that
program.

Viewed Project

A project that has been open a
s read-only. Projects that you
do notA project that has been open
as read-only. Projects that yo
FECT]

own can only be opened as a V
ewed Project.

w
SLC LICiS

XREF

Abbreviation for cross referen
ce. CodeBrowser's display of S
ource

LACTIS

Glossary 33/33GHIDRA Training 24
CRET//CYBER//NOFORNGhidra What's New 1/1

What's New in Ghidra 9.0
Ghidra: NSA Reverse Engineeri
g Software

Ghidra is a software a )

Cg “".Directorate. This framework in
cludes a suite of full-feature

d, high-end software analysis
tools that enable users to ana
lyze compiled code on a variet
y of platforms including
Windows, Mac OS, and Linux. C
pabilities include disassembly

, assembly, decompilation,
RE ——

 

JERE IR eoes. Ghidra supports a wiae
variety of process instruction
sets and executable formats a
nd can be run in both
user-interactive and automate
modes. Users may also develo
their own Ghidra plug-in
components and/or scripts usir
g the exposed API.

In support of NSA's CvbersecurLdadl do bos MLLhl RELL LL LL
problems on complex SRE effol
s, and to provide a customizab
le and extensible SRE

research platform. NSA has apj
lied Ghidra SRE capabilities t
o a variety of problems that
involve analyzing malicious co
de and generating deep insigh
s for NSA analysts who seek as and systems.
https://www.nsa.gov/ghidra

Ghidra Tips 1/5
Ghidra Tips of the Day

Ghidra provides context sensit
ive help on menu items, dialogress F1 or Help on any menu it
em or dialog. If specific

help is not available for an i
tem, this page will be display
ed.

In sortable tables you can sor
t on multiple columns by click
ing on a column and then
Control-clicking additional coolumns as desired by right-cli
cking on a table header.

You can change the look and fe
el of your tools by using the
"Edit->Options" command.
You can UNDO and REDO usin
e curved arrows on the menu k
N

You can have more than one pi
RRysrvs Terai Shes weve trond | OTSwitch between them.

You can bring a new program i
to Ghidra by selecting File->|
mport File from either

the front end manager or any t
ool.

You can import programs by dr
gging them onto the Ghidra Fri
nt End Manager.

You can assian kevbindinas toBM WIEN LHS Fa Rey.
The Program Tree is an organiz
ational view of the program th
at is initialized with the

same organization as the mem
y map. Changes to the Progran
Tree only change your

view of the program, not the M
emory Map.

The Program Tree allows a procLabi la
fragments. You can yrs [lvls]
le Program Trees.

You can add memory overlays |
your program using the Memo
Map dialog.

Did you know that you can cre:
te and edit structures from th
CIE T-I Ted

Did you know that you can appthe Decompiler figures out? Ju
st right click on them and cho
ose Apply Locals or

Apply Params/Return to get the
m all for a particular functio

n. You can also run the
Decompiler Parameter ID analy
is option to apply the Decompi
ler parameters when theot->Decompiler
Parameter ID to do it after an
alysis.

program is initially being an
alyzed or choose Analyis-One S
hot->Decompiler

Parameter ID to do it after an
nnDid you Know that you can run
various analyzers separately a
nd after the initial

analysis run? See Analysis->Or
e Shot for a list of them.

Did you know that you can righ
t-click on the marker margin t
o learn the meaning of

each color.

The largest diamond that was ¢2 thal LR LL Ls "LLL Ll
ng the byte viewer provided th
ose bytes are not
disassembled.

You can add URL's to your com
ents to link to other document
ERT BULTIC

making a comment to learn ho
You can embed links to other
rogram locations in your commhal atid ds adil

ut 2 pounds.

You can create structures, uni
ons, and enums using the Ghid
a data type manager.

Use enums (not equates) to ge
constant names to appear int
he decompiler. Enums are

also listed in the Equates men
u if you want to make one an e(eg structure) editor, double-
click on the "DataType"
column.

Ghidra can extract datatype an
d function signatures from C h
eader files using the

CParser.

You can drag datatypes from tt
S datatype manager and drop iYou can apply multiple copies

of a data type by making a sel

ection and then dragging

that data type from the Data T
ype Manager onto the selectior

You can find view information
about your current program by
selecting "Help ->

Arai Fmrrrirsnive msmweaslon and analysis options by sel
ecting "Edit->Options for
{program name}".

You can compare any two Ghid
programs (or Ghidra versions
of a program) using

the "Open Diff View" action fr
om the Listing's toolbar.Lb LLU EL lil Rabb
Ghidra Tips 3/5

Did you know that Ghidra does
version tracking? It includes
data version tracking as

well as function version track
ing. It also has numerous algo
rithms for finding matches.
Use the "Footprint" tool to geDid you know that you don't he
ve to remember a whole label t
o navigate to it? Simply

type 'g" to bring up the Goto
dialog and type in a partial |
abel then a "*'. If there are
more than one matches it will
bring up a navigable list of m
atches.igh language syntax and
compiler.

You can bring up an online pro
cessor manual (for most proces
sors) by right mousing

on an instruction and choosing
Processor Manual.

You can have snapshot (discon
Bel views of the Listing, Bcon to create a snapshot.
Windows within a Ghidra tool
an be moved, stacked, resized,
and undocked to suit

your layout preferences.

Did you know there is a Call T
ree Window that shows calls to
and from a given

function? Click on the green a
[ORAL CAEL I 1 I SmetA jiffy is an actual unit of t

ime for 1/100th of a second. T

hus the saying, | will be

there in a jiffy.

Did you know that all searches
and selections work on the cu

rrent selection?

Did you know that you can rest
ore vour last Selection if vouho lilingll | Beihai Ch dh
tion?

Did you know you can make a |
ble from a selection? See Sele
ct->Create Table from
Selection.

Did you know that you can mal
a selection from a table? Sim
ply highlight one or

more rows in the table and rigGhidra provides many customi:
ble tool options, see Edit->To
ol Options.

You can add symbol informatio
to your comments that autom:
ically update when

your symbols change. Hit F1 w
ile making a comment to learn
how.Bamboo plants can grow up to
36 inches in a day.

Ghidra Tips 4/5

To change direction of the "Ne
PCLT Code Unit" buttonsYou can use the Byte Viewer to
display bytes not just in hex

, but also octal, decimal,

ascii, etc.

You can use the Byte Viewer to
edit bytes. If you want to ed
itin hex use the hex view.

If you want to edit in ascii,

use the ascii view, etc...

TTS TVIn 1690, there was no sunshine
for the whole month of Decem
er in Westminster,

London.

You can change the representa
ion of scalars (hex, char, dec
imal, octal, etc) by using

the right mouse Convert comm
d.

You can clean up those peskv rLIL AEB AL) LCR hd
on the byte value you wish to
condense and running the Con
nseAllRepeatingBytes

Elda]

In 1992, the Antarctic Ozone h
ole was larger than the contin
ent of North America.

Did you know you can see whe
a register is initialized intton? All instances of the reg
ister in the current scope
will highlight in bright yello
w. The mustard yellow one is w
here it is initialized in the
current scope.

You can perform a program me
ry search using a regular expr
ession (regex).they are displayed in the
CodeBrowser. Do a Search -> F
ogram Text on Labels for "Rsrc
_lcon*" and

"Rsrc_Bitmap*" to find them.
The average temperature on E:
th is 15 degrees celsius.

If you hover on a reference in
the XREF or operand fields, aIf you hover on a data type in
the CodeBrowser or Data Type
Manager, a popup with

the data type definition will
appear.

You can add your own referenc
s just about anywhere and you
can have more than one€s Just about anywhere and yo!
can have more

than

Ghidra

LI EL

LTA)

of them on an item. See the ri
ght mouse References options.
You can write Ghidra scripts u
sina lava or Pvthon.Le lia LRA Lb) LL Ra bE
er. Install the GhidraDev
plugin for Eclipse to get star
LCC

Double-clicking on addresses a
nd labels in the console will
navigate to them.
Double-clicking on the "functi
on" area of the tool status ba

r will navigate to thegured to follow computed and
onditional calls and

JCI] -:R

You can reconfigure the brows:
r display by adding / removing
/ moving / resizing

HEC ERTS CR REEVE] g
tool!)

Did you know that you can runuser interface? (See analyzeHe
adlessREADME.html in the {Ins
all Dir}/support folder.

This is the last tip. You can
turn them off now.

Block Model 1/2A Block Model partitions the c
ode into address ranges based
on some set of rules. The most
obvious partitioning is by su
broutine. There are four Subro
Pla,

Models (i.e., Call Block Model
s). Each subroutine model defi

nes a subroutine slightly diff
URL RL —ba

points and whether overlappin
code between subroutines is a
llowed. It is important to not

e that all of these subroutine
models will all produce the s
ame result

for an M-Model subroutine whic
[RNC EER I TERT lds A TIT
Ihibhoie IE LLL
Model

Isolated Entry*
Multiple Entry
Overlapped
Code*
Partitioned Code*Entry
Il

po!

1 or more

[¢]
pEntry Point Type

Yes

only call
[LUE

ERIE NTI)[LUE
1
No

any

lenlatard Entry Madalk* - A ciibhrY point but may share code wit
h another subroutine. The subr
outine body will stop if anoth
3

called or source entry point i

s encountered.

Multiple Entry Model - A subro
utine may have multiple entry
points and may not overlap coc
e from other subroutines.Lhd t tll i Rt lb Lt EL
from a single entry point and
terminates at returns. Code m
ay be shared with other subrou
[<LCEN

Each subroutine is defined to
include the overlapping code a
s part of its body.

Partitioned Code Model* - Ther
e is exactly one entry point wngs to exactly one subroutine
(code
is not shared).

The default subroutine model f
or the tool can be specified f
rom Edit Tool Options dialog o
n Tool panel. The default subr
outine model is generallyroutine model choice (e.g., su
broutine selection, call graph
, symbol table, etc.).

There is a more primitive Bloc
k Model called a Basic (or Sim
ple) Block Model. Such blocks
generally consist of small run
s of instructions partitioned
basedwill cause the execution flow
to change, creating a new bloc
k. Arithmetic and store/load
instructions do not break a Ba
sic Block because they do not
change the execution flow. A |
abel will also end one block a
nd begin another.

In the example below each col
Se I ee eeeBlock Model 2/2

Provided By: Block Model Servi
ce Plugin

Related Topics:

Create Function

Select SubroutinesLiban UE Ab ed
Processor Languages 1/2

All processors have an associa
ted language that defines the
mapping between user readab
assembly language instruction:
(e.g. MOV, ADD, etc.) and the
irimage for a specific processor
, Ghidra requires a language m
odule for that processor. A la
nguage

module is the software that im
plements the language transla
ion. Ghidra has a set of langu
age modules for the most comi
nly-used processor languages.ra by writing new language mc
ules.

Ghidra uses a processor model
ng language called Sleigh to d
efine the binary parsing and i
nstruction symantics associate
d with each language. The serr
ntic

[CIEE] allows for more adThe list of available language
s can be found in the Ghidra R
elease Notes.

Setting a Program's Language
All programs are initially ass
igned a Processor Language wi
n they are first imported into

a project. The processor lang
FL rd Seren. SE TORrelated language. Any stored r
egister values will be transfe
rred if there is a register wi

th the same name in the new |
nguage. If a matching register
can't be found

those values will be removed.
If your program has been adde
to version control in a share

d proiect vou must first have